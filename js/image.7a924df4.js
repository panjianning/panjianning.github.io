import{a as e,bn as i,bj as t,o as a,l as r,M as s,K as n,J as l,bi as o,e as d,s as h,L as g,aD as m,H as c,V as u,r as p,t as f,G as v,c as y}from"./main.4a37ea2b.js";const I=e({name:"Grid",provide(){return{GridInstance:this}},props:{col:{type:Number,default:3},square:{type:Boolean,default:!1},padding:{type:String,default:"24px"},center:{type:Boolean,default:!1},border:{type:Boolean,default:!0},hover:{type:Boolean,default:!1}},data:()=>({resizeCount:0,handleResize:()=>{}}),computed:{classes(){return{"ivu-grid-center":this.center,"ivu-grid-border":this.border,"ivu-grid-hover":this.hover}}},methods:{onResize(){this.resizeCount++}},mounted(){this.handleResize=i(this.onResize,150,{leading:!1}),this.observer=t(),this.observer.listenTo(this.$refs.grid,this.handleResize)},beforeUnmount(){this.observer.removeListener(this.$refs.grid,this.handleResize)}},[["render",function(e,i,t,l,o,d){return a(),r("div",{class:n(["ivu-grid",d.classes]),ref:"grid"},[s(e.$slots,"default")],2)}]]);const w=e({name:"GridItem",inject:["GridInstance"],data:()=>({height:0}),computed:{col(){return this.GridInstance.col},square(){return this.GridInstance.square},styles(){const e={width:100/this.col+"%"};return this.height&&this.square&&(e.height=`${this.height}px`),e},mainStyles(){return{padding:this.GridInstance.padding}}},watch:{col(){l((()=>{this.handleChangeHeight()}))},square(){this.handleChangeHeight()},"GridInstance.resizeCount"(){this.handleChangeHeight()}},methods:{handleChangeHeight(){if(this.square){const e=this.$refs.col;this.height=parseFloat(o(e,"width"))}}},mounted(){this.handleChangeHeight()}},[["render",function(e,i,t,n,l,o){return a(),r("div",{class:"ivu-grid-item",style:h(o.styles),ref:"col"},[d("div",{class:"ivu-grid-item-main",style:h(o.mainStyles)},[s(e.$slots,"default")],4)],4)}]]),b={name:"Image",mixins:[g],components:{ImagePreview:m},emits:["on-load","on-error","on-switch","on-close","on-click"],props:{src:{type:String,default:""},alt:{type:String,default:""},preview:{type:Boolean,default:!1},referrerPolicy:{type:String,default:""},width:{type:[String,Number],default:""},height:{type:[String,Number],default:""},fit:{type:String,default:""},lazy:{type:Boolean,default:!1},scrollContainer:{type:[String],default:""},transfer:{type:Boolean,default(){const e=c().appContext.config.globalProperties;return!(!e.$VIEWUI||""===e.$VIEWUI.transfer)&&e.$VIEWUI.transfer}},maskClosable:{type:Boolean,default:!0},previewList:{type:Array},infinite:{type:Boolean,default:!0},initialIndex:{type:Number,default:0},previewTip:{type:Boolean,default:!0},toolbar:{type:Array,default(){const e=c().appContext.config.globalProperties;return e.$VIEWUI&&e.$VIEWUI.image&&""!==e.$VIEWUI.image.toolbar?e.$VIEWUI.image.toolbar:["zoomIn","zoomOut","original","rotateLeft","rotateRight","download"]}}},data:()=>({loadingImage:!1,loading:!1,imageError:!1,scrollElement:null,observer:null,imagePreviewModal:!1}),watch:{src(){this.loadImage()}},computed:{innerClasses(){return["ivu-image-inner",{"ivu-image-cursor":this.preview}]},imgClasses(){return["ivu-image-img",{"ivu-image-img-hidden":this.loading||this.imageError}]},fitStyle(){const{fit:e}=this;return["fill","contain","cover","none","scale-down"].includes(e)?`object-fit:${e};`:""},imageStyles(){return{width:"number"==typeof this.width?`${this.width}px`:this.width,height:"number"==typeof this.height?`${this.height}px`:this.height}},loadingLang(){return this.t("i.select.loading")},failLang(){return this.t("i.image.fail")},previewLang(){return this.t("i.image.preview")},loadingType(){return this.lazy?"lazy":"eager"}},mounted(){u&&this.handleImageEvent()},methods:{handleLazy(){const e=this.$refs.image;(this.observer=new IntersectionObserver(this.handlerObserveImage,{root:this.scrollElement,rootMargin:"0px",threshold:0})).observe(e)},handlerObserveImage(e){for(let i of e)i.isIntersecting&&(this.offObserver(),this.loadImage())},addLazyImageListener(){const{scrollContainer:e}=this;var i;this.scrollElement=null,i=e,"object"==typeof HTMLElement&&i instanceof HTMLElement?this.scrollElement=e:e&&"string"==typeof e&&(this.scrollElement=document.querySelector(e)),this.handleLazy()},handleImageLoad(){this.loading=!1,this.imageError=!1,this.$emit("on-load")},handleImageError(){this.loading=!1,this.imageError=!0,this.loadingImage=!1,this.$emit("on-error")},loadImage(){this.loading=!0,this.imageError=!1,this.loadingImage=!0},handleImageEvent(){const{lazy:e}=this;e?this.addLazyImageListener():this.loadImage()},offObserver(){const{observer:e}=this;e&&e.disconnect()},handlePreview(){const{preview:e,initialIndex:i}=this;e&&(this.imagePreviewModal=!0,this.$emit("on-click",{initialIndex:i}))},handleClose(){this.$emit("on-close")},handleSwitch(e){this.$emit("on-switch",e)}},beforeUnmount(){this.offObserver()}},E={key:0,class:"ivu-image-placeholder"},$={key:1,class:"ivu-image-error"},C=["alt","src","loading","referrerPolicy"],L={class:"ivu-image-mark"};const z=e(b,[["render",function(e,i,t,l,o,g){const m=p("ImagePreview");return a(),r("div",{class:"ivu-image",ref:"image",style:h(g.imageStyles)},[o.loading?(a(),r("div",E,[s(e.$slots,"placeholder",{},(()=>[d("span",null,f(g.loadingLang),1)]))])):o.imageError?(a(),r("div",$,[s(e.$slots,"error",{},(()=>[d("span",null,f(g.failLang),1)]))])):v("",!0),o.loadingImage?(a(),r("div",{key:2,class:n(g.innerClasses),onClick:i[2]||(i[2]=(...e)=>g.handlePreview&&g.handlePreview(...e))},[d("img",{class:n(g.imgClasses),style:h([g.fitStyle]),alt:t.alt,src:t.src,loading:g.loadingType,referrerPolicy:t.referrerPolicy,onLoad:i[0]||(i[0]=(...e)=>g.handleImageLoad&&g.handleImageLoad(...e)),onError:i[1]||(i[1]=(...e)=>g.handleImageError&&g.handleImageError(...e))},null,46,C),t.preview&&t.previewTip?s(e.$slots,"preview",{key:0},(()=>[d("div",L,[d("span",null,f(g.previewLang),1)])])):v("",!0)],2)):v("",!0),t.preview?(a(),y(m,{key:3,modelValue:o.imagePreviewModal,"onUpdate:modelValue":i[3]||(i[3]=e=>o.imagePreviewModal=e),"preview-list":t.previewList,"initial-index":t.initialIndex,infinite:t.infinite,"mask-closable":t.maskClosable,transfer:t.transfer,toolbar:t.toolbar,onOnClose:g.handleClose,onOnSwitch:g.handleSwitch},null,8,["modelValue","preview-list","initial-index","infinite","mask-closable","transfer","toolbar","onOnClose","onOnSwitch"])):v("",!0)],4)}]]);export{w as G,z as I,I as a};
