var t=Math.pow,e=(t,e,n)=>new Promise(((i,r)=>{var s=t=>{try{o(n.next(t))}catch(e){r(e)}},a=t=>{try{o(n.throw(t))}catch(e){r(e)}},o=t=>t.done?i(t.value):Promise.resolve(t.value).then(s,a);o((n=n.apply(t,e)).next())}));import{b6 as n,aT as i,b7 as r,f as s,u as a,av as o,g as l,aO as h,h as c,A as u,i as d,j as p,B as f,C as m,D as g,E as v,o as _,l as x,b as y,w as S,e as b,m as M,n as w,t as C,aF as T,F as E,q as A,p as P,G as R,c as W,b8 as L,aN as I,aP as k,aK as N,aL as O,aQ as U,aX as D,b9 as F,a_ as B,a$ as z,aZ as V,x as G,I as H,aB as q,y as X,z as j,a as J}from"./main.3a2286f1.js";import{r as Q,F as K,f as Z,_ as Y,I as $,c as tt,d as et,e as nt,S as it,b as rt,R as st,a as at,P as ot,C as lt}from"./UPNG.e1e11311.js";import{I as ht,G as ct,a as ut}from"./image.ab5fb070.js";import{_ as dt,H as pt,a as ft}from"./lang.vue_vue_type_script_setup_true_name_lang_lang.756f8adb.js";var mt,gt={};gt.parse=function(t){var e=function(t,e,n,i){gt.B;var r=gt.T,s={cmap:r.cmap,head:r.head,hhea:r.hhea,maxp:r.maxp,hmtx:r.hmtx,name:r.name,"OS/2":r.OS2,post:r.post,loca:r.loca,kern:r.kern,glyf:r.glyf,"CFF ":r.CFF,CBLC:r.CBLC,CBDT:r.CBDT,"SVG ":r.SVG,COLR:r.colr,CPAL:r.cpal,sbix:r.sbix},a={_data:t,_index:e,_offset:n};for(var o in s){var l=gt.findTable(t,o,n);if(l){var h=l[0],c=i[h];null==c&&(c=s[o].parseTab(t,h,l[1],a)),a[o]=i[h]=c}}return a},n=gt.B,i=new Uint8Array(t),r={};if("ttcf"==n.readASCII(i,0,4)){var s=4;n.readUshort(i,s),s+=2,n.readUshort(i,s),s+=2;var a=n.readUint(i,s);s+=4;for(var o=[],l=0;l<a;l++){var h=n.readUint(i,s);s+=4,o.push(e(i,l,h,r))}return o}return[e(i,0,0,r)]},gt.findTable=function(t,e,n){for(var i=gt.B,r=i.readUshort(t,n+4),s=n+12,a=0;a<r;a++){var o=i.readASCII(t,s,4);i.readUint(t,s+4);var l=i.readUint(t,s+8),h=i.readUint(t,s+12);if(o==e)return[l,h];s+=16}return null},gt.T={},gt.B={readFixed:function(t,e){return(t[e]<<8|t[e+1])+(t[e+2]<<8|t[e+3])/65540},readF2dot14:function(t,e){return gt.B.readShort(t,e)/16384},readInt:function(t,e){var n=gt.B.t.uint8;return n[0]=t[e+3],n[1]=t[e+2],n[2]=t[e+1],n[3]=t[e],gt.B.t.int32[0]},readInt8:function(t,e){return gt.B.t.uint8[0]=t[e],gt.B.t.int8[0]},readShort:function(t,e){return gt.B.t.uint16[0]=t[e]<<8|t[e+1],gt.B.t.int16[0]},readUshort:function(t,e){return t[e]<<8|t[e+1]},writeUshort:function(t,e,n){t[e]=n>>8&255,t[e+1]=255&n},readUshorts:function(t,e,n){for(var i=[],r=0;r<n;r++){var s=gt.B.readUshort(t,e+2*r);i.push(s)}return i},readUint:function(t,e){var n=gt.B.t.uint8;return n[3]=t[e],n[2]=t[e+1],n[1]=t[e+2],n[0]=t[e+3],gt.B.t.uint32[0]},writeUint:function(t,e,n){t[e]=n>>24&255,t[e+1]=n>>16&255,t[e+2]=n>>8&255,t[e+3]=n>>0&255},readUint64:function(t,e){return 4294967296*gt.B.readUint(t,e)+gt.B.readUint(t,e+4)},readASCII:function(t,e,n){for(var i="",r=0;r<n;r++)i+=String.fromCharCode(t[e+r]);return i},writeASCII:function(t,e,n){for(var i=0;i<n.length;i++)t[e+i]=n.charCodeAt(i)},readUnicode:function(t,e,n){for(var i="",r=0;r<n;r++){var s=t[e++]<<8|t[e++];i+=String.fromCharCode(s)}return i},_tdec:window.TextDecoder?new window.TextDecoder:null,readUTF8:function(t,e,n){var i=gt.B._tdec;return i&&0==e&&n==t.length?i.decode(t):gt.B.readASCII(t,e,n)},readBytes:function(t,e,n){for(var i=[],r=0;r<n;r++)i.push(t[e+r]);return i},readASCIIArray:function(t,e,n){for(var i=[],r=0;r<n;r++)i.push(String.fromCharCode(t[e+r]));return i},t:(mt=new ArrayBuffer(8),{buff:mt,int8:new Int8Array(mt),uint8:new Uint8Array(mt),int16:new Int16Array(mt),uint16:new Uint16Array(mt),int32:new Int32Array(mt),uint32:new Uint32Array(mt)})},gt.T.CFF={parseTab:function(t,e,n){var i=gt.B,r=gt.T.CFF;(t=new Uint8Array(t.buffer,e,n))[e=0],t[++e],t[++e],t[++e],e++;var s=[];e=r.readIndex(t,e,s);for(var a=[],o=0;o<s.length-1;o++)a.push(i.readASCII(t,e+s[o],s[o+1]-s[o]));e+=s[s.length-1];var l=[];e=r.readIndex(t,e,l);var h=[];for(o=0;o<l.length-1;o++)h.push(r.readDict(t,e+l[o],e+l[o+1]));e+=l[l.length-1];var c=h[0],u=[];e=r.readIndex(t,e,u);var d=[];for(o=0;o<u.length-1;o++)d.push(i.readASCII(t,e+u[o],u[o+1]-u[o]));if(e+=u[u.length-1],r.readSubrs(t,e,c),c.CharStrings&&(c.CharStrings=r.readBytes(t,c.CharStrings)),c.ROS){e=c.FDArray;var p=[];e=r.readIndex(t,e,p),c.FDArray=[];for(o=0;o<p.length-1;o++){var f=r.readDict(t,e+p[o],e+p[o+1]);r._readFDict(t,f,d),c.FDArray.push(f)}e+=p[p.length-1],e=c.FDSelect,c.FDSelect=[];var m=t[e];if(e++,3!=m)throw m;var g=i.readUshort(t,e);e+=2;for(o=0;o<g+1;o++)c.FDSelect.push(i.readUshort(t,e),t[e+2]),e+=3}return c.charset&&(c.charset=r.readCharset(t,c.charset,c.CharStrings.length)),r._readFDict(t,c,d),c},_readFDict:function(t,e,n){var i,r=gt.T.CFF;for(var s in e.Private&&(i=e.Private[1],e.Private=r.readDict(t,i,i+e.Private[0]),e.Private.Subrs&&r.readSubrs(t,i+e.Private.Subrs,e.Private)),e)-1!=["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(s)&&(e[s]=n[e[s]-426+35])},readSubrs:function(t,e,n){n.Subrs=gt.T.CFF.readBytes(t,e);var i,r=n.Subrs.length+1;i=r<1240?107:r<33900?1131:32768,n.Bias=i},readBytes:function(t,e){gt.B;var n=[];e=gt.T.CFF.readIndex(t,e,n);for(var i=[],r=n.length-1,s=t.byteOffset+e,a=0;a<r;a++){var o=n[a];i.push(new Uint8Array(t.buffer,s+o,n[a+1]-o))}return i},tableSE:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],glyphByUnicode:function(t,e){for(var n=0;n<t.charset.length;n++)if(t.charset[n]==e)return n;return-1},glyphBySE:function(t,e){return e<0||e>255?-1:gt.T.CFF.glyphByUnicode(t,gt.T.CFF.tableSE[e])},readCharset:function(t,e,n){var i=gt.B,r=[".notdef"],s=t[e];if(e++,0==s)for(var a=0;a<n;a++){var o=i.readUshort(t,e);e+=2,r.push(o)}else{if(1!=s&&2!=s)throw"error: format: "+s;for(;r.length<n;){o=i.readUshort(t,e);e+=2;var l=0;1==s?(l=t[e],e++):(l=i.readUshort(t,e),e+=2);for(a=0;a<=l;a++)r.push(o),o++}}return r},readIndex:function(t,e,n){var i=gt.B,r=i.readUshort(t,e)+1,s=t[e+=2];if(e++,1==s)for(var a=0;a<r;a++)n.push(t[e+a]);else if(2==s)for(a=0;a<r;a++)n.push(i.readUshort(t,e+2*a));else if(3==s)for(a=0;a<r;a++)n.push(16777215&i.readUint(t,e+3*a-1));else if(4==s)for(a=0;a<r;a++)n.push(i.readUint(t,e+4*a));else if(1!=r)throw"unsupported offset size: "+s+", count: "+r;return(e+=r*s)-1},getCharString:function(t,e,n){var i=gt.B,r=t[e],s=t[e+1];t[e+2],t[e+3],t[e+4];var a=1,o=null,l=null;r<=20&&(o=r,a=1),12==r&&(o=100*r+s,a=2),21<=r&&r<=27&&(o=r,a=1),28==r&&(l=i.readShort(t,e+1),a=3),29<=r&&r<=31&&(o=r,a=1),32<=r&&r<=246&&(l=r-139,a=1),247<=r&&r<=250&&(l=256*(r-247)+s+108,a=2),251<=r&&r<=254&&(l=256*-(r-251)-s-108,a=2),255==r&&(l=i.readInt(t,e+1)/65535,a=5),n.val=null!=l?l:"o"+o,n.size=a},readCharString:function(t,e,n){for(var i=e+n,r=gt.B,s=[];e<i;){var a=t[e],o=t[e+1];t[e+2],t[e+3],t[e+4];var l=1,h=null,c=null;a<=20&&(h=a,l=1),12==a&&(h=100*a+o,l=2),19!=a&&20!=a||(h=a,l=2),21<=a&&a<=27&&(h=a,l=1),28==a&&(c=r.readShort(t,e+1),l=3),29<=a&&a<=31&&(h=a,l=1),32<=a&&a<=246&&(c=a-139,l=1),247<=a&&a<=250&&(c=256*(a-247)+o+108,l=2),251<=a&&a<=254&&(c=256*-(a-251)-o-108,l=2),255==a&&(c=r.readInt(t,e+1)/65535,l=5),s.push(null!=c?c:"o"+h),e+=l}return s},readDict:function(t,e,n){for(var i=gt.B,r={},s=[];e<n;){var a=t[e],o=t[e+1];t[e+2],t[e+3],t[e+4];var l=1,h=null,c=null;if(28==a&&(c=i.readShort(t,e+1),l=3),29==a&&(c=i.readInt(t,e+1),l=5),32<=a&&a<=246&&(c=a-139,l=1),247<=a&&a<=250&&(c=256*(a-247)+o+108,l=2),251<=a&&a<=254&&(c=256*-(a-251)-o-108,l=2),255==a)throw c=i.readInt(t,e+1)/65535,l=5,"unknown number";if(30==a){var u=[];for(l=1;;){var d=t[e+l];l++;var p=d>>4,f=15&d;if(15!=p&&u.push(p),15!=f&&u.push(f),15==f)break}for(var m="",g=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],v=0;v<u.length;v++)m+=g[u[v]];c=parseFloat(m)}if(a<=21)if(h=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][a],l=1,12==a)h=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold","","","LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend","","","","","","","ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][o],l=2;null!=h?(r[h]=1==s.length?s[0]:s,s=[]):s.push(c),e+=l}return r}},gt.T.cmap={parseTab:function(t,e,n){var i={tables:[],ids:{},off:e};t=new Uint8Array(t.buffer,e,n),e=0;var r=gt.B,s=r.readUshort,a=gt.T.cmap;s(t,e);var o=s(t,e+=2);e+=2;for(var l=[],h=0;h<o;h++){var c=s(t,e),u=s(t,e+=2);e+=2;var d=r.readUint(t,e);e+=4;var p="p"+c+"e"+u,f=l.indexOf(d);if(-1==f){f=i.tables.length;var m={};l.push(d);var g=m.format=s(t,d);0==g?m=a.parse0(t,d,m):4==g?m=a.parse4(t,d,m):6==g?m=a.parse6(t,d,m):12==g&&(m=a.parse12(t,d,m)),i.tables.push(m)}i.ids[p],i.ids[p]=f}return i},parse0:function(t,e,n){var i=gt.B;e+=2;var r=i.readUshort(t,e);e+=2,i.readUshort(t,e),e+=2,n.map=[];for(var s=0;s<r-6;s++)n.map.push(t[e+s]);return n},parse4:function(t,e,n){var i=gt.B,r=i.readUshort,s=i.readUshorts,a=e,o=r(t,e+=2);r(t,e+=2);var l=r(t,e+=2);e+=2;var h=l>>>1;n.searchRange=r(t,e),e+=2,n.entrySelector=r(t,e),e+=2,n.rangeShift=r(t,e),e+=2,n.endCount=s(t,e,h),e+=2*h,e+=2,n.startCount=s(t,e,h),e+=2*h,n.idDelta=[];for(var c=0;c<h;c++)n.idDelta.push(i.readShort(t,e)),e+=2;return n.idRangeOffset=s(t,e,h),e+=2*h,n.glyphIdArray=s(t,e,a+o-e>>>1),n},parse6:function(t,e,n){var i=gt.B;e+=2,i.readUshort(t,e),e+=2,i.readUshort(t,e),e+=2,n.firstCode=i.readUshort(t,e),e+=2;var r=i.readUshort(t,e);e+=2,n.glyphIdArray=[];for(var s=0;s<r;s++)n.glyphIdArray.push(i.readUshort(t,e)),e+=2;return n},parse12:function(t,e,n){var i=gt.B.readUint;i(t,e+=4),i(t,e+=4);var r=3*i(t,e+=4);e+=4;for(var s=n.groups=new Uint32Array(r),a=0;a<r;a+=3)s[a]=i(t,e+(a<<2)),s[a+1]=i(t,e+(a<<2)+4),s[a+2]=i(t,e+(a<<2)+8);return n}},gt.T.CBLC={parseTab:function(t,e,n){var i=gt.B,r=e;i.readUshort(t,e),e+=2,i.readUshort(t,e),e+=2;var s=i.readUint(t,e);e+=4;for(var a=[],o=0;o<s;o++){var l=i.readUint(t,e);e+=4,i.readUint(t,e),e+=4,i.readUint(t,e),e+=4,e+=4,e+=24,i.readUshort(t,e),e+=2,i.readUshort(t,e),e+=2,e+=4;for(var h=r+l,c=0;c<3;c++){var u=i.readUshort(t,h);h+=2;var d=i.readUshort(t,h);h+=2;var p=i.readUint(t,h);h+=4;var f=d-u+1,m=r+l+p,g=i.readUshort(t,m);if(m+=2,1!=g)throw g;var v=i.readUshort(t,m);m+=2;var _=i.readUint(t,m);m+=4;for(var x=[],y=0;y<f;y++){var S=i.readUint(t,m+4*y);x.push(_+S)}a.push([u,d,v,x])}}return a}},gt.T.CBDT={parseTab:function(t,e,n){return gt.B,new Uint8Array(t.buffer,t.byteOffset+e,n)}},gt.T.glyf={parseTab:function(t,e,n,i){for(var r=[],s=i.maxp.numGlyphs,a=0;a<s;a++)r.push(null);return r},_parseGlyf:function(t,e){var n=gt.B,i=t._data,r=t.loca;if(r[e]==r[e+1])return null;var s=gt.findTable(i,"glyf",t._offset)[0]+r[e],a={};if(a.noc=n.readShort(i,s),s+=2,a.xMin=n.readShort(i,s),s+=2,a.yMin=n.readShort(i,s),s+=2,a.xMax=n.readShort(i,s),s+=2,a.yMax=n.readShort(i,s),s+=2,a.xMin>=a.xMax||a.yMin>=a.yMax)return null;if(a.noc>0){a.endPts=[];for(var o=0;o<a.noc;o++)a.endPts.push(n.readUshort(i,s)),s+=2;var l=n.readUshort(i,s);if(s+=2,i.length-s<l)return null;a.instructions=n.readBytes(i,s,l),s+=l;var h=a.endPts[a.noc-1]+1;a.flags=[];for(o=0;o<h;o++){var c=i[s];if(s++,a.flags.push(c),0!=(8&c)){var u=i[s];s++;for(var d=0;d<u;d++)a.flags.push(c),o++}}a.xs=[];for(o=0;o<h;o++){var p=0!=(2&a.flags[o]),f=0!=(16&a.flags[o]);p?(a.xs.push(f?i[s]:-i[s]),s++):f?a.xs.push(0):(a.xs.push(n.readShort(i,s)),s+=2)}a.ys=[];for(o=0;o<h;o++){p=0!=(4&a.flags[o]),f=0!=(32&a.flags[o]);p?(a.ys.push(f?i[s]:-i[s]),s++):f?a.ys.push(0):(a.ys.push(n.readShort(i,s)),s+=2)}var m=0,g=0;for(o=0;o<h;o++)m+=a.xs[o],g+=a.ys[o],a.xs[o]=m,a.ys[o]=g}else{var v;a.parts=[];do{v=n.readUshort(i,s),s+=2;var _={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(a.parts.push(_),_.glyphIndex=n.readUshort(i,s),s+=2,1&v){var x=n.readShort(i,s);s+=2;var y=n.readShort(i,s);s+=2}else{x=n.readInt8(i,s);s++;y=n.readInt8(i,s);s++}2&v?(_.m.tx=x,_.m.ty=y):(_.p1=x,_.p2=y),8&v?(_.m.a=_.m.d=n.readF2dot14(i,s),s+=2):64&v?(_.m.a=n.readF2dot14(i,s),s+=2,_.m.d=n.readF2dot14(i,s),s+=2):128&v&&(_.m.a=n.readF2dot14(i,s),s+=2,_.m.b=n.readF2dot14(i,s),s+=2,_.m.c=n.readF2dot14(i,s),s+=2,_.m.d=n.readF2dot14(i,s),s+=2)}while(32&v);if(256&v){var S=n.readUshort(i,s);s+=2,a.instr=[];for(o=0;o<S;o++)a.instr.push(i[s]),s++}}return a}},gt.T.head={parseTab:function(t,e,n){var i=gt.B,r={};return i.readFixed(t,e),e+=4,r.fontRevision=i.readFixed(t,e),e+=4,i.readUint(t,e),e+=4,i.readUint(t,e),e+=4,r.flags=i.readUshort(t,e),e+=2,r.unitsPerEm=i.readUshort(t,e),e+=2,r.created=i.readUint64(t,e),e+=8,r.modified=i.readUint64(t,e),e+=8,r.xMin=i.readShort(t,e),e+=2,r.yMin=i.readShort(t,e),e+=2,r.xMax=i.readShort(t,e),e+=2,r.yMax=i.readShort(t,e),e+=2,r.macStyle=i.readUshort(t,e),e+=2,r.lowestRecPPEM=i.readUshort(t,e),e+=2,r.fontDirectionHint=i.readShort(t,e),e+=2,r.indexToLocFormat=i.readShort(t,e),e+=2,r.glyphDataFormat=i.readShort(t,e),e+=2,r}},gt.T.hhea={parseTab:function(t,e,n){var i=gt.B,r={};i.readFixed(t,e),e+=4;for(var s=["ascender","descender","lineGap","advanceWidthMax","minLeftSideBearing","minRightSideBearing","xMaxExtent","caretSlopeRise","caretSlopeRun","caretOffset","res0","res1","res2","res3","metricDataFormat","numberOfHMetrics"],a=0;a<s.length;a++){var o=s[a],l="advanceWidthMax"==o||"numberOfHMetrics"==o?i.readUshort:i.readShort;r[o]=l(t,e+2*a)}return r}},gt.T.hmtx={parseTab:function(t,e,n,i){for(var r=gt.B,s=[],a=[],o=i.maxp.numGlyphs,l=i.hhea.numberOfHMetrics,h=0,c=0,u=0;u<l;)h=r.readUshort(t,e+(u<<2)),c=r.readShort(t,e+(u<<2)+2),s.push(h),a.push(c),u++;for(;u<o;)s.push(h),a.push(c),u++;return{aWidth:s,lsBearing:a}}},gt.T.kern={parseTab:function(t,e,n,i){var r=gt.B,s=gt.T.kern;if(1==r.readUshort(t,e))return s.parseV1(t,e,n,i);var a=r.readUshort(t,e+2);e+=4;for(var o={glyph1:[],rval:[]},l=0;l<a;l++){e+=2;n=r.readUshort(t,e);e+=2;var h=r.readUshort(t,e);e+=2;var c=h>>>8;0==(c&=15)&&(e=s.readFormat0(t,e,o))}return o},parseV1:function(t,e,n,i){var r=gt.B,s=gt.T.kern;r.readFixed(t,e);var a=r.readUint(t,e+4);e+=8;for(var o={glyph1:[],rval:[]},l=0;l<a;l++){r.readUint(t,e),e+=4;var h=r.readUshort(t,e);e+=2,r.readUshort(t,e),e+=2,0==(255&h)&&(e=s.readFormat0(t,e,o))}return o},readFormat0:function(t,e,n){var i=gt.B,r=i.readUshort,s=-1,a=r(t,e);r(t,e+2),r(t,e+4),r(t,e+6),e+=8;for(var o=0;o<a;o++){var l=r(t,e),h=r(t,e+=2);e+=2;var c=i.readShort(t,e);e+=2,l!=s&&(n.glyph1.push(l),n.rval.push({glyph2:[],vals:[]}));var u=n.rval[n.rval.length-1];u.glyph2.push(h),u.vals.push(c),s=l}return e}},gt.T.loca={parseTab:function(t,e,n,i){var r=gt.B,s=[],a=i.head.indexToLocFormat,o=i.maxp.numGlyphs+1;if(0==a)for(var l=0;l<o;l++)s.push(r.readUshort(t,e+(l<<1))<<1);if(1==a)for(l=0;l<o;l++)s.push(r.readUint(t,e+(l<<2)));return s}},gt.T.maxp={parseTab:function(t,e,n){var i=gt.B,r=i.readUshort,s={};return i.readUint(t,e),e+=4,s.numGlyphs=r(t,e),e+=2,s}},gt.T.name={parseTab:function(t,e,n){var i=gt.B,r={};i.readUshort(t,e),e+=2;var s=i.readUshort(t,e);e+=2,i.readUshort(t,e);for(var a=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],o=e+=2,l=i.readUshort,h=0;h<s;h++){var c=l(t,e),u=l(t,e+=2),d=l(t,e+=2),p=l(t,e+=2),f=l(t,e+=2),m=l(t,e+=2);e+=2;var g,v=o+12*s+m;g=0==c||3==c&&0==u||1==c&&25==u?i.readUnicode(t,v,f/2):0==u?i.readASCII(t,v,f):1==u||3==u||4==u||5==u||10==u?i.readUnicode(t,v,f/2):i.readASCII(t,v,f);var _="p"+c+","+d.toString(16);null==r[_]&&(r[_]={}),r[_][a[p]]=g,r[_]._lang=d}var x=gt.T.name.selectOne(r),y="fontFamily";if(null==x[y])for(var S in r)null!=r[S][y]&&(x[y]=r[S][y]);return x},selectOne:function(t){var e,n="postScriptName";for(var i in t)if(null!=t[i][n]&&1033==t[i]._lang)return t[i];for(var i in t)if(null!=t[i][n]&&0==t[i]._lang)return t[i];for(var i in t)if(null!=t[i][n]&&3084==t[i]._lang)return t[i];for(var i in t)if(null!=t[i][n])return t[i];for(var i in t){e=t[i];break}return null==e[n]&&null!=e.ID&&(e[n]=e.ID),e}},gt.T.OS2={parseTab:function(t,e,n){var i=gt.B.readUshort(t,e);e+=2;var r=gt.T.OS2,s={};if(0==i)r.version0(t,e,s);else if(1==i)r.version1(t,e,s);else if(2==i||3==i||4==i)r.version2(t,e,s);else{if(5!=i)throw"unknown OS/2 table version: "+i;r.version5(t,e,s)}return s},version0:function(t,e,n){var i=gt.B;return n.xAvgCharWidth=i.readShort(t,e),e+=2,n.usWeightClass=i.readUshort(t,e),e+=2,n.usWidthClass=i.readUshort(t,e),e+=2,n.fsType=i.readUshort(t,e),e+=2,n.ySubscriptXSize=i.readShort(t,e),e+=2,n.ySubscriptYSize=i.readShort(t,e),e+=2,n.ySubscriptXOffset=i.readShort(t,e),e+=2,n.ySubscriptYOffset=i.readShort(t,e),e+=2,n.ySuperscriptXSize=i.readShort(t,e),e+=2,n.ySuperscriptYSize=i.readShort(t,e),e+=2,n.ySuperscriptXOffset=i.readShort(t,e),e+=2,n.ySuperscriptYOffset=i.readShort(t,e),e+=2,n.yStrikeoutSize=i.readShort(t,e),e+=2,n.yStrikeoutPosition=i.readShort(t,e),e+=2,n.sFamilyClass=i.readShort(t,e),e+=2,n.panose=i.readBytes(t,e,10),e+=10,n.ulUnicodeRange1=i.readUint(t,e),e+=4,n.ulUnicodeRange2=i.readUint(t,e),e+=4,n.ulUnicodeRange3=i.readUint(t,e),e+=4,n.ulUnicodeRange4=i.readUint(t,e),e+=4,n.achVendID=i.readASCII(t,e,4),e+=4,n.fsSelection=i.readUshort(t,e),e+=2,n.usFirstCharIndex=i.readUshort(t,e),e+=2,n.usLastCharIndex=i.readUshort(t,e),e+=2,n.sTypoAscender=i.readShort(t,e),e+=2,n.sTypoDescender=i.readShort(t,e),e+=2,n.sTypoLineGap=i.readShort(t,e),e+=2,n.usWinAscent=i.readUshort(t,e),e+=2,n.usWinDescent=i.readUshort(t,e),e+=2},version1:function(t,e,n){var i=gt.B;return e=gt.T.OS2.version0(t,e,n),n.ulCodePageRange1=i.readUint(t,e),e+=4,n.ulCodePageRange2=i.readUint(t,e),e+=4},version2:function(t,e,n){var i=gt.B,r=i.readUshort;return e=gt.T.OS2.version1(t,e,n),n.sxHeight=i.readShort(t,e),e+=2,n.sCapHeight=i.readShort(t,e),e+=2,n.usDefault=r(t,e),e+=2,n.usBreak=r(t,e),e+=2,n.usMaxContext=r(t,e),e+=2},version5:function(t,e,n){var i=gt.B.readUshort;return e=gt.T.OS2.version2(t,e,n),n.usLowerOpticalPointSize=i(t,e),e+=2,n.usUpperOpticalPointSize=i(t,e),e+=2}},gt.T.post={parseTab:function(t,e,n){var i=gt.B,r={};return r.version=i.readFixed(t,e),e+=4,r.italicAngle=i.readFixed(t,e),e+=4,r.underlinePosition=i.readShort(t,e),e+=2,r.underlineThickness=i.readShort(t,e),e+=2,r}},gt.T.SVG={parseTab:function(t,e,n){var i=gt.B,r={entries:[],svgs:[]},s=e;i.readUshort(t,e),e+=2;var a=i.readUint(t,e);e+=4,i.readUint(t,e),e+=4,e=a+s;var o=i.readUshort(t,e);e+=2;for(var l=0;l<o;l++){var h=i.readUshort(t,e);e+=2;var c=i.readUshort(t,e);e+=2;var u=i.readUint(t,e);e+=4;var d=i.readUint(t,e);e+=4;var p=new Uint8Array(t.buffer,s+u+a,d);31==p[0]&&139==p[1]&&8==p[2]&&(p=pako.inflate(p));for(var f=i.readUTF8(p,0,p.length),m=h;m<=c;m++)r.entries[m]=r.svgs.length;r.svgs.push(f)}return r}},gt.T.sbix={parseTab:function(t,e,n,i){for(var r=i.maxp.numGlyphs,s=e,a=gt.B,o=a.readUint(t,e+4),l=[],h=o-1;h<o;h++)for(var c=s+a.readUint(t,e+8+4*h),u=0;u<r;u++){var d=a.readUint(t,c+4+4*u),p=a.readUint(t,c+4+4*u+4);if(d!=p){var f=c+d,m=a.readASCII(t,f+4,4);if("png "!=m)throw m;l[u]=new Uint8Array(t.buffer,t.byteOffset+f+8,p-d-8)}else l[u]=null}return l}},gt.T.colr={parseTab:function(t,e,n){var i=gt.B,r=e;e+=2;var s=i.readUshort(t,e);e+=2;var a=i.readUint(t,e);e+=4;var o=i.readUint(t,e);e+=4;var l=i.readUshort(t,e);e+=2;for(var h={},c=r+a,u=0;u<s;u++)h["g"+i.readUshort(t,c)]=[i.readUshort(t,c+2),i.readUshort(t,c+4)],c+=6;var d=[];c=r+o;for(u=0;u<l;u++)d.push(i.readUshort(t,c),i.readUshort(t,c+2)),c+=4;return[h,d]}},gt.T.cpal={parseTab:function(t,e,n){var i=gt.B,r=e,s=i.readUshort(t,e);if(e+=2,0==s){i.readUshort(t,e),e+=2,i.readUshort(t,e),e+=2;var a=i.readUshort(t,e);e+=2;var o=i.readUint(t,e);return e+=4,new Uint8Array(t.buffer,r+o,4*a)}throw s}},gt.U={shape:function(t,e,n){for(var i=function(t,e,n,i){var r=e[n],s=e[n+1],a=t.kern;if(a){var o=a.glyph1.indexOf(r);if(-1!=o){var l=a.rval[o].glyph2.indexOf(s);if(-1!=l)return[0,0,a.rval[o].vals[l],0]}}return[0,0,0,0]},r=[],s=0;s<e.length;s++){var a=e.codePointAt(s);a>65535&&s++,r.push(gt.U.codeToGlyph(t,a))}var o=[];for(s=0;s<r.length;s++){var l=i(t,r,s),h=r[s],c=t.hmtx.aWidth[h]+l[2];o.push({g:h,cl:s,dx:0,dy:0,ax:c,ay:0})}return o},shapeToPath:function(t,e,n){for(var i={cmds:[],crds:[]},r=0,s=0,a=0;a<e.length;a++){for(var o=e[a],l=gt.U.glyphToPath(t,o.g),h=l.crds,c=0;c<h.length;c+=2)i.crds.push(h[c]+r+o.dx),i.crds.push(h[c+1]+s+o.dy);n&&i.cmds.push(n);for(c=0;c<l.cmds.length;c++)i.cmds.push(l.cmds[c]);var u=i.cmds.length;n&&0!=u&&"X"!=i.cmds[u-1]&&i.cmds.push("X"),r+=o.ax,s+=o.ay}return{cmds:i.cmds,crds:i.crds}},codeToGlyph:function(){function t(t,e,n){for(var i=0,r=~~(t.length/e);i+1!=r;){var s=i+(r-i>>>1);t[s*e]<=n?i=s:r=s}return i*e}for(var e=[9,10,11,12,13,32,133,160,5760,6158,8232,8233,8239,8288,12288,65279],n={},i=0;i<e.length;i++)n[e[i]]=1;for(i=8192;i<=8205;i++)n[i]=1;return function(e,i){if(null==e._ctab){for(var r=e.cmap,s=-1,a=["p3e10","p0e4","p3e1","p1e0","p0e3","p0e1","p3e0","p3e5"],o=0;o<a.length;o++)if(null!=r.ids[a[o]]){s=r.ids[a[o]];break}if(-1==s)throw"no familiar platform and encoding!";e._ctab=r.tables[s]}var l=e._ctab,h=l.format,c=-1;if(0==h)c=i>=l.map.length?0:l.map[i];else if(4==h){var u=l.endCount;if(c=0,i<=u[u.length-1]){var d=t(u,1,i);if(u[d]<i&&d++,i>=l.startCount[d]){c=65535&(0!=l.idRangeOffset[d]?l.glyphIdArray[i-l.startCount[d]+(l.idRangeOffset[d]>>1)-(l.idRangeOffset.length-d)]:i+l.idDelta[d])}}}else if(6==h){var p=i-l.firstCode,f=l.glyphIdArray;c=p<0||p>=f.length?0:f[p]}else{if(12!=h)throw"unknown cmap table format "+l.format;var m=l.groups;c=0,i<=m[m.length-2]&&m[o=t(m,3,i)]<=i&&i<=m[o+1]&&(c=m[o+2]+(i-m[o]))}var g=e["SVG "],v=e.loca;return 0==c||null!=e["CFF "]||null!=g&&null!=g.entries[c]||!v||v[c]!=v[c+1]||null!=n[i]||(c=0),c}}(),glyphToPath:function(t,e,n){var i={cmds:[],crds:[]},r=t["SVG "],s=t["CFF "],a=t.COLR,o=t.CBLC,l=t.CBDT,h=t.sbix,c=window.UPNG,u=gt.U,d=null;if(o&&c)for(var p=0;p<o.length;p++)o[p][0]<=e&&e<=o[p][1]&&(d=o[p]);if(d||h&&h[e]){if(d&&17!=d[2])throw"not a PNG";null==t.__tmp&&(t.__tmp={});var f=t.__tmp["g"+e];if(null==f){var m,g;if(h)g=(m=h[e]).length;else{var v=d[3][e-d[0]]+5;g=l[v+1]<<16|l[v+2]<<8|l[v+3],v+=4,m=new Uint8Array(l.buffer,l.byteOffset+v,g)}var _="";for(p=0;p<g;p++)_+=String.fromCharCode(m[p]);f=t.__tmp["g"+e]="data:image/png;base64,"+btoa(_)}i.cmds.push(f);var x=1.15*t.head.unitsPerEm,y=Math.round(x),S=Math.round(x),b=Math.round(.15*-S);i.crds.push(0,S+b,y,S+b,y,b,0,b)}else if(r&&r.entries[e]){var M=r.entries[e];if(null!=M){if("number"==typeof M){var w=r.svgs[M];if("string"==typeof w){var C=(new DOMParser).parseFromString(w,"image/svg+xml");w=r.svgs[M]=C.getElementsByTagName("svg")[0]}M=u.SVG.toPath(w,e),r.entries[e]=M}i=M}}else if(1!=n&&a&&a[0]["g"+e]&&a[0]["g"+e][1]>1){let n=function(t){var e=t.toString(16);return(1==e.length?"0":"")+e};var T=t.CPAL,E=a[0]["g"+e];for(p=0;p<E[1];p++){var A=E[0]+p,P=a[1][2*A],R=4*a[1][2*A+1],W=gt.U.glyphToPath(t,P,P==e),L="#"+n(T[R+2])+n(T[R+1])+n(T[R+0]);i.cmds.push(L),i.cmds=i.cmds.concat(W.cmds),i.crds=i.crds.concat(W.crds),i.cmds.push("X")}}else if(s){var I=s.Private,k={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:I?I.defaultWidthX:0,open:!1};if(s.ROS){for(var N=0;s.FDSelect[N+2]<=e;)N+=2;I=s.FDArray[s.FDSelect[N+1]].Private}u._drawCFF(s.CharStrings[e],k,s,I,i)}else t.glyf&&u._drawGlyf(e,t,i);return{cmds:i.cmds,crds:i.crds}},_drawGlyf:function(t,e,n){var i=e.glyf[t];null==i&&(i=e.glyf[t]=gt.T.glyf._parseGlyf(e,t)),null!=i&&(i.noc>-1?gt.U._simpleGlyph(i,n):gt.U._compoGlyph(i,e,n))},_simpleGlyph:function(t,e){for(var n=gt.U.P,i=0;i<t.noc;i++){for(var r=0==i?0:t.endPts[i-1]+1,s=t.endPts[i],a=r;a<=s;a++){var o=a==r?s:a-1,l=a==s?r:a+1,h=1&t.flags[a],c=1&t.flags[o],u=1&t.flags[l],d=t.xs[a],p=t.ys[a];if(a==r)if(h){if(!c){n.MoveTo(e,d,p);continue}n.MoveTo(e,t.xs[o],t.ys[o])}else c?n.MoveTo(e,t.xs[o],t.ys[o]):n.MoveTo(e,Math.floor(.5*(t.xs[o]+d)),Math.floor(.5*(t.ys[o]+p)));h?c&&n.LineTo(e,d,p):u?n.qCurveTo(e,d,p,t.xs[l],t.ys[l]):n.qCurveTo(e,d,p,Math.floor(.5*(d+t.xs[l])),Math.floor(.5*(p+t.ys[l])))}n.ClosePath(e)}},_compoGlyph:function(t,e,n){for(var i=0;i<t.parts.length;i++){var r={cmds:[],crds:[]},s=t.parts[i];gt.U._drawGlyf(s.glyphIndex,e,r);for(var a=s.m,o=0;o<r.crds.length;o+=2){var l=r.crds[o],h=r.crds[o+1];n.crds.push(l*a.a+h*a.c+a.tx),n.crds.push(l*a.b+h*a.d+a.ty)}for(o=0;o<r.cmds.length;o++)n.cmds.push(r.cmds[o])}},pathToSVG:function(t,e){var n=t.cmds,i=t.crds;function r(t){return parseFloat(t.toFixed(e))}null==e&&(e=5);for(var s=[],a=0,o={M:2,L:2,Q:4,C:6},l=0,h=0,c=0,u=0,d=0,p=0,f=0;f<n.length;f++){var m,g,v,_,x=n[f],y=o[x]?o[x]:0,S=[];if("L"==x)m=i[a]-l,g=i[a+1]-h,v=r(m+c),_=r(g+u),"Z"==n[f+1]&&i[a]==d&&i[a+1]==p?(v=m,_=g):0==v&&0==_||(0==v?S.push("v",_):0==_?S.push("h",v):S.push("l",v,_));else{S.push(x.toLowerCase());for(var b=0;b<y;b+=2)m=i[a+b]-l,g=i[a+b+1]-h,v=r(m+c),_=r(g+u),S.push(v,_)}0!=y&&(c+=m-v,u+=g-_);var M=S;for(b=0;b<M.length;b++)s.push(M[b]);0!=y&&(l=i[(a+=y)-2],h=i[a-1]),"M"==x&&(d=l,p=h),"Z"==x&&(l=d,h=p)}return function(t){for(var e=[],n=!1,i="",r=0;r<t.length;r++){var s=t[r],a="number"==typeof s;if(!a){if(s==i&&1==s.length&&"m"!=s)continue;i=s}n&&a&&s>=0&&e.push(" "),e.push(s),n=a}return e.join("")}(s)},SVGToPath:function(t){var e={cmds:[],crds:[]};return gt.U.SVG.svgToPath(t,e),{cmds:e.cmds,crds:e.crds}},pathToContext:function(){var t,e;function n(t,e,n,i){for(var r=e>>1,s=n>>1,a=i&&i.length==r*s*4?i:new Uint8Array(r*s*4),o=new Uint32Array(t.buffer),l=new Uint32Array(a.buffer),h=0;h<s;h++)for(var c=0;c<r;c++){var u=h*r+c,d=(h<<1)*e+(c<<1),p=o[d],f=o[d+1],m=o[d+e],g=o[d+e+1],v=p>>>24,_=f>>>24,x=m>>>24,y=g>>>24,S=v+_+x+y;if(1020==S){var b=(p>>>0&255)+(f>>>0&255)+(m>>>0&255)+(g>>>0&255)+2>>>2,M=(p>>>8&255)+(f>>>8&255)+(m>>>8&255)+(g>>>8&255)+2>>>2,w=(p>>>16&255)+(f>>>16&255)+(m>>>16&255)+(g>>>16&255)+2>>>2;l[u]=255<<24|w<<16|M<<8|b}else if(0==S)l[u]=0;else{var C=1/S;b=~~((b=(p>>>0&255)*v+(f>>>0&255)*_+(m>>>0&255)*x+(g>>>0&255)*y)*C+.5),M=~~((M=(p>>>8&255)*v+(f>>>8&255)*_+(m>>>8&255)*x+(g>>>8&255)*y)*C+.5),w=~~((w=(p>>>16&255)*v+(f>>>16&255)*_+(m>>>16&255)*x+(g>>>16&255)*y)*C+.5),l[u]=S+2>>>2<<24|w<<16|M<<8|b}}return{buff:a,w:r,h:s}}return function(i,r){for(var s=0,a=i.cmds,o=i.crds,l=0;l<a.length;l++){var h=a[l];if("M"==h)r.moveTo(o[s],o[s+1]),s+=2;else if("L"==h)r.lineTo(o[s],o[s+1]),s+=2;else if("C"==h)r.bezierCurveTo(o[s],o[s+1],o[s+2],o[s+3],o[s+4],o[s+5]),s+=6;else if("Q"==h)r.quadraticCurveTo(o[s],o[s+1],o[s+2],o[s+3]),s+=4;else if("d"==h[0]){var c=window.UPNG,u=o[s],d=o[s+1],p=o[s+2],f=o[s+3],m=o[s+4],g=o[s+5],v=o[s+6],_=o[s+7];if(s+=8,null==c){r.moveTo(u,d),r.lineTo(p,f),r.lineTo(m,g),r.lineTo(v,_),r.closePath();continue}for(var x=p-u,y=f-d,S=v-u,b=_-d,M=atob(h.slice(22)),w=new Uint8Array(M.length),C=0;C<M.length;C++)w[C]=M.charCodeAt(C);for(var T=c.decode(w.buffer),E=T.width,A=T.height,P=new Uint8Array(c.toRGBA8(T)[0]),R=r.getTransform(),W=Math.sqrt(Math.abs(R.a*R.d-R.b*R.c))*Math.sqrt(S*S+b*b)/A;W<.5;){var L=n(P,E,A);P=L.buff,E=L.w,A=L.h,W*=2}null==t&&(t=document.createElement("canvas"),e=t.getContext("2d")),t.width==E&&t.height==A||(t.width=E,t.height=A),e.putImageData(new ImageData(new Uint8ClampedArray(P.buffer),E,A),0,0),r.save(),r.transform(x,y,S,b,u,d),r.scale(1/E,1/A),r.drawImage(t,0,0),r.restore()}else if("#"==h.charAt(0)||"r"==h.charAt(0))r.beginPath(),r.fillStyle=h;else if("O"==h.charAt(0)&&"OX"!=h){r.beginPath();var I=h.split("-");r.lineWidth=parseFloat(I[2]),r.strokeStyle=I[1]}else"Z"==h?r.closePath():"X"==h?r.fill():"OX"==h&&r.stroke()}}}(),P:{MoveTo:function(t,e,n){t.cmds.push("M"),t.crds.push(e,n)},LineTo:function(t,e,n){t.cmds.push("L"),t.crds.push(e,n)},CurveTo:function(t,e,n,i,r,s,a){t.cmds.push("C"),t.crds.push(e,n,i,r,s,a)},qCurveTo:function(t,e,n,i,r){t.cmds.push("Q"),t.crds.push(e,n,i,r)},ClosePath:function(t){t.cmds.push("Z")}},_drawCFF:function(t,e,n,i,r){for(var s=e.stack,a=e.nStems,o=e.haveWidth,l=e.width,h=e.open,c=0,u=e.x,d=e.y,p=0,f=0,m=0,g=0,v=0,_=0,x=0,y=0,S=0,b=0,M=gt.T.CFF,w=gt.U.P,C=i.nominalWidthX,T={val:0,size:0};c<t.length;){M.getCharString(t,c,T);var E=T.val;if(c+=T.size,"o1"==E||"o18"==E)s.length%2!=0&&!o&&(l=s.shift()+C),a+=s.length>>1,s.length=0,o=!0;else if("o3"==E||"o23"==E){s.length%2!=0&&!o&&(l=s.shift()+C),a+=s.length>>1,s.length=0,o=!0}else if("o4"==E)s.length>1&&!o&&(l=s.shift()+C,o=!0),h&&w.ClosePath(r),d+=s.pop(),w.MoveTo(r,u,d),h=!0;else if("o5"==E)for(;s.length>0;)u+=s.shift(),d+=s.shift(),w.LineTo(r,u,d);else if("o6"==E||"o7"==E)for(var A=s.length,P="o6"==E,R=0;R<A;R++){var W=s.shift();P?u+=W:d+=W,P=!P,w.LineTo(r,u,d)}else if("o8"==E||"o24"==E){A=s.length;for(var L=0;L+6<=A;)p=u+s.shift(),f=d+s.shift(),m=p+s.shift(),g=f+s.shift(),u=m+s.shift(),d=g+s.shift(),w.CurveTo(r,p,f,m,g,u,d),L+=6;"o24"==E&&(u+=s.shift(),d+=s.shift(),w.LineTo(r,u,d))}else{if("o11"==E)break;if("o1234"==E||"o1235"==E||"o1236"==E||"o1237"==E)"o1234"==E&&(f=d,m=(p=u+s.shift())+s.shift(),b=g=f+s.shift(),_=g,y=d,u=(x=(v=(S=m+s.shift())+s.shift())+s.shift())+s.shift(),w.CurveTo(r,p,f,m,g,S,b),w.CurveTo(r,v,_,x,y,u,d)),"o1235"==E&&(p=u+s.shift(),f=d+s.shift(),m=p+s.shift(),g=f+s.shift(),S=m+s.shift(),b=g+s.shift(),v=S+s.shift(),_=b+s.shift(),x=v+s.shift(),y=_+s.shift(),u=x+s.shift(),d=y+s.shift(),s.shift(),w.CurveTo(r,p,f,m,g,S,b),w.CurveTo(r,v,_,x,y,u,d)),"o1236"==E&&(p=u+s.shift(),f=d+s.shift(),m=p+s.shift(),b=g=f+s.shift(),_=g,x=(v=(S=m+s.shift())+s.shift())+s.shift(),y=_+s.shift(),u=x+s.shift(),w.CurveTo(r,p,f,m,g,S,b),w.CurveTo(r,v,_,x,y,u,d)),"o1237"==E&&(p=u+s.shift(),f=d+s.shift(),m=p+s.shift(),g=f+s.shift(),S=m+s.shift(),b=g+s.shift(),v=S+s.shift(),_=b+s.shift(),x=v+s.shift(),y=_+s.shift(),Math.abs(x-u)>Math.abs(y-d)?u=x+s.shift():d=y+s.shift(),w.CurveTo(r,p,f,m,g,S,b),w.CurveTo(r,v,_,x,y,u,d));else if("o14"==E){if(s.length>0&&4!=s.length&&!o&&(l=s.shift()+n.nominalWidthX,o=!0),4==s.length){var I=s.shift(),k=s.shift(),N=s.shift(),O=s.shift(),U=M.glyphBySE(n,N),D=M.glyphBySE(n,O);gt.U._drawCFF(n.CharStrings[U],e,n,i,r),e.x=I,e.y=k,gt.U._drawCFF(n.CharStrings[D],e,n,i,r)}h&&(w.ClosePath(r),h=!1)}else if("o19"==E||"o20"==E){s.length%2!=0&&!o&&(l=s.shift()+C),a+=s.length>>1,s.length=0,o=!0,c+=a+7>>3}else if("o21"==E)s.length>2&&!o&&(l=s.shift()+C,o=!0),d+=s.pop(),u+=s.pop(),h&&w.ClosePath(r),w.MoveTo(r,u,d),h=!0;else if("o22"==E)s.length>1&&!o&&(l=s.shift()+C,o=!0),u+=s.pop(),h&&w.ClosePath(r),w.MoveTo(r,u,d),h=!0;else if("o25"==E){for(;s.length>6;)u+=s.shift(),d+=s.shift(),w.LineTo(r,u,d);p=u+s.shift(),f=d+s.shift(),m=p+s.shift(),g=f+s.shift(),u=m+s.shift(),d=g+s.shift(),w.CurveTo(r,p,f,m,g,u,d)}else if("o26"==E)for(s.length%2&&(u+=s.shift());s.length>0;)p=u,f=d+s.shift(),u=m=p+s.shift(),d=(g=f+s.shift())+s.shift(),w.CurveTo(r,p,f,m,g,u,d);else if("o27"==E)for(s.length%2&&(d+=s.shift());s.length>0;)f=d,m=(p=u+s.shift())+s.shift(),g=f+s.shift(),u=m+s.shift(),d=g,w.CurveTo(r,p,f,m,g,u,d);else if("o10"==E||"o29"==E){var F="o10"==E?i:n;if(0==s.length);else{var B=s.pop(),z=F.Subrs[B+F.Bias];e.x=u,e.y=d,e.nStems=a,e.haveWidth=o,e.width=l,e.open=h,gt.U._drawCFF(z,e,n,i,r),u=e.x,d=e.y,a=e.nStems,o=e.haveWidth,l=e.width,h=e.open}}else if("o30"==E||"o31"==E){var V=s.length,G=(L=0,"o31"==E);for(L+=V-(A=-3&V);L<A;)G?(f=d,m=(p=u+s.shift())+s.shift(),d=(g=f+s.shift())+s.shift(),A-L==5?(u=m+s.shift(),L++):u=m,G=!1):(p=u,f=d+s.shift(),m=p+s.shift(),g=f+s.shift(),u=m+s.shift(),A-L==5?(d=g+s.shift(),L++):d=g,G=!0),w.CurveTo(r,p,f,m,g,u,d),L+=4}else{if("o"==(E+"").charAt(0))throw E;s.push(E)}}}e.x=u,e.y=d,e.nStems=a,e.haveWidth=o,e.width=l,e.open=h},SVG:function(){var t={getScale:function(t){return Math.sqrt(Math.abs(t[0]*t[3]-t[1]*t[2]))},translate:function(e,n,i){t.concat(e,[1,0,0,1,n,i])},rotate:function(e,n){t.concat(e,[Math.cos(n),-Math.sin(n),Math.sin(n),Math.cos(n),0,0])},scale:function(e,n,i){t.concat(e,[n,0,0,i,0,0])},concat:function(t,e){var n=t[0],i=t[1],r=t[2],s=t[3],a=t[4],o=t[5];t[0]=n*e[0]+i*e[2],t[1]=n*e[1]+i*e[3],t[2]=r*e[0]+s*e[2],t[3]=r*e[1]+s*e[3],t[4]=a*e[0]+o*e[2]+e[4],t[5]=a*e[1]+o*e[3]+e[5]},invert:function(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=e*r-n*i;t[0]=r/o,t[1]=-n/o,t[2]=-i/o,t[3]=e/o,t[4]=(i*a-r*s)/o,t[5]=(n*s-e*a)/o},multPoint:function(t,e){var n=e[0],i=e[1];return[n*t[0]+i*t[2]+t[4],n*t[1]+i*t[3]+t[5]]},multArray:function(t,e){for(var n=0;n<e.length;n+=2){var i=e[n],r=e[n+1];e[n]=i*t[0]+r*t[2]+t[4],e[n+1]=i*t[1]+r*t[3]+t[5]}}};function e(t,e,n){for(var i=[],r=0,s=0,a=0;;){var o=t.indexOf(e,s),l=t.indexOf(n,s);if(-1==o&&-1==l)break;-1==l||-1!=o&&o<l?(0==a&&(i.push(t.slice(r,o).trim()),r=o+1),a++,s=o+1):(-1==o||-1!=l&&l<o)&&(0==--a&&(i.push(t.slice(r,l).trim()),r=l+1),s=l+1)}return i}function n(n){for(var r=e(n,"(",")"),s=[1,0,0,1,0,0],a=0;a<r.length;a+=2){var o=s;s=i(r[a],r[a+1]),t.concat(s,o)}return s}function i(e,n){for(var i=[1,0,0,1,0,0],r=!0,s=0;s<n.length;s++){var a=n.charAt(s);","==a||" "==a?r=!0:"."==a?(r||(n=n.slice(0,s)+","+n.slice(s),s++),r=!1):"-"==a&&s>0&&"e"!=n[s-1]&&(n=n.slice(0,s)+" "+n.slice(s),s++,r=!0)}if(n=n.split(/\s*[\s,]\s*/).map(parseFloat),"translate"==e)1==n.length?t.translate(i,n[0],0):t.translate(i,n[0],n[1]);else if("scale"==e)1==n.length?t.scale(i,n[0],n[0]):t.scale(i,n[0],n[1]);else if("rotate"==e){var o=0,l=0;1!=n.length&&(o=n[1],l=n[2]),t.translate(i,-o,-l),t.rotate(i,-Math.PI*n[0]/180),t.translate(i,o,l)}else"matrix"==e&&(i=n);return i}var r={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function s(e,i,a,l){for(var h=0;h<e.length;h++){var c=e[h],u=c.tagName,d=c.getAttribute("fill");if(null==d&&(d=a),d&&d.startsWith("url")){var p=d.slice(5,-1),f=l.getElementById(p).children[0];if(null!=f.getAttribute("stop-opacity"))continue;d=f.getAttribute("stop-color")}if(r[d]&&(d=r[d]),"g"==u||"use"==u){var m={crds:[],cmds:[]};if("g"==u)s(c.children,m,d,l);else{var g=c.getAttribute("xlink:href").slice(1);s([l.getElementById(g)],m,d,l)}var v=[1,0,0,1,0,0],_=c.getAttribute("x"),x=c.getAttribute("y");_=_?parseFloat(_):0,x=x?parseFloat(x):0,t.concat(v,[1,0,0,1,_,x]);var y=c.getAttribute("transform");y&&t.concat(v,n(y)),t.multArray(v,m.crds),i.crds=i.crds.concat(m.crds),i.cmds=i.cmds.concat(m.cmds)}else if("path"==u||"circle"==u||"ellipse"==u){var S;if(i.cmds.push(d||"#000000"),"path"==u&&(S=c.getAttribute("d")),"circle"==u||"ellipse"==u){for(var b=[0,0,0,0],M=["cx","cy","rx","ry","r"],w=0;w<5;w++){var C=c.getAttribute(M[w]);C&&(C=parseFloat(C),w<4?b[w]=C:b[2]=b[3]=C)}var T=b[0],E=b[1],A=b[2],P=b[3];S=["M",T-A,E,"a",A,P,0,1,0,2*A,0,"a",A,P,0,1,0,2*-A,0].join(" ")}o(S,i),i.cmds.push("X")}else if("image"==u){var R=parseFloat(c.getAttribute("width")),W=parseFloat(c.getAttribute("height"));i.cmds.push(c.getAttribute("xlink:href")),i.crds.push(0,0,R,0,R,W,0,W)}}}function a(t,e,n){for(var i=e;i<t.length&&"string"!=typeof t[i];)i+=n;return(i-e)/n}function o(t,e){for(var n=function(t){for(var e=[],n=0,i=!1,r="",s="",a="",o=0;n<t.length;){var l=t.charCodeAt(n),h=t.charAt(n);n++;var c=48<=l&&l<=57||"."==h||"-"==h||"+"==h||"e"==h||"E"==h;i?("+"==h||"-"==h)&&"e"!=s||"."==h&&-1!=r.indexOf(".")||c&&("a"==a||"A"==a)&&(o%7==3||o%7==4)?(e.push(parseFloat(r)),o++,r=h):c?r+=h:(e.push(parseFloat(r)),o++,","!=h&&" "!=h&&(e.push(h),a=h,o=0),i=!1):c?(r=h,i=!0):","!=h&&" "!=h&&(e.push(h),a=h,o=0),s=h}return i&&e.push(parseFloat(r)),e}(t),i=0,r=0,s=0,o=0,l=0,h=e.crds.length,c={M:2,L:2,H:1,V:1,T:2,S:4,A:7,Q:4,C:6},u=e.cmds,d=e.crds;i<n.length;){var p=n[i];i++;var f=p.toUpperCase();if("Z"==f)u.push("Z"),r=o,s=l;else for(var m=a(n,i,c[f]),g=0;g<m;g++){1==g&&"M"==f&&(p=p==f?"L":"l",f="L");var v=0,_=0;if(p!=f&&(v=r,_=s),"M"==f)r=v+n[i++],s=_+n[i++],u.push("M"),d.push(r,s),o=r,l=s;else if("L"==f)r=v+n[i++],s=_+n[i++],u.push("L"),d.push(r,s);else if("H"==f)r=v+n[i++],u.push("L"),d.push(r,s);else if("V"==f)s=_+n[i++],u.push("L"),d.push(r,s);else if("Q"==f){var x=v+n[i++],y=_+n[i++],S=v+n[i++],b=_+n[i++];u.push("Q"),d.push(x,y,S,b),r=S,s=b}else if("T"==f){x=r+r-d[C=Math.max(d.length-("Q"==u[u.length-1]?4:2),h)],y=s+s-d[C+1],S=v+n[i++],b=_+n[i++];u.push("Q"),d.push(x,y,S,b),r=S,s=b}else if("C"==f){x=v+n[i++],y=_+n[i++],S=v+n[i++],b=_+n[i++];var M=v+n[i++],w=_+n[i++];u.push("C"),d.push(x,y,S,b,M,w),r=M,s=w}else if("S"==f){var C;x=r+r-d[C=Math.max(d.length-("C"==u[u.length-1]?4:2),h)],y=s+s-d[C+1],S=v+n[i++],b=_+n[i++],M=v+n[i++],w=_+n[i++];u.push("C"),d.push(x,y,S,b,M,w),r=M,s=w}else if("A"==f){x=r,y=s;var T=n[i++],E=n[i++],A=n[i++]*(Math.PI/180),P=n[i++],R=n[i++];S=v+n[i++],b=_+n[i++];if(S==r&&b==s&&0==T&&0==E)continue;var W=(x-S)/2,L=(y-b)/2,I=Math.cos(A),k=Math.sin(A),N=I*W+k*L,O=-k*W+I*L,U=T*T,D=E*E,F=N*N,B=O*O,z=(U*D-U*B-D*F)/(U*B+D*F),V=(P!=R?1:-1)*Math.sqrt(Math.max(z,0)),G=V*(T*O)/E,H=E*N*-V/T,q=I*G-k*H+(x+S)/2,X=k*G+I*H+(y+b)/2,j=function(t,e,n,i){var r=(t*n+e*i)/(Math.sqrt(t*t+e*e)*Math.sqrt(n*n+i*i));return(t*i-e*n>=0?1:-1)*Math.acos(Math.max(-1,Math.min(1,r)))},J=(N-G)/T,Q=(O-H)/E,K=j(1,0,J,Q),Z=j(J,Q,(-N-G)/T,(-O-H)/E);!function(t,e,n,i,r,s,a){var o=function(t,e){var n=Math.sin(e),i=Math.cos(e),r=(e=t[0],t[1]),s=t[2],a=t[3];t[0]=e*i+r*n,t[1]=-e*n+r*i,t[2]=s*i+a*n,t[3]=-s*n+a*i},l=function(t,e){for(var n=0;n<e.length;n+=2){var i=e[n],r=e[n+1];e[n]=t[0]*i+t[2]*r+t[4],e[n+1]=t[1]*i+t[3]*r+t[5]}},h=function(t,e){for(var n=0;n<e.length;n++)t.push(e[n])};if(a)for(;s>r;)s-=2*Math.PI;else for(;s<r;)s+=2*Math.PI;var c,u,d=(s-r)/4,p=Math.cos(d/2),f=-Math.sin(d/2),m=(4-p)/3,g=0==f?f:(1-p)*(3-p)/(3*f),v=[m,g,m,-g,p,-f],_={cmds:["C","C","C","C"],crds:v.slice(0)},x=[1,0,0,1,0,0];o(x,-d);for(var y=0;y<3;y++)l(x,v),h(_.crds,v);o(x,d/2-r),x[0]*=i,x[1]*=i,x[2]*=i,x[3]*=i,x[4]=e,x[5]=n,l(x,_.crds),l(t.ctm,_.crds),c=t.pth,u=_,h(c.cmds,u.cmds),h(c.crds,u.crds)}({pth:e,ctm:[T*I,T*k,-E*k,E*I,q,X]},0,0,1,K,K+(Z%=2*Math.PI),0==R),r=S,s=b}}}}return{cssMap:function(t){for(var n=e(t,"{","}"),i={},r=0;r<n.length;r+=2)for(var s=n[r].split(","),a=0;a<s.length;a++){var o=s[a].trim();null==i[o]&&(i[o]=""),i[o]+=n[r+1]}return i},readTrnf:n,svgToPath:o,toPath:function(t,e){var n={cmds:[],crds:[]},i=t.getAttribute("viewBox");i=i?i.trim().split(" ").map(parseFloat):[0,0,1e3,1e3];var r=t;if(null!=e){var a=t.getElementById("glyph"+e);a&&(r=a)}s(r.children,n,null,t);for(var o=0;o<n.crds.length;o+=2){var l=n.crds[o],h=n.crds[o+1];l-=i[0],h=-(h-=i[1]),n.crds[o]=l,n.crds[o+1]=h}return n}}}(),initHB:function(t,e){var n=function(t){var e=0;return 0==(4294967168&t)?e=1:0==(4294965248&t)?e=2:0==(4294901760&t)?e=3:0==(4292870144&t)&&(e=4),e};fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return WebAssembly.instantiate(t)})).then((function(t){var i,r,s,a,o,l,h,c,u,d=t.instance.exports,p=d.memory;gt.U.shapeHB=function(t,e,f){var m=t._data,g=t.name.postScriptName;if(i=new Uint8Array(p.buffer),r=new Uint32Array(p.buffer),s=new Int32Array(p.buffer),a!=g&&(null!=o&&(d.hb_blob_destroy(o),d.free(l),d.hb_face_destroy(h),d.hb_font_destroy(c)),l=d.malloc(m.byteLength),i.set(m,l),o=d.hb_blob_create(l,m.byteLength,2,0,0),h=d.hb_face_create(o,0),c=d.hb_font_create(h),a=g),null!=window.TextEncoder){null==u&&(u=new window.TextEncoder("utf8"));var v=d.hb_buffer_create(),_=u.encode(e),x=_.length,y=d.malloc(x);i.set(_,y),d.hb_buffer_add_utf8(v,y,x,0,x),d.free(y),d.hb_buffer_set_direction(v,f?4:5),d.hb_buffer_guess_segment_properties(v),d.hb_shape(c,v,0,0);var S=function(t){for(var e=d.hb_buffer_get_length(t),n=[],i=d.hb_buffer_get_glyph_infos(t,0)>>>2,a=d.hb_buffer_get_glyph_positions(t,0)>>>2,o=0;o<e;++o){var l=i+5*o,h=a+5*o;n.push({g:r[l+0],cl:r[l+2],ax:s[h+0],ay:s[h+1],dx:s[h+2],dy:s[h+3]})}return n}(v);d.hb_buffer_destroy(v);var b=S.slice(0);f||b.reverse();for(var M=0,w=0,C=1;C<b.length;C++){for(var T=b[C],E=T.cl;;){var A=e.codePointAt(M),P=n(A);if(!(w+P<=E))break;w+=P,M+=A<=65535?1:2}T.cl=M}return S}alert("Your browser is too old. Please, update it.")},e()}))}};const vt="161",_t=1,xt=2,yt=3,St=0,bt=1,Mt=100,wt=0,Ct=1,Tt=2,Et=0,At=1,Pt=2,Rt=3,Wt=4,Lt=5,It=6,kt=301,Nt=302,Ot=306,Ut=1e3,Dt=1001,Ft=1002,Bt=1003,zt=1005,Vt=1006,Gt=1007,Ht=1008,qt=1009,Xt=1012,jt=1013,Jt=1014,Qt=1015,Kt=1016,Zt=1020,Yt=1023,$t=1026,te=1027,ee=33776,ne=33777,ie=33778,re=33779,se=36492,ae=3001,oe="",le="srgb",he="srgb-linear",ce="display-p3",ue="display-p3-linear",de="linear",pe="srgb",fe="rec709",me="p3",ge=7680,ve="300 es",_e=1035,xe=2e3,ye=2001;class Se{addEventListener(t,e){void 0===this._listeners&&(this._listeners={});const n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)}hasEventListener(t,e){if(void 0===this._listeners)return!1;const n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)}removeEventListener(t,e){if(void 0===this._listeners)return;const n=this._listeners[t];if(void 0!==n){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}dispatchEvent(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const n=e.slice(0);for(let e=0,i=n.length;e<i;e++)n[e].call(this,t);t.target=null}}}const be=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],Me=Math.PI/180,we=180/Math.PI;function Ce(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(be[255&t]+be[t>>8&255]+be[t>>16&255]+be[t>>24&255]+"-"+be[255&e]+be[e>>8&255]+"-"+be[e>>16&15|64]+be[e>>24&255]+"-"+be[63&n|128]+be[n>>8&255]+"-"+be[n>>16&255]+be[n>>24&255]+be[255&i]+be[i>>8&255]+be[i>>16&255]+be[i>>24&255]).toLowerCase()}function Te(t,e,n){return Math.max(e,Math.min(n,t))}function Ee(t,e,n){return(1-n)*t+n*e}function Ae(t){return 0==(t&t-1)&&0!==t}function Pe(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function Re(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function We(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(4294967295*t);case Uint16Array:return Math.round(65535*t);case Uint8Array:return Math.round(255*t);case Int32Array:return Math.round(2147483647*t);case Int16Array:return Math.round(32767*t);case Int8Array:return Math.round(127*t);default:throw new Error("Invalid component type.")}}class Le{constructor(t=0,e=0){Le.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,n=this.y,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6],this.y=i[1]*e+i[4]*n+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(Te(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y;return e*e+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const n=Math.cos(e),i=Math.sin(e),r=this.x-t.x,s=this.y-t.y;return this.x=r*n-s*i+t.x,this.y=r*i+s*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ie{constructor(t,e,n,i,r,s,a,o,l){Ie.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==t&&this.set(t,e,n,i,r,s,a,o,l)}set(t,e,n,i,r,s,a,o,l){const h=this.elements;return h[0]=t,h[1]=i,h[2]=a,h[3]=e,h[4]=r,h[5]=o,h[6]=n,h[7]=s,h[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,s=n[0],a=n[3],o=n[6],l=n[1],h=n[4],c=n[7],u=n[2],d=n[5],p=n[8],f=i[0],m=i[3],g=i[6],v=i[1],_=i[4],x=i[7],y=i[2],S=i[5],b=i[8];return r[0]=s*f+a*v+o*y,r[3]=s*m+a*_+o*S,r[6]=s*g+a*x+o*b,r[1]=l*f+h*v+c*y,r[4]=l*m+h*_+c*S,r[7]=l*g+h*x+c*b,r[2]=u*f+d*v+p*y,r[5]=u*m+d*_+p*S,r[8]=u*g+d*x+p*b,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],l=t[7],h=t[8];return e*s*h-e*a*l-n*r*h+n*a*o+i*r*l-i*s*o}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],l=t[7],h=t[8],c=h*s-a*l,u=a*o-h*r,d=l*r-s*o,p=e*c+n*u+i*d;if(0===p)return this.set(0,0,0,0,0,0,0,0,0);const f=1/p;return t[0]=c*f,t[1]=(i*l-h*n)*f,t[2]=(a*n-i*s)*f,t[3]=u*f,t[4]=(h*e-i*o)*f,t[5]=(i*r-a*e)*f,t[6]=d*f,t[7]=(n*o-l*e)*f,t[8]=(s*e-n*r)*f,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,i,r,s,a){const o=Math.cos(r),l=Math.sin(r);return this.set(n*o,n*l,-n*(o*s+l*a)+s+t,-i*l,i*o,-i*(-l*s+o*a)+a+e,0,0,1),this}scale(t,e){return this.premultiply(ke.makeScale(t,e)),this}rotate(t){return this.premultiply(ke.makeRotation(-t)),this}translate(t,e){return this.premultiply(ke.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,n,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,n=t.elements;for(let i=0;i<9;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return(new this.constructor).fromArray(this.elements)}}const ke=new Ie;function Ne(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}function Oe(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function Ue(){const t=Oe("canvas");return t.style.display="block",t}const De={};function Fe(t){t in De||(De[t]=!0)}const Be=(new Ie).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),ze=(new Ie).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Ve={[he]:{transfer:de,primaries:fe,toReference:t=>t,fromReference:t=>t},[le]:{transfer:pe,primaries:fe,toReference:t=>t.convertSRGBToLinear(),fromReference:t=>t.convertLinearToSRGB()},[ue]:{transfer:de,primaries:me,toReference:t=>t.applyMatrix3(ze),fromReference:t=>t.applyMatrix3(Be)},[ce]:{transfer:pe,primaries:me,toReference:t=>t.convertSRGBToLinear().applyMatrix3(ze),fromReference:t=>t.applyMatrix3(Be).convertLinearToSRGB()}},Ge=new Set([he,ue]),He={enabled:!0,_workingColorSpace:he,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(t){if(!Ge.has(t))throw new Error(`Unsupported working color space, "${t}".`);this._workingColorSpace=t},convert:function(t,e,n){if(!1===this.enabled||e===n||!e||!n)return t;const i=Ve[e].toReference;return(0,Ve[n].fromReference)(i(t))},fromWorkingColorSpace:function(t,e){return this.convert(t,this._workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this._workingColorSpace)},getPrimaries:function(t){return Ve[t].primaries},getTransfer:function(t){return t===oe?de:Ve[t].transfer}};function qe(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Xe(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}let je;class Je{static getDataURL(t){if(/^data:/i.test(t.src))return t.src;if("undefined"==typeof HTMLCanvasElement)return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{void 0===je&&(je=Oe("canvas")),je.width=t.width,je.height=t.height;const n=je.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=je}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}static sRGBToLinear(t){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const e=Oe("canvas");e.width=t.width,e.height=t.height;const n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const i=n.getImageData(0,0,t.width,t.height),r=i.data;for(let t=0;t<r.length;t++)r[t]=255*qe(r[t]/255);return n.putImageData(i,0,0),e}if(t.data){const e=t.data.slice(0);for(let t=0;t<e.length;t++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[t]=Math.floor(255*qe(e[t]/255)):e[t]=qe(e[t]);return{data:e,width:t.width,height:t.height}}return t}}let Qe=0;class Ke{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Qe++}),this.uuid=Ce(),this.data=t,this.dataReady=!0,this.version=0}set needsUpdate(t){!0===t&&this.version++}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.images[this.uuid])return t.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(null!==i){let t;if(Array.isArray(i)){t=[];for(let e=0,n=i.length;e<n;e++)i[e].isDataTexture?t.push(Ze(i[e].image)):t.push(Ze(i[e]))}else t=Ze(i);n.url=t}return e||(t.images[this.uuid]=n),n}}function Ze(t){return"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?Je.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:{}}let Ye=0;class $e extends Se{constructor(t=$e.DEFAULT_IMAGE,e=$e.DEFAULT_MAPPING,n=1001,i=1001,r=1006,s=1008,a=1023,o=1009,l=$e.DEFAULT_ANISOTROPY,h=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Ye++}),this.uuid=Ce(),this.name="",this.source=new Ke(t),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new Le(0,0),this.repeat=new Le(1,1),this.center=new Le(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ie,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof h?this.colorSpace=h:(Fe("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=h===ae?le:oe),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Ut:t.x=t.x-Math.floor(t.x);break;case Dt:t.x=t.x<0?0:1;break;case Ft:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case Ut:t.y=t.y-Math.floor(t.y);break;case Dt:t.y=t.y<0?0:1;break;case Ft:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return Fe("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===le?ae:3e3}set encoding(t){Fe("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===ae?le:oe}}$e.DEFAULT_IMAGE=null,$e.DEFAULT_MAPPING=300,$e.DEFAULT_ANISOTROPY=1;class tn{constructor(t=0,e=0,n=0,i=1){tn.prototype.isVector4=!0,this.x=t,this.y=e,this.z=n,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=this.w,s=t.elements;return this.x=s[0]*e+s[4]*n+s[8]*i+s[12]*r,this.y=s[1]*e+s[5]*n+s[9]*i+s[13]*r,this.z=s[2]*e+s[6]*n+s[10]*i+s[14]*r,this.w=s[3]*e+s[7]*n+s[11]*i+s[15]*r,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,n,i,r;const s=.01,a=.1,o=t.elements,l=o[0],h=o[4],c=o[8],u=o[1],d=o[5],p=o[9],f=o[2],m=o[6],g=o[10];if(Math.abs(h-u)<s&&Math.abs(c-f)<s&&Math.abs(p-m)<s){if(Math.abs(h+u)<a&&Math.abs(c+f)<a&&Math.abs(p+m)<a&&Math.abs(l+d+g-3)<a)return this.set(1,0,0,0),this;e=Math.PI;const t=(l+1)/2,o=(d+1)/2,v=(g+1)/2,_=(h+u)/4,x=(c+f)/4,y=(p+m)/4;return t>o&&t>v?t<s?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(t),i=_/n,r=x/n):o>v?o<s?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(o),n=_/i,r=y/i):v<s?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(v),n=x/r,i=y/r),this.set(n,i,r,e),this}let v=Math.sqrt((m-p)*(m-p)+(c-f)*(c-f)+(u-h)*(u-h));return Math.abs(v)<.001&&(v=1),this.x=(m-p)/v,this.y=(c-f)/v,this.z=(u-h)/v,this.w=Math.acos((l+d+g-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this.w=t.w+(e.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class en extends Se{constructor(t=1,e=1,n={}){super(),this.isRenderTarget=!0,this.width=t,this.height=e,this.depth=1,this.scissor=new tn(0,0,t,e),this.scissorTest=!1,this.viewport=new tn(0,0,t,e);const i={width:t,height:e,depth:1};void 0!==n.encoding&&(Fe("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),n.colorSpace=n.encoding===ae?le:oe),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Vt,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},n),this.texture=new $e(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=n.generateMipmaps,this.texture.internalFormat=n.internalFormat,this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.depthTexture=n.depthTexture,this.samples=n.samples}setSize(t,e,n=1){this.width===t&&this.height===e&&this.depth===n||(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return(new this.constructor).copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.scissor.copy(t.scissor),this.scissorTest=t.scissorTest,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;const e=Object.assign({},t.texture.image);return this.texture.source=new Ke(e),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,null!==t.depthTexture&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class nn extends en{constructor(t=1,e=1,n={}){super(t,e,n),this.isWebGLRenderTarget=!0}}class rn extends $e{constructor(t=null,e=1,n=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:n,depth:i},this.magFilter=Bt,this.minFilter=Bt,this.wrapR=Dt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class sn extends $e{constructor(t=null,e=1,n=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:n,depth:i},this.magFilter=Bt,this.minFilter=Bt,this.wrapR=Dt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class an{constructor(t=0,e=0,n=0,i=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=n,this._w=i}static slerpFlat(t,e,n,i,r,s,a){let o=n[i+0],l=n[i+1],h=n[i+2],c=n[i+3];const u=r[s+0],d=r[s+1],p=r[s+2],f=r[s+3];if(0===a)return t[e+0]=o,t[e+1]=l,t[e+2]=h,void(t[e+3]=c);if(1===a)return t[e+0]=u,t[e+1]=d,t[e+2]=p,void(t[e+3]=f);if(c!==f||o!==u||l!==d||h!==p){let t=1-a;const e=o*u+l*d+h*p+c*f,n=e>=0?1:-1,i=1-e*e;if(i>Number.EPSILON){const r=Math.sqrt(i),s=Math.atan2(r,e*n);t=Math.sin(t*s)/r,a=Math.sin(a*s)/r}const r=a*n;if(o=o*t+u*r,l=l*t+d*r,h=h*t+p*r,c=c*t+f*r,t===1-a){const t=1/Math.sqrt(o*o+l*l+h*h+c*c);o*=t,l*=t,h*=t,c*=t}}t[e]=o,t[e+1]=l,t[e+2]=h,t[e+3]=c}static multiplyQuaternionsFlat(t,e,n,i,r,s){const a=n[i],o=n[i+1],l=n[i+2],h=n[i+3],c=r[s],u=r[s+1],d=r[s+2],p=r[s+3];return t[e]=a*p+h*c+o*d-l*u,t[e+1]=o*p+h*u+l*c-a*d,t[e+2]=l*p+h*d+a*u-o*c,t[e+3]=h*p-a*c-o*u-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e=!0){const n=t._x,i=t._y,r=t._z,s=t._order,a=Math.cos,o=Math.sin,l=a(n/2),h=a(i/2),c=a(r/2),u=o(n/2),d=o(i/2),p=o(r/2);switch(s){case"XYZ":this._x=u*h*c+l*d*p,this._y=l*d*c-u*h*p,this._z=l*h*p+u*d*c,this._w=l*h*c-u*d*p;break;case"YXZ":this._x=u*h*c+l*d*p,this._y=l*d*c-u*h*p,this._z=l*h*p-u*d*c,this._w=l*h*c+u*d*p;break;case"ZXY":this._x=u*h*c-l*d*p,this._y=l*d*c+u*h*p,this._z=l*h*p+u*d*c,this._w=l*h*c-u*d*p;break;case"ZYX":this._x=u*h*c-l*d*p,this._y=l*d*c+u*h*p,this._z=l*h*p-u*d*c,this._w=l*h*c+u*d*p;break;case"YZX":this._x=u*h*c+l*d*p,this._y=l*d*c+u*h*p,this._z=l*h*p-u*d*c,this._w=l*h*c-u*d*p;break;case"XZY":this._x=u*h*c-l*d*p,this._y=l*d*c-u*h*p,this._z=l*h*p+u*d*c,this._w=l*h*c+u*d*p}return!0===e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,n=e[0],i=e[4],r=e[8],s=e[1],a=e[5],o=e[9],l=e[2],h=e[6],c=e[10],u=n+a+c;if(u>0){const t=.5/Math.sqrt(u+1);this._w=.25/t,this._x=(h-o)*t,this._y=(r-l)*t,this._z=(s-i)*t}else if(n>a&&n>c){const t=2*Math.sqrt(1+n-a-c);this._w=(h-o)/t,this._x=.25*t,this._y=(i+s)/t,this._z=(r+l)/t}else if(a>c){const t=2*Math.sqrt(1+a-n-c);this._w=(r-l)/t,this._x=(i+s)/t,this._y=.25*t,this._z=(o+h)/t}else{const t=2*Math.sqrt(1+c-n-a);this._w=(s-i)/t,this._x=(r+l)/t,this._y=(o+h)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Te(this.dot(t),-1,1)))}rotateTowards(t,e){const n=this.angleTo(t);if(0===n)return this;const i=Math.min(1,e/n);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const n=t._x,i=t._y,r=t._z,s=t._w,a=e._x,o=e._y,l=e._z,h=e._w;return this._x=n*h+s*a+i*l-r*o,this._y=i*h+s*o+r*a-n*l,this._z=r*h+s*l+n*o-i*a,this._w=s*h-n*a-i*o-r*l,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const n=this._x,i=this._y,r=this._z,s=this._w;let a=s*t._w+n*t._x+i*t._y+r*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=s,this._x=n,this._y=i,this._z=r,this;const o=1-a*a;if(o<=Number.EPSILON){const t=1-e;return this._w=t*s+e*this._w,this._x=t*n+e*this._x,this._y=t*i+e*this._y,this._z=t*r+e*this._z,this.normalize(),this}const l=Math.sqrt(o),h=Math.atan2(l,a),c=Math.sin((1-e)*h)/l,u=Math.sin(e*h)/l;return this._w=s*c+this._w*u,this._x=n*c+this._x*u,this._y=i*c+this._y*u,this._z=r*c+this._z*u,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){const t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),i=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(e*Math.cos(i),n*Math.sin(r),n*Math.cos(r),e*Math.sin(i))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class on{constructor(t=0,e=0,n=0){on.prototype.isVector3=!0,this.x=t,this.y=e,this.z=n}set(t,e,n){return void 0===n&&(n=this.z),this.x=t,this.y=e,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(hn.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(hn.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6]*i,this.y=r[1]*e+r[4]*n+r[7]*i,this.z=r[2]*e+r[5]*n+r[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,n=this.y,i=this.z,r=t.elements,s=1/(r[3]*e+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*e+r[4]*n+r[8]*i+r[12])*s,this.y=(r[1]*e+r[5]*n+r[9]*i+r[13])*s,this.z=(r[2]*e+r[6]*n+r[10]*i+r[14])*s,this}applyQuaternion(t){const e=this.x,n=this.y,i=this.z,r=t.x,s=t.y,a=t.z,o=t.w,l=2*(s*i-a*n),h=2*(a*e-r*i),c=2*(r*n-s*e);return this.x=e+o*l+s*c-a*h,this.y=n+o*h+a*l-r*c,this.z=i+o*c+r*h-s*l,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,n=this.y,i=this.z,r=t.elements;return this.x=r[0]*e+r[4]*n+r[8]*i,this.y=r[1]*e+r[5]*n+r[9]*i,this.z=r[2]*e+r[6]*n+r[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const n=t.x,i=t.y,r=t.z,s=e.x,a=e.y,o=e.z;return this.x=i*o-r*a,this.y=r*s-n*o,this.z=n*a-i*s,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const n=t.dot(this)/e;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return ln.copy(this).projectOnVector(t),this.sub(ln)}reflect(t){return this.sub(ln.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const n=this.dot(t)/e;return Math.acos(Te(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return e*e+n*n+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,n){const i=Math.sin(e)*t;return this.x=i*Math.sin(n),this.y=Math.cos(e)*t,this.z=i*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,n){return this.x=t*Math.sin(e),this.y=n,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),n=Math.random()*Math.PI*2,i=Math.sqrt(1-t(e,2));return this.x=i*Math.cos(n),this.y=i*Math.sin(n),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const ln=new on,hn=new an;class cn{constructor(t=new on(1/0,1/0,1/0),e=new on(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e+=3)this.expandByPoint(dn.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,n=t.count;e<n;e++)this.expandByPoint(dn.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=dn.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const n=t.geometry;if(void 0!==n){const i=n.getAttribute("position");if(!0===e&&void 0!==i&&!0!==t.isInstancedMesh)for(let e=0,n=i.count;e<n;e++)!0===t.isMesh?t.getVertexPosition(e,dn):dn.fromBufferAttribute(i,e),dn.applyMatrix4(t.matrixWorld),this.expandByPoint(dn);else void 0!==t.boundingBox?(null===t.boundingBox&&t.computeBoundingBox(),pn.copy(t.boundingBox)):(null===n.boundingBox&&n.computeBoundingBox(),pn.copy(n.boundingBox)),pn.applyMatrix4(t.matrixWorld),this.union(pn)}const i=t.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,dn),dn.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(yn),Sn.subVectors(this.max,yn),fn.subVectors(t.a,yn),mn.subVectors(t.b,yn),gn.subVectors(t.c,yn),vn.subVectors(mn,fn),_n.subVectors(gn,mn),xn.subVectors(fn,gn);let e=[0,-vn.z,vn.y,0,-_n.z,_n.y,0,-xn.z,xn.y,vn.z,0,-vn.x,_n.z,0,-_n.x,xn.z,0,-xn.x,-vn.y,vn.x,0,-_n.y,_n.x,0,-xn.y,xn.x,0];return!!wn(e,fn,mn,gn,Sn)&&(e=[1,0,0,0,1,0,0,0,1],!!wn(e,fn,mn,gn,Sn)&&(bn.crossVectors(vn,_n),e=[bn.x,bn.y,bn.z],wn(e,fn,mn,gn,Sn)))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,dn).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=.5*this.getSize(dn).length()),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()||(un[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),un[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),un[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),un[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),un[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),un[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),un[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),un[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(un)),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const un=[new on,new on,new on,new on,new on,new on,new on,new on],dn=new on,pn=new cn,fn=new on,mn=new on,gn=new on,vn=new on,_n=new on,xn=new on,yn=new on,Sn=new on,bn=new on,Mn=new on;function wn(t,e,n,i,r){for(let s=0,a=t.length-3;s<=a;s+=3){Mn.fromArray(t,s);const a=r.x*Math.abs(Mn.x)+r.y*Math.abs(Mn.y)+r.z*Math.abs(Mn.z),o=e.dot(Mn),l=n.dot(Mn),h=i.dot(Mn);if(Math.max(-Math.max(o,l,h),Math.min(o,l,h))>a)return!1}return!0}const Cn=new cn,Tn=new on,En=new on;class An{constructor(t=new on,e=-1){this.isSphere=!0,this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const n=this.center;void 0!==e?n.copy(e):Cn.setFromPoints(t).getCenter(n);let i=0;for(let r=0,s=t.length;r<s;r++)i=Math.max(i,n.distanceToSquared(t[r]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;Tn.subVectors(t,this.center);const e=Tn.lengthSq();if(e>this.radius*this.radius){const t=Math.sqrt(e),n=.5*(t-this.radius);this.center.addScaledVector(Tn,n/t),this.radius+=n}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(!0===this.center.equals(t.center)?this.radius=Math.max(this.radius,t.radius):(En.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(Tn.copy(t.center).add(En)),this.expandByPoint(Tn.copy(t.center).sub(En))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Pn=new on,Rn=new on,Wn=new on,Ln=new on,In=new on,kn=new on,Nn=new on;class On{constructor(t=new on,e=new on(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Pn)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=Pn.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Pn.copy(this.origin).addScaledVector(this.direction,e),Pn.distanceToSquared(t))}distanceSqToSegment(t,e,n,i){Rn.copy(t).add(e).multiplyScalar(.5),Wn.copy(e).sub(t).normalize(),Ln.copy(this.origin).sub(Rn);const r=.5*t.distanceTo(e),s=-this.direction.dot(Wn),a=Ln.dot(this.direction),o=-Ln.dot(Wn),l=Ln.lengthSq(),h=Math.abs(1-s*s);let c,u,d,p;if(h>0)if(c=s*o-a,u=s*a-o,p=r*h,c>=0)if(u>=-p)if(u<=p){const t=1/h;c*=t,u*=t,d=c*(c+s*u+2*a)+u*(s*c+u+2*o)+l}else u=r,c=Math.max(0,-(s*u+a)),d=-c*c+u*(u+2*o)+l;else u=-r,c=Math.max(0,-(s*u+a)),d=-c*c+u*(u+2*o)+l;else u<=-p?(c=Math.max(0,-(-s*r+a)),u=c>0?-r:Math.min(Math.max(-r,-o),r),d=-c*c+u*(u+2*o)+l):u<=p?(c=0,u=Math.min(Math.max(-r,-o),r),d=u*(u+2*o)+l):(c=Math.max(0,-(s*r+a)),u=c>0?r:Math.min(Math.max(-r,-o),r),d=-c*c+u*(u+2*o)+l);else u=s>0?-r:r,c=Math.max(0,-(s*u+a)),d=-c*c+u*(u+2*o)+l;return n&&n.copy(this.origin).addScaledVector(this.direction,c),i&&i.copy(Rn).addScaledVector(Wn,u),d}intersectSphere(t,e){Pn.subVectors(t.center,this.origin);const n=Pn.dot(this.direction),i=Pn.dot(Pn)-n*n,r=t.radius*t.radius;if(i>r)return null;const s=Math.sqrt(r-i),a=n-s,o=n+s;return o<0?null:a<0?this.at(o,e):this.at(a,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){const n=this.distanceToPlane(t);return null===n?null:this.at(n,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);if(0===e)return!0;return t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,i,r,s,a,o;const l=1/this.direction.x,h=1/this.direction.y,c=1/this.direction.z,u=this.origin;return l>=0?(n=(t.min.x-u.x)*l,i=(t.max.x-u.x)*l):(n=(t.max.x-u.x)*l,i=(t.min.x-u.x)*l),h>=0?(r=(t.min.y-u.y)*h,s=(t.max.y-u.y)*h):(r=(t.max.y-u.y)*h,s=(t.min.y-u.y)*h),n>s||r>i?null:((r>n||isNaN(n))&&(n=r),(s<i||isNaN(i))&&(i=s),c>=0?(a=(t.min.z-u.z)*c,o=(t.max.z-u.z)*c):(a=(t.max.z-u.z)*c,o=(t.min.z-u.z)*c),n>o||a>i?null:((a>n||n!=n)&&(n=a),(o<i||i!=i)&&(i=o),i<0?null:this.at(n>=0?n:i,e)))}intersectsBox(t){return null!==this.intersectBox(t,Pn)}intersectTriangle(t,e,n,i,r){In.subVectors(e,t),kn.subVectors(n,t),Nn.crossVectors(In,kn);let s,a=this.direction.dot(Nn);if(a>0){if(i)return null;s=1}else{if(!(a<0))return null;s=-1,a=-a}Ln.subVectors(this.origin,t);const o=s*this.direction.dot(kn.crossVectors(Ln,kn));if(o<0)return null;const l=s*this.direction.dot(In.cross(Ln));if(l<0)return null;if(o+l>a)return null;const h=-s*Ln.dot(Nn);return h<0?null:this.at(h/a,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Un{constructor(t,e,n,i,r,s,a,o,l,h,c,u,d,p,f,m){Un.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==t&&this.set(t,e,n,i,r,s,a,o,l,h,c,u,d,p,f,m)}set(t,e,n,i,r,s,a,o,l,h,c,u,d,p,f,m){const g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=i,g[1]=r,g[5]=s,g[9]=a,g[13]=o,g[2]=l,g[6]=h,g[10]=c,g[14]=u,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Un).fromArray(this.elements)}copy(t){const e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this}copyPosition(t){const e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,n=t.elements,i=1/Dn.setFromMatrixColumn(t,0).length(),r=1/Dn.setFromMatrixColumn(t,1).length(),s=1/Dn.setFromMatrixColumn(t,2).length();return e[0]=n[0]*i,e[1]=n[1]*i,e[2]=n[2]*i,e[3]=0,e[4]=n[4]*r,e[5]=n[5]*r,e[6]=n[6]*r,e[7]=0,e[8]=n[8]*s,e[9]=n[9]*s,e[10]=n[10]*s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,n=t.x,i=t.y,r=t.z,s=Math.cos(n),a=Math.sin(n),o=Math.cos(i),l=Math.sin(i),h=Math.cos(r),c=Math.sin(r);if("XYZ"===t.order){const t=s*h,n=s*c,i=a*h,r=a*c;e[0]=o*h,e[4]=-o*c,e[8]=l,e[1]=n+i*l,e[5]=t-r*l,e[9]=-a*o,e[2]=r-t*l,e[6]=i+n*l,e[10]=s*o}else if("YXZ"===t.order){const t=o*h,n=o*c,i=l*h,r=l*c;e[0]=t+r*a,e[4]=i*a-n,e[8]=s*l,e[1]=s*c,e[5]=s*h,e[9]=-a,e[2]=n*a-i,e[6]=r+t*a,e[10]=s*o}else if("ZXY"===t.order){const t=o*h,n=o*c,i=l*h,r=l*c;e[0]=t-r*a,e[4]=-s*c,e[8]=i+n*a,e[1]=n+i*a,e[5]=s*h,e[9]=r-t*a,e[2]=-s*l,e[6]=a,e[10]=s*o}else if("ZYX"===t.order){const t=s*h,n=s*c,i=a*h,r=a*c;e[0]=o*h,e[4]=i*l-n,e[8]=t*l+r,e[1]=o*c,e[5]=r*l+t,e[9]=n*l-i,e[2]=-l,e[6]=a*o,e[10]=s*o}else if("YZX"===t.order){const t=s*o,n=s*l,i=a*o,r=a*l;e[0]=o*h,e[4]=r-t*c,e[8]=i*c+n,e[1]=c,e[5]=s*h,e[9]=-a*h,e[2]=-l*h,e[6]=n*c+i,e[10]=t-r*c}else if("XZY"===t.order){const t=s*o,n=s*l,i=a*o,r=a*l;e[0]=o*h,e[4]=-c,e[8]=l*h,e[1]=t*c+r,e[5]=s*h,e[9]=n*c-i,e[2]=i*c-n,e[6]=a*h,e[10]=r*c+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Bn,t,zn)}lookAt(t,e,n){const i=this.elements;return Hn.subVectors(t,e),0===Hn.lengthSq()&&(Hn.z=1),Hn.normalize(),Vn.crossVectors(n,Hn),0===Vn.lengthSq()&&(1===Math.abs(n.z)?Hn.x+=1e-4:Hn.z+=1e-4,Hn.normalize(),Vn.crossVectors(n,Hn)),Vn.normalize(),Gn.crossVectors(Hn,Vn),i[0]=Vn.x,i[4]=Gn.x,i[8]=Hn.x,i[1]=Vn.y,i[5]=Gn.y,i[9]=Hn.y,i[2]=Vn.z,i[6]=Gn.z,i[10]=Hn.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const n=t.elements,i=e.elements,r=this.elements,s=n[0],a=n[4],o=n[8],l=n[12],h=n[1],c=n[5],u=n[9],d=n[13],p=n[2],f=n[6],m=n[10],g=n[14],v=n[3],_=n[7],x=n[11],y=n[15],S=i[0],b=i[4],M=i[8],w=i[12],C=i[1],T=i[5],E=i[9],A=i[13],P=i[2],R=i[6],W=i[10],L=i[14],I=i[3],k=i[7],N=i[11],O=i[15];return r[0]=s*S+a*C+o*P+l*I,r[4]=s*b+a*T+o*R+l*k,r[8]=s*M+a*E+o*W+l*N,r[12]=s*w+a*A+o*L+l*O,r[1]=h*S+c*C+u*P+d*I,r[5]=h*b+c*T+u*R+d*k,r[9]=h*M+c*E+u*W+d*N,r[13]=h*w+c*A+u*L+d*O,r[2]=p*S+f*C+m*P+g*I,r[6]=p*b+f*T+m*R+g*k,r[10]=p*M+f*E+m*W+g*N,r[14]=p*w+f*A+m*L+g*O,r[3]=v*S+_*C+x*P+y*I,r[7]=v*b+_*T+x*R+y*k,r[11]=v*M+_*E+x*W+y*N,r[15]=v*w+_*A+x*L+y*O,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],n=t[4],i=t[8],r=t[12],s=t[1],a=t[5],o=t[9],l=t[13],h=t[2],c=t[6],u=t[10],d=t[14];return t[3]*(+r*o*c-i*l*c-r*a*u+n*l*u+i*a*d-n*o*d)+t[7]*(+e*o*d-e*l*u+r*s*u-i*s*d+i*l*h-r*o*h)+t[11]*(+e*l*c-e*a*d-r*s*c+n*s*d+r*a*h-n*l*h)+t[15]*(-i*a*h-e*o*c+e*a*u+i*s*c-n*s*u+n*o*h)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,n){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=n),this}invert(){const t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],l=t[7],h=t[8],c=t[9],u=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15],v=c*m*l-f*u*l+f*o*d-a*m*d-c*o*g+a*u*g,_=p*u*l-h*m*l-p*o*d+s*m*d+h*o*g-s*u*g,x=h*f*l-p*c*l+p*a*d-s*f*d-h*a*g+s*c*g,y=p*c*o-h*f*o-p*a*u+s*f*u+h*a*m-s*c*m,S=e*v+n*_+i*x+r*y;if(0===S)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const b=1/S;return t[0]=v*b,t[1]=(f*u*r-c*m*r-f*i*d+n*m*d+c*i*g-n*u*g)*b,t[2]=(a*m*r-f*o*r+f*i*l-n*m*l-a*i*g+n*o*g)*b,t[3]=(c*o*r-a*u*r-c*i*l+n*u*l+a*i*d-n*o*d)*b,t[4]=_*b,t[5]=(h*m*r-p*u*r+p*i*d-e*m*d-h*i*g+e*u*g)*b,t[6]=(p*o*r-s*m*r-p*i*l+e*m*l+s*i*g-e*o*g)*b,t[7]=(s*u*r-h*o*r+h*i*l-e*u*l-s*i*d+e*o*d)*b,t[8]=x*b,t[9]=(p*c*r-h*f*r-p*n*d+e*f*d+h*n*g-e*c*g)*b,t[10]=(s*f*r-p*a*r+p*n*l-e*f*l-s*n*g+e*a*g)*b,t[11]=(h*a*r-s*c*r-h*n*l+e*c*l+s*n*d-e*a*d)*b,t[12]=y*b,t[13]=(h*f*i-p*c*i+p*n*u-e*f*u-h*n*m+e*c*m)*b,t[14]=(p*a*i-s*f*i-p*n*o+e*f*o+s*n*m-e*a*m)*b,t[15]=(s*c*i-h*a*i+h*n*o-e*c*o-s*n*u+e*a*u)*b,this}scale(t){const e=this.elements,n=t.x,i=t.y,r=t.z;return e[0]*=n,e[4]*=i,e[8]*=r,e[1]*=n,e[5]*=i,e[9]*=r,e[2]*=n,e[6]*=i,e[10]*=r,e[3]*=n,e[7]*=i,e[11]*=r,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,i))}makeTranslation(t,e,n){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const n=Math.cos(e),i=Math.sin(e),r=1-n,s=t.x,a=t.y,o=t.z,l=r*s,h=r*a;return this.set(l*s+n,l*a-i*o,l*o+i*a,0,l*a+i*o,h*a+n,h*o-i*s,0,l*o-i*a,h*o+i*s,r*o*o+n,0,0,0,0,1),this}makeScale(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,e,n,i,r,s){return this.set(1,n,r,0,t,1,s,0,e,i,1,0,0,0,0,1),this}compose(t,e,n){const i=this.elements,r=e._x,s=e._y,a=e._z,o=e._w,l=r+r,h=s+s,c=a+a,u=r*l,d=r*h,p=r*c,f=s*h,m=s*c,g=a*c,v=o*l,_=o*h,x=o*c,y=n.x,S=n.y,b=n.z;return i[0]=(1-(f+g))*y,i[1]=(d+x)*y,i[2]=(p-_)*y,i[3]=0,i[4]=(d-x)*S,i[5]=(1-(u+g))*S,i[6]=(m+v)*S,i[7]=0,i[8]=(p+_)*b,i[9]=(m-v)*b,i[10]=(1-(u+f))*b,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,n){const i=this.elements;let r=Dn.set(i[0],i[1],i[2]).length();const s=Dn.set(i[4],i[5],i[6]).length(),a=Dn.set(i[8],i[9],i[10]).length();this.determinant()<0&&(r=-r),t.x=i[12],t.y=i[13],t.z=i[14],Fn.copy(this);const o=1/r,l=1/s,h=1/a;return Fn.elements[0]*=o,Fn.elements[1]*=o,Fn.elements[2]*=o,Fn.elements[4]*=l,Fn.elements[5]*=l,Fn.elements[6]*=l,Fn.elements[8]*=h,Fn.elements[9]*=h,Fn.elements[10]*=h,e.setFromRotationMatrix(Fn),n.x=r,n.y=s,n.z=a,this}makePerspective(t,e,n,i,r,s,a=2e3){const o=this.elements,l=2*r/(e-t),h=2*r/(n-i),c=(e+t)/(e-t),u=(n+i)/(n-i);let d,p;if(a===xe)d=-(s+r)/(s-r),p=-2*s*r/(s-r);else{if(a!==ye)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);d=-s/(s-r),p=-s*r/(s-r)}return o[0]=l,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=h,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=d,o[14]=p,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(t,e,n,i,r,s,a=2e3){const o=this.elements,l=1/(e-t),h=1/(n-i),c=1/(s-r),u=(e+t)*l,d=(n+i)*h;let p,f;if(a===xe)p=(s+r)*c,f=-2*c;else{if(a!==ye)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);p=r*c,f=-1*c}return o[0]=2*l,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*h,o[9]=0,o[13]=-d,o[2]=0,o[6]=0,o[10]=f,o[14]=-p,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(t){const e=this.elements,n=t.elements;for(let i=0;i<16;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t,e=0){for(let n=0;n<16;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){const n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}const Dn=new on,Fn=new Un,Bn=new on(0,0,0),zn=new on(1,1,1),Vn=new on,Gn=new on,Hn=new on,qn=new Un,Xn=new an;class jn{constructor(t=0,e=0,n=0,i=jn.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=n,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,i=this._order){return this._x=t,this._y=e,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){const i=t.elements,r=i[0],s=i[4],a=i[8],o=i[1],l=i[5],h=i[9],c=i[2],u=i[6],d=i[10];switch(e){case"XYZ":this._y=Math.asin(Te(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-h,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Te(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-c,r),this._z=0);break;case"ZXY":this._x=Math.asin(Te(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-c,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,r));break;case"ZYX":this._y=Math.asin(-Te(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(u,d),this._z=Math.atan2(o,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(Te(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-h,l),this._y=Math.atan2(-c,r)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-Te(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-h,d),this._y=0)}return this._order=e,!0===n&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return qn.makeRotationFromQuaternion(t),this.setFromRotationMatrix(qn,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return Xn.setFromEuler(this),this.setFromQuaternion(Xn,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}jn.DEFAULT_ORDER="XYZ";class Jn{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}isEnabled(t){return 0!=(this.mask&(1<<t|0))}}let Qn=0;const Kn=new on,Zn=new an,Yn=new Un,$n=new on,ti=new on,ei=new on,ni=new an,ii=new on(1,0,0),ri=new on(0,1,0),si=new on(0,0,1),ai={type:"added"},oi={type:"removed"};class li extends Se{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Qn++}),this.uuid=Ce(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=li.DEFAULT_UP.clone();const t=new on,e=new jn,n=new an,i=new on(1,1,1);e._onChange((function(){n.setFromEuler(e,!1)})),n._onChange((function(){e.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Un},normalMatrix:{value:new Ie}}),this.matrix=new Un,this.matrixWorld=new Un,this.matrixAutoUpdate=li.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=li.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Jn,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Zn.setFromAxisAngle(t,e),this.quaternion.multiply(Zn),this}rotateOnWorldAxis(t,e){return Zn.setFromAxisAngle(t,e),this.quaternion.premultiply(Zn),this}rotateX(t){return this.rotateOnAxis(ii,t)}rotateY(t){return this.rotateOnAxis(ri,t)}rotateZ(t){return this.rotateOnAxis(si,t)}translateOnAxis(t,e){return Kn.copy(t).applyQuaternion(this.quaternion),this.position.add(Kn.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(ii,t)}translateY(t){return this.translateOnAxis(ri,t)}translateZ(t){return this.translateOnAxis(si,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Yn.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?$n.copy(t):$n.set(t,e,n);const i=this.parent;this.updateWorldMatrix(!0,!1),ti.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Yn.lookAt(ti,$n,this.up):Yn.lookAt($n,ti,this.up),this.quaternion.setFromRotationMatrix(Yn),i&&(Yn.extractRotation(i.matrixWorld),Zn.setFromRotationMatrix(Yn),this.quaternion.premultiply(Zn.invert()))}add(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this||t&&t.isObject3D&&(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(ai)),this}remove(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(oi)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Yn.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Yn.multiply(t.parent.matrixWorld)),t.applyMatrix4(Yn),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,i=this.children.length;n<i;n++){const i=this.children[n].getObjectByProperty(t,e);if(void 0!==i)return i}}getObjectsByProperty(t,e,n=[]){this[t]===e&&n.push(this);const i=this.children;for(let r=0,s=i.length;r<s;r++)i[r].getObjectsByProperty(t,e,n);return n}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ti,t,ei),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ti,ni,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}traverseAncestors(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let n=0,i=e.length;n<i;n++){const i=e[n];!0!==i.matrixWorldAutoUpdate&&!0!==t||i.updateMatrixWorld(t)}}updateWorldMatrix(t,e){const n=this.parent;if(!0===t&&null!==n&&!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,n=t.length;e<n;e++){const n=t[e];!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!1,!0)}}}toJSON(t){const e=void 0===t||"string"==typeof t,n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};function r(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map((t=>({boxInitialized:t.boxInitialized,boxMin:t.box.min.toArray(),boxMax:t.box.max.toArray(),sphereInitialized:t.sphereInitialized,sphereRadius:t.sphere.radius,sphereCenter:t.sphere.center.toArray()}))),i.maxGeometryCount=this._maxGeometryCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(t),null!==this.boundingSphere&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),null!==this.boundingBox&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const n=e.shapes;if(Array.isArray(n))for(let e=0,i=n.length;e<i;e++){const i=n[e];r(t.shapes,i)}else r(t.shapes,n)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(r(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let n=0,i=this.material.length;n<i;n++)e.push(r(t.materials,this.material[n]));i.material=e}else i.material=r(t.materials,this.material);if(this.children.length>0){i.children=[];for(let e=0;e<this.children.length;e++)i.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let e=0;e<this.animations.length;e++){const n=this.animations[e];i.animations.push(r(t.animations,n))}}if(e){const e=s(t.geometries),i=s(t.materials),r=s(t.textures),a=s(t.images),o=s(t.shapes),l=s(t.skeletons),h=s(t.animations),c=s(t.nodes);e.length>0&&(n.geometries=e),i.length>0&&(n.materials=i),r.length>0&&(n.textures=r),a.length>0&&(n.images=a),o.length>0&&(n.shapes=o),l.length>0&&(n.skeletons=l),h.length>0&&(n.animations=h),c.length>0&&(n.nodes=c)}return n.object=i,n;function s(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}}clone(t){return(new this.constructor).copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let n=0;n<t.children.length;n++){const e=t.children[n];this.add(e.clone())}return this}}li.DEFAULT_UP=new on(0,1,0),li.DEFAULT_MATRIX_AUTO_UPDATE=!0,li.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const hi=new on,ci=new on,ui=new on,di=new on,pi=new on,fi=new on,mi=new on,gi=new on,vi=new on,_i=new on;class xi{constructor(t=new on,e=new on,n=new on){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,i){i.subVectors(n,e),hi.subVectors(t,e),i.cross(hi);const r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(t,e,n,i,r){hi.subVectors(i,e),ci.subVectors(n,e),ui.subVectors(t,e);const s=hi.dot(hi),a=hi.dot(ci),o=hi.dot(ui),l=ci.dot(ci),h=ci.dot(ui),c=s*l-a*a;if(0===c)return r.set(0,0,0),null;const u=1/c,d=(l*o-a*h)*u,p=(s*h-a*o)*u;return r.set(1-d-p,p,d)}static containsPoint(t,e,n,i){return null!==this.getBarycoord(t,e,n,i,di)&&(di.x>=0&&di.y>=0&&di.x+di.y<=1)}static getInterpolation(t,e,n,i,r,s,a,o){return null===this.getBarycoord(t,e,n,i,di)?(o.x=0,o.y=0,"z"in o&&(o.z=0),"w"in o&&(o.w=0),null):(o.setScalar(0),o.addScaledVector(r,di.x),o.addScaledVector(s,di.y),o.addScaledVector(a,di.z),o)}static isFrontFacing(t,e,n,i){return hi.subVectors(n,e),ci.subVectors(t,e),hi.cross(ci).dot(i)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,e,n,i){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,i),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return hi.subVectors(this.c,this.b),ci.subVectors(this.a,this.b),.5*hi.cross(ci).length()}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return xi.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return xi.getBarycoord(t,this.a,this.b,this.c,e)}getInterpolation(t,e,n,i,r){return xi.getInterpolation(t,this.a,this.b,this.c,e,n,i,r)}containsPoint(t){return xi.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return xi.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const n=this.a,i=this.b,r=this.c;let s,a;pi.subVectors(i,n),fi.subVectors(r,n),gi.subVectors(t,n);const o=pi.dot(gi),l=fi.dot(gi);if(o<=0&&l<=0)return e.copy(n);vi.subVectors(t,i);const h=pi.dot(vi),c=fi.dot(vi);if(h>=0&&c<=h)return e.copy(i);const u=o*c-h*l;if(u<=0&&o>=0&&h<=0)return s=o/(o-h),e.copy(n).addScaledVector(pi,s);_i.subVectors(t,r);const d=pi.dot(_i),p=fi.dot(_i);if(p>=0&&d<=p)return e.copy(r);const f=d*l-o*p;if(f<=0&&l>=0&&p<=0)return a=l/(l-p),e.copy(n).addScaledVector(fi,a);const m=h*p-d*c;if(m<=0&&c-h>=0&&d-p>=0)return mi.subVectors(r,i),a=(c-h)/(c-h+(d-p)),e.copy(i).addScaledVector(mi,a);const g=1/(m+f+u);return s=f*g,a=u*g,e.copy(n).addScaledVector(pi,s).addScaledVector(fi,a)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const yi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Si={h:0,s:0,l:0},bi={h:0,s:0,l:0};function Mi(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}class wi{constructor(t,e,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,n)}set(t,e,n){if(void 0===e&&void 0===n){const e=t;e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e)}else this.setRGB(t,e,n);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=le){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,He.toWorkingColorSpace(this,e),this}setRGB(t,e,n,i=He.workingColorSpace){return this.r=t,this.g=e,this.b=n,He.toWorkingColorSpace(this,i),this}setHSL(t,e,n,i=He.workingColorSpace){var r;if(t=(t%(r=1)+r)%r,e=Te(e,0,1),n=Te(n,0,1),0===e)this.r=this.g=this.b=n;else{const i=n<=.5?n*(1+e):n+e-n*e,r=2*n-i;this.r=Mi(r,i,t+1/3),this.g=Mi(r,i,t),this.b=Mi(r,i,t-1/3)}return He.toWorkingColorSpace(this,i),this}setStyle(t,e=le){function n(t){void 0!==t&&parseFloat(t)}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(t)){let t;const r=i[1],s=i[2];switch(r){case"rgb":case"rgba":if(t=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(t[4]),this.setRGB(Math.min(255,parseInt(t[1],10))/255,Math.min(255,parseInt(t[2],10))/255,Math.min(255,parseInt(t[3],10))/255,e);if(t=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(t[4]),this.setRGB(Math.min(100,parseInt(t[1],10))/100,Math.min(100,parseInt(t[2],10))/100,Math.min(100,parseInt(t[3],10))/100,e);break;case"hsl":case"hsla":if(t=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(t[4]),this.setHSL(parseFloat(t[1])/360,parseFloat(t[2])/100,parseFloat(t[3])/100,e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=i[1],n=t.length;if(3===n)return this.setRGB(parseInt(t.charAt(0),16)/15,parseInt(t.charAt(1),16)/15,parseInt(t.charAt(2),16)/15,e);if(6===n)return this.setHex(parseInt(t,16),e)}else if(t&&t.length>0)return this.setColorName(t,e);return this}setColorName(t,e=le){const n=yi[t.toLowerCase()];return void 0!==n&&this.setHex(n,e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=qe(t.r),this.g=qe(t.g),this.b=qe(t.b),this}copyLinearToSRGB(t){return this.r=Xe(t.r),this.g=Xe(t.g),this.b=Xe(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=le){return He.fromWorkingColorSpace(Ci.copy(this),t),65536*Math.round(Te(255*Ci.r,0,255))+256*Math.round(Te(255*Ci.g,0,255))+Math.round(Te(255*Ci.b,0,255))}getHexString(t=le){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=He.workingColorSpace){He.fromWorkingColorSpace(Ci.copy(this),e);const n=Ci.r,i=Ci.g,r=Ci.b,s=Math.max(n,i,r),a=Math.min(n,i,r);let o,l;const h=(a+s)/2;if(a===s)o=0,l=0;else{const t=s-a;switch(l=h<=.5?t/(s+a):t/(2-s-a),s){case n:o=(i-r)/t+(i<r?6:0);break;case i:o=(r-n)/t+2;break;case r:o=(n-i)/t+4}o/=6}return t.h=o,t.s=l,t.l=h,t}getRGB(t,e=He.workingColorSpace){return He.fromWorkingColorSpace(Ci.copy(this),e),t.r=Ci.r,t.g=Ci.g,t.b=Ci.b,t}getStyle(t=le){He.fromWorkingColorSpace(Ci.copy(this),t);const e=Ci.r,n=Ci.g,i=Ci.b;return t!==le?`color(${t} ${e.toFixed(3)} ${n.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(255*e)},${Math.round(255*n)},${Math.round(255*i)})`}offsetHSL(t,e,n){return this.getHSL(Si),this.setHSL(Si.h+t,Si.s+e,Si.l+n)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,n){return this.r=t.r+(e.r-t.r)*n,this.g=t.g+(e.g-t.g)*n,this.b=t.b+(e.b-t.b)*n,this}lerpHSL(t,e){this.getHSL(Si),t.getHSL(bi);const n=Ee(Si.h,bi.h,e),i=Ee(Si.s,bi.s,e),r=Ee(Si.l,bi.l,e);return this.setHSL(n,i,r),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,n=this.g,i=this.b,r=t.elements;return this.r=r[0]*e+r[3]*n+r[6]*i,this.g=r[1]*e+r[4]*n+r[7]*i,this.b=r[2]*e+r[5]*n+r[8]*i,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Ci=new wi;wi.NAMES=yi;let Ti=0;class Ei extends Se{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Ti++}),this.uuid=Ce(),this.name="",this.type="Material",this.blending=1,this.side=St,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=Mt,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new wi(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ge,this.stencilZFail=ge,this.stencilZPass=ge,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(void 0!==t)for(const e in t){const n=t[e];if(void 0===n)continue;const i=this[e];void 0!==i&&(i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]=n)}}toJSON(t){const e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function i(t){const e=[];for(const n in t){const i=t[n];delete i.metadata,e.push(i)}return e}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),this.side!==St&&(n.side=this.side),!0===this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=!0),204!==this.blendSrc&&(n.blendSrc=this.blendSrc),205!==this.blendDst&&(n.blendDst=this.blendDst),this.blendEquation!==Mt&&(n.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(n.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(n.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(n.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(n.depthFunc=this.depthFunc),!1===this.depthTest&&(n.depthTest=this.depthTest),!1===this.depthWrite&&(n.depthWrite=this.depthWrite),!1===this.colorWrite&&(n.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(n.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(n.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(n.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==ge&&(n.stencilFail=this.stencilFail),this.stencilZFail!==ge&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==ge&&(n.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(n.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=!0),!0===this.alphaToCoverage&&(n.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=!0),!0===this.forceSinglePass&&(n.forceSinglePass=!0),!0===this.wireframe&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),e){const e=i(t.textures),r=i(t.images);e.length>0&&(n.textures=e),r.length>0&&(n.images=r)}return n}clone(){return(new this.constructor).copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let n=null;if(null!==e){const t=e.length;n=new Array(t);for(let i=0;i!==t;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){!0===t&&this.version++}}class Ai extends Ei{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new wi(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=wt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const Pi=new on,Ri=new Le;class Wi{constructor(t,e,n=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=n,this.usage=35044,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Qt,this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}get updateRange(){return Fe("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(t){return this.usage=t,this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,n){t*=this.itemSize,n*=e.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[t+i]=e.array[n+i];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(2===this.itemSize)for(let e=0,n=this.count;e<n;e++)Ri.fromBufferAttribute(this,e),Ri.applyMatrix3(t),this.setXY(e,Ri.x,Ri.y);else if(3===this.itemSize)for(let e=0,n=this.count;e<n;e++)Pi.fromBufferAttribute(this,e),Pi.applyMatrix3(t),this.setXYZ(e,Pi.x,Pi.y,Pi.z);return this}applyMatrix4(t){for(let e=0,n=this.count;e<n;e++)Pi.fromBufferAttribute(this,e),Pi.applyMatrix4(t),this.setXYZ(e,Pi.x,Pi.y,Pi.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)Pi.fromBufferAttribute(this,e),Pi.applyNormalMatrix(t),this.setXYZ(e,Pi.x,Pi.y,Pi.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)Pi.fromBufferAttribute(this,e),Pi.transformDirection(t),this.setXYZ(e,Pi.x,Pi.y,Pi.z);return this}set(t,e=0){return this.array.set(t,e),this}getComponent(t,e){let n=this.array[t*this.itemSize+e];return this.normalized&&(n=Re(n,this.array)),n}setComponent(t,e,n){return this.normalized&&(n=We(n,this.array)),this.array[t*this.itemSize+e]=n,this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=Re(e,this.array)),e}setX(t,e){return this.normalized&&(e=We(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=Re(e,this.array)),e}setY(t,e){return this.normalized&&(e=We(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=Re(e,this.array)),e}setZ(t,e){return this.normalized&&(e=We(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=Re(e,this.array)),e}setW(t,e){return this.normalized&&(e=We(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,n){return t*=this.itemSize,this.normalized&&(e=We(e,this.array),n=We(n,this.array)),this.array[t+0]=e,this.array[t+1]=n,this}setXYZ(t,e,n,i){return t*=this.itemSize,this.normalized&&(e=We(e,this.array),n=We(n,this.array),i=We(i,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this}setXYZW(t,e,n,i,r){return t*=this.itemSize,this.normalized&&(e=We(e,this.array),n=We(n,this.array),i=We(i,this.array),r=We(r,this.array)),this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=r,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),35044!==this.usage&&(t.usage=this.usage),t}}class Li extends Wi{constructor(t,e,n){super(new Uint16Array(t),e,n)}}class Ii extends Wi{constructor(t,e,n){super(new Uint32Array(t),e,n)}}class ki extends Wi{constructor(t,e,n){super(new Float32Array(t),e,n)}}let Ni=0;const Oi=new Un,Ui=new li,Di=new on,Fi=new cn,Bi=new cn,zi=new on;class Vi extends Se{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Ni++}),this.uuid=Ce(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(Ne(t)?Ii:Li)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return void 0!==this.attributes[t]}addGroup(t,e,n=0){this.groups.push({start:t,count:e,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const n=this.attributes.normal;if(void 0!==n){const e=(new Ie).getNormalMatrix(t);n.applyNormalMatrix(e),n.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(t){return Oi.makeRotationFromQuaternion(t),this.applyMatrix4(Oi),this}rotateX(t){return Oi.makeRotationX(t),this.applyMatrix4(Oi),this}rotateY(t){return Oi.makeRotationY(t),this.applyMatrix4(Oi),this}rotateZ(t){return Oi.makeRotationZ(t),this.applyMatrix4(Oi),this}translate(t,e,n){return Oi.makeTranslation(t,e,n),this.applyMatrix4(Oi),this}scale(t,e,n){return Oi.makeScale(t,e,n),this.applyMatrix4(Oi),this}lookAt(t){return Ui.lookAt(t),Ui.updateMatrix(),this.applyMatrix4(Ui.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Di).negate(),this.translate(Di.x,Di.y,Di.z),this}setFromPoints(t){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new ki(e,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new cn);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)this.boundingBox.set(new on(-1/0,-1/0,-1/0),new on(1/0,1/0,1/0));else{if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let t=0,n=e.length;t<n;t++){const n=e[t];Fi.setFromBufferAttribute(n),this.morphTargetsRelative?(zi.addVectors(this.boundingBox.min,Fi.min),this.boundingBox.expandByPoint(zi),zi.addVectors(this.boundingBox.max,Fi.max),this.boundingBox.expandByPoint(zi)):(this.boundingBox.expandByPoint(Fi.min),this.boundingBox.expandByPoint(Fi.max))}}else this.boundingBox.makeEmpty();isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z)}}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new An);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)this.boundingSphere.set(new on,1/0);else if(t){const n=this.boundingSphere.center;if(Fi.setFromBufferAttribute(t),e)for(let t=0,r=e.length;t<r;t++){const n=e[t];Bi.setFromBufferAttribute(n),this.morphTargetsRelative?(zi.addVectors(Fi.min,Bi.min),Fi.expandByPoint(zi),zi.addVectors(Fi.max,Bi.max),Fi.expandByPoint(zi)):(Fi.expandByPoint(Bi.min),Fi.expandByPoint(Bi.max))}Fi.getCenter(n);let i=0;for(let e=0,r=t.count;e<r;e++)zi.fromBufferAttribute(t,e),i=Math.max(i,n.distanceToSquared(zi));if(e)for(let r=0,s=e.length;r<s;r++){const s=e[r],a=this.morphTargetsRelative;for(let e=0,r=s.count;e<r;e++)zi.fromBufferAttribute(s,e),a&&(Di.fromBufferAttribute(t,e),zi.add(Di)),i=Math.max(i,n.distanceToSquared(zi))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)}}computeTangents(){const t=this.index,e=this.attributes;if(null===t||void 0===e.position||void 0===e.normal||void 0===e.uv)return;const n=t.array,i=e.position.array,r=e.normal.array,s=e.uv.array,a=i.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Wi(new Float32Array(4*a),4));const o=this.getAttribute("tangent").array,l=[],h=[];for(let C=0;C<a;C++)l[C]=new on,h[C]=new on;const c=new on,u=new on,d=new on,p=new Le,f=new Le,m=new Le,g=new on,v=new on;function _(t,e,n){c.fromArray(i,3*t),u.fromArray(i,3*e),d.fromArray(i,3*n),p.fromArray(s,2*t),f.fromArray(s,2*e),m.fromArray(s,2*n),u.sub(c),d.sub(c),f.sub(p),m.sub(p);const r=1/(f.x*m.y-m.x*f.y);isFinite(r)&&(g.copy(u).multiplyScalar(m.y).addScaledVector(d,-f.y).multiplyScalar(r),v.copy(d).multiplyScalar(f.x).addScaledVector(u,-m.x).multiplyScalar(r),l[t].add(g),l[e].add(g),l[n].add(g),h[t].add(v),h[e].add(v),h[n].add(v))}let x=this.groups;0===x.length&&(x=[{start:0,count:n.length}]);for(let C=0,T=x.length;C<T;++C){const t=x[C],e=t.start;for(let i=e,r=e+t.count;i<r;i+=3)_(n[i+0],n[i+1],n[i+2])}const y=new on,S=new on,b=new on,M=new on;function w(t){b.fromArray(r,3*t),M.copy(b);const e=l[t];y.copy(e),y.sub(b.multiplyScalar(b.dot(e))).normalize(),S.crossVectors(M,e);const n=S.dot(h[t])<0?-1:1;o[4*t]=y.x,o[4*t+1]=y.y,o[4*t+2]=y.z,o[4*t+3]=n}for(let C=0,T=x.length;C<T;++C){const t=x[C],e=t.start;for(let i=e,r=e+t.count;i<r;i+=3)w(n[i+0]),w(n[i+1]),w(n[i+2])}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let n=this.getAttribute("normal");if(void 0===n)n=new Wi(new Float32Array(3*e.count),3),this.setAttribute("normal",n);else for(let t=0,e=n.count;t<e;t++)n.setXYZ(t,0,0,0);const i=new on,r=new on,s=new on,a=new on,o=new on,l=new on,h=new on,c=new on;if(t)for(let u=0,d=t.count;u<d;u+=3){const d=t.getX(u+0),p=t.getX(u+1),f=t.getX(u+2);i.fromBufferAttribute(e,d),r.fromBufferAttribute(e,p),s.fromBufferAttribute(e,f),h.subVectors(s,r),c.subVectors(i,r),h.cross(c),a.fromBufferAttribute(n,d),o.fromBufferAttribute(n,p),l.fromBufferAttribute(n,f),a.add(h),o.add(h),l.add(h),n.setXYZ(d,a.x,a.y,a.z),n.setXYZ(p,o.x,o.y,o.z),n.setXYZ(f,l.x,l.y,l.z)}else for(let t=0,u=e.count;t<u;t+=3)i.fromBufferAttribute(e,t+0),r.fromBufferAttribute(e,t+1),s.fromBufferAttribute(e,t+2),h.subVectors(s,r),c.subVectors(i,r),h.cross(c),n.setXYZ(t+0,h.x,h.y,h.z),n.setXYZ(t+1,h.x,h.y,h.z),n.setXYZ(t+2,h.x,h.y,h.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let e=0,n=t.count;e<n;e++)zi.fromBufferAttribute(t,e),zi.normalize(),t.setXYZ(e,zi.x,zi.y,zi.z)}toNonIndexed(){function t(t,e){const n=t.array,i=t.itemSize,r=t.normalized,s=new n.constructor(e.length*i);let a=0,o=0;for(let l=0,h=e.length;l<h;l++){a=t.isInterleavedBufferAttribute?e[l]*t.data.stride+t.offset:e[l]*i;for(let t=0;t<i;t++)s[o++]=n[a++]}return new Wi(s,i,r)}if(null===this.index)return this;const e=new Vi,n=this.index.array,i=this.attributes;for(const a in i){const r=t(i[a],n);e.setAttribute(a,r)}const r=this.morphAttributes;for(const a in r){const i=[],s=r[a];for(let e=0,r=s.length;e<r;e++){const r=t(s[e],n);i.push(r)}e.morphAttributes[a]=i}e.morphTargetsRelative=this.morphTargetsRelative;const s=this.groups;for(let a=0,o=s.length;a<o;a++){const t=s[a];e.addGroup(t.start,t.count,t.materialIndex)}return e}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const n=this.attributes;for(const o in n){const e=n[o];t.data.attributes[o]=e.toJSON(t.data)}const i={};let r=!1;for(const o in this.morphAttributes){const e=this.morphAttributes[o],n=[];for(let i=0,r=e.length;i<r;i++){const r=e[i];n.push(r.toJSON(t.data))}n.length>0&&(i[o]=n,r=!0)}r&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));const a=this.boundingSphere;return null!==a&&(t.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),t}clone(){return(new this.constructor).copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const n=t.index;null!==n&&this.setIndex(n.clone(e));const i=t.attributes;for(const l in i){const t=i[l];this.setAttribute(l,t.clone(e))}const r=t.morphAttributes;for(const l in r){const t=[],n=r[l];for(let i=0,r=n.length;i<r;i++)t.push(n[i].clone(e));this.morphAttributes[l]=t}this.morphTargetsRelative=t.morphTargetsRelative;const s=t.groups;for(let l=0,h=s.length;l<h;l++){const t=s[l];this.addGroup(t.start,t.count,t.materialIndex)}const a=t.boundingBox;null!==a&&(this.boundingBox=a.clone());const o=t.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Gi=new Un,Hi=new On,qi=new An,Xi=new on,ji=new on,Ji=new on,Qi=new on,Ki=new on,Zi=new on,Yi=new Le,$i=new Le,tr=new Le,er=new on,nr=new on,ir=new on,rr=new on,sr=new on;class ar extends li{constructor(t=new Vi,e=new Ai){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){const n=t[e[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,e=n.length;t<e;t++){const e=n[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[e]=t}}}}getVertexPosition(t,e){const n=this.geometry,i=n.attributes.position,r=n.morphAttributes.position,s=n.morphTargetsRelative;e.fromBufferAttribute(i,t);const a=this.morphTargetInfluences;if(r&&a){Zi.set(0,0,0);for(let n=0,i=r.length;n<i;n++){const i=a[n],o=r[n];0!==i&&(Ki.fromBufferAttribute(o,t),s?Zi.addScaledVector(Ki,i):Zi.addScaledVector(Ki.sub(e),i))}e.add(Zi)}return e}raycast(e,n){const i=this.geometry,r=this.material,s=this.matrixWorld;if(void 0!==r){if(null===i.boundingSphere&&i.computeBoundingSphere(),qi.copy(i.boundingSphere),qi.applyMatrix4(s),Hi.copy(e.ray).recast(e.near),!1===qi.containsPoint(Hi.origin)){if(null===Hi.intersectSphere(qi,Xi))return;if(Hi.origin.distanceToSquared(Xi)>t(e.far-e.near,2))return}Gi.copy(s).invert(),Hi.copy(e.ray).applyMatrix4(Gi),null!==i.boundingBox&&!1===Hi.intersectsBox(i.boundingBox)||this._computeIntersections(e,n,Hi)}}_computeIntersections(t,e,n){let i;const r=this.geometry,s=this.material,a=r.index,o=r.attributes.position,l=r.attributes.uv,h=r.attributes.uv1,c=r.attributes.normal,u=r.groups,d=r.drawRange;if(null!==a)if(Array.isArray(s))for(let p=0,f=u.length;p<f;p++){const r=u[p],o=s[r.materialIndex];for(let s=Math.max(r.start,d.start),u=Math.min(a.count,Math.min(r.start+r.count,d.start+d.count));s<u;s+=3){i=or(this,o,t,n,l,h,c,a.getX(s),a.getX(s+1),a.getX(s+2)),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,e.push(i))}}else{for(let r=Math.max(0,d.start),o=Math.min(a.count,d.start+d.count);r<o;r+=3){i=or(this,s,t,n,l,h,c,a.getX(r),a.getX(r+1),a.getX(r+2)),i&&(i.faceIndex=Math.floor(r/3),e.push(i))}}else if(void 0!==o)if(Array.isArray(s))for(let p=0,f=u.length;p<f;p++){const r=u[p],a=s[r.materialIndex];for(let s=Math.max(r.start,d.start),u=Math.min(o.count,Math.min(r.start+r.count,d.start+d.count));s<u;s+=3){i=or(this,a,t,n,l,h,c,s,s+1,s+2),i&&(i.faceIndex=Math.floor(s/3),i.face.materialIndex=r.materialIndex,e.push(i))}}else{for(let r=Math.max(0,d.start),a=Math.min(o.count,d.start+d.count);r<a;r+=3){i=or(this,s,t,n,l,h,c,r,r+1,r+2),i&&(i.faceIndex=Math.floor(r/3),e.push(i))}}}}function or(t,e,n,i,r,s,a,o,l,h){t.getVertexPosition(o,ji),t.getVertexPosition(l,Ji),t.getVertexPosition(h,Qi);const c=function(t,e,n,i,r,s,a,o){let l;if(l=e.side===bt?i.intersectTriangle(a,s,r,!0,o):i.intersectTriangle(r,s,a,e.side===St,o),null===l)return null;sr.copy(o),sr.applyMatrix4(t.matrixWorld);const h=n.ray.origin.distanceTo(sr);return h<n.near||h>n.far?null:{distance:h,point:sr.clone(),object:t}}(t,e,n,i,ji,Ji,Qi,rr);if(c){r&&(Yi.fromBufferAttribute(r,o),$i.fromBufferAttribute(r,l),tr.fromBufferAttribute(r,h),c.uv=xi.getInterpolation(rr,ji,Ji,Qi,Yi,$i,tr,new Le)),s&&(Yi.fromBufferAttribute(s,o),$i.fromBufferAttribute(s,l),tr.fromBufferAttribute(s,h),c.uv1=xi.getInterpolation(rr,ji,Ji,Qi,Yi,$i,tr,new Le),c.uv2=c.uv1),a&&(er.fromBufferAttribute(a,o),nr.fromBufferAttribute(a,l),ir.fromBufferAttribute(a,h),c.normal=xi.getInterpolation(rr,ji,Ji,Qi,er,nr,ir,new on),c.normal.dot(i.direction)>0&&c.normal.multiplyScalar(-1));const t={a:o,b:l,c:h,normal:new on,materialIndex:0};xi.getNormal(ji,Ji,Qi,t.normal),c.face=t}return c}class lr extends Vi{constructor(t=1,e=1,n=1,i=1,r=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:s};const a=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s);const o=[],l=[],h=[],c=[];let u=0,d=0;function p(t,e,n,i,r,s,p,f,m,g,v){const _=s/m,x=p/g,y=s/2,S=p/2,b=f/2,M=m+1,w=g+1;let C=0,T=0;const E=new on;for(let a=0;a<w;a++){const s=a*x-S;for(let o=0;o<M;o++){const u=o*_-y;E[t]=u*i,E[e]=s*r,E[n]=b,l.push(E.x,E.y,E.z),E[t]=0,E[e]=0,E[n]=f>0?1:-1,h.push(E.x,E.y,E.z),c.push(o/m),c.push(1-a/g),C+=1}}for(let a=0;a<g;a++)for(let t=0;t<m;t++){const e=u+t+M*a,n=u+t+M*(a+1),i=u+(t+1)+M*(a+1),r=u+(t+1)+M*a;o.push(e,n,r),o.push(n,i,r),T+=6}a.addGroup(d,T,v),d+=T,u+=C}p("z","y","x",-1,-1,n,e,t,s,r,0),p("z","y","x",1,-1,n,e,-t,s,r,1),p("x","z","y",1,1,t,n,e,i,s,2),p("x","z","y",1,-1,t,n,-e,i,s,3),p("x","y","z",1,-1,t,e,n,i,r,4),p("x","y","z",-1,-1,t,e,-n,i,r,5),this.setIndex(o),this.setAttribute("position",new ki(l,3)),this.setAttribute("normal",new ki(h,3)),this.setAttribute("uv",new ki(c,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new lr(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function hr(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?e[n][i]=null:e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function cr(t){const e={};for(let n=0;n<t.length;n++){const i=hr(t[n]);for(const t in i)e[t]=i[t]}return e}function ur(t){return null===t.getRenderTarget()?t.outputColorSpace:He.workingColorSpace}const dr={clone:hr,merge:cr};class pr extends Ei{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==t&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=hr(t.uniforms),this.uniformsGroups=function(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(const i in this.uniforms){const n=this.uniforms[i].value;n&&n.isTexture?e.uniforms[i]={type:"t",value:n.toJSON(t).uuid}:n&&n.isColor?e.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?e.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?e.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?e.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?e.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?e.uniforms[i]={type:"m4",value:n.toArray()}:e.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.lights=this.lights,e.clipping=this.clipping;const n={};for(const i in this.extensions)!0===this.extensions[i]&&(n[i]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}}class fr extends li{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Un,this.projectionMatrix=new Un,this.projectionMatrixInverse=new Un,this.coordinateSystem=xe}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this.coordinateSystem=t.coordinateSystem,this}getWorldDirection(t){return super.getWorldDirection(t).negate()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}const mr=new on,gr=new Le,vr=new Le;class _r extends fr{constructor(t=50,e=1,n=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const e=.5*this.getFilmHeight()/t;this.fov=2*we*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(.5*Me*this.fov);return.5*this.getFilmHeight()/t}getEffectiveFOV(){return 2*we*Math.atan(Math.tan(.5*Me*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(t,e,n){mr.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),e.set(mr.x,mr.y).multiplyScalar(-t/mr.z),mr.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(mr.x,mr.y).multiplyScalar(-t/mr.z)}getViewSize(t,e){return this.getViewBounds(t,gr,vr),e.subVectors(vr,gr)}setViewOffset(t,e,n,i,r,s){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let e=t*Math.tan(.5*Me*this.fov)/this.zoom,n=2*e,i=this.aspect*n,r=-.5*i;const s=this.view;if(null!==this.view&&this.view.enabled){const t=s.fullWidth,a=s.fullHeight;r+=s.offsetX*i/t,e-=s.offsetY*n/a,i*=s.width/t,n*=s.height/a}const a=this.filmOffset;0!==a&&(r+=t*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,e,e-n,t,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}const xr=-90;class yr extends li{constructor(t,e,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new _r(xr,1,t,e);i.layers=this.layers,this.add(i);const r=new _r(xr,1,t,e);r.layers=this.layers,this.add(r);const s=new _r(xr,1,t,e);s.layers=this.layers,this.add(s);const a=new _r(xr,1,t,e);a.layers=this.layers,this.add(a);const o=new _r(xr,1,t,e);o.layers=this.layers,this.add(o);const l=new _r(xr,1,t,e);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const t=this.coordinateSystem,e=this.children.concat(),[n,i,r,s,a,o]=e;for(const l of e)this.remove(l);if(t===xe)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),r.up.set(0,0,-1),r.lookAt(0,1,0),s.up.set(0,0,1),s.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),o.up.set(0,1,0),o.lookAt(0,0,-1);else{if(t!==ye)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t);n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),r.up.set(0,0,1),r.lookAt(0,1,0),s.up.set(0,0,-1),s.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),o.up.set(0,-1,0),o.lookAt(0,0,-1)}for(const l of e)this.add(l),l.updateMatrixWorld()}update(t,e){null===this.parent&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:i}=this;this.coordinateSystem!==t.coordinateSystem&&(this.coordinateSystem=t.coordinateSystem,this.updateCoordinateSystem());const[r,s,a,o,l,h]=this.children,c=t.getRenderTarget(),u=t.getActiveCubeFace(),d=t.getActiveMipmapLevel(),p=t.xr.enabled;t.xr.enabled=!1;const f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0,i),t.render(e,r),t.setRenderTarget(n,1,i),t.render(e,s),t.setRenderTarget(n,2,i),t.render(e,a),t.setRenderTarget(n,3,i),t.render(e,o),t.setRenderTarget(n,4,i),t.render(e,l),n.texture.generateMipmaps=f,t.setRenderTarget(n,5,i),t.render(e,h),t.setRenderTarget(c,u,d),t.xr.enabled=p,n.texture.needsPMREMUpdate=!0}}class Sr extends $e{constructor(t,e,n,i,r,s,a,o,l,h){super(t=void 0!==t?t:[],e=void 0!==e?e:kt,n,i,r,s,a,o,l,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class br extends nn{constructor(t=1,e={}){super(t,t,e),this.isWebGLCubeRenderTarget=!0;const n={width:t,height:t,depth:1},i=[n,n,n,n,n,n];void 0!==e.encoding&&(Fe("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),e.colorSpace=e.encoding===ae?le:oe),this.texture=new Sr(i,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==e.generateMipmaps&&e.generateMipmaps,this.texture.minFilter=void 0!==e.minFilter?e.minFilter:Vt}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.colorSpace=e.colorSpace,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"},i=new lr(5,5,5),r=new pr({name:"CubemapFromEquirect",uniforms:hr(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:bt,blending:0});r.uniforms.tEquirect.value=e;const s=new ar(i,r),a=e.minFilter;e.minFilter===Ht&&(e.minFilter=Vt);return new yr(1,10,this).update(t,s),e.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(t,e,n,i){const r=t.getRenderTarget();for(let s=0;s<6;s++)t.setRenderTarget(this,s),t.clear(e,n,i);t.setRenderTarget(r)}}const Mr=new on,wr=new on,Cr=new Ie;class Tr{constructor(t=new on(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){const i=Mr.subVectors(n,e).cross(wr.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,e){const n=t.delta(Mr),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(t.start)?e.copy(t.start):null;const r=-(t.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:e.copy(t.start).addScaledVector(n,r)}intersectsLine(t){const e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){const n=e||Cr.getNormalMatrix(t),i=this.coplanarPoint(Mr).applyMatrix4(t),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const Er=new An,Ar=new on;class Pr{constructor(t=new Tr,e=new Tr,n=new Tr,i=new Tr,r=new Tr,s=new Tr){this.planes=[t,e,n,i,r,s]}set(t,e,n,i,r,s){const a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(i),a[4].copy(r),a[5].copy(s),this}copy(t){const e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t,e=2e3){const n=this.planes,i=t.elements,r=i[0],s=i[1],a=i[2],o=i[3],l=i[4],h=i[5],c=i[6],u=i[7],d=i[8],p=i[9],f=i[10],m=i[11],g=i[12],v=i[13],_=i[14],x=i[15];if(n[0].setComponents(o-r,u-l,m-d,x-g).normalize(),n[1].setComponents(o+r,u+l,m+d,x+g).normalize(),n[2].setComponents(o+s,u+h,m+p,x+v).normalize(),n[3].setComponents(o-s,u-h,m-p,x-v).normalize(),n[4].setComponents(o-a,u-c,m-f,x-_).normalize(),e===xe)n[5].setComponents(o+a,u+c,m+f,x+_).normalize();else{if(e!==ye)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+e);n[5].setComponents(a,c,f,_).normalize()}return this}intersectsObject(t){if(void 0!==t.boundingSphere)null===t.boundingSphere&&t.computeBoundingSphere(),Er.copy(t.boundingSphere).applyMatrix4(t.matrixWorld);else{const e=t.geometry;null===e.boundingSphere&&e.computeBoundingSphere(),Er.copy(e.boundingSphere).applyMatrix4(t.matrixWorld)}return this.intersectsSphere(Er)}intersectsSprite(t){return Er.center.set(0,0,0),Er.radius=.7071067811865476,Er.applyMatrix4(t.matrixWorld),this.intersectsSphere(Er)}intersectsSphere(t){const e=this.planes,n=t.center,i=-t.radius;for(let r=0;r<6;r++){if(e[r].distanceToPoint(n)<i)return!1}return!0}intersectsBox(t){const e=this.planes;for(let n=0;n<6;n++){const i=e[n];if(Ar.x=i.normal.x>0?t.max.x:t.min.x,Ar.y=i.normal.y>0?t.max.y:t.min.y,Ar.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(Ar)<0)return!1}return!0}containsPoint(t){const e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Rr(){let t=null,e=!1,n=null,i=null;function r(e,s){n(e,s),i=t.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==n&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(t){n=t},setContext:function(e){t=e}}}function Wr(t,e){const n=e.isWebGL2,i=new WeakMap;return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),i.get(t)},remove:function(e){e.isInterleavedBufferAttribute&&(e=e.data);const n=i.get(e);n&&(t.deleteBuffer(n.buffer),i.delete(e))},update:function(e,r){if(e.isGLBufferAttribute){const t=i.get(e);return void((!t||t.version<e.version)&&i.set(e,{buffer:e.buffer,type:e.type,bytesPerElement:e.elementSize,version:e.version}))}e.isInterleavedBufferAttribute&&(e=e.data);const s=i.get(e);if(void 0===s)i.set(e,function(e,i){const r=e.array,s=e.usage,a=r.byteLength,o=t.createBuffer();let l;if(t.bindBuffer(i,o),t.bufferData(i,r,s),e.onUploadCallback(),r instanceof Float32Array)l=t.FLOAT;else if(r instanceof Uint16Array)if(e.isFloat16BufferAttribute){if(!n)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");l=t.HALF_FLOAT}else l=t.UNSIGNED_SHORT;else if(r instanceof Int16Array)l=t.SHORT;else if(r instanceof Uint32Array)l=t.UNSIGNED_INT;else if(r instanceof Int32Array)l=t.INT;else if(r instanceof Int8Array)l=t.BYTE;else if(r instanceof Uint8Array)l=t.UNSIGNED_BYTE;else{if(!(r instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+r);l=t.UNSIGNED_BYTE}return{buffer:o,type:l,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version,size:a}}(e,r));else if(s.version<e.version){if(s.size!==e.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");!function(e,i,r){const s=i.array,a=i._updateRange,o=i.updateRanges;if(t.bindBuffer(r,e),-1===a.count&&0===o.length&&t.bufferSubData(r,0,s),0!==o.length){for(let e=0,i=o.length;e<i;e++){const i=o[e];n?t.bufferSubData(r,i.start*s.BYTES_PER_ELEMENT,s,i.start,i.count):t.bufferSubData(r,i.start*s.BYTES_PER_ELEMENT,s.subarray(i.start,i.start+i.count))}i.clearUpdateRanges()}-1!==a.count&&(n?t.bufferSubData(r,a.offset*s.BYTES_PER_ELEMENT,s,a.offset,a.count):t.bufferSubData(r,a.offset*s.BYTES_PER_ELEMENT,s.subarray(a.offset,a.offset+a.count)),a.count=-1),i.onUploadCallback()}(s.buffer,e,r),s.version=e.version}}}}class Lr extends Vi{constructor(t=1,e=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};const r=t/2,s=e/2,a=Math.floor(n),o=Math.floor(i),l=a+1,h=o+1,c=t/a,u=e/o,d=[],p=[],f=[],m=[];for(let g=0;g<h;g++){const t=g*u-s;for(let e=0;e<l;e++){const n=e*c-r;p.push(n,-t,0),f.push(0,0,1),m.push(e/a),m.push(1-g/o)}}for(let g=0;g<o;g++)for(let t=0;t<a;t++){const e=t+l*g,n=t+l*(g+1),i=t+1+l*(g+1),r=t+1+l*g;d.push(e,n,r),d.push(n,i,r)}this.setIndex(d),this.setAttribute("position",new ki(p,3)),this.setAttribute("normal",new ki(f,3)),this.setAttribute("uv",new ki(m,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Lr(t.width,t.height,t.widthSegments,t.heightSegments)}}const Ir={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\t#ifdef ALPHA_TO_COVERAGE\n\tdiffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );\n\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\tif ( diffuseColor.a < alphaTest ) discard;\n\t#endif\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_CLEARCOAT ) \n\t\tclearcoatSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_SHEEN ) \n\t\tsheenSpecularIndirect *= ambientOcclusion;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometryNormal, geometryViewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",batching_pars_vertex:"#ifdef USE_BATCHING\n\tattribute float batchId;\n\tuniform highp sampler2D batchingTexture;\n\tmat4 getBatchingMatrix( const in float i ) {\n\t\tint size = textureSize( batchingTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",batching_vertex:"#ifdef USE_BATCHING\n\tmat4 batchingMatrix = getBatchingMatrix( batchId );\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );\n\t\tvec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#ifdef ALPHA_TO_COVERAGE\n\t\tfloat distanceToPlane, distanceGradient;\n\t\tfloat clipOpacity = 1.0;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\tclipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\tif ( clipOpacity == 0.0 ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tfloat unionClipOpacity = 1.0;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tdistanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;\n\t\t\t\tdistanceGradient = fwidth( distanceToPlane ) / 2.0;\n\t\t\t\tunionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tclipOpacity *= 1.0 - unionClipOpacity;\n\t\t#endif\n\t\tdiffuseColor.a *= clipOpacity;\n\t\tif ( diffuseColor.a == 0.0 ) discard;\n\t#else\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\t\tbool clipped = true;\n\t\t\t#pragma unroll_loop_start\n\t\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\t\tplane = clippingPlanes[ i ];\n\t\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t\t}\n\t\t\t#pragma unroll_loop_end\n\t\t\tif ( clipped ) discard;\n\t\t#endif\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = objectTangent;\n#endif\n#ifdef USE_BATCHING\n\tmat3 bm = mat3( batchingMatrix );\n\ttransformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );\n\ttransformedNormal = bm * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = bm * transformedTangent;\n\t#endif\n#endif\n#ifdef USE_INSTANCING\n\tmat3 im = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );\n\ttransformedNormal = im * transformedNormal;\n\t#ifdef USE_TANGENT\n\t\ttransformedTangent = im * transformedTangent;\n\t#endif\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\ttransformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"\nconst mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(\n\tvec3( 0.8224621, 0.177538, 0.0 ),\n\tvec3( 0.0331941, 0.9668058, 0.0 ),\n\tvec3( 0.0170827, 0.0723974, 0.9105199 )\n);\nconst mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.2249401, - 0.2249404, 0.0 ),\n\tvec3( - 0.0420569, 1.0420571, 0.0 ),\n\tvec3( - 0.0196376, - 0.0786361, 1.0982735 )\n);\nvec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );\n}\nvec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {\n\treturn vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );\n}\nvec4 LinearTransferOETF( in vec4 value ) {\n\treturn value;\n}\nvec4 sRGBTransferOETF( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn sRGBTransferOETF( value );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\n#if defined( USE_LIGHT_PROBES )\n\tuniform vec3 lightProbe[ 9 ];\n#endif\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometryPosition;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tif( material.anisotropy == 0.0 ) {\n\t\tanisotropyV = vec2( 1.0, 0.0 );\n\t} else {\n\t\tanisotropyV /= material.anisotropy;\n\t\tmaterial.anisotropy = saturate( material.anisotropy );\n\t}\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecularDirect = vec3( 0.0 );\nvec3 clearcoatSpecularIndirect = vec3( 0.0 );\nvec3 sheenSpecularDirect = vec3( 0.0 );\nvec3 sheenSpecularIndirect = vec3(0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometryNormal;\n\t\tvec3 viewDir = geometryViewDir;\n\t\tvec3 position = geometryPosition;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometryNormal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nvec3 geometryPosition = - vViewPosition;\nvec3 geometryNormal = normal;\nvec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\nvec3 geometryClearcoatNormal = vec3( 0.0 );\n#ifdef USE_CLEARCOAT\n\tgeometryClearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometryViewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometryPosition, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometryPosition, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if defined( USE_LIGHT_PROBES )\n\t\tirradiance += getLightProbeIrradiance( lightProbe, geometryNormal );\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometryNormal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vMapUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 nonPerturbedNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = nonPerturbedNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_BATCHING\n\tmvPosition = batchingMatrix * mvPosition;\n#endif\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tint size = textureSize( boneTexture, 0 ).x;\n\t\tint j = int( i ) * 4;\n\t\tint x = j % size;\n\t\tint y = j / size;\n\t\tvec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );\n\t\tvec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );\n\t\tvec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );\n\t\tvec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );\n\t\treturn mat4( v1, v2, v3, v4 );\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nconst mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(\n\tvec3( 1.6605, - 0.1246, - 0.0182 ),\n\tvec3( - 0.5876, 1.1329, - 0.1006 ),\n\tvec3( - 0.0728, - 0.0083, 1.1187 )\n);\nconst mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(\n\tvec3( 0.6274, 0.0691, 0.0164 ),\n\tvec3( 0.3293, 0.9195, 0.0880 ),\n\tvec3( 0.0433, 0.0113, 0.8956 )\n);\nvec3 agxDefaultContrastApprox( vec3 x ) {\n\tvec3 x2 = x * x;\n\tvec3 x4 = x2 * x2;\n\treturn + 15.5 * x4 * x2\n\t\t- 40.14 * x4 * x\n\t\t+ 31.96 * x4\n\t\t- 6.868 * x2 * x\n\t\t+ 0.4298 * x2\n\t\t+ 0.1191 * x\n\t\t- 0.00232;\n}\nvec3 AgXToneMapping( vec3 color ) {\n\tconst mat3 AgXInsetMatrix = mat3(\n\t\tvec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),\n\t\tvec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),\n\t\tvec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )\n\t);\n\tconst mat3 AgXOutsetMatrix = mat3(\n\t\tvec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),\n\t\tvec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),\n\t\tvec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )\n\t);\n\tconst float AgxMinEv = - 12.47393;\tconst float AgxMaxEv = 4.026069;\n\tcolor *= toneMappingExposure;\n\tcolor = LINEAR_SRGB_TO_LINEAR_REC2020 * color;\n\tcolor = AgXInsetMatrix * color;\n\tcolor = max( color, 1e-10 );\tcolor = log2( color );\n\tcolor = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );\n\tcolor = clamp( color, 0.0, 1.0 );\n\tcolor = agxDefaultContrastApprox( color );\n\tcolor = AgXOutsetMatrix * color;\n\tcolor = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );\n\tcolor = LINEAR_REC2020_TO_LINEAR_SRGB * color;\n\tcolor = clamp( color, 0.0, 1.0 );\n\treturn color;\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_BATCHING\n\t\tworldPosition = batchingMatrix * worldPosition;\n\t#endif\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\ttexColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <clipping_planes_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <batching_pars_vertex>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <batching_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <batching_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},kr={common:{diffuse:{value:new wi(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ie},alphaMap:{value:null},alphaMapTransform:{value:new Ie},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ie}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ie}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ie}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ie},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ie},normalScale:{value:new Le(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ie},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ie}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ie}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ie}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new wi(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new wi(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ie},alphaTest:{value:0},uvTransform:{value:new Ie}},sprite:{diffuse:{value:new wi(16777215)},opacity:{value:1},center:{value:new Le(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ie},alphaMap:{value:null},alphaMapTransform:{value:new Ie},alphaTest:{value:0}}},Nr={basic:{uniforms:cr([kr.common,kr.specularmap,kr.envmap,kr.aomap,kr.lightmap,kr.fog]),vertexShader:Ir.meshbasic_vert,fragmentShader:Ir.meshbasic_frag},lambert:{uniforms:cr([kr.common,kr.specularmap,kr.envmap,kr.aomap,kr.lightmap,kr.emissivemap,kr.bumpmap,kr.normalmap,kr.displacementmap,kr.fog,kr.lights,{emissive:{value:new wi(0)}}]),vertexShader:Ir.meshlambert_vert,fragmentShader:Ir.meshlambert_frag},phong:{uniforms:cr([kr.common,kr.specularmap,kr.envmap,kr.aomap,kr.lightmap,kr.emissivemap,kr.bumpmap,kr.normalmap,kr.displacementmap,kr.fog,kr.lights,{emissive:{value:new wi(0)},specular:{value:new wi(1118481)},shininess:{value:30}}]),vertexShader:Ir.meshphong_vert,fragmentShader:Ir.meshphong_frag},standard:{uniforms:cr([kr.common,kr.envmap,kr.aomap,kr.lightmap,kr.emissivemap,kr.bumpmap,kr.normalmap,kr.displacementmap,kr.roughnessmap,kr.metalnessmap,kr.fog,kr.lights,{emissive:{value:new wi(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ir.meshphysical_vert,fragmentShader:Ir.meshphysical_frag},toon:{uniforms:cr([kr.common,kr.aomap,kr.lightmap,kr.emissivemap,kr.bumpmap,kr.normalmap,kr.displacementmap,kr.gradientmap,kr.fog,kr.lights,{emissive:{value:new wi(0)}}]),vertexShader:Ir.meshtoon_vert,fragmentShader:Ir.meshtoon_frag},matcap:{uniforms:cr([kr.common,kr.bumpmap,kr.normalmap,kr.displacementmap,kr.fog,{matcap:{value:null}}]),vertexShader:Ir.meshmatcap_vert,fragmentShader:Ir.meshmatcap_frag},points:{uniforms:cr([kr.points,kr.fog]),vertexShader:Ir.points_vert,fragmentShader:Ir.points_frag},dashed:{uniforms:cr([kr.common,kr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ir.linedashed_vert,fragmentShader:Ir.linedashed_frag},depth:{uniforms:cr([kr.common,kr.displacementmap]),vertexShader:Ir.depth_vert,fragmentShader:Ir.depth_frag},normal:{uniforms:cr([kr.common,kr.bumpmap,kr.normalmap,kr.displacementmap,{opacity:{value:1}}]),vertexShader:Ir.meshnormal_vert,fragmentShader:Ir.meshnormal_frag},sprite:{uniforms:cr([kr.sprite,kr.fog]),vertexShader:Ir.sprite_vert,fragmentShader:Ir.sprite_frag},background:{uniforms:{uvTransform:{value:new Ie},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Ir.background_vert,fragmentShader:Ir.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Ir.backgroundCube_vert,fragmentShader:Ir.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Ir.cube_vert,fragmentShader:Ir.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ir.equirect_vert,fragmentShader:Ir.equirect_frag},distanceRGBA:{uniforms:cr([kr.common,kr.displacementmap,{referencePosition:{value:new on},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ir.distanceRGBA_vert,fragmentShader:Ir.distanceRGBA_frag},shadow:{uniforms:cr([kr.lights,kr.fog,{color:{value:new wi(0)},opacity:{value:1}}]),vertexShader:Ir.shadow_vert,fragmentShader:Ir.shadow_frag}};Nr.physical={uniforms:cr([Nr.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ie},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ie},clearcoatNormalScale:{value:new Le(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ie},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ie},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ie},sheen:{value:0},sheenColor:{value:new wi(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ie},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ie},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ie},transmissionSamplerSize:{value:new Le},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ie},attenuationDistance:{value:0},attenuationColor:{value:new wi(0)},specularColor:{value:new wi(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ie},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ie},anisotropyVector:{value:new Le},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ie}}]),vertexShader:Ir.meshphysical_vert,fragmentShader:Ir.meshphysical_frag};const Or={r:0,b:0,g:0};function Ur(t,e,n,i,r,s,a){const o=new wi(0);let l,h,c=!0===s?0:1,u=null,d=0,p=null;function f(e,n){e.getRGB(Or,ur(t)),i.buffers.color.setClear(Or.r,Or.g,Or.b,n,a)}return{getClearColor:function(){return o},setClearColor:function(t,e=1){o.set(t),c=e,f(o,c)},getClearAlpha:function(){return c},setClearAlpha:function(t){c=t,f(o,c)},render:function(s,m){let g=!1,v=!0===m.isScene?m.background:null;if(v&&v.isTexture){v=(m.backgroundBlurriness>0?n:e).get(v)}null===v?f(o,c):v&&v.isColor&&(f(v,1),g=!0);const _=t.xr.getEnvironmentBlendMode();"additive"===_?i.buffers.color.setClear(0,0,0,1,a):"alpha-blend"===_&&i.buffers.color.setClear(0,0,0,0,a),(t.autoClear||g)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),v&&(v.isCubeTexture||v.mapping===Ot)?(void 0===h&&(h=new ar(new lr(1,1,1),new pr({name:"BackgroundCubeMaterial",uniforms:hr(Nr.backgroundCube.uniforms),vertexShader:Nr.backgroundCube.vertexShader,fragmentShader:Nr.backgroundCube.fragmentShader,side:bt,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(h)),h.material.uniforms.envMap.value=v,h.material.uniforms.flipEnvMap.value=v.isCubeTexture&&!1===v.isRenderTargetTexture?-1:1,h.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,h.material.toneMapped=He.getTransfer(v.colorSpace)!==pe,u===v&&d===v.version&&p===t.toneMapping||(h.material.needsUpdate=!0,u=v,d=v.version,p=t.toneMapping),h.layers.enableAll(),s.unshift(h,h.geometry,h.material,0,0,null)):v&&v.isTexture&&(void 0===l&&(l=new ar(new Lr(2,2),new pr({name:"BackgroundMaterial",uniforms:hr(Nr.background.uniforms),vertexShader:Nr.background.vertexShader,fragmentShader:Nr.background.fragmentShader,side:St,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=v,l.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,l.material.toneMapped=He.getTransfer(v.colorSpace)!==pe,!0===v.matrixAutoUpdate&&v.updateMatrix(),l.material.uniforms.uvTransform.value.copy(v.matrix),u===v&&d===v.version&&p===t.toneMapping||(l.material.needsUpdate=!0,u=v,d=v.version,p=t.toneMapping),l.layers.enableAll(),s.unshift(l,l.geometry,l.material,0,0,null))}}}function Dr(t,e,n,i){const r=t.getParameter(t.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),a=i.isWebGL2||null!==s,o={},l=p(null);let h=l,c=!1;function u(e){return i.isWebGL2?t.bindVertexArray(e):s.bindVertexArrayOES(e)}function d(e){return i.isWebGL2?t.deleteVertexArray(e):s.deleteVertexArrayOES(e)}function p(t){const e=[],n=[],i=[];for(let s=0;s<r;s++)e[s]=0,n[s]=0,i[s]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:e,enabledAttributes:n,attributeDivisors:i,object:t,attributes:{},index:null}}function f(){const t=h.newAttributes;for(let e=0,n=t.length;e<n;e++)t[e]=0}function m(t){g(t,0)}function g(n,r){const s=h.newAttributes,a=h.enabledAttributes,o=h.attributeDivisors;if(s[n]=1,0===a[n]&&(t.enableVertexAttribArray(n),a[n]=1),o[n]!==r){(i.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,r),o[n]=r}}function v(){const e=h.newAttributes,n=h.enabledAttributes;for(let i=0,r=n.length;i<r;i++)n[i]!==e[i]&&(t.disableVertexAttribArray(i),n[i]=0)}function _(e,n,i,r,s,a,o){!0===o?t.vertexAttribIPointer(e,n,i,s,a):t.vertexAttribPointer(e,n,i,r,s,a)}function x(){y(),c=!0,h!==l&&(h=l,u(h.object))}function y(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(r,l,d,x,y){let S=!1;if(a){const e=function(e,n,r){const a=!0===r.wireframe;let l=o[e.id];void 0===l&&(l={},o[e.id]=l);let h=l[n.id];void 0===h&&(h={},l[n.id]=h);let c=h[a];void 0===c&&(c=p(i.isWebGL2?t.createVertexArray():s.createVertexArrayOES()),h[a]=c);return c}(x,d,l);h!==e&&(h=e,u(h.object)),S=function(t,e,n,i){const r=h.attributes,s=e.attributes;let a=0;const o=n.getAttributes();for(const l in o){if(o[l].location>=0){const e=r[l];let n=s[l];if(void 0===n&&("instanceMatrix"===l&&t.instanceMatrix&&(n=t.instanceMatrix),"instanceColor"===l&&t.instanceColor&&(n=t.instanceColor)),void 0===e)return!0;if(e.attribute!==n)return!0;if(n&&e.data!==n.data)return!0;a++}}return h.attributesNum!==a||h.index!==i}(r,x,d,y),S&&function(t,e,n,i){const r={},s=e.attributes;let a=0;const o=n.getAttributes();for(const l in o){if(o[l].location>=0){let e=s[l];void 0===e&&("instanceMatrix"===l&&t.instanceMatrix&&(e=t.instanceMatrix),"instanceColor"===l&&t.instanceColor&&(e=t.instanceColor));const n={};n.attribute=e,e&&e.data&&(n.data=e.data),r[l]=n,a++}}h.attributes=r,h.attributesNum=a,h.index=i}(r,x,d,y)}else{const t=!0===l.wireframe;h.geometry===x.id&&h.program===d.id&&h.wireframe===t||(h.geometry=x.id,h.program=d.id,h.wireframe=t,S=!0)}null!==y&&n.update(y,t.ELEMENT_ARRAY_BUFFER),(S||c)&&(c=!1,function(r,s,a,o){if(!1===i.isWebGL2&&(r.isInstancedMesh||o.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;f();const l=o.attributes,h=a.getAttributes(),c=s.defaultAttributeValues;for(const e in h){const s=h[e];if(s.location>=0){let a=l[e];if(void 0===a&&("instanceMatrix"===e&&r.instanceMatrix&&(a=r.instanceMatrix),"instanceColor"===e&&r.instanceColor&&(a=r.instanceColor)),void 0!==a){const e=a.normalized,l=a.itemSize,h=n.get(a);if(void 0===h)continue;const c=h.buffer,u=h.type,d=h.bytesPerElement,p=!0===i.isWebGL2&&(u===t.INT||u===t.UNSIGNED_INT||a.gpuType===jt);if(a.isInterleavedBufferAttribute){const n=a.data,i=n.stride,h=a.offset;if(n.isInstancedInterleavedBuffer){for(let t=0;t<s.locationSize;t++)g(s.location+t,n.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=n.meshPerAttribute*n.count)}else for(let t=0;t<s.locationSize;t++)m(s.location+t);t.bindBuffer(t.ARRAY_BUFFER,c);for(let t=0;t<s.locationSize;t++)_(s.location+t,l/s.locationSize,u,e,i*d,(h+l/s.locationSize*t)*d,p)}else{if(a.isInstancedBufferAttribute){for(let t=0;t<s.locationSize;t++)g(s.location+t,a.meshPerAttribute);!0!==r.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=a.meshPerAttribute*a.count)}else for(let t=0;t<s.locationSize;t++)m(s.location+t);t.bindBuffer(t.ARRAY_BUFFER,c);for(let t=0;t<s.locationSize;t++)_(s.location+t,l/s.locationSize,u,e,l*d,l/s.locationSize*t*d,p)}}else if(void 0!==c){const n=c[e];if(void 0!==n)switch(n.length){case 2:t.vertexAttrib2fv(s.location,n);break;case 3:t.vertexAttrib3fv(s.location,n);break;case 4:t.vertexAttrib4fv(s.location,n);break;default:t.vertexAttrib1fv(s.location,n)}}}}v()}(r,l,d,x),null!==y&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.get(y).buffer))},reset:x,resetDefaultState:y,dispose:function(){x();for(const t in o){const e=o[t];for(const t in e){const n=e[t];for(const t in n)d(n[t].object),delete n[t];delete e[t]}delete o[t]}},releaseStatesOfGeometry:function(t){if(void 0===o[t.id])return;const e=o[t.id];for(const n in e){const t=e[n];for(const e in t)d(t[e].object),delete t[e];delete e[n]}delete o[t.id]},releaseStatesOfProgram:function(t){for(const e in o){const n=o[e];if(void 0===n[t.id])continue;const i=n[t.id];for(const t in i)d(i[t].object),delete i[t];delete n[t.id]}},initAttributes:f,enableAttribute:m,disableUnusedAttributes:v}}function Fr(t,e,n,i){const r=i.isWebGL2;let s;this.setMode=function(t){s=t},this.render=function(e,i){t.drawArrays(s,e,i),n.update(i,s,1)},this.renderInstances=function(i,a,o){if(0===o)return;let l,h;if(r)l=t,h="drawArraysInstanced";else if(l=e.get("ANGLE_instanced_arrays"),h="drawArraysInstancedANGLE",null===l)return;l[h](s,i,a,o),n.update(a,s,o)},this.renderMultiDraw=function(t,i,r){if(0===r)return;const a=e.get("WEBGL_multi_draw");if(null===a)for(let e=0;e<r;e++)this.render(t[e],i[e]);else{a.multiDrawArraysWEBGL(s,t,0,i,0,r);let e=0;for(let t=0;t<r;t++)e+=i[t];n.update(e,s,1)}}}function Br(t,e,n){let i;function r(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const s="undefined"!=typeof WebGL2RenderingContext&&"WebGL2RenderingContext"===t.constructor.name;let a=void 0!==n.precision?n.precision:"highp";const o=r(a);o!==a&&(a=o);const l=s||e.has("WEBGL_draw_buffers"),h=!0===n.logarithmicDepthBuffer,c=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),u=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),d=t.getParameter(t.MAX_TEXTURE_SIZE),p=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),f=t.getParameter(t.MAX_VERTEX_ATTRIBS),m=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),g=t.getParameter(t.MAX_VARYING_VECTORS),v=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),_=u>0,x=s||e.has("OES_texture_float");return{isWebGL2:s,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const n=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:r,precision:a,logarithmicDepthBuffer:h,maxTextures:c,maxVertexTextures:u,maxTextureSize:d,maxCubemapSize:p,maxAttributes:f,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:_,floatFragmentTextures:x,floatVertexTextures:_&&x,maxSamples:s?t.getParameter(t.MAX_SAMPLES):0}}function zr(t){const e=this;let n=null,i=0,r=!1,s=!1;const a=new Tr,o=new Ie,l={value:null,needsUpdate:!1};function h(t,n,i,r){const s=null!==t?t.length:0;let h=null;if(0!==s){if(h=l.value,!0!==r||null===h){const e=i+4*s,r=n.matrixWorldInverse;o.getNormalMatrix(r),(null===h||h.length<e)&&(h=new Float32Array(e));for(let n=0,l=i;n!==s;++n,l+=4)a.copy(t[n]).applyMatrix4(r,o),a.normal.toArray(h,l),h[l+3]=a.constant}l.value=h,l.needsUpdate=!0}return e.numPlanes=s,e.numIntersection=0,h}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(t,e){const n=0!==t.length||e||0!==i||r;return r=e,i=t.length,n},this.beginShadows=function(){s=!0,h(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(t,e){n=h(t,e,0)},this.setState=function(a,o,c){const u=a.clippingPlanes,d=a.clipIntersection,p=a.clipShadows,f=t.get(a);if(!r||null===u||0===u.length||s&&!p)s?h(null):function(){l.value!==n&&(l.value=n,l.needsUpdate=i>0);e.numPlanes=i,e.numIntersection=0}();else{const t=s?0:i,e=4*t;let r=f.clippingState||null;l.value=r,r=h(u,o,e,c);for(let i=0;i!==e;++i)r[i]=n[i];f.clippingState=r,this.numIntersection=d?this.numPlanes:0,this.numPlanes+=t}}}function Vr(t){let e=new WeakMap;function n(t,e){return 303===e?t.mapping=kt:304===e&&(t.mapping=Nt),t}function i(t){const n=t.target;n.removeEventListener("dispose",i);const r=e.get(n);void 0!==r&&(e.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping;if(303===s||304===s){if(e.has(r)){return n(e.get(r).texture,r.mapping)}{const s=r.image;if(s&&s.height>0){const a=new br(s.height);return a.fromEquirectangularTexture(t,r),e.set(r,a),r.addEventListener("dispose",i),n(a.texture,r.mapping)}return null}}}return r},dispose:function(){e=new WeakMap}}}class Gr extends fr{constructor(t=-1,e=1,n=1,i=-1,r=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this}setViewOffset(t,e,n,i,r,s){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let r=n-t,s=n+t,a=i+e,o=i-e;if(null!==this.view&&this.view.enabled){const t=(this.right-this.left)/this.view.fullWidth/this.zoom,e=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=t*this.view.offsetX,s=r+t*this.view.width,a-=e*this.view.offsetY,o=a-e*this.view.height}this.projectionMatrix.makeOrthographic(r,s,a,o,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}const Hr=[.125,.215,.35,.446,.526,.582],qr=20,Xr=new Gr,jr=new wi;let Jr=null,Qr=0,Kr=0;const Zr=(1+Math.sqrt(5))/2,Yr=1/Zr,$r=[new on(1,1,1),new on(-1,1,1),new on(1,1,-1),new on(-1,1,-1),new on(0,Zr,Yr),new on(0,Zr,-Yr),new on(Yr,0,Zr),new on(-Yr,0,Zr),new on(Zr,Yr,0),new on(-Zr,Yr,0)];class ts{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,n=.1,i=100){Jr=this._renderer.getRenderTarget(),Qr=this._renderer.getActiveCubeFace(),Kr=this._renderer.getActiveMipmapLevel(),this._setSize(256);const r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(t,n,i,r),e>0&&this._blur(r,0,0,e),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=rs(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=is(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(Jr,Qr,Kr),t.scissorTest=!1,ns(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===kt||t.mapping===Nt?this._setSize(0===t.image.length?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),Jr=this._renderer.getRenderTarget(),Qr=this._renderer.getActiveCubeFace(),Kr=this._renderer.getActiveMipmapLevel();const n=e||this._allocateTargets();return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,n={magFilter:Vt,minFilter:Vt,generateMipmaps:!1,type:Kt,format:Yt,colorSpace:he,depthBuffer:!1},i=es(t,e,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=es(t,e,n);const{_lodMax:i}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(t){const e=[],n=[],i=[];let r=t;const s=t-4+1+Hr.length;for(let a=0;a<s;a++){const s=Math.pow(2,r);n.push(s);let o=1/s;a>t-4?o=Hr[a-t+4-1]:0===a&&(o=0),i.push(o);const l=1/(s-2),h=-l,c=1+l,u=[h,h,c,h,c,c,h,h,c,c,h,c],d=6,p=6,f=3,m=2,g=1,v=new Float32Array(f*p*d),_=new Float32Array(m*p*d),x=new Float32Array(g*p*d);for(let t=0;t<d;t++){const e=t%3*2/3-1,n=t>2?0:-1,i=[e,n,0,e+2/3,n,0,e+2/3,n+1,0,e,n,0,e+2/3,n+1,0,e,n+1,0];v.set(i,f*p*t),_.set(u,m*p*t);const r=[t,t,t,t,t,t];x.set(r,g*p*t)}const y=new Vi;y.setAttribute("position",new Wi(v,f)),y.setAttribute("uv",new Wi(_,m)),y.setAttribute("faceIndex",new Wi(x,g)),e.push(y),r>4&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}(i)),this._blurMaterial=function(t,e,n){const i=new Float32Array(qr),r=new on(0,1,0),s=new pr({name:"SphericalGaussianBlur",defines:{n:qr,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:ss(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1});return s}(i,t,e)}return i}_compileMaterial(t){const e=new ar(this._lodPlanes[0],t);this._renderer.compile(e,Xr)}_sceneToCubeUV(t,e,n,i){const r=new _r(90,1,e,n),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],o=this._renderer,l=o.autoClear,h=o.toneMapping;o.getClearColor(jr),o.toneMapping=Et,o.autoClear=!1;const c=new Ai({name:"PMREM.Background",side:bt,depthWrite:!1,depthTest:!1}),u=new ar(new lr,c);let d=!1;const p=t.background;p?p.isColor&&(c.color.copy(p),t.background=null,d=!0):(c.color.copy(jr),d=!0);for(let f=0;f<6;f++){const e=f%3;0===e?(r.up.set(0,s[f],0),r.lookAt(a[f],0,0)):1===e?(r.up.set(0,0,s[f]),r.lookAt(0,a[f],0)):(r.up.set(0,s[f],0),r.lookAt(0,0,a[f]));const n=this._cubeSize;ns(i,e*n,f>2?n:0,n,n),o.setRenderTarget(i),d&&o.render(u,r),o.render(t,r)}u.geometry.dispose(),u.material.dispose(),o.toneMapping=h,o.autoClear=l,t.background=p}_textureToCubeUV(t,e){const n=this._renderer,i=t.mapping===kt||t.mapping===Nt;i?(null===this._cubemapMaterial&&(this._cubemapMaterial=rs()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===t.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=is());const r=i?this._cubemapMaterial:this._equirectMaterial,s=new ar(this._lodPlanes[0],r);r.uniforms.envMap.value=t;const a=this._cubeSize;ns(e,0,0,3*a,2*a),n.setRenderTarget(e),n.render(s,Xr)}_applyPMREM(t){const e=this._renderer,n=e.autoClear;e.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const e=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),n=$r[(i-1)%$r.length];this._blur(t,i-1,i,e,n)}e.autoClear=n}_blur(t,e,n,i,r){const s=this._pingPongRenderTarget;this._halfBlur(t,s,e,n,i,"latitudinal",r),this._halfBlur(s,t,n,n,i,"longitudinal",r)}_halfBlur(t,e,n,i,r,s,a){const o=this._renderer,l=this._blurMaterial,h=new ar(this._lodPlanes[i],l),c=l.uniforms,u=this._sizeLods[n]-1,d=isFinite(r)?Math.PI/(2*u):2*Math.PI/39,p=r/d,f=isFinite(r)?1+Math.floor(3*p):qr,m=[];let g=0;for(let x=0;x<qr;++x){const t=x/p,e=Math.exp(-t*t/2);m.push(e),0===x?g+=e:x<f&&(g+=2*e)}for(let x=0;x<m.length;x++)m[x]=m[x]/g;c.envMap.value=t.texture,c.samples.value=f,c.weights.value=m,c.latitudinal.value="latitudinal"===s,a&&(c.poleAxis.value=a);const{_lodMax:v}=this;c.dTheta.value=d,c.mipInt.value=v-n;const _=this._sizeLods[i];ns(e,3*_*(i>v-4?i-v+4:0),4*(this._cubeSize-_),3*_,2*_),o.setRenderTarget(e),o.render(h,Xr)}}function es(t,e,n){const i=new nn(t,e,n);return i.texture.mapping=Ot,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function ns(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function is(){return new pr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:ss(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function rs(){return new pr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:ss(),fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function ss(){return"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t"}function as(t){let e=new WeakMap,n=null;function i(t){const n=t.target;n.removeEventListener("dispose",i);const r=e.get(n);void 0!==r&&(e.delete(n),r.dispose())}return{get:function(r){if(r&&r.isTexture){const s=r.mapping,a=303===s||304===s,o=s===kt||s===Nt;if(a||o){if(r.isRenderTargetTexture&&!0===r.needsPMREMUpdate){r.needsPMREMUpdate=!1;let i=e.get(r);return null===n&&(n=new ts(t)),i=a?n.fromEquirectangular(r,i):n.fromCubemap(r,i),e.set(r,i),i.texture}if(e.has(r))return e.get(r).texture;{const s=r.image;if(a&&s&&s.height>0||o&&s&&function(t){let e=0;const n=6;for(let i=0;i<n;i++)void 0!==t[i]&&e++;return e===n}(s)){null===n&&(n=new ts(t));const s=a?n.fromEquirectangular(r):n.fromCubemap(r);return e.set(r,s),r.addEventListener("dispose",i),s.texture}return null}}}return r},dispose:function(){e=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function os(t){const e={};function n(n){if(void 0!==e[n])return e[n];let i;switch(n){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(n)}return e[n]=i,i}return{has:function(t){return null!==n(t)},init:function(t){t.isWebGL2?(n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance")):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(t){const e=n(t);return e}}}function ls(t,e,n,i){const r={},s=new WeakMap;function a(t){const o=t.target;null!==o.index&&e.remove(o.index);for(const n in o.attributes)e.remove(o.attributes[n]);for(const n in o.morphAttributes){const t=o.morphAttributes[n];for(let n=0,i=t.length;n<i;n++)e.remove(t[n])}o.removeEventListener("dispose",a),delete r[o.id];const l=s.get(o);l&&(e.remove(l),s.delete(o)),i.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,n.memory.geometries--}function o(t){const n=[],i=t.index,r=t.attributes.position;let a=0;if(null!==i){const t=i.array;a=i.version;for(let e=0,i=t.length;e<i;e+=3){const i=t[e+0],r=t[e+1],s=t[e+2];n.push(i,r,r,s,s,i)}}else{if(void 0===r)return;{const t=r.array;a=r.version;for(let e=0,i=t.length/3-1;e<i;e+=3){const t=e+0,i=e+1,r=e+2;n.push(t,i,i,r,r,t)}}}const o=new(Ne(n)?Ii:Li)(n,1);o.version=a;const l=s.get(t);l&&e.remove(l),s.set(t,o)}return{get:function(t,e){return!0===r[e.id]||(e.addEventListener("dispose",a),r[e.id]=!0,n.memory.geometries++),e},update:function(n){const i=n.attributes;for(const s in i)e.update(i[s],t.ARRAY_BUFFER);const r=n.morphAttributes;for(const s in r){const n=r[s];for(let i=0,r=n.length;i<r;i++)e.update(n[i],t.ARRAY_BUFFER)}},getWireframeAttribute:function(t){const e=s.get(t);if(e){const n=t.index;null!==n&&e.version<n.version&&o(t)}else o(t);return s.get(t)}}}function hs(t,e,n,i){const r=i.isWebGL2;let s,a,o;this.setMode=function(t){s=t},this.setIndex=function(t){a=t.type,o=t.bytesPerElement},this.render=function(e,i){t.drawElements(s,i,a,e*o),n.update(i,s,1)},this.renderInstances=function(i,l,h){if(0===h)return;let c,u;if(r)c=t,u="drawElementsInstanced";else if(c=e.get("ANGLE_instanced_arrays"),u="drawElementsInstancedANGLE",null===c)return;c[u](s,l,a,i*o,h),n.update(l,s,h)},this.renderMultiDraw=function(t,i,r){if(0===r)return;const l=e.get("WEBGL_multi_draw");if(null===l)for(let e=0;e<r;e++)this.render(t[e]/o,i[e]);else{l.multiDrawElementsWEBGL(s,i,0,a,t,0,r);let e=0;for(let t=0;t<r;t++)e+=i[t];n.update(e,s,1)}}}function cs(t){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(n,i,r){switch(e.calls++,i){case t.TRIANGLES:e.triangles+=r*(n/3);break;case t.LINES:e.lines+=r*(n/2);break;case t.LINE_STRIP:e.lines+=r*(n-1);break;case t.LINE_LOOP:e.lines+=r*n;break;case t.POINTS:e.points+=r*n}}}}function us(t,e){return t[0]-e[0]}function ds(t,e){return Math.abs(e[1])-Math.abs(t[1])}function ps(t,e,n){const i={},r=new Float32Array(8),s=new WeakMap,a=new tn,o=[];for(let l=0;l<8;l++)o[l]=[l,0];return{update:function(l,h,c){const u=l.morphTargetInfluences;if(!0===e.isWebGL2){const i=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,r=void 0!==i?i.length:0;let o=s.get(h);if(void 0===o||o.count!==r){let t=function(){v.dispose(),s.delete(h),h.removeEventListener("dispose",t)};void 0!==o&&o.texture.dispose();const n=void 0!==h.morphAttributes.position,i=void 0!==h.morphAttributes.normal,l=void 0!==h.morphAttributes.color,c=h.morphAttributes.position||[],u=h.morphAttributes.normal||[],d=h.morphAttributes.color||[];let p=0;!0===n&&(p=1),!0===i&&(p=2),!0===l&&(p=3);let f=h.attributes.position.count*p,m=1;f>e.maxTextureSize&&(m=Math.ceil(f/e.maxTextureSize),f=e.maxTextureSize);const g=new Float32Array(f*m*4*r),v=new rn(g,f,m,r);v.type=Qt,v.needsUpdate=!0;const _=4*p;for(let e=0;e<r;e++){const t=c[e],r=u[e],s=d[e],o=f*m*4*e;for(let e=0;e<t.count;e++){const h=e*_;!0===n&&(a.fromBufferAttribute(t,e),g[o+h+0]=a.x,g[o+h+1]=a.y,g[o+h+2]=a.z,g[o+h+3]=0),!0===i&&(a.fromBufferAttribute(r,e),g[o+h+4]=a.x,g[o+h+5]=a.y,g[o+h+6]=a.z,g[o+h+7]=0),!0===l&&(a.fromBufferAttribute(s,e),g[o+h+8]=a.x,g[o+h+9]=a.y,g[o+h+10]=a.z,g[o+h+11]=4===s.itemSize?a.w:1)}}o={count:r,texture:v,size:new Le(f,m)},s.set(h,o),h.addEventListener("dispose",t)}let l=0;for(let t=0;t<u.length;t++)l+=u[t];const d=h.morphTargetsRelative?1:1-l;c.getUniforms().setValue(t,"morphTargetBaseInfluence",d),c.getUniforms().setValue(t,"morphTargetInfluences",u),c.getUniforms().setValue(t,"morphTargetsTexture",o.texture,n),c.getUniforms().setValue(t,"morphTargetsTextureSize",o.size)}else{const e=void 0===u?0:u.length;let n=i[h.id];if(void 0===n||n.length!==e){n=[];for(let t=0;t<e;t++)n[t]=[t,0];i[h.id]=n}for(let t=0;t<e;t++){const e=n[t];e[0]=t,e[1]=u[t]}n.sort(ds);for(let t=0;t<8;t++)t<e&&n[t][1]?(o[t][0]=n[t][0],o[t][1]=n[t][1]):(o[t][0]=Number.MAX_SAFE_INTEGER,o[t][1]=0);o.sort(us);const s=h.morphAttributes.position,a=h.morphAttributes.normal;let l=0;for(let t=0;t<8;t++){const e=o[t],n=e[0],i=e[1];n!==Number.MAX_SAFE_INTEGER&&i?(s&&h.getAttribute("morphTarget"+t)!==s[n]&&h.setAttribute("morphTarget"+t,s[n]),a&&h.getAttribute("morphNormal"+t)!==a[n]&&h.setAttribute("morphNormal"+t,a[n]),r[t]=i,l+=i):(s&&!0===h.hasAttribute("morphTarget"+t)&&h.deleteAttribute("morphTarget"+t),a&&!0===h.hasAttribute("morphNormal"+t)&&h.deleteAttribute("morphNormal"+t),r[t]=0)}const d=h.morphTargetsRelative?1:1-l;c.getUniforms().setValue(t,"morphTargetBaseInfluence",d),c.getUniforms().setValue(t,"morphTargetInfluences",r)}}}}function fs(t,e,n,i){let r=new WeakMap;function s(t){const e=t.target;e.removeEventListener("dispose",s),n.remove(e.instanceMatrix),null!==e.instanceColor&&n.remove(e.instanceColor)}return{update:function(a){const o=i.render.frame,l=a.geometry,h=e.get(a,l);if(r.get(h)!==o&&(e.update(h),r.set(h,o)),a.isInstancedMesh&&(!1===a.hasEventListener("dispose",s)&&a.addEventListener("dispose",s),r.get(a)!==o&&(n.update(a.instanceMatrix,t.ARRAY_BUFFER),null!==a.instanceColor&&n.update(a.instanceColor,t.ARRAY_BUFFER),r.set(a,o))),a.isSkinnedMesh){const t=a.skeleton;r.get(t)!==o&&(t.update(),r.set(t,o))}return h},dispose:function(){r=new WeakMap}}}class ms extends $e{constructor(t,e,n,i,r,s,a,o,l,h){if((h=void 0!==h?h:$t)!==$t&&h!==te)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&h===$t&&(n=Jt),void 0===n&&h===te&&(n=Zt),super(null,i,r,s,a,o,h,n,l),this.isDepthTexture=!0,this.image={width:t,height:e},this.magFilter=void 0!==a?a:Bt,this.minFilter=void 0!==o?o:Bt,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(t){return super.copy(t),this.compareFunction=t.compareFunction,this}toJSON(t){const e=super.toJSON(t);return null!==this.compareFunction&&(e.compareFunction=this.compareFunction),e}}const gs=new $e,vs=new ms(1,1);vs.compareFunction=515;const _s=new rn,xs=new sn,ys=new Sr,Ss=[],bs=[],Ms=new Float32Array(16),ws=new Float32Array(9),Cs=new Float32Array(4);function Ts(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let s=Ss[r];if(void 0===s&&(s=new Float32Array(r),Ss[r]=s),0!==e){i.toArray(s,0);for(let i=1,r=0;i!==e;++i)r+=n,t[i].toArray(s,r)}return s}function Es(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function As(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function Ps(t,e){let n=bs[e];void 0===n&&(n=new Int32Array(e),bs[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function Rs(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Ws(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Es(n,e))return;t.uniform2fv(this.addr,e),As(n,e)}}function Ls(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(void 0!==e.r)n[0]===e.r&&n[1]===e.g&&n[2]===e.b||(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Es(n,e))return;t.uniform3fv(this.addr,e),As(n,e)}}function Is(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Es(n,e))return;t.uniform4fv(this.addr,e),As(n,e)}}function ks(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(Es(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),As(n,e)}else{if(Es(n,i))return;Cs.set(i),t.uniformMatrix2fv(this.addr,!1,Cs),As(n,i)}}function Ns(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(Es(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),As(n,e)}else{if(Es(n,i))return;ws.set(i),t.uniformMatrix3fv(this.addr,!1,ws),As(n,i)}}function Os(t,e){const n=this.cache,i=e.elements;if(void 0===i){if(Es(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),As(n,e)}else{if(Es(n,i))return;Ms.set(i),t.uniformMatrix4fv(this.addr,!1,Ms),As(n,i)}}function Us(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Ds(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Es(n,e))return;t.uniform2iv(this.addr,e),As(n,e)}}function Fs(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Es(n,e))return;t.uniform3iv(this.addr,e),As(n,e)}}function Bs(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Es(n,e))return;t.uniform4iv(this.addr,e),As(n,e)}}function zs(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Vs(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y||(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Es(n,e))return;t.uniform2uiv(this.addr,e),As(n,e)}}function Gs(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z||(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Es(n,e))return;t.uniform3uiv(this.addr,e),As(n,e)}}function Hs(t,e){const n=this.cache;if(void 0!==e.x)n[0]===e.x&&n[1]===e.y&&n[2]===e.z&&n[3]===e.w||(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Es(n,e))return;t.uniform4uiv(this.addr,e),As(n,e)}}function qs(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r);const s=this.type===t.SAMPLER_2D_SHADOW?vs:gs;n.setTexture2D(e||s,r)}function Xs(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||xs,r)}function js(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||ys,r)}function Js(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||_s,r)}function Qs(t,e){t.uniform1fv(this.addr,e)}function Ks(t,e){const n=Ts(e,this.size,2);t.uniform2fv(this.addr,n)}function Zs(t,e){const n=Ts(e,this.size,3);t.uniform3fv(this.addr,n)}function Ys(t,e){const n=Ts(e,this.size,4);t.uniform4fv(this.addr,n)}function $s(t,e){const n=Ts(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function ta(t,e){const n=Ts(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function ea(t,e){const n=Ts(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function na(t,e){t.uniform1iv(this.addr,e)}function ia(t,e){t.uniform2iv(this.addr,e)}function ra(t,e){t.uniform3iv(this.addr,e)}function sa(t,e){t.uniform4iv(this.addr,e)}function aa(t,e){t.uniform1uiv(this.addr,e)}function oa(t,e){t.uniform2uiv(this.addr,e)}function la(t,e){t.uniform3uiv(this.addr,e)}function ha(t,e){t.uniform4uiv(this.addr,e)}function ca(t,e,n){const i=this.cache,r=e.length,s=Ps(n,r);Es(i,s)||(t.uniform1iv(this.addr,s),As(i,s));for(let a=0;a!==r;++a)n.setTexture2D(e[a]||gs,s[a])}function ua(t,e,n){const i=this.cache,r=e.length,s=Ps(n,r);Es(i,s)||(t.uniform1iv(this.addr,s),As(i,s));for(let a=0;a!==r;++a)n.setTexture3D(e[a]||xs,s[a])}function da(t,e,n){const i=this.cache,r=e.length,s=Ps(n,r);Es(i,s)||(t.uniform1iv(this.addr,s),As(i,s));for(let a=0;a!==r;++a)n.setTextureCube(e[a]||ys,s[a])}function pa(t,e,n){const i=this.cache,r=e.length,s=Ps(n,r);Es(i,s)||(t.uniform1iv(this.addr,s),As(i,s));for(let a=0;a!==r;++a)n.setTexture2DArray(e[a]||_s,s[a])}class fa{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.type=e.type,this.setValue=function(t){switch(t){case 5126:return Rs;case 35664:return Ws;case 35665:return Ls;case 35666:return Is;case 35674:return ks;case 35675:return Ns;case 35676:return Os;case 5124:case 35670:return Us;case 35667:case 35671:return Ds;case 35668:case 35672:return Fs;case 35669:case 35673:return Bs;case 5125:return zs;case 36294:return Vs;case 36295:return Gs;case 36296:return Hs;case 35678:case 36198:case 36298:case 36306:case 35682:return qs;case 35679:case 36299:case 36307:return Xs;case 35680:case 36300:case 36308:case 36293:return js;case 36289:case 36303:case 36311:case 36292:return Js}}(e.type)}}class ma{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.type=e.type,this.size=e.size,this.setValue=function(t){switch(t){case 5126:return Qs;case 35664:return Ks;case 35665:return Zs;case 35666:return Ys;case 35674:return $s;case 35675:return ta;case 35676:return ea;case 5124:case 35670:return na;case 35667:case 35671:return ia;case 35668:case 35672:return ra;case 35669:case 35673:return sa;case 5125:return aa;case 36294:return oa;case 36295:return la;case 36296:return ha;case 35678:case 36198:case 36298:case 36306:case 35682:return ca;case 35679:case 36299:case 36307:return ua;case 35680:case 36300:case 36308:case 36293:return da;case 36289:case 36303:case 36311:case 36292:return pa}}(e.type)}}class ga{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,n){const i=this.seq;for(let r=0,s=i.length;r!==s;++r){const s=i[r];s.setValue(t,e[s.id],n)}}}const va=/(\w+)(\])?(\[|\.)?/g;function _a(t,e){t.seq.push(e),t.map[e.id]=e}function xa(t,e,n){const i=t.name,r=i.length;for(va.lastIndex=0;;){const s=va.exec(i),a=va.lastIndex;let o=s[1];const l="]"===s[2],h=s[3];if(l&&(o|=0),void 0===h||"["===h&&a+2===r){_a(n,void 0===h?new fa(o,t,e):new ma(o,t,e));break}{let t=n.map[o];void 0===t&&(t=new ga(o),_a(n,t)),n=t}}}class ya{constructor(t,e){this.seq=[],this.map={};const n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){const n=t.getActiveUniform(e,i);xa(n,t.getUniformLocation(e,n.name),this)}}setValue(t,e,n,i){const r=this.map[e];void 0!==r&&r.setValue(t,n,i)}setOptional(t,e,n){const i=e[n];void 0!==i&&this.setValue(t,n,i)}static upload(t,e,n,i){for(let r=0,s=e.length;r!==s;++r){const s=e[r],a=n[s.id];!1!==a.needsUpdate&&s.setValue(t,a.value,i)}}static seqWithValue(t,e){const n=[];for(let i=0,r=t.length;i!==r;++i){const r=t[i];r.id in e&&n.push(r)}return n}}function Sa(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}const ba=37297;let Ma=0;function wa(t,e,n){const i=t.getShaderParameter(e,t.COMPILE_STATUS),r=t.getShaderInfoLog(e).trim();if(i&&""===r)return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const i=parseInt(s[1]);return n.toUpperCase()+"\n\n"+r+"\n\n"+function(t,e){const n=t.split("\n"),i=[],r=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let a=r;a<s;a++){const t=a+1;i.push(`${t===e?">":" "} ${t}: ${n[a]}`)}return i.join("\n")}(t.getShaderSource(e),i)}return r}function Ca(t,e){const n=function(t){const e=He.getPrimaries(He.workingColorSpace),n=He.getPrimaries(t);let i;switch(e===n?i="":e===me&&n===fe?i="LinearDisplayP3ToLinearSRGB":e===fe&&n===me&&(i="LinearSRGBToLinearDisplayP3"),t){case he:case ue:return[i,"LinearTransferOETF"];case le:case ce:return[i,"sRGBTransferOETF"];default:return[i,"LinearTransferOETF"]}}(e);return`vec4 ${t}( vec4 value ) { return ${n[0]}( ${n[1]}( value ) ); }`}function Ta(t,e){let n;switch(e){case At:n="Linear";break;case Pt:n="Reinhard";break;case Rt:n="OptimizedCineon";break;case Wt:n="ACESFilmic";break;case It:n="AgX";break;case Lt:n="Custom";break;default:n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Ea(t){return""!==t}function Aa(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Pa(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Ra=/^[ \t]*#include +<([\w\d./]+)>/gm;function Wa(t){return t.replace(Ra,Ia)}const La=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Ia(t,e){let n=Ir[e];if(void 0===n){const t=La.get(e);if(void 0===t)throw new Error("Can not resolve #include <"+e+">");n=Ir[t]}return Wa(n)}const ka=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Na(t){return t.replace(ka,Oa)}function Oa(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function Ua(t){let e=`precision ${t.precision} float;\n\tprecision ${t.precision} int;\n\tprecision ${t.precision} sampler2D;\n\tprecision ${t.precision} samplerCube;\n\t`;return t.isWebGL2&&(e+=`precision ${t.precision} sampler3D;\n\t\tprecision ${t.precision} sampler2DArray;\n\t\tprecision ${t.precision} sampler2DShadow;\n\t\tprecision ${t.precision} samplerCubeShadow;\n\t\tprecision ${t.precision} sampler2DArrayShadow;\n\t\tprecision ${t.precision} isampler2D;\n\t\tprecision ${t.precision} isampler3D;\n\t\tprecision ${t.precision} isamplerCube;\n\t\tprecision ${t.precision} isampler2DArray;\n\t\tprecision ${t.precision} usampler2D;\n\t\tprecision ${t.precision} usampler3D;\n\t\tprecision ${t.precision} usamplerCube;\n\t\tprecision ${t.precision} usampler2DArray;\n\t\t`),"highp"===t.precision?e+="\n#define HIGH_PRECISION":"mediump"===t.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(e+="\n#define LOW_PRECISION"),e}function Da(t,e,n,i){const r=t.getContext(),s=n.defines;let a=n.vertexShader,o=n.fragmentShader;const l=function(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===_t?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===xt?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===yt&&(e="SHADOWMAP_TYPE_VSM"),e}(n),h=function(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case kt:case Nt:e="ENVMAP_TYPE_CUBE";break;case Ot:e="ENVMAP_TYPE_CUBE_UV"}return e}(n),c=function(t){let e="ENVMAP_MODE_REFLECTION";t.envMap&&t.envMapMode===Nt&&(e="ENVMAP_MODE_REFRACTION");return e}(n),u=function(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case wt:e="ENVMAP_BLENDING_MULTIPLY";break;case Ct:e="ENVMAP_BLENDING_MIX";break;case Tt:e="ENVMAP_BLENDING_ADD"}return e}(n),d=function(t){const e=t.envMapCubeUVHeight;if(null===e)return null;const n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:i,maxMip:n}}(n),p=n.isWebGL2?"":function(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.normalMapTangentSpace||t.clearcoatNormalMap||t.flatShading||t.alphaToCoverage||"physical"===t.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ea).join("\n")}(n),f=function(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Ea).join("\n")}(n),m=function(t){const e=[];for(const n in t){const i=t[n];!1!==i&&e.push("#define "+n+" "+i)}return e.join("\n")}(s),g=r.createProgram();let v,_,x=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?(v=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m].filter(Ea).join("\n"),v.length>0&&(v+="\n"),_=[p,"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m].filter(Ea).join("\n"),_.length>0&&(_+="\n")):(v=[Ua(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ea).join("\n"),_=[p,Ua(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,m,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Et?"#define TONE_MAPPING":"",n.toneMapping!==Et?Ir.tonemapping_pars_fragment:"",n.toneMapping!==Et?Ta("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Ir.colorspace_pars_fragment,Ca("linearToOutputTexel",n.outputColorSpace),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Ea).join("\n")),a=Wa(a),a=Aa(a,n),a=Pa(a,n),o=Wa(o),o=Aa(o,n),o=Pa(o,n),a=Na(a),o=Na(o),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(x="#version 300 es\n",v=[f,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+v,_=["precision mediump sampler2DArray;","#define varying in",n.glslVersion===ve?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===ve?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+_);const y=x+v+a,S=x+_+o,b=Sa(r,r.VERTEX_SHADER,y),M=Sa(r,r.FRAGMENT_SHADER,S);function w(e){if(t.debug.checkShaderErrors){const n=r.getProgramInfoLog(g).trim(),i=r.getShaderInfoLog(b).trim(),s=r.getShaderInfoLog(M).trim();let a=!0,o=!0;if(!1===r.getProgramParameter(g,r.LINK_STATUS))if(a=!1,"function"==typeof t.debug.onShaderError)t.debug.onShaderError(r,g,b,M);else{wa(r,b,"vertex"),wa(r,M,"fragment")}else""!==n||""!==i&&""!==s||(o=!1);o&&(e.diagnostics={runnable:a,programLog:n,vertexShader:{log:i,prefix:v},fragmentShader:{log:s,prefix:_}})}r.deleteShader(b),r.deleteShader(M),C=new ya(r,g),T=function(t,e){const n={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const i=t.getActiveAttrib(e,r),s=i.name;let a=1;i.type===t.FLOAT_MAT2&&(a=2),i.type===t.FLOAT_MAT3&&(a=3),i.type===t.FLOAT_MAT4&&(a=4),n[s]={type:i.type,location:t.getAttribLocation(e,s),locationSize:a}}return n}(r,g)}let C,T;r.attachShader(g,b),r.attachShader(g,M),void 0!==n.index0AttributeName?r.bindAttribLocation(g,0,n.index0AttributeName):!0===n.morphTargets&&r.bindAttribLocation(g,0,"position"),r.linkProgram(g),this.getUniforms=function(){return void 0===C&&w(this),C},this.getAttributes=function(){return void 0===T&&w(this),T};let E=!1===n.rendererExtensionParallelShaderCompile;return this.isReady=function(){return!1===E&&(E=r.getProgramParameter(g,ba)),E},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(g),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=Ma++,this.cacheKey=e,this.usedTimes=1,this.program=g,this.vertexShader=b,this.fragmentShader=M,this}let Fa=0;class Ba{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const e=t.vertexShader,n=t.fragmentShader,i=this._getShaderStage(e),r=this._getShaderStage(n),s=this._getShaderCacheForMaterial(t);return!1===s.has(i)&&(s.add(i),i.usedTimes++),!1===s.has(r)&&(s.add(r),r.usedTimes++),this}remove(t){const e=this.materialCache.get(t);for(const n of e)n.usedTimes--,0===n.usedTimes&&this.shaderCache.delete(n.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const e=this.materialCache;let n=e.get(t);return void 0===n&&(n=new Set,e.set(t,n)),n}_getShaderStage(t){const e=this.shaderCache;let n=e.get(t);return void 0===n&&(n=new za(t),e.set(t,n)),n}}class za{constructor(t){this.id=Fa++,this.code=t,this.usedTimes=0}}function Va(t,e,n,i,r,s,a){const o=new Jn,l=new Ba,h=new Set,c=[],u=r.isWebGL2,d=r.logarithmicDepthBuffer,p=r.vertexTextures;let f=r.precision;const m={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(t){return h.add(t),0===t?"uv":`uv${t}`}return{getParameters:function(s,o,c,v,_){const x=v.fog,y=_.geometry,S=s.isMeshStandardMaterial?v.environment:null,b=(s.isMeshStandardMaterial?n:e).get(s.envMap||S),M=b&&b.mapping===Ot?b.image.height:null,w=m[s.type];null!==s.precision&&(f=r.getMaxPrecision(s.precision),s.precision);const C=y.morphAttributes.position||y.morphAttributes.normal||y.morphAttributes.color,T=void 0!==C?C.length:0;let E,A,P,R,W=0;if(void 0!==y.morphAttributes.position&&(W=1),void 0!==y.morphAttributes.normal&&(W=2),void 0!==y.morphAttributes.color&&(W=3),w){const t=Nr[w];E=t.vertexShader,A=t.fragmentShader}else E=s.vertexShader,A=s.fragmentShader,l.update(s),P=l.getVertexShaderID(s),R=l.getFragmentShaderID(s);const L=t.getRenderTarget(),I=!0===_.isInstancedMesh,k=!0===_.isBatchedMesh,N=!!s.map,O=!!s.matcap,U=!!b,D=!!s.aoMap,F=!!s.lightMap,B=!!s.bumpMap,z=!!s.normalMap,V=!!s.displacementMap,G=!!s.emissiveMap,H=!!s.metalnessMap,q=!!s.roughnessMap,X=s.anisotropy>0,j=s.clearcoat>0,J=s.iridescence>0,Q=s.sheen>0,K=s.transmission>0,Z=X&&!!s.anisotropyMap,Y=j&&!!s.clearcoatMap,$=j&&!!s.clearcoatNormalMap,tt=j&&!!s.clearcoatRoughnessMap,et=J&&!!s.iridescenceMap,nt=J&&!!s.iridescenceThicknessMap,it=Q&&!!s.sheenColorMap,rt=Q&&!!s.sheenRoughnessMap,st=!!s.specularMap,at=!!s.specularColorMap,ot=!!s.specularIntensityMap,lt=K&&!!s.transmissionMap,ht=K&&!!s.thicknessMap,ct=!!s.gradientMap,ut=!!s.alphaMap,dt=s.alphaTest>0,pt=!!s.alphaHash,ft=!!s.extensions;let mt=Et;s.toneMapped&&(null!==L&&!0!==L.isXRRenderTarget||(mt=t.toneMapping));const gt={isWebGL2:u,shaderID:w,shaderType:s.type,shaderName:s.name,vertexShader:E,fragmentShader:A,defines:s.defines,customVertexShaderID:P,customFragmentShaderID:R,isRawShaderMaterial:!0===s.isRawShaderMaterial,glslVersion:s.glslVersion,precision:f,batching:k,instancing:I,instancingColor:I&&null!==_.instanceColor,supportsVertexTextures:p,outputColorSpace:null===L?t.outputColorSpace:!0===L.isXRRenderTarget?L.texture.colorSpace:he,alphaToCoverage:!!s.alphaToCoverage,map:N,matcap:O,envMap:U,envMapMode:U&&b.mapping,envMapCubeUVHeight:M,aoMap:D,lightMap:F,bumpMap:B,normalMap:z,displacementMap:p&&V,emissiveMap:G,normalMapObjectSpace:z&&1===s.normalMapType,normalMapTangentSpace:z&&0===s.normalMapType,metalnessMap:H,roughnessMap:q,anisotropy:X,anisotropyMap:Z,clearcoat:j,clearcoatMap:Y,clearcoatNormalMap:$,clearcoatRoughnessMap:tt,iridescence:J,iridescenceMap:et,iridescenceThicknessMap:nt,sheen:Q,sheenColorMap:it,sheenRoughnessMap:rt,specularMap:st,specularColorMap:at,specularIntensityMap:ot,transmission:K,transmissionMap:lt,thicknessMap:ht,gradientMap:ct,opaque:!1===s.transparent&&1===s.blending&&!1===s.alphaToCoverage,alphaMap:ut,alphaTest:dt,alphaHash:pt,combine:s.combine,mapUv:N&&g(s.map.channel),aoMapUv:D&&g(s.aoMap.channel),lightMapUv:F&&g(s.lightMap.channel),bumpMapUv:B&&g(s.bumpMap.channel),normalMapUv:z&&g(s.normalMap.channel),displacementMapUv:V&&g(s.displacementMap.channel),emissiveMapUv:G&&g(s.emissiveMap.channel),metalnessMapUv:H&&g(s.metalnessMap.channel),roughnessMapUv:q&&g(s.roughnessMap.channel),anisotropyMapUv:Z&&g(s.anisotropyMap.channel),clearcoatMapUv:Y&&g(s.clearcoatMap.channel),clearcoatNormalMapUv:$&&g(s.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:tt&&g(s.clearcoatRoughnessMap.channel),iridescenceMapUv:et&&g(s.iridescenceMap.channel),iridescenceThicknessMapUv:nt&&g(s.iridescenceThicknessMap.channel),sheenColorMapUv:it&&g(s.sheenColorMap.channel),sheenRoughnessMapUv:rt&&g(s.sheenRoughnessMap.channel),specularMapUv:st&&g(s.specularMap.channel),specularColorMapUv:at&&g(s.specularColorMap.channel),specularIntensityMapUv:ot&&g(s.specularIntensityMap.channel),transmissionMapUv:lt&&g(s.transmissionMap.channel),thicknessMapUv:ht&&g(s.thicknessMap.channel),alphaMapUv:ut&&g(s.alphaMap.channel),vertexTangents:!!y.attributes.tangent&&(z||X),vertexColors:s.vertexColors,vertexAlphas:!0===s.vertexColors&&!!y.attributes.color&&4===y.attributes.color.itemSize,pointsUvs:!0===_.isPoints&&!!y.attributes.uv&&(N||ut),fog:!!x,useFog:!0===s.fog,fogExp2:!!x&&x.isFogExp2,flatShading:!0===s.flatShading,sizeAttenuation:!0===s.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===_.isSkinnedMesh,morphTargets:void 0!==y.morphAttributes.position,morphNormals:void 0!==y.morphAttributes.normal,morphColors:void 0!==y.morphAttributes.color,morphTargetsCount:T,morphTextureStride:W,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numSpotLightMaps:o.spotLightMap.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numSpotLightShadowsWithMaps:o.numSpotLightShadowsWithMaps,numLightProbes:o.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:s.dithering,shadowMapEnabled:t.shadowMap.enabled&&c.length>0,shadowMapType:t.shadowMap.type,toneMapping:mt,useLegacyLights:t._useLegacyLights,decodeVideoTexture:N&&!0===s.map.isVideoTexture&&He.getTransfer(s.map.colorSpace)===pe,premultipliedAlpha:s.premultipliedAlpha,doubleSided:2===s.side,flipSided:s.side===bt,useDepthPacking:s.depthPacking>=0,depthPacking:s.depthPacking||0,index0AttributeName:s.index0AttributeName,extensionDerivatives:ft&&!0===s.extensions.derivatives,extensionFragDepth:ft&&!0===s.extensions.fragDepth,extensionDrawBuffers:ft&&!0===s.extensions.drawBuffers,extensionShaderTextureLOD:ft&&!0===s.extensions.shaderTextureLOD,extensionClipCullDistance:ft&&!0===s.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:ft&&!0===s.extensions.multiDraw&&i.has("WEBGL_multi_draw"),rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:s.customProgramCacheKey()};return gt.vertexUv1s=h.has(1),gt.vertexUv2s=h.has(2),gt.vertexUv3s=h.has(3),h.clear(),gt},getProgramCacheKey:function(e){const n=[];if(e.shaderID?n.push(e.shaderID):(n.push(e.customVertexShaderID),n.push(e.customFragmentShaderID)),void 0!==e.defines)for(const t in e.defines)n.push(t),n.push(e.defines[t]);return!1===e.isRawShaderMaterial&&(!function(t,e){t.push(e.precision),t.push(e.outputColorSpace),t.push(e.envMapMode),t.push(e.envMapCubeUVHeight),t.push(e.mapUv),t.push(e.alphaMapUv),t.push(e.lightMapUv),t.push(e.aoMapUv),t.push(e.bumpMapUv),t.push(e.normalMapUv),t.push(e.displacementMapUv),t.push(e.emissiveMapUv),t.push(e.metalnessMapUv),t.push(e.roughnessMapUv),t.push(e.anisotropyMapUv),t.push(e.clearcoatMapUv),t.push(e.clearcoatNormalMapUv),t.push(e.clearcoatRoughnessMapUv),t.push(e.iridescenceMapUv),t.push(e.iridescenceThicknessMapUv),t.push(e.sheenColorMapUv),t.push(e.sheenRoughnessMapUv),t.push(e.specularMapUv),t.push(e.specularColorMapUv),t.push(e.specularIntensityMapUv),t.push(e.transmissionMapUv),t.push(e.thicknessMapUv),t.push(e.combine),t.push(e.fogExp2),t.push(e.sizeAttenuation),t.push(e.morphTargetsCount),t.push(e.morphAttributeCount),t.push(e.numDirLights),t.push(e.numPointLights),t.push(e.numSpotLights),t.push(e.numSpotLightMaps),t.push(e.numHemiLights),t.push(e.numRectAreaLights),t.push(e.numDirLightShadows),t.push(e.numPointLightShadows),t.push(e.numSpotLightShadows),t.push(e.numSpotLightShadowsWithMaps),t.push(e.numLightProbes),t.push(e.shadowMapType),t.push(e.toneMapping),t.push(e.numClippingPlanes),t.push(e.numClipIntersection),t.push(e.depthPacking)}(n,e),function(t,e){o.disableAll(),e.isWebGL2&&o.enable(0);e.supportsVertexTextures&&o.enable(1);e.instancing&&o.enable(2);e.instancingColor&&o.enable(3);e.matcap&&o.enable(4);e.envMap&&o.enable(5);e.normalMapObjectSpace&&o.enable(6);e.normalMapTangentSpace&&o.enable(7);e.clearcoat&&o.enable(8);e.iridescence&&o.enable(9);e.alphaTest&&o.enable(10);e.vertexColors&&o.enable(11);e.vertexAlphas&&o.enable(12);e.vertexUv1s&&o.enable(13);e.vertexUv2s&&o.enable(14);e.vertexUv3s&&o.enable(15);e.vertexTangents&&o.enable(16);e.anisotropy&&o.enable(17);e.alphaHash&&o.enable(18);e.batching&&o.enable(19);t.push(o.mask),o.disableAll(),e.fog&&o.enable(0);e.useFog&&o.enable(1);e.flatShading&&o.enable(2);e.logarithmicDepthBuffer&&o.enable(3);e.skinning&&o.enable(4);e.morphTargets&&o.enable(5);e.morphNormals&&o.enable(6);e.morphColors&&o.enable(7);e.premultipliedAlpha&&o.enable(8);e.shadowMapEnabled&&o.enable(9);e.useLegacyLights&&o.enable(10);e.doubleSided&&o.enable(11);e.flipSided&&o.enable(12);e.useDepthPacking&&o.enable(13);e.dithering&&o.enable(14);e.transmission&&o.enable(15);e.sheen&&o.enable(16);e.opaque&&o.enable(17);e.pointsUvs&&o.enable(18);e.decodeVideoTexture&&o.enable(19);e.alphaToCoverage&&o.enable(20);t.push(o.mask)}(n,e),n.push(t.outputColorSpace)),n.push(e.customProgramCacheKey),n.join()},getUniforms:function(t){const e=m[t.type];let n;if(e){const t=Nr[e];n=dr.clone(t.uniforms)}else n=t.uniforms;return n},acquireProgram:function(e,n){let i;for(let t=0,r=c.length;t<r;t++){const e=c[t];if(e.cacheKey===n){i=e,++i.usedTimes;break}}return void 0===i&&(i=new Da(t,n,e,s),c.push(i)),i},releaseProgram:function(t){if(0==--t.usedTimes){const e=c.indexOf(t);c[e]=c[c.length-1],c.pop(),t.destroy()}},releaseShaderCache:function(t){l.remove(t)},programs:c,dispose:function(){l.dispose()}}}function Ga(){let t=new WeakMap;return{get:function(e){let n=t.get(e);return void 0===n&&(n={},t.set(e,n)),n},remove:function(e){t.delete(e)},update:function(e,n,i){t.get(e)[n]=i},dispose:function(){t=new WeakMap}}}function Ha(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function qa(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Xa(){const t=[];let e=0;const n=[],i=[],r=[];function s(n,i,r,s,a,o){let l=t[e];return void 0===l?(l={id:n.id,object:n,geometry:i,material:r,groupOrder:s,renderOrder:n.renderOrder,z:a,group:o},t[e]=l):(l.id=n.id,l.object=n,l.geometry=i,l.material=r,l.groupOrder=s,l.renderOrder=n.renderOrder,l.z=a,l.group=o),e++,l}return{opaque:n,transmissive:i,transparent:r,init:function(){e=0,n.length=0,i.length=0,r.length=0},push:function(t,e,a,o,l,h){const c=s(t,e,a,o,l,h);a.transmission>0?i.push(c):!0===a.transparent?r.push(c):n.push(c)},unshift:function(t,e,a,o,l,h){const c=s(t,e,a,o,l,h);a.transmission>0?i.unshift(c):!0===a.transparent?r.unshift(c):n.unshift(c)},finish:function(){for(let n=e,i=t.length;n<i;n++){const e=t[n];if(null===e.id)break;e.id=null,e.object=null,e.geometry=null,e.material=null,e.group=null}},sort:function(t,e){n.length>1&&n.sort(t||Ha),i.length>1&&i.sort(e||qa),r.length>1&&r.sort(e||qa)}}}function ja(){let t=new WeakMap;return{get:function(e,n){const i=t.get(e);let r;return void 0===i?(r=new Xa,t.set(e,[r])):n>=i.length?(r=new Xa,i.push(r)):r=i[n],r},dispose:function(){t=new WeakMap}}}function Ja(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new on,color:new wi};break;case"SpotLight":n={position:new on,direction:new on,color:new wi,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new on,color:new wi,distance:0,decay:0};break;case"HemisphereLight":n={direction:new on,skyColor:new wi,groundColor:new wi};break;case"RectAreaLight":n={color:new wi,position:new on,halfWidth:new on,halfHeight:new on}}return t[e.id]=n,n}}}let Qa=0;function Ka(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function Za(t,e){const n=new Ja,i=function(){const t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];let n;switch(e.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Le};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Le,shadowCameraNear:1,shadowCameraFar:1e3}}return t[e.id]=n,n}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let l=0;l<9;l++)r.probe.push(new on);const s=new on,a=new Un,o=new Un;return{setup:function(s,a){let o=0,l=0,h=0;for(let t=0;t<9;t++)r.probe[t].set(0,0,0);let c=0,u=0,d=0,p=0,f=0,m=0,g=0,v=0,_=0,x=0,y=0;s.sort(Ka);const S=!0===a?Math.PI:1;for(let t=0,e=s.length;t<e;t++){const e=s[t],a=e.color,b=e.intensity,M=e.distance,w=e.shadow&&e.shadow.map?e.shadow.map.texture:null;if(e.isAmbientLight)o+=a.r*b*S,l+=a.g*b*S,h+=a.b*b*S;else if(e.isLightProbe){for(let t=0;t<9;t++)r.probe[t].addScaledVector(e.sh.coefficients[t],b);y++}else if(e.isDirectionalLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*S),e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,r.directionalShadow[c]=n,r.directionalShadowMap[c]=w,r.directionalShadowMatrix[c]=e.shadow.matrix,m++}r.directional[c]=t,c++}else if(e.isSpotLight){const t=n.get(e);t.position.setFromMatrixPosition(e.matrixWorld),t.color.copy(a).multiplyScalar(b*S),t.distance=M,t.coneCos=Math.cos(e.angle),t.penumbraCos=Math.cos(e.angle*(1-e.penumbra)),t.decay=e.decay,r.spot[d]=t;const s=e.shadow;if(e.map&&(r.spotLightMap[_]=e.map,_++,s.updateMatrices(e),e.castShadow&&x++),r.spotLightMatrix[d]=s.matrix,e.castShadow){const t=i.get(e);t.shadowBias=s.bias,t.shadowNormalBias=s.normalBias,t.shadowRadius=s.radius,t.shadowMapSize=s.mapSize,r.spotShadow[d]=t,r.spotShadowMap[d]=w,v++}d++}else if(e.isRectAreaLight){const t=n.get(e);t.color.copy(a).multiplyScalar(b),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),r.rectArea[p]=t,p++}else if(e.isPointLight){const t=n.get(e);if(t.color.copy(e.color).multiplyScalar(e.intensity*S),t.distance=e.distance,t.decay=e.decay,e.castShadow){const t=e.shadow,n=i.get(e);n.shadowBias=t.bias,n.shadowNormalBias=t.normalBias,n.shadowRadius=t.radius,n.shadowMapSize=t.mapSize,n.shadowCameraNear=t.camera.near,n.shadowCameraFar=t.camera.far,r.pointShadow[u]=n,r.pointShadowMap[u]=w,r.pointShadowMatrix[u]=e.shadow.matrix,g++}r.point[u]=t,u++}else if(e.isHemisphereLight){const t=n.get(e);t.skyColor.copy(e.color).multiplyScalar(b*S),t.groundColor.copy(e.groundColor).multiplyScalar(b*S),r.hemi[f]=t,f++}}p>0&&(e.isWebGL2?!0===t.has("OES_texture_float_linear")?(r.rectAreaLTC1=kr.LTC_FLOAT_1,r.rectAreaLTC2=kr.LTC_FLOAT_2):(r.rectAreaLTC1=kr.LTC_HALF_1,r.rectAreaLTC2=kr.LTC_HALF_2):!0===t.has("OES_texture_float_linear")?(r.rectAreaLTC1=kr.LTC_FLOAT_1,r.rectAreaLTC2=kr.LTC_FLOAT_2):!0===t.has("OES_texture_half_float_linear")&&(r.rectAreaLTC1=kr.LTC_HALF_1,r.rectAreaLTC2=kr.LTC_HALF_2)),r.ambient[0]=o,r.ambient[1]=l,r.ambient[2]=h;const b=r.hash;b.directionalLength===c&&b.pointLength===u&&b.spotLength===d&&b.rectAreaLength===p&&b.hemiLength===f&&b.numDirectionalShadows===m&&b.numPointShadows===g&&b.numSpotShadows===v&&b.numSpotMaps===_&&b.numLightProbes===y||(r.directional.length=c,r.spot.length=d,r.rectArea.length=p,r.point.length=u,r.hemi.length=f,r.directionalShadow.length=m,r.directionalShadowMap.length=m,r.pointShadow.length=g,r.pointShadowMap.length=g,r.spotShadow.length=v,r.spotShadowMap.length=v,r.directionalShadowMatrix.length=m,r.pointShadowMatrix.length=g,r.spotLightMatrix.length=v+_-x,r.spotLightMap.length=_,r.numSpotLightShadowsWithMaps=x,r.numLightProbes=y,b.directionalLength=c,b.pointLength=u,b.spotLength=d,b.rectAreaLength=p,b.hemiLength=f,b.numDirectionalShadows=m,b.numPointShadows=g,b.numSpotShadows=v,b.numSpotMaps=_,b.numLightProbes=y,r.version=Qa++)},setupView:function(t,e){let n=0,i=0,l=0,h=0,c=0;const u=e.matrixWorldInverse;for(let d=0,p=t.length;d<p;d++){const e=t[d];if(e.isDirectionalLight){const t=r.directional[n];t.direction.setFromMatrixPosition(e.matrixWorld),s.setFromMatrixPosition(e.target.matrixWorld),t.direction.sub(s),t.direction.transformDirection(u),n++}else if(e.isSpotLight){const t=r.spot[l];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(u),t.direction.setFromMatrixPosition(e.matrixWorld),s.setFromMatrixPosition(e.target.matrixWorld),t.direction.sub(s),t.direction.transformDirection(u),l++}else if(e.isRectAreaLight){const t=r.rectArea[h];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(u),o.identity(),a.copy(e.matrixWorld),a.premultiply(u),o.extractRotation(a),t.halfWidth.set(.5*e.width,0,0),t.halfHeight.set(0,.5*e.height,0),t.halfWidth.applyMatrix4(o),t.halfHeight.applyMatrix4(o),h++}else if(e.isPointLight){const t=r.point[i];t.position.setFromMatrixPosition(e.matrixWorld),t.position.applyMatrix4(u),i++}else if(e.isHemisphereLight){const t=r.hemi[c];t.direction.setFromMatrixPosition(e.matrixWorld),t.direction.transformDirection(u),c++}}},state:r}}function Ya(t,e){const n=new Za(t,e),i=[],r=[];return{init:function(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:function(t){n.setup(i,t)},setupLightsView:function(t){n.setupView(i,t)},pushLight:function(t){i.push(t)},pushShadow:function(t){r.push(t)}}}function $a(t,e){let n=new WeakMap;return{get:function(i,r=0){const s=n.get(i);let a;return void 0===s?(a=new Ya(t,e),n.set(i,[a])):r>=s.length?(a=new Ya(t,e),s.push(a)):a=s[r],a},dispose:function(){n=new WeakMap}}}class to extends Ei{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class eo extends Ei{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}function no(t,e,n){let i=new Pr;const r=new Le,s=new Le,a=new tn,o=new to({depthPacking:3201}),l=new eo,h={},c=n.maxTextureSize,u={[St]:bt,[bt]:St,2:2},d=new pr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Le},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=d.clone();p.defines.HORIZONTAL_PASS=1;const f=new Vi;f.setAttribute("position",new Wi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const m=new ar(f,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=_t;let v=this.type;function _(n,i){const s=e.update(m);d.defines.VSM_SAMPLES!==n.blurSamples&&(d.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new nn(r.x,r.y)),d.uniforms.shadow_pass.value=n.map.texture,d.uniforms.resolution.value=n.mapSize,d.uniforms.radius.value=n.radius,t.setRenderTarget(n.mapPass),t.clear(),t.renderBufferDirect(i,null,s,d,m,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,t.setRenderTarget(n.map),t.clear(),t.renderBufferDirect(i,null,s,p,m,null)}function x(e,n,i,r){let s=null;const a=!0===i.isPointLight?e.customDistanceMaterial:e.customDepthMaterial;if(void 0!==a)s=a;else if(s=!0===i.isPointLight?l:o,t.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0){const t=s.uuid,e=n.uuid;let i=h[t];void 0===i&&(i={},h[t]=i);let r=i[e];void 0===r&&(r=s.clone(),i[e]=r,n.addEventListener("dispose",S)),s=r}if(s.visible=n.visible,s.wireframe=n.wireframe,s.side=r===yt?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:u[n.side],s.alphaMap=n.alphaMap,s.alphaTest=n.alphaTest,s.map=n.map,s.clipShadows=n.clipShadows,s.clippingPlanes=n.clippingPlanes,s.clipIntersection=n.clipIntersection,s.displacementMap=n.displacementMap,s.displacementScale=n.displacementScale,s.displacementBias=n.displacementBias,s.wireframeLinewidth=n.wireframeLinewidth,s.linewidth=n.linewidth,!0===i.isPointLight&&!0===s.isMeshDistanceMaterial){t.properties.get(s).light=i}return s}function y(n,r,s,a,o){if(!1===n.visible)return;if(n.layers.test(r.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&o===yt)&&(!n.frustumCulled||i.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,n.matrixWorld);const i=e.update(n),l=n.material;if(Array.isArray(l)){const e=i.groups;for(let h=0,c=e.length;h<c;h++){const c=e[h],u=l[c.materialIndex];if(u&&u.visible){const e=x(n,u,a,o);n.onBeforeShadow(t,n,r,s,i,e,c),t.renderBufferDirect(s,null,i,e,n,c),n.onAfterShadow(t,n,r,s,i,e,c)}}}else if(l.visible){const e=x(n,l,a,o);n.onBeforeShadow(t,n,r,s,i,e,null),t.renderBufferDirect(s,null,i,e,n,null),n.onAfterShadow(t,n,r,s,i,e,null)}}const l=n.children;for(let t=0,e=l.length;t<e;t++)y(l[t],r,s,a,o)}function S(t){t.target.removeEventListener("dispose",S);for(const e in h){const n=h[e],i=t.target.uuid;if(i in n){n[i].dispose(),delete n[i]}}}this.render=function(e,n,o){if(!1===g.enabled)return;if(!1===g.autoUpdate&&!1===g.needsUpdate)return;if(0===e.length)return;const l=t.getRenderTarget(),h=t.getActiveCubeFace(),u=t.getActiveMipmapLevel(),d=t.state;d.setBlending(0),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);const p=v!==yt&&this.type===yt,f=v===yt&&this.type!==yt;for(let m=0,g=e.length;m<g;m++){const l=e[m],h=l.shadow;if(void 0===h)continue;if(!1===h.autoUpdate&&!1===h.needsUpdate)continue;r.copy(h.mapSize);const u=h.getFrameExtents();if(r.multiply(u),s.copy(h.mapSize),(r.x>c||r.y>c)&&(r.x>c&&(s.x=Math.floor(c/u.x),r.x=s.x*u.x,h.mapSize.x=s.x),r.y>c&&(s.y=Math.floor(c/u.y),r.y=s.y*u.y,h.mapSize.y=s.y)),null===h.map||!0===p||!0===f){const t=this.type!==yt?{minFilter:Bt,magFilter:Bt}:{};null!==h.map&&h.map.dispose(),h.map=new nn(r.x,r.y,t),h.map.texture.name=l.name+".shadowMap",h.camera.updateProjectionMatrix()}t.setRenderTarget(h.map),t.clear();const g=h.getViewportCount();for(let t=0;t<g;t++){const e=h.getViewport(t);a.set(s.x*e.x,s.y*e.y,s.x*e.z,s.y*e.w),d.viewport(a),h.updateMatrices(l,t),i=h.getFrustum(),y(n,o,h.camera,l,this.type)}!0!==h.isPointLightShadow&&this.type===yt&&_(h,o),h.needsUpdate=!1}v=this.type,g.needsUpdate=!1,t.setRenderTarget(l,h,u)}}function io(t,e,n){const i=n.isWebGL2;const r=new function(){let e=!1;const n=new tn;let i=null;const r=new tn(0,0,0,0);return{setMask:function(n){i===n||e||(t.colorMask(n,n,n,n),i=n)},setLocked:function(t){e=t},setClear:function(e,i,s,a,o){!0===o&&(e*=a,i*=a,s*=a),n.set(e,i,s,a),!1===r.equals(n)&&(t.clearColor(e,i,s,a),r.copy(n))},reset:function(){e=!1,i=null,r.set(-1,0,0,0)}}},s=new function(){let e=!1,n=null,i=null,r=null;return{setTest:function(e){e?V(t.DEPTH_TEST):G(t.DEPTH_TEST)},setMask:function(i){n===i||e||(t.depthMask(i),n=i)},setFunc:function(e){if(i!==e){switch(e){case 0:t.depthFunc(t.NEVER);break;case 1:t.depthFunc(t.ALWAYS);break;case 2:t.depthFunc(t.LESS);break;case 3:default:t.depthFunc(t.LEQUAL);break;case 4:t.depthFunc(t.EQUAL);break;case 5:t.depthFunc(t.GEQUAL);break;case 6:t.depthFunc(t.GREATER);break;case 7:t.depthFunc(t.NOTEQUAL)}i=e}},setLocked:function(t){e=t},setClear:function(e){r!==e&&(t.clearDepth(e),r=e)},reset:function(){e=!1,n=null,i=null,r=null}}},a=new function(){let e=!1,n=null,i=null,r=null,s=null,a=null,o=null,l=null,h=null;return{setTest:function(n){e||(n?V(t.STENCIL_TEST):G(t.STENCIL_TEST))},setMask:function(i){n===i||e||(t.stencilMask(i),n=i)},setFunc:function(e,n,a){i===e&&r===n&&s===a||(t.stencilFunc(e,n,a),i=e,r=n,s=a)},setOp:function(e,n,i){a===e&&o===n&&l===i||(t.stencilOp(e,n,i),a=e,o=n,l=i)},setLocked:function(t){e=t},setClear:function(e){h!==e&&(t.clearStencil(e),h=e)},reset:function(){e=!1,n=null,i=null,r=null,s=null,a=null,o=null,l=null,h=null}}},o=new WeakMap,l=new WeakMap;let h={},c={},u=new WeakMap,d=[],p=null,f=!1,m=null,g=null,v=null,_=null,x=null,y=null,S=null,b=new wi(0,0,0),M=0,w=!1,C=null,T=null,E=null,A=null,P=null;const R=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let W=!1,L=0;const I=t.getParameter(t.VERSION);-1!==I.indexOf("WebGL")?(L=parseFloat(/^WebGL (\d)/.exec(I)[1]),W=L>=1):-1!==I.indexOf("OpenGL ES")&&(L=parseFloat(/^OpenGL ES (\d)/.exec(I)[1]),W=L>=2);let k=null,N={};const O=t.getParameter(t.SCISSOR_BOX),U=t.getParameter(t.VIEWPORT),D=(new tn).fromArray(O),F=(new tn).fromArray(U);function B(e,n,r,s){const a=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let l=0;l<r;l++)!i||e!==t.TEXTURE_3D&&e!==t.TEXTURE_2D_ARRAY?t.texImage2D(n+l,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,a):t.texImage3D(n,0,t.RGBA,1,1,s,0,t.RGBA,t.UNSIGNED_BYTE,a);return o}const z={};function V(e){!0!==h[e]&&(t.enable(e),h[e]=!0)}function G(e){!1!==h[e]&&(t.disable(e),h[e]=!1)}z[t.TEXTURE_2D]=B(t.TEXTURE_2D,t.TEXTURE_2D,1),z[t.TEXTURE_CUBE_MAP]=B(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(z[t.TEXTURE_2D_ARRAY]=B(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),z[t.TEXTURE_3D]=B(t.TEXTURE_3D,t.TEXTURE_3D,1,1)),r.setClear(0,0,0,1),s.setClear(1),a.setClear(0),V(t.DEPTH_TEST),s.setFunc(3),j(!1),J(1),V(t.CULL_FACE),X(0);const H={[Mt]:t.FUNC_ADD,101:t.FUNC_SUBTRACT,102:t.FUNC_REVERSE_SUBTRACT};if(i)H[103]=t.MIN,H[104]=t.MAX;else{const t=e.get("EXT_blend_minmax");null!==t&&(H[103]=t.MIN_EXT,H[104]=t.MAX_EXT)}const q={200:t.ZERO,201:t.ONE,202:t.SRC_COLOR,204:t.SRC_ALPHA,210:t.SRC_ALPHA_SATURATE,208:t.DST_COLOR,206:t.DST_ALPHA,203:t.ONE_MINUS_SRC_COLOR,205:t.ONE_MINUS_SRC_ALPHA,209:t.ONE_MINUS_DST_COLOR,207:t.ONE_MINUS_DST_ALPHA,211:t.CONSTANT_COLOR,212:t.ONE_MINUS_CONSTANT_COLOR,213:t.CONSTANT_ALPHA,214:t.ONE_MINUS_CONSTANT_ALPHA};function X(e,n,i,r,s,a,o,l,h,c){if(0!==e){if(!1===f&&(V(t.BLEND),f=!0),5===e)s=s||n,a=a||i,o=o||r,n===g&&s===x||(t.blendEquationSeparate(H[n],H[s]),g=n,x=s),i===v&&r===_&&a===y&&o===S||(t.blendFuncSeparate(q[i],q[r],q[a],q[o]),v=i,_=r,y=a,S=o),!1!==l.equals(b)&&h===M||(t.blendColor(l.r,l.g,l.b,h),b.copy(l),M=h),m=e,w=!1;else if(e!==m||c!==w){if(g===Mt&&x===Mt||(t.blendEquation(t.FUNC_ADD),g=Mt,x=Mt),c)switch(e){case 1:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case 2:t.blendFunc(t.ONE,t.ONE);break;case 3:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case 4:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)}else switch(e){case 1:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case 2:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case 3:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case 4:t.blendFunc(t.ZERO,t.SRC_COLOR)}v=null,_=null,y=null,S=null,b.set(0,0,0),M=0,m=e,w=c}}else!0===f&&(G(t.BLEND),f=!1)}function j(e){C!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),C=e)}function J(e){0!==e?(V(t.CULL_FACE),e!==T&&(1===e?t.cullFace(t.BACK):2===e?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):G(t.CULL_FACE),T=e}function Q(e,n,i){e?(V(t.POLYGON_OFFSET_FILL),A===n&&P===i||(t.polygonOffset(n,i),A=n,P=i)):G(t.POLYGON_OFFSET_FILL)}return{buffers:{color:r,depth:s,stencil:a},enable:V,disable:G,bindFramebuffer:function(e,n){return c[e]!==n&&(t.bindFramebuffer(e,n),c[e]=n,i&&(e===t.DRAW_FRAMEBUFFER&&(c[t.FRAMEBUFFER]=n),e===t.FRAMEBUFFER&&(c[t.DRAW_FRAMEBUFFER]=n)),!0)},drawBuffers:function(i,r){let s=d,a=!1;if(i)if(s=u.get(r),void 0===s&&(s=[],u.set(r,s)),i.isWebGLMultipleRenderTargets){const e=i.texture;if(s.length!==e.length||s[0]!==t.COLOR_ATTACHMENT0){for(let n=0,i=e.length;n<i;n++)s[n]=t.COLOR_ATTACHMENT0+n;s.length=e.length,a=!0}}else s[0]!==t.COLOR_ATTACHMENT0&&(s[0]=t.COLOR_ATTACHMENT0,a=!0);else s[0]!==t.BACK&&(s[0]=t.BACK,a=!0);a&&(n.isWebGL2?t.drawBuffers(s):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(s))},useProgram:function(e){return p!==e&&(t.useProgram(e),p=e,!0)},setBlending:X,setMaterial:function(e,n){2===e.side?G(t.CULL_FACE):V(t.CULL_FACE);let i=e.side===bt;n&&(i=!i),j(i),1===e.blending&&!1===e.transparent?X(0):X(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.blendColor,e.blendAlpha,e.premultipliedAlpha),s.setFunc(e.depthFunc),s.setTest(e.depthTest),s.setMask(e.depthWrite),r.setMask(e.colorWrite);const o=e.stencilWrite;a.setTest(o),o&&(a.setMask(e.stencilWriteMask),a.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),a.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),Q(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?V(t.SAMPLE_ALPHA_TO_COVERAGE):G(t.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:j,setCullFace:J,setLineWidth:function(e){e!==E&&(W&&t.lineWidth(e),E=e)},setPolygonOffset:Q,setScissorTest:function(e){e?V(t.SCISSOR_TEST):G(t.SCISSOR_TEST)},activeTexture:function(e){void 0===e&&(e=t.TEXTURE0+R-1),k!==e&&(t.activeTexture(e),k=e)},bindTexture:function(e,n,i){void 0===i&&(i=null===k?t.TEXTURE0+R-1:k);let r=N[i];void 0===r&&(r={type:void 0,texture:void 0},N[i]=r),r.type===e&&r.texture===n||(k!==i&&(t.activeTexture(i),k=i),t.bindTexture(e,n||z[e]),r.type=e,r.texture=n)},unbindTexture:function(){const e=N[k];void 0!==e&&void 0!==e.type&&(t.bindTexture(e.type,null),e.type=void 0,e.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(e){}},compressedTexImage3D:function(){try{t.compressedTexImage3D.apply(t,arguments)}catch(e){}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(e){}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(e){}},updateUBOMapping:function(e,n){let i=l.get(n);void 0===i&&(i=new WeakMap,l.set(n,i));let r=i.get(e);void 0===r&&(r=t.getUniformBlockIndex(n,e.name),i.set(e,r))},uniformBlockBinding:function(e,n){const i=l.get(n).get(e);o.get(n)!==i&&(t.uniformBlockBinding(n,i,e.__bindingPointIndex),o.set(n,i))},texStorage2D:function(){try{t.texStorage2D.apply(t,arguments)}catch(e){}},texStorage3D:function(){try{t.texStorage3D.apply(t,arguments)}catch(e){}},texSubImage2D:function(){try{t.texSubImage2D.apply(t,arguments)}catch(e){}},texSubImage3D:function(){try{t.texSubImage3D.apply(t,arguments)}catch(e){}},compressedTexSubImage2D:function(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(e){}},compressedTexSubImage3D:function(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(e){}},scissor:function(e){!1===D.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),D.copy(e))},viewport:function(e){!1===F.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),F.copy(e))},reset:function(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),!0===i&&(t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),h={},k=null,N={},c={},u=new WeakMap,d=[],p=null,f=!1,m=null,g=null,v=null,_=null,x=null,y=null,S=null,b=new wi(0,0,0),M=0,w=!1,C=null,T=null,E=null,A=null,P=null,D.set(0,0,t.canvas.width,t.canvas.height),F.set(0,0,t.canvas.width,t.canvas.height),r.reset(),s.reset(),a.reset()}}}function ro(t,e,n,i,r,s,a){const o=r.isWebGL2,l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,h="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),c=new WeakMap;let u;const d=new WeakMap;let p=!1;try{p="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(F){}function f(t,e){return p?new OffscreenCanvas(t,e):Oe("canvas")}function m(t,e,n,i){let r=1;if((t.width>i||t.height>i)&&(r=i/Math.max(t.width,t.height)),r<1||!0===e){if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap){const i=e?Pe:Math.floor,s=i(r*t.width),a=i(r*t.height);void 0===u&&(u=f(s,a));const o=n?f(s,a):u;o.width=s,o.height=a;return o.getContext("2d").drawImage(t,0,0,s,a),o}return t}return t}function g(t){return Ae(t.width)&&Ae(t.height)}function v(t,e){return t.generateMipmaps&&e&&t.minFilter!==Bt&&t.minFilter!==Vt}function _(e){t.generateMipmap(e)}function x(n,i,r,s,a=!1){if(!1===o)return i;if(null!==n&&void 0!==t[n])return t[n];let l=i;if(i===t.RED&&(r===t.FLOAT&&(l=t.R32F),r===t.HALF_FLOAT&&(l=t.R16F),r===t.UNSIGNED_BYTE&&(l=t.R8)),i===t.RED_INTEGER&&(r===t.UNSIGNED_BYTE&&(l=t.R8UI),r===t.UNSIGNED_SHORT&&(l=t.R16UI),r===t.UNSIGNED_INT&&(l=t.R32UI),r===t.BYTE&&(l=t.R8I),r===t.SHORT&&(l=t.R16I),r===t.INT&&(l=t.R32I)),i===t.RG&&(r===t.FLOAT&&(l=t.RG32F),r===t.HALF_FLOAT&&(l=t.RG16F),r===t.UNSIGNED_BYTE&&(l=t.RG8)),i===t.RGBA){const e=a?de:He.getTransfer(s);r===t.FLOAT&&(l=t.RGBA32F),r===t.HALF_FLOAT&&(l=t.RGBA16F),r===t.UNSIGNED_BYTE&&(l=e===pe?t.SRGB8_ALPHA8:t.RGBA8),r===t.UNSIGNED_SHORT_4_4_4_4&&(l=t.RGBA4),r===t.UNSIGNED_SHORT_5_5_5_1&&(l=t.RGB5_A1)}return l!==t.R16F&&l!==t.R32F&&l!==t.RG16F&&l!==t.RG32F&&l!==t.RGBA16F&&l!==t.RGBA32F||e.get("EXT_color_buffer_float"),l}function y(t,e,n){return!0===v(t,n)||t.isFramebufferTexture&&t.minFilter!==Bt&&t.minFilter!==Vt?Math.log2(Math.max(e.width,e.height))+1:void 0!==t.mipmaps&&t.mipmaps.length>0?t.mipmaps.length:t.isCompressedTexture&&Array.isArray(t.image)?e.mipmaps.length:1}function S(e){return e===Bt||1004===e||e===zt?t.NEAREST:t.LINEAR}function b(t){const e=t.target;e.removeEventListener("dispose",b),function(t){const e=i.get(t);if(void 0===e.__webglInit)return;const n=t.source,r=d.get(n);if(r){const i=r[e.__cacheKey];i.usedTimes--,0===i.usedTimes&&w(t),0===Object.keys(r).length&&d.delete(n)}i.remove(t)}(e),e.isVideoTexture&&c.delete(e)}function M(e){const n=e.target;n.removeEventListener("dispose",M),function(e){const n=e.texture,r=i.get(e),s=i.get(n);void 0!==s.__webglTexture&&(t.deleteTexture(s.__webglTexture),a.memory.textures--);e.depthTexture&&e.depthTexture.dispose();if(e.isWebGLCubeRenderTarget)for(let i=0;i<6;i++){if(Array.isArray(r.__webglFramebuffer[i]))for(let e=0;e<r.__webglFramebuffer[i].length;e++)t.deleteFramebuffer(r.__webglFramebuffer[i][e]);else t.deleteFramebuffer(r.__webglFramebuffer[i]);r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer[i])}else{if(Array.isArray(r.__webglFramebuffer))for(let e=0;e<r.__webglFramebuffer.length;e++)t.deleteFramebuffer(r.__webglFramebuffer[e]);else t.deleteFramebuffer(r.__webglFramebuffer);if(r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer),r.__webglMultisampledFramebuffer&&t.deleteFramebuffer(r.__webglMultisampledFramebuffer),r.__webglColorRenderbuffer)for(let e=0;e<r.__webglColorRenderbuffer.length;e++)r.__webglColorRenderbuffer[e]&&t.deleteRenderbuffer(r.__webglColorRenderbuffer[e]);r.__webglDepthRenderbuffer&&t.deleteRenderbuffer(r.__webglDepthRenderbuffer)}if(e.isWebGLMultipleRenderTargets)for(let o=0,l=n.length;o<l;o++){const e=i.get(n[o]);e.__webglTexture&&(t.deleteTexture(e.__webglTexture),a.memory.textures--),i.remove(n[o])}i.remove(n),i.remove(e)}(n)}function w(e){const n=i.get(e);t.deleteTexture(n.__webglTexture);const r=e.source;delete d.get(r)[n.__cacheKey],a.memory.textures--}let C=0;function T(e,r){const s=i.get(e);if(e.isVideoTexture&&function(t){const e=a.render.frame;c.get(t)!==e&&(c.set(t,e),t.update())}(e),!1===e.isRenderTargetTexture&&e.version>0&&s.__version!==e.version){const t=e.image;if(null===t);else if(!1!==t.complete)return void L(s,e,r)}n.bindTexture(t.TEXTURE_2D,s.__webglTexture,t.TEXTURE0+r)}const E={[Ut]:t.REPEAT,[Dt]:t.CLAMP_TO_EDGE,[Ft]:t.MIRRORED_REPEAT},A={[Bt]:t.NEAREST,1004:t.NEAREST_MIPMAP_NEAREST,[zt]:t.NEAREST_MIPMAP_LINEAR,[Vt]:t.LINEAR,[Gt]:t.LINEAR_MIPMAP_NEAREST,[Ht]:t.LINEAR_MIPMAP_LINEAR},P={512:t.NEVER,519:t.ALWAYS,513:t.LESS,515:t.LEQUAL,514:t.EQUAL,518:t.GEQUAL,516:t.GREATER,517:t.NOTEQUAL};function R(n,s,a){if(s.type===Qt&&!1===e.has("OES_texture_float_linear")&&(s.magFilter===Vt||s.magFilter===Gt||s.magFilter===zt||s.magFilter===Ht||s.minFilter===Vt||s.minFilter===Gt||s.minFilter===zt||s.minFilter),a?(t.texParameteri(n,t.TEXTURE_WRAP_S,E[s.wrapS]),t.texParameteri(n,t.TEXTURE_WRAP_T,E[s.wrapT]),n!==t.TEXTURE_3D&&n!==t.TEXTURE_2D_ARRAY||t.texParameteri(n,t.TEXTURE_WRAP_R,E[s.wrapR]),t.texParameteri(n,t.TEXTURE_MAG_FILTER,A[s.magFilter]),t.texParameteri(n,t.TEXTURE_MIN_FILTER,A[s.minFilter])):(t.texParameteri(n,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(n,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),n!==t.TEXTURE_3D&&n!==t.TEXTURE_2D_ARRAY||t.texParameteri(n,t.TEXTURE_WRAP_R,t.CLAMP_TO_EDGE),s.wrapS!==Dt||s.wrapT,t.texParameteri(n,t.TEXTURE_MAG_FILTER,S(s.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,S(s.minFilter)),s.minFilter!==Bt&&s.minFilter),s.compareFunction&&(t.texParameteri(n,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(n,t.TEXTURE_COMPARE_FUNC,P[s.compareFunction])),!0===e.has("EXT_texture_filter_anisotropic")){const a=e.get("EXT_texture_filter_anisotropic");if(s.magFilter===Bt)return;if(s.minFilter!==zt&&s.minFilter!==Ht)return;if(s.type===Qt&&!1===e.has("OES_texture_float_linear"))return;if(!1===o&&s.type===Kt&&!1===e.has("OES_texture_half_float_linear"))return;(s.anisotropy>1||i.get(s).__currentAnisotropy)&&(t.texParameterf(n,a.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,r.getMaxAnisotropy())),i.get(s).__currentAnisotropy=s.anisotropy)}}function W(e,n){let i=!1;void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",b));const r=n.source;let s=d.get(r);void 0===s&&(s={},d.set(r,s));const o=function(t){const e=[];return e.push(t.wrapS),e.push(t.wrapT),e.push(t.wrapR||0),e.push(t.magFilter),e.push(t.minFilter),e.push(t.anisotropy),e.push(t.internalFormat),e.push(t.format),e.push(t.type),e.push(t.generateMipmaps),e.push(t.premultiplyAlpha),e.push(t.flipY),e.push(t.unpackAlignment),e.push(t.colorSpace),e.join()}(n);if(o!==e.__cacheKey){void 0===s[o]&&(s[o]={texture:t.createTexture(),usedTimes:0},a.memory.textures++,i=!0),s[o].usedTimes++;const r=s[e.__cacheKey];void 0!==r&&(s[e.__cacheKey].usedTimes--,0===r.usedTimes&&w(n)),e.__cacheKey=o,e.__webglTexture=s[o].texture}return i}function L(e,a,l){let h=t.TEXTURE_2D;(a.isDataArrayTexture||a.isCompressedArrayTexture)&&(h=t.TEXTURE_2D_ARRAY),a.isData3DTexture&&(h=t.TEXTURE_3D);const c=W(e,a),u=a.source;n.bindTexture(h,e.__webglTexture,t.TEXTURE0+l);const d=i.get(u);if(u.version!==d.__version||!0===c){n.activeTexture(t.TEXTURE0+l);const e=He.getPrimaries(He.workingColorSpace),i=a.colorSpace===oe?null:He.getPrimaries(a.colorSpace),p=a.colorSpace===oe||e===i?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,a.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,a.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,p);const f=function(t){return!o&&(t.wrapS!==Dt||t.wrapT!==Dt||t.minFilter!==Bt&&t.minFilter!==Vt)}(a)&&!1===g(a.image);let S=m(a.image,f,!1,r.maxTextureSize);S=D(a,S);const b=g(S)||o,M=s.convert(a.format,a.colorSpace);let w,C=s.convert(a.type),T=x(a.internalFormat,M,C,a.colorSpace,a.isVideoTexture);R(h,a,b);const E=a.mipmaps,A=o&&!0!==a.isVideoTexture&&36196!==T,P=void 0===d.__version||!0===c,W=u.dataReady,L=y(a,S,b);if(a.isDepthTexture)T=t.DEPTH_COMPONENT,o?T=a.type===Qt?t.DEPTH_COMPONENT32F:a.type===Jt?t.DEPTH_COMPONENT24:a.type===Zt?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT16:a.type,a.format===$t&&T===t.DEPTH_COMPONENT&&a.type!==Xt&&a.type!==Jt&&(a.type=Jt,C=s.convert(a.type)),a.format===te&&T===t.DEPTH_COMPONENT&&(T=t.DEPTH_STENCIL,a.type!==Zt&&(a.type=Zt,C=s.convert(a.type))),P&&(A?n.texStorage2D(t.TEXTURE_2D,1,T,S.width,S.height):n.texImage2D(t.TEXTURE_2D,0,T,S.width,S.height,0,M,C,null));else if(a.isDataTexture)if(E.length>0&&b){A&&P&&n.texStorage2D(t.TEXTURE_2D,L,T,E[0].width,E[0].height);for(let e=0,i=E.length;e<i;e++)w=E[e],A?W&&n.texSubImage2D(t.TEXTURE_2D,e,0,0,w.width,w.height,M,C,w.data):n.texImage2D(t.TEXTURE_2D,e,T,w.width,w.height,0,M,C,w.data);a.generateMipmaps=!1}else A?(P&&n.texStorage2D(t.TEXTURE_2D,L,T,S.width,S.height),W&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,S.width,S.height,M,C,S.data)):n.texImage2D(t.TEXTURE_2D,0,T,S.width,S.height,0,M,C,S.data);else if(a.isCompressedTexture)if(a.isCompressedArrayTexture){A&&P&&n.texStorage3D(t.TEXTURE_2D_ARRAY,L,T,E[0].width,E[0].height,S.depth);for(let e=0,i=E.length;e<i;e++)w=E[e],a.format!==Yt?null!==M&&(A?W&&n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,0,w.width,w.height,S.depth,M,w.data,0,0):n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,e,T,w.width,w.height,S.depth,0,w.data,0,0)):A?W&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,e,0,0,0,w.width,w.height,S.depth,M,C,w.data):n.texImage3D(t.TEXTURE_2D_ARRAY,e,T,w.width,w.height,S.depth,0,M,C,w.data)}else{A&&P&&n.texStorage2D(t.TEXTURE_2D,L,T,E[0].width,E[0].height);for(let e=0,i=E.length;e<i;e++)w=E[e],a.format!==Yt?null!==M&&(A?W&&n.compressedTexSubImage2D(t.TEXTURE_2D,e,0,0,w.width,w.height,M,w.data):n.compressedTexImage2D(t.TEXTURE_2D,e,T,w.width,w.height,0,w.data)):A?W&&n.texSubImage2D(t.TEXTURE_2D,e,0,0,w.width,w.height,M,C,w.data):n.texImage2D(t.TEXTURE_2D,e,T,w.width,w.height,0,M,C,w.data)}else if(a.isDataArrayTexture)A?(P&&n.texStorage3D(t.TEXTURE_2D_ARRAY,L,T,S.width,S.height,S.depth),W&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,S.width,S.height,S.depth,M,C,S.data)):n.texImage3D(t.TEXTURE_2D_ARRAY,0,T,S.width,S.height,S.depth,0,M,C,S.data);else if(a.isData3DTexture)A?(P&&n.texStorage3D(t.TEXTURE_3D,L,T,S.width,S.height,S.depth),W&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,S.width,S.height,S.depth,M,C,S.data)):n.texImage3D(t.TEXTURE_3D,0,T,S.width,S.height,S.depth,0,M,C,S.data);else if(a.isFramebufferTexture){if(P)if(A)n.texStorage2D(t.TEXTURE_2D,L,T,S.width,S.height);else{let e=S.width,i=S.height;for(let r=0;r<L;r++)n.texImage2D(t.TEXTURE_2D,r,T,e,i,0,M,C,null),e>>=1,i>>=1}}else if(E.length>0&&b){A&&P&&n.texStorage2D(t.TEXTURE_2D,L,T,E[0].width,E[0].height);for(let e=0,i=E.length;e<i;e++)w=E[e],A?W&&n.texSubImage2D(t.TEXTURE_2D,e,0,0,M,C,w):n.texImage2D(t.TEXTURE_2D,e,T,M,C,w);a.generateMipmaps=!1}else A?(P&&n.texStorage2D(t.TEXTURE_2D,L,T,S.width,S.height),W&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,M,C,S)):n.texImage2D(t.TEXTURE_2D,0,T,M,C,S);v(a,b)&&_(h),d.__version=u.version,a.onUpdate&&a.onUpdate(a)}e.__version=a.version}function I(e,r,a,o,h,c){const u=s.convert(a.format,a.colorSpace),d=s.convert(a.type),p=x(a.internalFormat,u,d,a.colorSpace);if(!i.get(r).__hasExternalTextures){const e=Math.max(1,r.width>>c),i=Math.max(1,r.height>>c);h===t.TEXTURE_3D||h===t.TEXTURE_2D_ARRAY?n.texImage3D(h,c,p,e,i,r.depth,0,u,d,null):n.texImage2D(h,c,p,e,i,0,u,d,null)}n.bindFramebuffer(t.FRAMEBUFFER,e),U(r)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,o,h,i.get(a).__webglTexture,0,O(r)):(h===t.TEXTURE_2D||h>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&h<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,o,h,i.get(a).__webglTexture,c),n.bindFramebuffer(t.FRAMEBUFFER,null)}function k(e,n,i){if(t.bindRenderbuffer(t.RENDERBUFFER,e),n.depthBuffer&&!n.stencilBuffer){let r=!0===o?t.DEPTH_COMPONENT24:t.DEPTH_COMPONENT16;if(i||U(n)){const e=n.depthTexture;e&&e.isDepthTexture&&(e.type===Qt?r=t.DEPTH_COMPONENT32F:e.type===Jt&&(r=t.DEPTH_COMPONENT24));const i=O(n);U(n)?l.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,i,r,n.width,n.height):t.renderbufferStorageMultisample(t.RENDERBUFFER,i,r,n.width,n.height)}else t.renderbufferStorage(t.RENDERBUFFER,r,n.width,n.height);t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)}else if(n.depthBuffer&&n.stencilBuffer){const r=O(n);i&&!1===U(n)?t.renderbufferStorageMultisample(t.RENDERBUFFER,r,t.DEPTH24_STENCIL8,n.width,n.height):U(n)?l.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,r,t.DEPTH24_STENCIL8,n.width,n.height):t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)}else{const e=!0===n.isWebGLMultipleRenderTargets?n.texture:[n.texture];for(let r=0;r<e.length;r++){const a=e[r],o=s.convert(a.format,a.colorSpace),h=s.convert(a.type),c=x(a.internalFormat,o,h,a.colorSpace),u=O(n);i&&!1===U(n)?t.renderbufferStorageMultisample(t.RENDERBUFFER,u,c,n.width,n.height):U(n)?l.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,u,c,n.width,n.height):t.renderbufferStorage(t.RENDERBUFFER,c,n.width,n.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function N(e){const r=i.get(e),s=!0===e.isWebGLCubeRenderTarget;if(e.depthTexture&&!r.__autoAllocateDepthBuffer){if(s)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,r){if(r&&r.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,e),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),T(r.depthTexture,0);const s=i.get(r.depthTexture).__webglTexture,a=O(r);if(r.depthTexture.format===$t)U(r)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,s,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,s,0);else{if(r.depthTexture.format!==te)throw new Error("Unknown depthTexture format");U(r)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,s,0,a):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,s,0)}}(r.__webglFramebuffer,e)}else if(s){r.__webglDepthbuffer=[];for(let i=0;i<6;i++)n.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer[i]),r.__webglDepthbuffer[i]=t.createRenderbuffer(),k(r.__webglDepthbuffer[i],e,!1)}else n.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer),r.__webglDepthbuffer=t.createRenderbuffer(),k(r.__webglDepthbuffer,e,!1);n.bindFramebuffer(t.FRAMEBUFFER,null)}function O(t){return Math.min(r.maxSamples,t.samples)}function U(t){const n=i.get(t);return o&&t.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function D(t,n){const i=t.colorSpace,r=t.format;t.type;return!0===t.isCompressedTexture||!0===t.isVideoTexture||t.format===_e||i!==he&&i!==oe&&He.getTransfer(i)===pe&&!1===o&&(!0===e.has("EXT_sRGB")&&r===Yt?(t.format=_e,t.minFilter=Vt,t.generateMipmaps=!1):n=Je.sRGBToLinear(n)),n}this.allocateTextureUnit=function(){const t=C;return r.maxTextures,C+=1,t},this.resetTextureUnits=function(){C=0},this.setTexture2D=T,this.setTexture2DArray=function(e,r){const s=i.get(e);e.version>0&&s.__version!==e.version?L(s,e,r):n.bindTexture(t.TEXTURE_2D_ARRAY,s.__webglTexture,t.TEXTURE0+r)},this.setTexture3D=function(e,r){const s=i.get(e);e.version>0&&s.__version!==e.version?L(s,e,r):n.bindTexture(t.TEXTURE_3D,s.__webglTexture,t.TEXTURE0+r)},this.setTextureCube=function(e,a){const l=i.get(e);e.version>0&&l.__version!==e.version?function(e,a,l){if(6!==a.image.length)return;const h=W(e,a),c=a.source;n.bindTexture(t.TEXTURE_CUBE_MAP,e.__webglTexture,t.TEXTURE0+l);const u=i.get(c);if(c.version!==u.__version||!0===h){n.activeTexture(t.TEXTURE0+l);const e=He.getPrimaries(He.workingColorSpace),i=a.colorSpace===oe?null:He.getPrimaries(a.colorSpace),d=a.colorSpace===oe||e===i?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,a.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,a.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,d);const p=a.isCompressedTexture||a.image[0].isCompressedTexture,f=a.image[0]&&a.image[0].isDataTexture,S=[];for(let t=0;t<6;t++)S[t]=p||f?f?a.image[t].image:a.image[t]:m(a.image[t],!1,!0,r.maxCubemapSize),S[t]=D(a,S[t]);const b=S[0],M=g(b)||o,w=s.convert(a.format,a.colorSpace),C=s.convert(a.type),T=x(a.internalFormat,w,C,a.colorSpace),E=o&&!0!==a.isVideoTexture,A=void 0===u.__version||!0===h,P=c.dataReady;let W,L=y(a,b,M);if(R(t.TEXTURE_CUBE_MAP,a,M),p){E&&A&&n.texStorage2D(t.TEXTURE_CUBE_MAP,L,T,b.width,b.height);for(let e=0;e<6;e++){W=S[e].mipmaps;for(let i=0;i<W.length;i++){const r=W[i];a.format!==Yt?null!==w&&(E?P&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i,0,0,r.width,r.height,w,r.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i,T,r.width,r.height,0,r.data)):E?P&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i,0,0,r.width,r.height,w,C,r.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i,T,r.width,r.height,0,w,C,r.data)}}}else{W=a.mipmaps,E&&A&&(W.length>0&&L++,n.texStorage2D(t.TEXTURE_CUBE_MAP,L,T,S[0].width,S[0].height));for(let e=0;e<6;e++)if(f){E?P&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,S[e].width,S[e].height,w,C,S[e].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,T,S[e].width,S[e].height,0,w,C,S[e].data);for(let i=0;i<W.length;i++){const r=W[i].image[e].image;E?P&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i+1,0,0,r.width,r.height,w,C,r.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i+1,T,r.width,r.height,0,w,C,r.data)}}else{E?P&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,0,0,w,C,S[e]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,T,w,C,S[e]);for(let i=0;i<W.length;i++){const r=W[i];E?P&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i+1,0,0,w,C,r.image[e]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i+1,T,w,C,r.image[e])}}}v(a,M)&&_(t.TEXTURE_CUBE_MAP),u.__version=c.version,a.onUpdate&&a.onUpdate(a)}e.__version=a.version}(l,e,a):n.bindTexture(t.TEXTURE_CUBE_MAP,l.__webglTexture,t.TEXTURE0+a)},this.rebindTextures=function(e,n,r){const s=i.get(e);void 0!==n&&I(s.__webglFramebuffer,e,e.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),void 0!==r&&N(e)},this.setupRenderTarget=function(e){const l=e.texture,h=i.get(e),c=i.get(l);e.addEventListener("dispose",M),!0!==e.isWebGLMultipleRenderTargets&&(void 0===c.__webglTexture&&(c.__webglTexture=t.createTexture()),c.__version=l.version,a.memory.textures++);const u=!0===e.isWebGLCubeRenderTarget,d=!0===e.isWebGLMultipleRenderTargets,p=g(e)||o;if(u){h.__webglFramebuffer=[];for(let e=0;e<6;e++)if(o&&l.mipmaps&&l.mipmaps.length>0){h.__webglFramebuffer[e]=[];for(let n=0;n<l.mipmaps.length;n++)h.__webglFramebuffer[e][n]=t.createFramebuffer()}else h.__webglFramebuffer[e]=t.createFramebuffer()}else{if(o&&l.mipmaps&&l.mipmaps.length>0){h.__webglFramebuffer=[];for(let e=0;e<l.mipmaps.length;e++)h.__webglFramebuffer[e]=t.createFramebuffer()}else h.__webglFramebuffer=t.createFramebuffer();if(d&&r.drawBuffers){const n=e.texture;for(let e=0,r=n.length;e<r;e++){const r=i.get(n[e]);void 0===r.__webglTexture&&(r.__webglTexture=t.createTexture(),a.memory.textures++)}}if(o&&e.samples>0&&!1===U(e)){const i=d?l:[l];h.__webglMultisampledFramebuffer=t.createFramebuffer(),h.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,h.__webglMultisampledFramebuffer);for(let n=0;n<i.length;n++){const r=i[n];h.__webglColorRenderbuffer[n]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,h.__webglColorRenderbuffer[n]);const a=s.convert(r.format,r.colorSpace),o=s.convert(r.type),l=x(r.internalFormat,a,o,r.colorSpace,!0===e.isXRRenderTarget),c=O(e);t.renderbufferStorageMultisample(t.RENDERBUFFER,c,l,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+n,t.RENDERBUFFER,h.__webglColorRenderbuffer[n])}t.bindRenderbuffer(t.RENDERBUFFER,null),e.depthBuffer&&(h.__webglDepthRenderbuffer=t.createRenderbuffer(),k(h.__webglDepthRenderbuffer,e,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(u){n.bindTexture(t.TEXTURE_CUBE_MAP,c.__webglTexture),R(t.TEXTURE_CUBE_MAP,l,p);for(let n=0;n<6;n++)if(o&&l.mipmaps&&l.mipmaps.length>0)for(let i=0;i<l.mipmaps.length;i++)I(h.__webglFramebuffer[n][i],e,l,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+n,i);else I(h.__webglFramebuffer[n],e,l,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+n,0);v(l,p)&&_(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(d){const r=e.texture;for(let s=0,a=r.length;s<a;s++){const a=r[s],o=i.get(a);n.bindTexture(t.TEXTURE_2D,o.__webglTexture),R(t.TEXTURE_2D,a,p),I(h.__webglFramebuffer,e,a,t.COLOR_ATTACHMENT0+s,t.TEXTURE_2D,0),v(a,p)&&_(t.TEXTURE_2D)}n.unbindTexture()}else{let i=t.TEXTURE_2D;if((e.isWebGL3DRenderTarget||e.isWebGLArrayRenderTarget)&&o&&(i=e.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(i,c.__webglTexture),R(i,l,p),o&&l.mipmaps&&l.mipmaps.length>0)for(let n=0;n<l.mipmaps.length;n++)I(h.__webglFramebuffer[n],e,l,t.COLOR_ATTACHMENT0,i,n);else I(h.__webglFramebuffer,e,l,t.COLOR_ATTACHMENT0,i,0);v(l,p)&&_(i),n.unbindTexture()}e.depthBuffer&&N(e)},this.updateRenderTargetMipmap=function(e){const r=g(e)||o,s=!0===e.isWebGLMultipleRenderTargets?e.texture:[e.texture];for(let a=0,o=s.length;a<o;a++){const o=s[a];if(v(o,r)){const r=e.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,s=i.get(o).__webglTexture;n.bindTexture(r,s),_(r),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(e){if(o&&e.samples>0&&!1===U(e)){const r=e.isWebGLMultipleRenderTargets?e.texture:[e.texture],s=e.width,a=e.height;let o=t.COLOR_BUFFER_BIT;const l=[],c=e.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,u=i.get(e),d=!0===e.isWebGLMultipleRenderTargets;if(d)for(let e=0;e<r.length;e++)n.bindFramebuffer(t.FRAMEBUFFER,u.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,u.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,u.__webglMultisampledFramebuffer),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,u.__webglFramebuffer);for(let n=0;n<r.length;n++){l.push(t.COLOR_ATTACHMENT0+n),e.depthBuffer&&l.push(c);const p=void 0!==u.__ignoreDepthValues&&u.__ignoreDepthValues;if(!1===p&&(e.depthBuffer&&(o|=t.DEPTH_BUFFER_BIT),e.stencilBuffer&&(o|=t.STENCIL_BUFFER_BIT)),d&&t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,u.__webglColorRenderbuffer[n]),!0===p&&(t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[c]),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[c])),d){const e=i.get(r[n]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0)}t.blitFramebuffer(0,0,s,a,0,0,s,a,o,t.NEAREST),h&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,l)}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),d)for(let e=0;e<r.length;e++){n.bindFramebuffer(t.FRAMEBUFFER,u.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.RENDERBUFFER,u.__webglColorRenderbuffer[e]);const s=i.get(r[e]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,u.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+e,t.TEXTURE_2D,s,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,u.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=N,this.setupFrameBufferTexture=I,this.useMultisampledRTT=U}function so(t,e,n){const i=n.isWebGL2;return{convert:function(n,r=""){let s;const a=He.getTransfer(r);if(n===qt)return t.UNSIGNED_BYTE;if(1017===n)return t.UNSIGNED_SHORT_4_4_4_4;if(1018===n)return t.UNSIGNED_SHORT_5_5_5_1;if(1010===n)return t.BYTE;if(1011===n)return t.SHORT;if(n===Xt)return t.UNSIGNED_SHORT;if(n===jt)return t.INT;if(n===Jt)return t.UNSIGNED_INT;if(n===Qt)return t.FLOAT;if(n===Kt)return i?t.HALF_FLOAT:(s=e.get("OES_texture_half_float"),null!==s?s.HALF_FLOAT_OES:null);if(1021===n)return t.ALPHA;if(n===Yt)return t.RGBA;if(1024===n)return t.LUMINANCE;if(1025===n)return t.LUMINANCE_ALPHA;if(n===$t)return t.DEPTH_COMPONENT;if(n===te)return t.DEPTH_STENCIL;if(n===_e)return s=e.get("EXT_sRGB"),null!==s?s.SRGB_ALPHA_EXT:null;if(1028===n)return t.RED;if(1029===n)return t.RED_INTEGER;if(1030===n)return t.RG;if(1031===n)return t.RG_INTEGER;if(1033===n)return t.RGBA_INTEGER;if(n===ee||n===ne||n===ie||n===re)if(a===pe){if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===s)return null;if(n===ee)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===ne)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===ie)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===re)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(s=e.get("WEBGL_compressed_texture_s3tc"),null===s)return null;if(n===ee)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===ne)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===ie)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===re)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===n||35841===n||35842===n||35843===n){if(s=e.get("WEBGL_compressed_texture_pvrtc"),null===s)return null;if(35840===n)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===n)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===n)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===n)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===n)return s=e.get("WEBGL_compressed_texture_etc1"),null!==s?s.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===n||37496===n){if(s=e.get("WEBGL_compressed_texture_etc"),null===s)return null;if(37492===n)return a===pe?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(37496===n)return a===pe?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}if(37808===n||37809===n||37810===n||37811===n||37812===n||37813===n||37814===n||37815===n||37816===n||37817===n||37818===n||37819===n||37820===n||37821===n){if(s=e.get("WEBGL_compressed_texture_astc"),null===s)return null;if(37808===n)return a===pe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===n)return a===pe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===n)return a===pe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===n)return a===pe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===n)return a===pe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===n)return a===pe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===n)return a===pe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===n)return a===pe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===n)return a===pe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===n)return a===pe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===n)return a===pe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===n)return a===pe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===n)return a===pe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===n)return a===pe?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}if(n===se||36494===n||36495===n){if(s=e.get("EXT_texture_compression_bptc"),null===s)return null;if(n===se)return a===pe?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(36494===n)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(36495===n)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(36283===n||36284===n||36285===n||36286===n){if(s=e.get("EXT_texture_compression_rgtc"),null===s)return null;if(n===se)return s.COMPRESSED_RED_RGTC1_EXT;if(36284===n)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===n)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===n)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return n===Zt?i?t.UNSIGNED_INT_24_8:(s=e.get("WEBGL_depth_texture"),null!==s?s.UNSIGNED_INT_24_8_WEBGL:null):void 0!==t[n]?t[n]:null}}}class ao extends _r{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t}}class oo extends li{constructor(){super(),this.isGroup=!0,this.type="Group"}}const lo={type:"move"};class ho{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new oo,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new oo,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new on,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new on),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new oo,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new on,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new on),this._grip}dispatchEvent(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){const e=this._hand;if(e)for(const n of t.hand.values())this._getHandJoint(e,n)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(t,e,n){let i=null,r=null,s=null;const a=this._targetRay,o=this._grip,l=this._hand;if(t&&"visible-blurred"!==e.session.visibilityState){if(l&&t.hand){s=!0;for(const s of t.hand.values()){const t=e.getJointPose(s,n),i=this._getHandJoint(l,s);null!==t&&(i.matrix.fromArray(t.transform.matrix),i.matrix.decompose(i.position,i.rotation,i.scale),i.matrixWorldNeedsUpdate=!0,i.jointRadius=t.radius),i.visible=null!==t}const i=l.joints["index-finger-tip"],r=l.joints["thumb-tip"],a=i.position.distanceTo(r.position),o=.02,h=.005;l.inputState.pinching&&a>o+h?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&a<=o-h&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else null!==o&&t.gripSpace&&(r=e.getPose(t.gripSpace,n),null!==r&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1));null!==a&&(i=e.getPose(t.targetRaySpace,n),null===i&&null!==r&&(i=r),null!==i&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(lo)))}return null!==a&&(a.visible=null!==i),null!==o&&(o.visible=null!==r),null!==l&&(l.visible=null!==s),this}_getHandJoint(t,e){if(void 0===t.joints[e.jointName]){const n=new oo;n.matrixAutoUpdate=!1,n.visible=!1,t.joints[e.jointName]=n,t.add(n)}return t.joints[e.jointName]}}class co{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(t,e,n){if(null===this.texture){const i=new $e;t.properties.get(i).__webglTexture=e.texture,e.depthNear==n.depthNear&&e.depthFar==n.depthFar||(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=i}}render(t,e){if(null!==this.texture){if(null===this.mesh){const t=e.cameras[0].viewport,n=new pr({extensions:{fragDepth:!0},vertexShader:"\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}",fragmentShader:"\nuniform sampler2DArray depthColor;\nuniform float depthWidth;\nuniform float depthHeight;\n\nvoid main() {\n\n\tvec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );\n\n\tif ( coord.x >= 1.0 ) {\n\n\t\tgl_FragDepthEXT = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;\n\n\t} else {\n\n\t\tgl_FragDepthEXT = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;\n\n\t}\n\n}",uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new ar(new Lr(20,20),n)}t.render(this.mesh,e)}}reset(){this.texture=null,this.mesh=null}}class uo extends Se{constructor(t,n){super();const i=this;let r=null,s=1,a=null,o="local-floor",l=1,h=null,c=null,u=null,d=null,p=null,f=null;const m=new co,g=n.getContextAttributes();let v=null,_=null;const x=[],y=[],S=new Le;let b=null;const M=new _r;M.layers.enable(1),M.viewport=new tn;const w=new _r;w.layers.enable(2),w.viewport=new tn;const C=[M,w],T=new ao;T.layers.enable(1),T.layers.enable(2);let E=null,A=null;function P(t){const e=y.indexOf(t.inputSource);if(-1===e)return;const n=x[e];void 0!==n&&(n.update(t.inputSource,t.frame,h||a),n.dispatchEvent({type:t.type,data:t.inputSource}))}function R(){r.removeEventListener("select",P),r.removeEventListener("selectstart",P),r.removeEventListener("selectend",P),r.removeEventListener("squeeze",P),r.removeEventListener("squeezestart",P),r.removeEventListener("squeezeend",P),r.removeEventListener("end",R),r.removeEventListener("inputsourceschange",W);for(let t=0;t<x.length;t++){const e=y[t];null!==e&&(y[t]=null,x[t].disconnect(e))}E=null,A=null,m.reset(),t.setRenderTarget(v),p=null,d=null,u=null,r=null,_=null,O.stop(),i.isPresenting=!1,t.setPixelRatio(b),t.setSize(S.width,S.height,!1),i.dispatchEvent({type:"sessionend"})}function W(t){for(let e=0;e<t.removed.length;e++){const n=t.removed[e],i=y.indexOf(n);i>=0&&(y[i]=null,x[i].disconnect(n))}for(let e=0;e<t.added.length;e++){const n=t.added[e];let i=y.indexOf(n);if(-1===i){for(let t=0;t<x.length;t++){if(t>=y.length){y.push(n),i=t;break}if(null===y[t]){y[t]=n,i=t;break}}if(-1===i)break}const r=x[i];r&&r.connect(n)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(t){let e=x[t];return void 0===e&&(e=new ho,x[t]=e),e.getTargetRaySpace()},this.getControllerGrip=function(t){let e=x[t];return void 0===e&&(e=new ho,x[t]=e),e.getGripSpace()},this.getHand=function(t){let e=x[t];return void 0===e&&(e=new ho,x[t]=e),e.getHandSpace()},this.setFramebufferScaleFactor=function(t){s=t,i.isPresenting},this.setReferenceSpaceType=function(t){o=t,i.isPresenting},this.getReferenceSpace=function(){return h||a},this.setReferenceSpace=function(t){h=t},this.getBaseLayer=function(){return null!==d?d:p},this.getBinding=function(){return u},this.getFrame=function(){return f},this.getSession=function(){return r},this.setSession=function(c){return e(this,null,(function*(){if(r=c,null!==r){if(v=t.getRenderTarget(),r.addEventListener("select",P),r.addEventListener("selectstart",P),r.addEventListener("selectend",P),r.addEventListener("squeeze",P),r.addEventListener("squeezestart",P),r.addEventListener("squeezeend",P),r.addEventListener("end",R),r.addEventListener("inputsourceschange",W),!0!==g.xrCompatible&&(yield n.makeXRCompatible()),b=t.getPixelRatio(),t.getSize(S),void 0===r.renderState.layers||!1===t.capabilities.isWebGL2){const e={antialias:void 0!==r.renderState.layers||g.antialias,alpha:!0,depth:g.depth,stencil:g.stencil,framebufferScaleFactor:s};p=new XRWebGLLayer(r,n,e),r.updateRenderState({baseLayer:p}),t.setPixelRatio(1),t.setSize(p.framebufferWidth,p.framebufferHeight,!1),_=new nn(p.framebufferWidth,p.framebufferHeight,{format:Yt,type:qt,colorSpace:t.outputColorSpace,stencilBuffer:g.stencil})}else{let e=null,i=null,a=null;g.depth&&(a=g.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,e=g.stencil?te:$t,i=g.stencil?Zt:Jt);const o={colorFormat:n.RGBA8,depthFormat:a,scaleFactor:s};u=new XRWebGLBinding(r,n),d=u.createProjectionLayer(o),r.updateRenderState({layers:[d]}),t.setPixelRatio(1),t.setSize(d.textureWidth,d.textureHeight,!1),_=new nn(d.textureWidth,d.textureHeight,{format:Yt,type:qt,depthTexture:new ms(d.textureWidth,d.textureHeight,i,void 0,void 0,void 0,void 0,void 0,void 0,e),stencilBuffer:g.stencil,colorSpace:t.outputColorSpace,samples:g.antialias?4:0});t.properties.get(_).__ignoreDepthValues=d.ignoreDepthValues}_.isXRRenderTarget=!0,this.setFoveation(l),h=null,a=yield r.requestReferenceSpace(o),O.setContext(r),O.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}}))},this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode};const L=new on,I=new on;function k(t,e){null===e?t.matrixWorld.copy(t.matrix):t.matrixWorld.multiplyMatrices(e.matrixWorld,t.matrix),t.matrixWorldInverse.copy(t.matrixWorld).invert()}this.updateCamera=function(t){if(null===r)return;null!==m.texture&&(t.near=m.depthNear,t.far=m.depthFar),T.near=w.near=M.near=t.near,T.far=w.far=M.far=t.far,E===T.near&&A===T.far||(r.updateRenderState({depthNear:T.near,depthFar:T.far}),E=T.near,A=T.far,M.near=E,M.far=A,w.near=E,w.far=A,M.updateProjectionMatrix(),w.updateProjectionMatrix(),t.updateProjectionMatrix());const e=t.parent,n=T.cameras;k(T,e);for(let i=0;i<n.length;i++)k(n[i],e);2===n.length?function(t,e,n){L.setFromMatrixPosition(e.matrixWorld),I.setFromMatrixPosition(n.matrixWorld);const i=L.distanceTo(I),r=e.projectionMatrix.elements,s=n.projectionMatrix.elements,a=r[14]/(r[10]-1),o=r[14]/(r[10]+1),l=(r[9]+1)/r[5],h=(r[9]-1)/r[5],c=(r[8]-1)/r[0],u=(s[8]+1)/s[0],d=a*c,p=a*u,f=i/(-c+u),m=f*-c;e.matrixWorld.decompose(t.position,t.quaternion,t.scale),t.translateX(m),t.translateZ(f),t.matrixWorld.compose(t.position,t.quaternion,t.scale),t.matrixWorldInverse.copy(t.matrixWorld).invert();const g=a+f,v=o+f,_=d-m,x=p+(i-m),y=l*o/v*g,S=h*o/v*g;t.projectionMatrix.makePerspective(_,x,y,S,g,v),t.projectionMatrixInverse.copy(t.projectionMatrix).invert()}(T,M,w):T.projectionMatrix.copy(M.projectionMatrix),function(t,e,n){null===n?t.matrix.copy(e.matrixWorld):(t.matrix.copy(n.matrixWorld),t.matrix.invert(),t.matrix.multiply(e.matrixWorld));t.matrix.decompose(t.position,t.quaternion,t.scale),t.updateMatrixWorld(!0),t.projectionMatrix.copy(e.projectionMatrix),t.projectionMatrixInverse.copy(e.projectionMatrixInverse),t.isPerspectiveCamera&&(t.fov=2*we*Math.atan(1/t.projectionMatrix.elements[5]),t.zoom=1)}(t,T,e)},this.getCamera=function(){return T},this.getFoveation=function(){if(null!==d||null!==p)return l},this.setFoveation=function(t){l=t,null!==d&&(d.fixedFoveation=t),null!==p&&void 0!==p.fixedFoveation&&(p.fixedFoveation=t)},this.hasDepthSensing=function(){return null!==m.texture};let N=null;const O=new Rr;O.setAnimationLoop((function(e,n){if(c=n.getViewerPose(h||a),f=n,null!==c){const e=c.views;null!==p&&(t.setRenderTargetFramebuffer(_,p.framebuffer),t.setRenderTarget(_));let n=!1;e.length!==T.cameras.length&&(T.cameras.length=0,n=!0);for(let r=0;r<e.length;r++){const i=e[r];let s=null;if(null!==p)s=p.getViewport(i);else{const e=u.getViewSubImage(d,i);s=e.viewport,0===r&&(t.setRenderTargetTextures(_,e.colorTexture,d.ignoreDepthValues?void 0:e.depthStencilTexture),t.setRenderTarget(_))}let a=C[r];void 0===a&&(a=new _r,a.layers.enable(r),a.viewport=new tn,C[r]=a),a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.quaternion,a.scale),a.projectionMatrix.fromArray(i.projectionMatrix),a.projectionMatrixInverse.copy(a.projectionMatrix).invert(),a.viewport.set(s.x,s.y,s.width,s.height),0===r&&(T.matrix.copy(a.matrix),T.matrix.decompose(T.position,T.quaternion,T.scale)),!0===n&&T.cameras.push(a)}const i=r.enabledFeatures;if(i&&i.includes("depth-sensing")){const n=u.getDepthInformation(e[0]);n&&n.isValid&&n.texture&&m.init(t,n,r.renderState)}}for(let t=0;t<x.length;t++){const e=y[t],i=x[t];null!==e&&void 0!==i&&i.update(e,n,h||a)}m.render(t,T),N&&N(e,n),n.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:n}),f=null})),this.setAnimationLoop=function(t){N=t},this.dispose=function(){}}}function po(t,e){function n(t,e){!0===t.matrixAutoUpdate&&t.updateMatrix(),e.value.copy(t.matrix)}function i(i,r){i.opacity.value=r.opacity,r.color&&i.diffuse.value.copy(r.color),r.emissive&&i.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(i.map.value=r.map,n(r.map,i.mapTransform)),r.alphaMap&&(i.alphaMap.value=r.alphaMap,n(r.alphaMap,i.alphaMapTransform)),r.bumpMap&&(i.bumpMap.value=r.bumpMap,n(r.bumpMap,i.bumpMapTransform),i.bumpScale.value=r.bumpScale,r.side===bt&&(i.bumpScale.value*=-1)),r.normalMap&&(i.normalMap.value=r.normalMap,n(r.normalMap,i.normalMapTransform),i.normalScale.value.copy(r.normalScale),r.side===bt&&i.normalScale.value.negate()),r.displacementMap&&(i.displacementMap.value=r.displacementMap,n(r.displacementMap,i.displacementMapTransform),i.displacementScale.value=r.displacementScale,i.displacementBias.value=r.displacementBias),r.emissiveMap&&(i.emissiveMap.value=r.emissiveMap,n(r.emissiveMap,i.emissiveMapTransform)),r.specularMap&&(i.specularMap.value=r.specularMap,n(r.specularMap,i.specularMapTransform)),r.alphaTest>0&&(i.alphaTest.value=r.alphaTest);const s=e.get(r).envMap;if(s&&(i.envMap.value=s,i.flipEnvMap.value=s.isCubeTexture&&!1===s.isRenderTargetTexture?-1:1,i.reflectivity.value=r.reflectivity,i.ior.value=r.ior,i.refractionRatio.value=r.refractionRatio),r.lightMap){i.lightMap.value=r.lightMap;const e=!0===t._useLegacyLights?Math.PI:1;i.lightMapIntensity.value=r.lightMapIntensity*e,n(r.lightMap,i.lightMapTransform)}r.aoMap&&(i.aoMap.value=r.aoMap,i.aoMapIntensity.value=r.aoMapIntensity,n(r.aoMap,i.aoMapTransform))}return{refreshFogUniforms:function(e,n){n.color.getRGB(e.fogColor.value,ur(t)),n.isFog?(e.fogNear.value=n.near,e.fogFar.value=n.far):n.isFogExp2&&(e.fogDensity.value=n.density)},refreshMaterialUniforms:function(t,r,s,a,o){r.isMeshBasicMaterial||r.isMeshLambertMaterial?i(t,r):r.isMeshToonMaterial?(i(t,r),function(t,e){e.gradientMap&&(t.gradientMap.value=e.gradientMap)}(t,r)):r.isMeshPhongMaterial?(i(t,r),function(t,e){t.specular.value.copy(e.specular),t.shininess.value=Math.max(e.shininess,1e-4)}(t,r)):r.isMeshStandardMaterial?(i(t,r),function(t,i){t.metalness.value=i.metalness,i.metalnessMap&&(t.metalnessMap.value=i.metalnessMap,n(i.metalnessMap,t.metalnessMapTransform));t.roughness.value=i.roughness,i.roughnessMap&&(t.roughnessMap.value=i.roughnessMap,n(i.roughnessMap,t.roughnessMapTransform));const r=e.get(i).envMap;r&&(t.envMapIntensity.value=i.envMapIntensity)}(t,r),r.isMeshPhysicalMaterial&&function(t,e,i){t.ior.value=e.ior,e.sheen>0&&(t.sheenColor.value.copy(e.sheenColor).multiplyScalar(e.sheen),t.sheenRoughness.value=e.sheenRoughness,e.sheenColorMap&&(t.sheenColorMap.value=e.sheenColorMap,n(e.sheenColorMap,t.sheenColorMapTransform)),e.sheenRoughnessMap&&(t.sheenRoughnessMap.value=e.sheenRoughnessMap,n(e.sheenRoughnessMap,t.sheenRoughnessMapTransform)));e.clearcoat>0&&(t.clearcoat.value=e.clearcoat,t.clearcoatRoughness.value=e.clearcoatRoughness,e.clearcoatMap&&(t.clearcoatMap.value=e.clearcoatMap,n(e.clearcoatMap,t.clearcoatMapTransform)),e.clearcoatRoughnessMap&&(t.clearcoatRoughnessMap.value=e.clearcoatRoughnessMap,n(e.clearcoatRoughnessMap,t.clearcoatRoughnessMapTransform)),e.clearcoatNormalMap&&(t.clearcoatNormalMap.value=e.clearcoatNormalMap,n(e.clearcoatNormalMap,t.clearcoatNormalMapTransform),t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale),e.side===bt&&t.clearcoatNormalScale.value.negate()));e.iridescence>0&&(t.iridescence.value=e.iridescence,t.iridescenceIOR.value=e.iridescenceIOR,t.iridescenceThicknessMinimum.value=e.iridescenceThicknessRange[0],t.iridescenceThicknessMaximum.value=e.iridescenceThicknessRange[1],e.iridescenceMap&&(t.iridescenceMap.value=e.iridescenceMap,n(e.iridescenceMap,t.iridescenceMapTransform)),e.iridescenceThicknessMap&&(t.iridescenceThicknessMap.value=e.iridescenceThicknessMap,n(e.iridescenceThicknessMap,t.iridescenceThicknessMapTransform)));e.transmission>0&&(t.transmission.value=e.transmission,t.transmissionSamplerMap.value=i.texture,t.transmissionSamplerSize.value.set(i.width,i.height),e.transmissionMap&&(t.transmissionMap.value=e.transmissionMap,n(e.transmissionMap,t.transmissionMapTransform)),t.thickness.value=e.thickness,e.thicknessMap&&(t.thicknessMap.value=e.thicknessMap,n(e.thicknessMap,t.thicknessMapTransform)),t.attenuationDistance.value=e.attenuationDistance,t.attenuationColor.value.copy(e.attenuationColor));e.anisotropy>0&&(t.anisotropyVector.value.set(e.anisotropy*Math.cos(e.anisotropyRotation),e.anisotropy*Math.sin(e.anisotropyRotation)),e.anisotropyMap&&(t.anisotropyMap.value=e.anisotropyMap,n(e.anisotropyMap,t.anisotropyMapTransform)));t.specularIntensity.value=e.specularIntensity,t.specularColor.value.copy(e.specularColor),e.specularColorMap&&(t.specularColorMap.value=e.specularColorMap,n(e.specularColorMap,t.specularColorMapTransform));e.specularIntensityMap&&(t.specularIntensityMap.value=e.specularIntensityMap,n(e.specularIntensityMap,t.specularIntensityMapTransform))}(t,r,o)):r.isMeshMatcapMaterial?(i(t,r),function(t,e){e.matcap&&(t.matcap.value=e.matcap)}(t,r)):r.isMeshDepthMaterial?i(t,r):r.isMeshDistanceMaterial?(i(t,r),function(t,n){const i=e.get(n).light;t.referencePosition.value.setFromMatrixPosition(i.matrixWorld),t.nearDistance.value=i.shadow.camera.near,t.farDistance.value=i.shadow.camera.far}(t,r)):r.isMeshNormalMaterial?i(t,r):r.isLineBasicMaterial?(function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,e.map&&(t.map.value=e.map,n(e.map,t.mapTransform))}(t,r),r.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(t,r)):r.isPointsMaterial?function(t,e,i,r){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.size.value=e.size*i,t.scale.value=.5*r,e.map&&(t.map.value=e.map,n(e.map,t.uvTransform));e.alphaMap&&(t.alphaMap.value=e.alphaMap,n(e.alphaMap,t.alphaMapTransform));e.alphaTest>0&&(t.alphaTest.value=e.alphaTest)}(t,r,s,a):r.isSpriteMaterial?function(t,e){t.diffuse.value.copy(e.color),t.opacity.value=e.opacity,t.rotation.value=e.rotation,e.map&&(t.map.value=e.map,n(e.map,t.mapTransform));e.alphaMap&&(t.alphaMap.value=e.alphaMap,n(e.alphaMap,t.alphaMapTransform));e.alphaTest>0&&(t.alphaTest.value=e.alphaTest)}(t,r):r.isShadowMaterial?(t.color.value.copy(r.color),t.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function fo(t,e,n,i){let r={},s={},a=[];const o=n.isWebGL2?t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(t,e,n,i){const r=t.value,s=e+"_"+n;if(void 0===i[s])return i[s]="number"==typeof r||"boolean"==typeof r?r:r.clone(),!0;{const t=i[s];if("number"==typeof r||"boolean"==typeof r){if(t!==r)return i[s]=r,!0}else if(!1===t.equals(r))return t.copy(r),!0}return!1}function h(t){const e={boundary:0,storage:0};return"number"==typeof t||"boolean"==typeof t?(e.boundary=4,e.storage=4):t.isVector2?(e.boundary=8,e.storage=8):t.isVector3||t.isColor?(e.boundary=16,e.storage=12):t.isVector4?(e.boundary=16,e.storage=16):t.isMatrix3?(e.boundary=48,e.storage=48):t.isMatrix4?(e.boundary=64,e.storage=64):t.isTexture,e}function c(e){const n=e.target;n.removeEventListener("dispose",c);const i=a.indexOf(n.__bindingPointIndex);a.splice(i,1),t.deleteBuffer(r[n.id]),delete r[n.id],delete s[n.id]}return{bind:function(t,e){const n=e.program;i.uniformBlockBinding(t,n)},update:function(n,u){let d=r[n.id];void 0===d&&(!function(t){const e=t.uniforms;let n=0;const i=16;for(let s=0,a=e.length;s<a;s++){const t=Array.isArray(e[s])?e[s]:[e[s]];for(let e=0,r=t.length;e<r;e++){const r=t[e],s=Array.isArray(r.value)?r.value:[r.value];for(let t=0,e=s.length;t<e;t++){const e=h(s[t]),a=n%i;0!==a&&i-a<e.boundary&&(n+=i-a),r.__data=new Float32Array(e.storage/Float32Array.BYTES_PER_ELEMENT),r.__offset=n,n+=e.storage}}}const r=n%i;r>0&&(n+=i-r);t.__size=n,t.__cache={}}(n),d=function(e){const n=function(){for(let t=0;t<o;t++)if(-1===a.indexOf(t))return a.push(t),t;return 0}();e.__bindingPointIndex=n;const i=t.createBuffer(),r=e.__size,s=e.usage;return t.bindBuffer(t.UNIFORM_BUFFER,i),t.bufferData(t.UNIFORM_BUFFER,r,s),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,n,i),i}(n),r[n.id]=d,n.addEventListener("dispose",c));const p=u.program;i.updateUBOMapping(n,p);const f=e.render.frame;s[n.id]!==f&&(!function(e){const n=r[e.id],i=e.uniforms,s=e.__cache;t.bindBuffer(t.UNIFORM_BUFFER,n);for(let r=0,a=i.length;r<a;r++){const e=Array.isArray(i[r])?i[r]:[i[r]];for(let n=0,i=e.length;n<i;n++){const i=e[n];if(!0===l(i,r,n,s)){const e=i.__offset,n=Array.isArray(i.value)?i.value:[i.value];let r=0;for(let s=0;s<n.length;s++){const a=n[s],o=h(a);"number"==typeof a||"boolean"==typeof a?(i.__data[0]=a,t.bufferSubData(t.UNIFORM_BUFFER,e+r,i.__data)):a.isMatrix3?(i.__data[0]=a.elements[0],i.__data[1]=a.elements[1],i.__data[2]=a.elements[2],i.__data[3]=0,i.__data[4]=a.elements[3],i.__data[5]=a.elements[4],i.__data[6]=a.elements[5],i.__data[7]=0,i.__data[8]=a.elements[6],i.__data[9]=a.elements[7],i.__data[10]=a.elements[8],i.__data[11]=0):(a.toArray(i.__data,r),r+=o.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,e,i.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}(n),s[n.id]=f)},dispose:function(){for(const e in r)t.deleteBuffer(r[e]);a=[],r={},s={}}}}class mo{constructor(t={}){const{canvas:e=Ue(),context:n=null,depth:i=!0,stencil:r=!0,alpha:s=!1,antialias:a=!1,premultipliedAlpha:o=!0,preserveDrawingBuffer:l=!1,powerPreference:h="default",failIfMajorPerformanceCaveat:c=!1}=t;let u;this.isWebGLRenderer=!0,u=null!==n?n.getContextAttributes().alpha:s;const d=new Uint32Array(4),p=new Int32Array(4);let f=null,m=null;const g=[],v=[];this.domElement=e,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=le,this._useLegacyLights=!1,this.toneMapping=Et,this.toneMappingExposure=1;const _=this;let x=!1,y=0,S=0,b=null,M=-1,w=null;const C=new tn,T=new tn;let E=null;const A=new wi(0);let P=0,R=e.width,W=e.height,L=1,I=null,k=null;const N=new tn(0,0,R,W),O=new tn(0,0,R,W);let U=!1;const D=new Pr;let F=!1,B=!1,z=null;const V=new Un,G=new Le,H=new on,q={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function X(){return null===b?L:1}let j,J,Q,K,Z,Y,$,tt,et,nt,it,rt,st,at,ot,lt,ht,ct,ut,dt,pt,ft,mt,gt,_t=n;function xt(t,n){for(let i=0;i<t.length;i++){const r=t[i],s=e.getContext(r,n);if(null!==s)return s}return null}try{const t={alpha:!0,depth:i,stencil:r,antialias:a,premultipliedAlpha:o,preserveDrawingBuffer:l,powerPreference:h,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${vt}`),e.addEventListener("webglcontextlost",wt,!1),e.addEventListener("webglcontextrestored",Ct,!1),e.addEventListener("webglcontextcreationerror",Tt,!1),null===_t){const e=["webgl2","webgl","experimental-webgl"];if(!0===_.isWebGL1Renderer&&e.shift(),_t=xt(e,t),null===_t)throw xt(e)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}"undefined"!=typeof WebGLRenderingContext&&WebGLRenderingContext,void 0===_t.getShaderPrecisionFormat&&(_t.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(zt){throw zt}function yt(){j=new os(_t),J=new Br(_t,j,t),j.init(J),ft=new so(_t,j,J),Q=new io(_t,j,J),K=new cs(_t),Z=new Ga,Y=new ro(_t,j,Q,Z,J,ft,K),$=new Vr(_),tt=new as(_),et=new Wr(_t,J),mt=new Dr(_t,j,et,J),nt=new ls(_t,et,K,mt),it=new fs(_t,nt,et,K),ut=new ps(_t,J,Y),lt=new zr(Z),rt=new Va(_,$,tt,j,J,mt,lt),st=new po(_,Z),at=new ja,ot=new $a(j,J),ct=new Ur(_,$,tt,Q,it,u,o),ht=new no(_,it,J),gt=new fo(_t,K,J,Q),dt=new Fr(_t,j,K,J),pt=new hs(_t,j,K,J),K.programs=rt.programs,_.capabilities=J,_.extensions=j,_.properties=Z,_.renderLists=at,_.shadowMap=ht,_.state=Q,_.info=K}yt();const Mt=new uo(_,_t);function wt(t){t.preventDefault(),x=!0}function Ct(){x=!1;const t=K.autoReset,e=ht.enabled,n=ht.autoUpdate,i=ht.needsUpdate,r=ht.type;yt(),K.autoReset=t,ht.enabled=e,ht.autoUpdate=n,ht.needsUpdate=i,ht.type=r}function Tt(t){}function At(t){const e=t.target;e.removeEventListener("dispose",At),function(t){(function(t){const e=Z.get(t).programs;void 0!==e&&(e.forEach((function(t){rt.releaseProgram(t)})),t.isShaderMaterial&&rt.releaseShaderCache(t))})(t),Z.remove(t)}(e)}function Pt(t,e,n){!0===t.transparent&&2===t.side&&!1===t.forceSinglePass?(t.side=bt,t.needsUpdate=!0,Dt(t,e,n),t.side=St,t.needsUpdate=!0,Dt(t,e,n),t.side=2):Dt(t,e,n)}this.xr=Mt,this.getContext=function(){return _t},this.getContextAttributes=function(){return _t.getContextAttributes()},this.forceContextLoss=function(){const t=j.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){const t=j.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return L},this.setPixelRatio=function(t){void 0!==t&&(L=t,this.setSize(R,W,!1))},this.getSize=function(t){return t.set(R,W)},this.setSize=function(t,n,i=!0){Mt.isPresenting||(R=t,W=n,e.width=Math.floor(t*L),e.height=Math.floor(n*L),!0===i&&(e.style.width=t+"px",e.style.height=n+"px"),this.setViewport(0,0,t,n))},this.getDrawingBufferSize=function(t){return t.set(R*L,W*L).floor()},this.setDrawingBufferSize=function(t,n,i){R=t,W=n,L=i,e.width=Math.floor(t*i),e.height=Math.floor(n*i),this.setViewport(0,0,t,n)},this.getCurrentViewport=function(t){return t.copy(C)},this.getViewport=function(t){return t.copy(N)},this.setViewport=function(t,e,n,i){t.isVector4?N.set(t.x,t.y,t.z,t.w):N.set(t,e,n,i),Q.viewport(C.copy(N).multiplyScalar(L).floor())},this.getScissor=function(t){return t.copy(O)},this.setScissor=function(t,e,n,i){t.isVector4?O.set(t.x,t.y,t.z,t.w):O.set(t,e,n,i),Q.scissor(T.copy(O).multiplyScalar(L).floor())},this.getScissorTest=function(){return U},this.setScissorTest=function(t){Q.setScissorTest(U=t)},this.setOpaqueSort=function(t){I=t},this.setTransparentSort=function(t){k=t},this.getClearColor=function(t){return t.copy(ct.getClearColor())},this.setClearColor=function(){ct.setClearColor.apply(ct,arguments)},this.getClearAlpha=function(){return ct.getClearAlpha()},this.setClearAlpha=function(){ct.setClearAlpha.apply(ct,arguments)},this.clear=function(t=!0,e=!0,n=!0){let i=0;if(t){let t=!1;if(null!==b){const e=b.texture.format;t=1033===e||1031===e||1029===e}if(t){const t=b.texture.type,e=t===qt||t===Jt||t===Xt||t===Zt||1017===t||1018===t,n=ct.getClearColor(),i=ct.getClearAlpha(),r=n.r,s=n.g,a=n.b;e?(d[0]=r,d[1]=s,d[2]=a,d[3]=i,_t.clearBufferuiv(_t.COLOR,0,d)):(p[0]=r,p[1]=s,p[2]=a,p[3]=i,_t.clearBufferiv(_t.COLOR,0,p))}else i|=_t.COLOR_BUFFER_BIT}e&&(i|=_t.DEPTH_BUFFER_BIT),n&&(i|=_t.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),_t.clear(i)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",wt,!1),e.removeEventListener("webglcontextrestored",Ct,!1),e.removeEventListener("webglcontextcreationerror",Tt,!1),at.dispose(),ot.dispose(),Z.dispose(),$.dispose(),tt.dispose(),it.dispose(),mt.dispose(),gt.dispose(),rt.dispose(),Mt.dispose(),Mt.removeEventListener("sessionstart",Wt),Mt.removeEventListener("sessionend",Lt),z&&(z.dispose(),z=null),It.stop()},this.renderBufferDirect=function(t,e,n,i,r,s){null===e&&(e=q);const a=r.isMesh&&r.matrixWorld.determinant()<0,o=function(t,e,n,i,r){!0!==e.isScene&&(e=q);Y.resetTextureUnits();const s=e.fog,a=i.isMeshStandardMaterial?e.environment:null,o=null===b?_.outputColorSpace:!0===b.isXRRenderTarget?b.texture.colorSpace:he,l=(i.isMeshStandardMaterial?tt:$).get(i.envMap||a),h=!0===i.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,c=!!n.attributes.tangent&&(!!i.normalMap||i.anisotropy>0),u=!!n.morphAttributes.position,d=!!n.morphAttributes.normal,p=!!n.morphAttributes.color;let f=Et;i.toneMapped&&(null!==b&&!0!==b.isXRRenderTarget||(f=_.toneMapping));const g=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,v=void 0!==g?g.length:0,x=Z.get(i),y=m.state.lights;if(!0===F&&(!0===B||t!==w)){const e=t===w&&i.id===M;lt.setState(i,t,e)}let S=!1;i.version===x.__version?x.needsLights&&x.lightsStateVersion!==y.state.version||x.outputColorSpace!==o||r.isBatchedMesh&&!1===x.batching?S=!0:r.isBatchedMesh||!0!==x.batching?r.isInstancedMesh&&!1===x.instancing?S=!0:r.isInstancedMesh||!0!==x.instancing?r.isSkinnedMesh&&!1===x.skinning?S=!0:r.isSkinnedMesh||!0!==x.skinning?r.isInstancedMesh&&!0===x.instancingColor&&null===r.instanceColor||r.isInstancedMesh&&!1===x.instancingColor&&null!==r.instanceColor||x.envMap!==l||!0===i.fog&&x.fog!==s?S=!0:void 0===x.numClippingPlanes||x.numClippingPlanes===lt.numPlanes&&x.numIntersection===lt.numIntersection?(x.vertexAlphas!==h||x.vertexTangents!==c||x.morphTargets!==u||x.morphNormals!==d||x.morphColors!==p||x.toneMapping!==f||!0===J.isWebGL2&&x.morphTargetsCount!==v)&&(S=!0):S=!0:S=!0:S=!0:S=!0:(S=!0,x.__version=i.version);let C=x.currentProgram;!0===S&&(C=Dt(i,e,r));let T=!1,E=!1,A=!1;const P=C.getUniforms(),R=x.uniforms;Q.useProgram(C.program)&&(T=!0,E=!0,A=!0);i.id!==M&&(M=i.id,E=!0);if(T||w!==t){P.setValue(_t,"projectionMatrix",t.projectionMatrix),P.setValue(_t,"viewMatrix",t.matrixWorldInverse);const e=P.map.cameraPosition;void 0!==e&&e.setValue(_t,H.setFromMatrixPosition(t.matrixWorld)),J.logarithmicDepthBuffer&&P.setValue(_t,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),(i.isMeshPhongMaterial||i.isMeshToonMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial)&&P.setValue(_t,"isOrthographic",!0===t.isOrthographicCamera),w!==t&&(w=t,E=!0,A=!0)}if(r.isSkinnedMesh){P.setOptional(_t,r,"bindMatrix"),P.setOptional(_t,r,"bindMatrixInverse");const t=r.skeleton;t&&J.floatVertexTextures&&(null===t.boneTexture&&t.computeBoneTexture(),P.setValue(_t,"boneTexture",t.boneTexture,Y))}r.isBatchedMesh&&(P.setOptional(_t,r,"batchingTexture"),P.setValue(_t,"batchingTexture",r._matricesTexture,Y));const I=n.morphAttributes;(void 0!==I.position||void 0!==I.normal||void 0!==I.color&&!0===J.isWebGL2)&&ut.update(r,n,C);(E||x.receiveShadow!==r.receiveShadow)&&(x.receiveShadow=r.receiveShadow,P.setValue(_t,"receiveShadow",r.receiveShadow));i.isMeshGouraudMaterial&&null!==i.envMap&&(R.envMap.value=l,R.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1);E&&(P.setValue(_t,"toneMappingExposure",_.toneMappingExposure),x.needsLights&&(N=A,(k=R).ambientLightColor.needsUpdate=N,k.lightProbe.needsUpdate=N,k.directionalLights.needsUpdate=N,k.directionalLightShadows.needsUpdate=N,k.pointLights.needsUpdate=N,k.pointLightShadows.needsUpdate=N,k.spotLights.needsUpdate=N,k.spotLightShadows.needsUpdate=N,k.rectAreaLights.needsUpdate=N,k.hemisphereLights.needsUpdate=N),s&&!0===i.fog&&st.refreshFogUniforms(R,s),st.refreshMaterialUniforms(R,i,L,W,z),ya.upload(_t,Ft(x),R,Y));var k,N;i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(ya.upload(_t,Ft(x),R,Y),i.uniformsNeedUpdate=!1);i.isSpriteMaterial&&P.setValue(_t,"center",r.center);if(P.setValue(_t,"modelViewMatrix",r.modelViewMatrix),P.setValue(_t,"normalMatrix",r.normalMatrix),P.setValue(_t,"modelMatrix",r.matrixWorld),i.isShaderMaterial||i.isRawShaderMaterial){const t=i.uniformsGroups;for(let e=0,n=t.length;e<n;e++)if(J.isWebGL2){const n=t[e];gt.update(n,C),gt.bind(n,C)}}return C}(t,e,n,i,r);Q.setMaterial(i,a);let l=n.index,h=1;if(!0===i.wireframe){if(l=nt.getWireframeAttribute(n),void 0===l)return;h=2}const c=n.drawRange,u=n.attributes.position;let d=c.start*h,p=(c.start+c.count)*h;null!==s&&(d=Math.max(d,s.start*h),p=Math.min(p,(s.start+s.count)*h)),null!==l?(d=Math.max(d,0),p=Math.min(p,l.count)):null!=u&&(d=Math.max(d,0),p=Math.min(p,u.count));const f=p-d;if(f<0||f===1/0)return;let g;mt.setup(r,i,o,n,l);let v=dt;if(null!==l&&(g=et.get(l),v=pt,v.setIndex(g)),r.isMesh)!0===i.wireframe?(Q.setLineWidth(i.wireframeLinewidth*X()),v.setMode(_t.LINES)):v.setMode(_t.TRIANGLES);else if(r.isLine){let t=i.linewidth;void 0===t&&(t=1),Q.setLineWidth(t*X()),r.isLineSegments?v.setMode(_t.LINES):r.isLineLoop?v.setMode(_t.LINE_LOOP):v.setMode(_t.LINE_STRIP)}else r.isPoints?v.setMode(_t.POINTS):r.isSprite&&v.setMode(_t.TRIANGLES);if(r.isBatchedMesh)v.renderMultiDraw(r._multiDrawStarts,r._multiDrawCounts,r._multiDrawCount);else if(r.isInstancedMesh)v.renderInstances(d,f,r.count);else if(n.isInstancedBufferGeometry){const t=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,e=Math.min(n.instanceCount,t);v.renderInstances(d,f,e)}else v.render(d,f)},this.compile=function(t,e,n=null){null===n&&(n=t),m=ot.get(n),m.init(),v.push(m),n.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(m.pushLight(t),t.castShadow&&m.pushShadow(t))})),t!==n&&t.traverseVisible((function(t){t.isLight&&t.layers.test(e.layers)&&(m.pushLight(t),t.castShadow&&m.pushShadow(t))})),m.setupLights(_._useLegacyLights);const i=new Set;return t.traverse((function(t){const e=t.material;if(e)if(Array.isArray(e))for(let r=0;r<e.length;r++){const s=e[r];Pt(s,n,t),i.add(s)}else Pt(e,n,t),i.add(e)})),v.pop(),m=null,i},this.compileAsync=function(t,e,n=null){const i=this.compile(t,e,n);return new Promise((e=>{function n(){i.forEach((function(t){Z.get(t).currentProgram.isReady()&&i.delete(t)})),0!==i.size?setTimeout(n,10):e(t)}null!==j.get("KHR_parallel_shader_compile")?n():setTimeout(n,10)}))};let Rt=null;function Wt(){It.stop()}function Lt(){It.start()}const It=new Rr;function kt(t,e,n,i){if(!1===t.visible)return;if(t.layers.test(e.layers))if(t.isGroup)n=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(e);else if(t.isLight)m.pushLight(t),t.castShadow&&m.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||D.intersectsSprite(t)){i&&H.setFromMatrixPosition(t.matrixWorld).applyMatrix4(V);const e=it.update(t),r=t.material;r.visible&&f.push(t,e,r,n,H.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(!t.frustumCulled||D.intersectsObject(t))){const e=it.update(t),r=t.material;if(i&&(void 0!==t.boundingSphere?(null===t.boundingSphere&&t.computeBoundingSphere(),H.copy(t.boundingSphere.center)):(null===e.boundingSphere&&e.computeBoundingSphere(),H.copy(e.boundingSphere.center)),H.applyMatrix4(t.matrixWorld).applyMatrix4(V)),Array.isArray(r)){const i=e.groups;for(let s=0,a=i.length;s<a;s++){const a=i[s],o=r[a.materialIndex];o&&o.visible&&f.push(t,e,o,n,H.z,a)}}else r.visible&&f.push(t,e,r,n,H.z,null)}const r=t.children;for(let s=0,a=r.length;s<a;s++)kt(r[s],e,n,i)}function Nt(t,e,n,i){const r=t.opaque,s=t.transmissive,a=t.transparent;m.setupLightsView(n),!0===F&&lt.setGlobalState(_.clippingPlanes,n),s.length>0&&function(t,e,n,i){const r=!0===n.isScene?n.overrideMaterial:null;if(null!==r)return;const s=J.isWebGL2;null===z&&(z=new nn(1,1,{generateMipmaps:!0,type:j.has("EXT_color_buffer_half_float")?Kt:qt,minFilter:Ht,samples:s?4:0}));_.getDrawingBufferSize(G),s?z.setSize(G.x,G.y):z.setSize(Pe(G.x),Pe(G.y));const a=_.getRenderTarget();_.setRenderTarget(z),_.getClearColor(A),P=_.getClearAlpha(),P<1&&_.setClearColor(16777215,.5);_.clear();const o=_.toneMapping;_.toneMapping=Et,Ot(t,n,i),Y.updateMultisampleRenderTarget(z),Y.updateRenderTargetMipmap(z);let l=!1;for(let h=0,c=e.length;h<c;h++){const t=e[h],r=t.object,s=t.geometry,a=t.material,o=t.group;if(2===a.side&&r.layers.test(i.layers)){const t=a.side;a.side=bt,a.needsUpdate=!0,Ut(r,n,i,s,a,o),a.side=t,a.needsUpdate=!0,l=!0}}!0===l&&(Y.updateMultisampleRenderTarget(z),Y.updateRenderTargetMipmap(z));_.setRenderTarget(a),_.setClearColor(A,P),_.toneMapping=o}(r,s,e,n),i&&Q.viewport(C.copy(i)),r.length>0&&Ot(r,e,n),s.length>0&&Ot(s,e,n),a.length>0&&Ot(a,e,n),Q.buffers.depth.setTest(!0),Q.buffers.depth.setMask(!0),Q.buffers.color.setMask(!0),Q.setPolygonOffset(!1)}function Ot(t,e,n){const i=!0===e.isScene?e.overrideMaterial:null;for(let r=0,s=t.length;r<s;r++){const s=t[r],a=s.object,o=s.geometry,l=null===i?s.material:i,h=s.group;a.layers.test(n.layers)&&Ut(a,e,n,o,l,h)}}function Ut(t,e,n,i,r,s){t.onBeforeRender(_,e,n,i,r,s),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),r.onBeforeRender(_,e,n,i,t,s),!0===r.transparent&&2===r.side&&!1===r.forceSinglePass?(r.side=bt,r.needsUpdate=!0,_.renderBufferDirect(n,e,i,r,t,s),r.side=St,r.needsUpdate=!0,_.renderBufferDirect(n,e,i,r,t,s),r.side=2):_.renderBufferDirect(n,e,i,r,t,s),t.onAfterRender(_,e,n,i,r,s)}function Dt(t,e,n){!0!==e.isScene&&(e=q);const i=Z.get(t),r=m.state.lights,s=m.state.shadowsArray,a=r.state.version,o=rt.getParameters(t,r.state,s,e,n),l=rt.getProgramCacheKey(o);let h=i.programs;i.environment=t.isMeshStandardMaterial?e.environment:null,i.fog=e.fog,i.envMap=(t.isMeshStandardMaterial?tt:$).get(t.envMap||i.environment),void 0===h&&(t.addEventListener("dispose",At),h=new Map,i.programs=h);let c=h.get(l);if(void 0!==c){if(i.currentProgram===c&&i.lightsStateVersion===a)return Bt(t,o),c}else o.uniforms=rt.getUniforms(t),t.onBuild(n,o,_),t.onBeforeCompile(o,_),c=rt.acquireProgram(o,l),h.set(l,c),i.uniforms=o.uniforms;const u=i.uniforms;return(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(u.clippingPlanes=lt.uniform),Bt(t,o),i.needsLights=function(t){return t.isMeshLambertMaterial||t.isMeshToonMaterial||t.isMeshPhongMaterial||t.isMeshStandardMaterial||t.isShadowMaterial||t.isShaderMaterial&&!0===t.lights}(t),i.lightsStateVersion=a,i.needsLights&&(u.ambientLightColor.value=r.state.ambient,u.lightProbe.value=r.state.probe,u.directionalLights.value=r.state.directional,u.directionalLightShadows.value=r.state.directionalShadow,u.spotLights.value=r.state.spot,u.spotLightShadows.value=r.state.spotShadow,u.rectAreaLights.value=r.state.rectArea,u.ltc_1.value=r.state.rectAreaLTC1,u.ltc_2.value=r.state.rectAreaLTC2,u.pointLights.value=r.state.point,u.pointLightShadows.value=r.state.pointShadow,u.hemisphereLights.value=r.state.hemi,u.directionalShadowMap.value=r.state.directionalShadowMap,u.directionalShadowMatrix.value=r.state.directionalShadowMatrix,u.spotShadowMap.value=r.state.spotShadowMap,u.spotLightMatrix.value=r.state.spotLightMatrix,u.spotLightMap.value=r.state.spotLightMap,u.pointShadowMap.value=r.state.pointShadowMap,u.pointShadowMatrix.value=r.state.pointShadowMatrix),i.currentProgram=c,i.uniformsList=null,c}function Ft(t){if(null===t.uniformsList){const e=t.currentProgram.getUniforms();t.uniformsList=ya.seqWithValue(e.seq,t.uniforms)}return t.uniformsList}function Bt(t,e){const n=Z.get(t);n.outputColorSpace=e.outputColorSpace,n.batching=e.batching,n.instancing=e.instancing,n.instancingColor=e.instancingColor,n.skinning=e.skinning,n.morphTargets=e.morphTargets,n.morphNormals=e.morphNormals,n.morphColors=e.morphColors,n.morphTargetsCount=e.morphTargetsCount,n.numClippingPlanes=e.numClippingPlanes,n.numIntersection=e.numClipIntersection,n.vertexAlphas=e.vertexAlphas,n.vertexTangents=e.vertexTangents,n.toneMapping=e.toneMapping}It.setAnimationLoop((function(t){Rt&&Rt(t)})),"undefined"!=typeof self&&It.setContext(self),this.setAnimationLoop=function(t){Rt=t,Mt.setAnimationLoop(t),null===t?It.stop():It.start()},Mt.addEventListener("sessionstart",Wt),Mt.addEventListener("sessionend",Lt),this.render=function(t,e){if(void 0!==e&&!0!==e.isCamera)return;if(!0===x)return;!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),null===e.parent&&!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),!0===Mt.enabled&&!0===Mt.isPresenting&&(!0===Mt.cameraAutoUpdate&&Mt.updateCamera(e),e=Mt.getCamera()),!0===t.isScene&&t.onBeforeRender(_,t,e,b),m=ot.get(t,v.length),m.init(),v.push(m),V.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),D.setFromProjectionMatrix(V),B=this.localClippingEnabled,F=lt.init(this.clippingPlanes,B),f=at.get(t,g.length),f.init(),g.push(f),kt(t,e,0,_.sortObjects),f.finish(),!0===_.sortObjects&&f.sort(I,k),this.info.render.frame++,!0===F&&lt.beginShadows();const n=m.state.shadowsArray;if(ht.render(n,t,e),!0===F&&lt.endShadows(),!0===this.info.autoReset&&this.info.reset(),!1!==Mt.enabled&&!1!==Mt.isPresenting&&!1!==Mt.hasDepthSensing()||ct.render(f,t),m.setupLights(_._useLegacyLights),e.isArrayCamera){const n=e.cameras;for(let e=0,i=n.length;e<i;e++){const i=n[e];Nt(f,t,i,i.viewport)}}else Nt(f,t,e);null!==b&&(Y.updateMultisampleRenderTarget(b),Y.updateRenderTargetMipmap(b)),!0===t.isScene&&t.onAfterRender(_,t,e),mt.resetDefaultState(),M=-1,w=null,v.pop(),m=v.length>0?v[v.length-1]:null,g.pop(),f=g.length>0?g[g.length-1]:null},this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return S},this.getRenderTarget=function(){return b},this.setRenderTargetTextures=function(t,e,n){Z.get(t.texture).__webglTexture=e,Z.get(t.depthTexture).__webglTexture=n;const i=Z.get(t);i.__hasExternalTextures=!0,i.__hasExternalTextures&&(i.__autoAllocateDepthBuffer=void 0===n,i.__autoAllocateDepthBuffer||!0===j.has("WEBGL_multisampled_render_to_texture")&&(i.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(t,e){const n=Z.get(t);n.__webglFramebuffer=e,n.__useDefaultFramebuffer=void 0===e},this.setRenderTarget=function(t,e=0,n=0){b=t,y=e,S=n;let i=!0,r=null,s=!1,a=!1;if(t){const o=Z.get(t);void 0!==o.__useDefaultFramebuffer?(Q.bindFramebuffer(_t.FRAMEBUFFER,null),i=!1):void 0===o.__webglFramebuffer?Y.setupRenderTarget(t):o.__hasExternalTextures&&Y.rebindTextures(t,Z.get(t.texture).__webglTexture,Z.get(t.depthTexture).__webglTexture);const l=t.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(a=!0);const h=Z.get(t).__webglFramebuffer;t.isWebGLCubeRenderTarget?(r=Array.isArray(h[e])?h[e][n]:h[e],s=!0):r=J.isWebGL2&&t.samples>0&&!1===Y.useMultisampledRTT(t)?Z.get(t).__webglMultisampledFramebuffer:Array.isArray(h)?h[n]:h,C.copy(t.viewport),T.copy(t.scissor),E=t.scissorTest}else C.copy(N).multiplyScalar(L).floor(),T.copy(O).multiplyScalar(L).floor(),E=U;if(Q.bindFramebuffer(_t.FRAMEBUFFER,r)&&J.drawBuffers&&i&&Q.drawBuffers(t,r),Q.viewport(C),Q.scissor(T),Q.setScissorTest(E),s){const i=Z.get(t.texture);_t.framebufferTexture2D(_t.FRAMEBUFFER,_t.COLOR_ATTACHMENT0,_t.TEXTURE_CUBE_MAP_POSITIVE_X+e,i.__webglTexture,n)}else if(a){const i=Z.get(t.texture),r=e||0;_t.framebufferTextureLayer(_t.FRAMEBUFFER,_t.COLOR_ATTACHMENT0,i.__webglTexture,n||0,r)}M=-1},this.readRenderTargetPixels=function(t,e,n,i,r,s,a){if(!t||!t.isWebGLRenderTarget)return;let o=Z.get(t).__webglFramebuffer;if(t.isWebGLCubeRenderTarget&&void 0!==a&&(o=o[a]),o){Q.bindFramebuffer(_t.FRAMEBUFFER,o);try{const a=t.texture,o=a.format,l=a.type;if(o!==Yt&&ft.convert(o)!==_t.getParameter(_t.IMPLEMENTATION_COLOR_READ_FORMAT))return;const h=l===Kt&&(j.has("EXT_color_buffer_half_float")||J.isWebGL2&&j.has("EXT_color_buffer_float"));if(!(l===qt||ft.convert(l)===_t.getParameter(_t.IMPLEMENTATION_COLOR_READ_TYPE)||l===Qt&&(J.isWebGL2||j.has("OES_texture_float")||j.has("WEBGL_color_buffer_float"))||h))return;e>=0&&e<=t.width-i&&n>=0&&n<=t.height-r&&_t.readPixels(e,n,i,r,ft.convert(o),ft.convert(l),s)}finally{const t=null!==b?Z.get(b).__webglFramebuffer:null;Q.bindFramebuffer(_t.FRAMEBUFFER,t)}}},this.copyFramebufferToTexture=function(t,e,n=0){const i=Math.pow(2,-n),r=Math.floor(e.image.width*i),s=Math.floor(e.image.height*i);Y.setTexture2D(e,0),_t.copyTexSubImage2D(_t.TEXTURE_2D,n,0,0,t.x,t.y,r,s),Q.unbindTexture()},this.copyTextureToTexture=function(t,e,n,i=0){const r=e.image.width,s=e.image.height,a=ft.convert(n.format),o=ft.convert(n.type);Y.setTexture2D(n,0),_t.pixelStorei(_t.UNPACK_FLIP_Y_WEBGL,n.flipY),_t.pixelStorei(_t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),_t.pixelStorei(_t.UNPACK_ALIGNMENT,n.unpackAlignment),e.isDataTexture?_t.texSubImage2D(_t.TEXTURE_2D,i,t.x,t.y,r,s,a,o,e.image.data):e.isCompressedTexture?_t.compressedTexSubImage2D(_t.TEXTURE_2D,i,t.x,t.y,e.mipmaps[0].width,e.mipmaps[0].height,a,e.mipmaps[0].data):_t.texSubImage2D(_t.TEXTURE_2D,i,t.x,t.y,a,o,e.image),0===i&&n.generateMipmaps&&_t.generateMipmap(_t.TEXTURE_2D),Q.unbindTexture()},this.copyTextureToTexture3D=function(t,e,n,i,r=0){if(_.isWebGL1Renderer)return;const s=t.max.x-t.min.x+1,a=t.max.y-t.min.y+1,o=t.max.z-t.min.z+1,l=ft.convert(i.format),h=ft.convert(i.type);let c;if(i.isData3DTexture)Y.setTexture3D(i,0),c=_t.TEXTURE_3D;else{if(!i.isDataArrayTexture&&!i.isCompressedArrayTexture)return;Y.setTexture2DArray(i,0),c=_t.TEXTURE_2D_ARRAY}_t.pixelStorei(_t.UNPACK_FLIP_Y_WEBGL,i.flipY),_t.pixelStorei(_t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),_t.pixelStorei(_t.UNPACK_ALIGNMENT,i.unpackAlignment);const u=_t.getParameter(_t.UNPACK_ROW_LENGTH),d=_t.getParameter(_t.UNPACK_IMAGE_HEIGHT),p=_t.getParameter(_t.UNPACK_SKIP_PIXELS),f=_t.getParameter(_t.UNPACK_SKIP_ROWS),m=_t.getParameter(_t.UNPACK_SKIP_IMAGES),g=n.isCompressedTexture?n.mipmaps[r]:n.image;_t.pixelStorei(_t.UNPACK_ROW_LENGTH,g.width),_t.pixelStorei(_t.UNPACK_IMAGE_HEIGHT,g.height),_t.pixelStorei(_t.UNPACK_SKIP_PIXELS,t.min.x),_t.pixelStorei(_t.UNPACK_SKIP_ROWS,t.min.y),_t.pixelStorei(_t.UNPACK_SKIP_IMAGES,t.min.z),n.isDataTexture||n.isData3DTexture?_t.texSubImage3D(c,r,e.x,e.y,e.z,s,a,o,l,h,g.data):n.isCompressedArrayTexture?_t.compressedTexSubImage3D(c,r,e.x,e.y,e.z,s,a,o,l,g.data):_t.texSubImage3D(c,r,e.x,e.y,e.z,s,a,o,l,h,g),_t.pixelStorei(_t.UNPACK_ROW_LENGTH,u),_t.pixelStorei(_t.UNPACK_IMAGE_HEIGHT,d),_t.pixelStorei(_t.UNPACK_SKIP_PIXELS,p),_t.pixelStorei(_t.UNPACK_SKIP_ROWS,f),_t.pixelStorei(_t.UNPACK_SKIP_IMAGES,m),0===r&&i.generateMipmaps&&_t.generateMipmap(c),Q.unbindTexture()},this.initTexture=function(t){t.isCubeTexture?Y.setTextureCube(t,0):t.isData3DTexture?Y.setTexture3D(t,0):t.isDataArrayTexture||t.isCompressedArrayTexture?Y.setTexture2DArray(t,0):Y.setTexture2D(t,0),Q.unbindTexture()},this.resetState=function(){y=0,S=0,b=null,Q.reset(),mt.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return xe}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t;const e=this.getContext();e.drawingBufferColorSpace=t===ce?"display-p3":"srgb",e.unpackColorSpace=He.workingColorSpace===ue?"display-p3":"srgb"}get outputEncoding(){return this.outputColorSpace===le?ae:3e3}set outputEncoding(t){this.outputColorSpace=t===ae?le:he}get useLegacyLights(){return this._useLegacyLights}set useLegacyLights(t){this._useLegacyLights=t}}(class extends mo{}).prototype.isWebGL1Renderer=!0;class go extends li{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return null!==this.fog&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(e.object.backgroundIntensity=this.backgroundIntensity),e}}class vo{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return null}getPointAt(t,e){const n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){const e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let n,i=this.getPoint(0),r=0;e.push(0);for(let s=1;s<=t;s++)n=this.getPoint(s/t),r+=n.distanceTo(i),e.push(r),i=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const n=this.getLengths();let i=0;const r=n.length;let s;s=e||t*n[r-1];let a,o=0,l=r-1;for(;o<=l;)if(i=Math.floor(o+(l-o)/2),a=n[i]-s,a<0)o=i+1;else{if(!(a>0)){l=i;break}l=i-1}if(i=l,n[i]===s)return i/(r-1);const h=n[i];return(i+(s-h)/(n[i+1]-h))/(r-1)}getTangent(t,e){const n=1e-4;let i=t-n,r=t+n;i<0&&(i=0),r>1&&(r=1);const s=this.getPoint(i),a=this.getPoint(r),o=e||(s.isVector2?new Le:new on);return o.copy(a).sub(s).normalize(),o}getTangentAt(t,e){const n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){const n=new on,i=[],r=[],s=[],a=new on,o=new Un;for(let d=0;d<=t;d++){const e=d/t;i[d]=this.getTangentAt(e,new on)}r[0]=new on,s[0]=new on;let l=Number.MAX_VALUE;const h=Math.abs(i[0].x),c=Math.abs(i[0].y),u=Math.abs(i[0].z);h<=l&&(l=h,n.set(1,0,0)),c<=l&&(l=c,n.set(0,1,0)),u<=l&&n.set(0,0,1),a.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],a),s[0].crossVectors(i[0],r[0]);for(let d=1;d<=t;d++){if(r[d]=r[d-1].clone(),s[d]=s[d-1].clone(),a.crossVectors(i[d-1],i[d]),a.length()>Number.EPSILON){a.normalize();const t=Math.acos(Te(i[d-1].dot(i[d]),-1,1));r[d].applyMatrix4(o.makeRotationAxis(a,t))}s[d].crossVectors(i[d],r[d])}if(!0===e){let e=Math.acos(Te(r[0].dot(r[t]),-1,1));e/=t,i[0].dot(a.crossVectors(r[0],r[t]))>0&&(e=-e);for(let n=1;n<=t;n++)r[n].applyMatrix4(o.makeRotationAxis(i[n],e*n)),s[n].crossVectors(i[n],r[n])}return{tangents:i,normals:r,binormals:s}}clone(){return(new this.constructor).copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class _o extends vo{constructor(t=0,e=0,n=1,i=1,r=0,s=2*Math.PI,a=!1,o=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=a,this.aRotation=o}getPoint(t,e){const n=e||new Le,i=2*Math.PI;let r=this.aEndAngle-this.aStartAngle;const s=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(r=s?0:i),!0!==this.aClockwise||s||(r===i?r=-i:r-=i);const a=this.aStartAngle+t*r;let o=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){const t=Math.cos(this.aRotation),e=Math.sin(this.aRotation),n=o-this.aX,i=l-this.aY;o=n*t-i*e+this.aX,l=n*e+i*t+this.aY}return n.set(o,l)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}function xo(){let t=0,e=0,n=0,i=0;function r(r,s,a,o){t=r,e=a,n=-3*r+3*s-2*a-o,i=2*r-2*s+a+o}return{initCatmullRom:function(t,e,n,i,s){r(e,n,s*(n-t),s*(i-e))},initNonuniformCatmullRom:function(t,e,n,i,s,a,o){let l=(e-t)/s-(n-t)/(s+a)+(n-e)/a,h=(n-e)/a-(i-e)/(a+o)+(i-n)/o;l*=a,h*=a,r(e,n,l,h)},calc:function(r){const s=r*r;return t+e*r+n*s+i*(s*r)}}}const yo=new on,So=new xo,bo=new xo,Mo=new xo;function wo(t,e,n,i,r){const s=.5*(i-e),a=.5*(r-n),o=t*t;return(2*n-2*i+s+a)*(t*o)+(-3*n+3*i-2*s-a)*o+s*t+n}function Co(t,e,n,i){return function(t,e){const n=1-t;return n*n*e}(t,e)+function(t,e){return 2*(1-t)*t*e}(t,n)+function(t,e){return t*t*e}(t,i)}function To(t,e,n,i,r){return function(t,e){const n=1-t;return n*n*n*e}(t,e)+function(t,e){const n=1-t;return 3*n*n*t*e}(t,n)+function(t,e){return 3*(1-t)*t*t*e}(t,i)+function(t,e){return t*t*t*e}(t,r)}class Eo extends vo{constructor(t=new Le,e=new Le,n=new Le,i=new Le){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new Le){const n=e,i=this.v0,r=this.v1,s=this.v2,a=this.v3;return n.set(To(t,i.x,r.x,s.x,a.x),To(t,i.y,r.y,s.y,a.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class Ao extends vo{constructor(t=new Le,e=new Le){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new Le){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new Le){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Po extends vo{constructor(t=new Le,e=new Le,n=new Le){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new Le){const n=e,i=this.v0,r=this.v1,s=this.v2;return n.set(Co(t,i.x,r.x,s.x),Co(t,i.y,r.y,s.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Ro extends vo{constructor(t=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=t}getPoint(t,e=new Le){const n=e,i=this.points,r=(i.length-1)*t,s=Math.floor(r),a=r-s,o=i[0===s?s:s-1],l=i[s],h=i[s>i.length-2?i.length-1:s+1],c=i[s>i.length-3?i.length-1:s+2];return n.set(wo(a,o.x,l.x,h.x,c.x),wo(a,o.y,l.y,h.y,c.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new Le).fromArray(n))}return this}}var Wo=Object.freeze({__proto__:null,ArcCurve:class extends _o{constructor(t,e,n,i,r,s){super(t,e,n,n,i,r,s),this.isArcCurve=!0,this.type="ArcCurve"}},CatmullRomCurve3:class extends vo{constructor(t=[],e=!1,n="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=i}getPoint(t,e=new on){const n=e,i=this.points,r=i.length,s=(r-(this.closed?0:1))*t;let a,o,l=Math.floor(s),h=s-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/r)+1)*r:0===h&&l===r-1&&(l=r-2,h=1),this.closed||l>0?a=i[(l-1)%r]:(yo.subVectors(i[0],i[1]).add(i[0]),a=yo);const c=i[l%r],u=i[(l+1)%r];if(this.closed||l+2<r?o=i[(l+2)%r]:(yo.subVectors(i[r-1],i[r-2]).add(i[r-1]),o=yo),"centripetal"===this.curveType||"chordal"===this.curveType){const t="chordal"===this.curveType?.5:.25;let e=Math.pow(a.distanceToSquared(c),t),n=Math.pow(c.distanceToSquared(u),t),i=Math.pow(u.distanceToSquared(o),t);n<1e-4&&(n=1),e<1e-4&&(e=n),i<1e-4&&(i=n),So.initNonuniformCatmullRom(a.x,c.x,u.x,o.x,e,n,i),bo.initNonuniformCatmullRom(a.y,c.y,u.y,o.y,e,n,i),Mo.initNonuniformCatmullRom(a.z,c.z,u.z,o.z,e,n,i)}else"catmullrom"===this.curveType&&(So.initCatmullRom(a.x,c.x,u.x,o.x,this.tension),bo.initCatmullRom(a.y,c.y,u.y,o.y,this.tension),Mo.initCatmullRom(a.z,c.z,u.z,o.z,this.tension));return n.set(So.calc(h),bo.calc(h),Mo.calc(h)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){const n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){const n=t.points[e];this.points.push((new on).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}},CubicBezierCurve:Eo,CubicBezierCurve3:class extends vo{constructor(t=new on,e=new on,n=new on,i=new on){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new on){const n=e,i=this.v0,r=this.v1,s=this.v2,a=this.v3;return n.set(To(t,i.x,r.x,s.x,a.x),To(t,i.y,r.y,s.y,a.y),To(t,i.z,r.z,s.z,a.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}},EllipseCurve:_o,LineCurve:Ao,LineCurve3:class extends vo{constructor(t=new on,e=new on){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=t,this.v2=e}getPoint(t,e=new on){const n=e;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new on){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},QuadraticBezierCurve:Po,QuadraticBezierCurve3:class extends vo{constructor(t=new on,e=new on,n=new on){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new on){const n=e,i=this.v0,r=this.v1,s=this.v2;return n.set(Co(t,i.x,r.x,s.x),Co(t,i.y,r.y,s.y),Co(t,i.z,r.z,s.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},SplineCurve:Ro});class Lo extends vo{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);if(!t.equals(e)){const n=!0===t.isVector2?"LineCurve":"LineCurve3";this.curves.push(new Wo[n](e,t))}return this}getPoint(t,e){const n=t*this.getLength(),i=this.getCurveLengths();let r=0;for(;r<i.length;){if(i[r]>=n){const t=i[r]-n,s=this.curves[r],a=s.getLength(),o=0===a?0:1-t/a;return s.getPointAt(o,e)}r++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let n;for(let i=0,r=this.curves;i<r.length;i++){const s=r[i],a=s.isEllipseCurve?2*t:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?t*s.points.length:t,o=s.getPoints(a);for(let t=0;t<o.length;t++){const i=o[t];n&&n.equals(i)||(e.push(i),n=i)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){const n=this.curves[e];t.curves.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){const n=t.curves[e];this.curves.push((new Wo[n.type]).fromJSON(n))}return this}}class Io extends Lo{constructor(t){super(),this.type="Path",this.currentPoint=new Le,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const n=new Ao(this.currentPoint.clone(),new Le(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,i){const r=new Po(this.currentPoint.clone(),new Le(t,e),new Le(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(t,e,n,i,r,s){const a=new Eo(this.currentPoint.clone(),new Le(t,e),new Le(n,i),new Le(r,s));return this.curves.push(a),this.currentPoint.set(r,s),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),n=new Ro(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,i,r,s){const a=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(t+a,e+o,n,i,r,s),this}absarc(t,e,n,i,r,s){return this.absellipse(t,e,n,n,i,r,s),this}ellipse(t,e,n,i,r,s,a,o){const l=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(t+l,e+h,n,i,r,s,a,o),this}absellipse(t,e,n,i,r,s,a,o){const l=new _o(t,e,n,i,r,s,a,o);if(this.curves.length>0){const t=l.getPoint(0);t.equals(this.currentPoint)||this.lineTo(t.x,t.y)}this.curves.push(l);const h=l.getPoint(1);return this.currentPoint.copy(h),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class ko extends Io{constructor(t){super(t),this.uuid=Ce(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){const n=this.holes[e];t.holes.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){const n=t.holes[e];this.holes.push((new Io).fromJSON(n))}return this}}const No=function(t,e,n=2){const i=e&&e.length,r=i?e[0]*n:t.length;let s=Oo(t,0,r,n,!0);const a=[];if(!s||s.next===s.prev)return a;let o,l,h,c,u,d,p;if(i&&(s=function(t,e,n,i){const r=[];let s,a,o,l,h;for(s=0,a=e.length;s<a;s++)o=e[s]*i,l=s<a-1?e[s+1]*i:t.length,h=Oo(t,o,l,i,!1),h===h.next&&(h.steiner=!0),r.push(jo(h));for(r.sort(Go),s=0;s<r.length;s++)n=Ho(r[s],n);return n}(t,e,s,n)),t.length>80*n){o=h=t[0],l=c=t[1];for(let e=n;e<r;e+=n)u=t[e],d=t[e+1],u<o&&(o=u),d<l&&(l=d),u>h&&(h=u),d>c&&(c=d);p=Math.max(h-o,c-l),p=0!==p?32767/p:0}return Do(s,a,n,o,l,p,0),a};function Oo(t,e,n,i,r){let s,a;if(r===function(t,e,n,i){let r=0;for(let s=e,a=n-i;s<n;s+=i)r+=(t[a]-t[s])*(t[s+1]+t[a+1]),a=s;return r}(t,e,n,i)>0)for(s=e;s<n;s+=i)a=il(s,t[s],t[s+1],a);else for(s=n-i;s>=e;s-=i)a=il(s,t[s],t[s+1],a);return a&&Zo(a,a.next)&&(rl(a),a=a.next),a}function Uo(t,e){if(!t)return t;e||(e=t);let n,i=t;do{if(n=!1,i.steiner||!Zo(i,i.next)&&0!==Ko(i.prev,i,i.next))i=i.next;else{if(rl(i),i=e=i.prev,i===i.next)break;n=!0}}while(n||i!==e);return e}function Do(t,e,n,i,r,s,a){if(!t)return;!a&&s&&function(t,e,n,i){let r=t;do{0===r.z&&(r.z=Xo(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){let e,n,i,r,s,a,o,l,h=1;do{for(n=t,t=null,s=null,a=0;n;){for(a++,i=n,o=0,e=0;e<h&&(o++,i=i.nextZ,i);e++);for(l=h;o>0||l>0&&i;)0!==o&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,o--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,h*=2}while(a>1)}(r)}(t,i,r,s);let o,l,h=t;for(;t.prev!==t.next;)if(o=t.prev,l=t.next,s?Bo(t,i,r,s):Fo(t))e.push(o.i/n|0),e.push(t.i/n|0),e.push(l.i/n|0),rl(t),t=l.next,h=l.next;else if((t=l)===h){a?1===a?Do(t=zo(Uo(t),e,n),e,n,i,r,s,2):2===a&&Vo(t,e,n,i,r,s):Do(Uo(t),e,n,i,r,s,1);break}}function Fo(t){const e=t.prev,n=t,i=t.next;if(Ko(e,n,i)>=0)return!1;const r=e.x,s=n.x,a=i.x,o=e.y,l=n.y,h=i.y,c=r<s?r<a?r:a:s<a?s:a,u=o<l?o<h?o:h:l<h?l:h,d=r>s?r>a?r:a:s>a?s:a,p=o>l?o>h?o:h:l>h?l:h;let f=i.next;for(;f!==e;){if(f.x>=c&&f.x<=d&&f.y>=u&&f.y<=p&&Jo(r,o,s,l,a,h,f.x,f.y)&&Ko(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Bo(t,e,n,i){const r=t.prev,s=t,a=t.next;if(Ko(r,s,a)>=0)return!1;const o=r.x,l=s.x,h=a.x,c=r.y,u=s.y,d=a.y,p=o<l?o<h?o:h:l<h?l:h,f=c<u?c<d?c:d:u<d?u:d,m=o>l?o>h?o:h:l>h?l:h,g=c>u?c>d?c:d:u>d?u:d,v=Xo(p,f,e,n,i),_=Xo(m,g,e,n,i);let x=t.prevZ,y=t.nextZ;for(;x&&x.z>=v&&y&&y.z<=_;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==r&&x!==a&&Jo(o,c,l,u,h,d,x.x,x.y)&&Ko(x.prev,x,x.next)>=0)return!1;if(x=x.prevZ,y.x>=p&&y.x<=m&&y.y>=f&&y.y<=g&&y!==r&&y!==a&&Jo(o,c,l,u,h,d,y.x,y.y)&&Ko(y.prev,y,y.next)>=0)return!1;y=y.nextZ}for(;x&&x.z>=v;){if(x.x>=p&&x.x<=m&&x.y>=f&&x.y<=g&&x!==r&&x!==a&&Jo(o,c,l,u,h,d,x.x,x.y)&&Ko(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;y&&y.z<=_;){if(y.x>=p&&y.x<=m&&y.y>=f&&y.y<=g&&y!==r&&y!==a&&Jo(o,c,l,u,h,d,y.x,y.y)&&Ko(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}function zo(t,e,n){let i=t;do{const r=i.prev,s=i.next.next;!Zo(r,s)&&Yo(r,i,i.next,s)&&el(r,s)&&el(s,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(s.i/n|0),rl(i),rl(i.next),i=t=s),i=i.next}while(i!==t);return Uo(i)}function Vo(t,e,n,i,r,s){let a=t;do{let t=a.next.next;for(;t!==a.prev;){if(a.i!==t.i&&Qo(a,t)){let o=nl(a,t);return a=Uo(a,a.next),o=Uo(o,o.next),Do(a,e,n,i,r,s,0),void Do(o,e,n,i,r,s,0)}t=t.next}a=a.next}while(a!==t)}function Go(t,e){return t.x-e.x}function Ho(t,e){const n=function(t,e){let n,i=e,r=-1/0;const s=t.x,a=t.y;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){const t=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(t<=s&&t>r&&(r=t,n=i.x<i.next.x?i:i.next,t===s))return n}i=i.next}while(i!==e);if(!n)return null;const o=n,l=n.x,h=n.y;let c,u=1/0;i=n;do{s>=i.x&&i.x>=l&&s!==i.x&&Jo(a<h?s:r,a,l,h,a<h?r:s,a,i.x,i.y)&&(c=Math.abs(a-i.y)/(s-i.x),el(i,t)&&(c<u||c===u&&(i.x>n.x||i.x===n.x&&qo(n,i)))&&(n=i,u=c)),i=i.next}while(i!==o);return n}(t,e);if(!n)return e;const i=nl(n,t);return Uo(i,i.next),Uo(n,n.next)}function qo(t,e){return Ko(t.prev,t,e.prev)<0&&Ko(e.next,t,t.next)<0}function Xo(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function jo(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Jo(t,e,n,i,r,s,a,o){return(r-a)*(e-o)>=(t-a)*(s-o)&&(t-a)*(i-o)>=(n-a)*(e-o)&&(n-a)*(s-o)>=(r-a)*(i-o)}function Qo(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Yo(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(el(t,e)&&el(e,t)&&function(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(Ko(t.prev,t,e.prev)||Ko(t,e.prev,e))||Zo(t,e)&&Ko(t.prev,t,t.next)>0&&Ko(e.prev,e,e.next)>0)}function Ko(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function Zo(t,e){return t.x===e.x&&t.y===e.y}function Yo(t,e,n,i){const r=tl(Ko(t,e,n)),s=tl(Ko(t,e,i)),a=tl(Ko(n,i,t)),o=tl(Ko(n,i,e));return r!==s&&a!==o||(!(0!==r||!$o(t,n,e))||(!(0!==s||!$o(t,i,e))||(!(0!==a||!$o(n,t,i))||!(0!==o||!$o(n,e,i)))))}function $o(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function tl(t){return t>0?1:t<0?-1:0}function el(t,e){return Ko(t.prev,t,t.next)<0?Ko(t,e,t.next)>=0&&Ko(t,t.prev,e)>=0:Ko(t,e,t.prev)<0||Ko(t,t.next,e)<0}function nl(t,e){const n=new sl(t.i,t.x,t.y),i=new sl(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function il(t,e,n,i){const r=new sl(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function rl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function sl(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class al{static area(t){const e=t.length;let n=0;for(let i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return.5*n}static isClockWise(t){return al.area(t)<0}static triangulateShape(t,e){const n=[],i=[],r=[];ol(t),ll(n,t);let s=t.length;e.forEach(ol);for(let o=0;o<e.length;o++)i.push(s),s+=e[o].length,ll(n,e[o]);const a=No(n,i);for(let o=0;o<a.length;o+=3)r.push(a.slice(o,o+3));return r}}function ol(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function ll(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class hl extends Vi{constructor(t=new ko([new Le(.5,.5),new Le(-.5,.5),new Le(-.5,-.5),new Le(.5,-.5)]),e={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const n=this,i=[],r=[];for(let a=0,o=t.length;a<o;a++){s(t[a])}function s(t){const s=[],a=void 0!==e.curveSegments?e.curveSegments:12,o=void 0!==e.steps?e.steps:1,l=void 0!==e.depth?e.depth:1;let h=void 0===e.bevelEnabled||e.bevelEnabled,c=void 0!==e.bevelThickness?e.bevelThickness:.2,u=void 0!==e.bevelSize?e.bevelSize:c-.1,d=void 0!==e.bevelOffset?e.bevelOffset:0,p=void 0!==e.bevelSegments?e.bevelSegments:3;const f=e.extrudePath,m=void 0!==e.UVGenerator?e.UVGenerator:cl;let g,v,_,x,y,S=!1;f&&(g=f.getSpacedPoints(o),S=!0,h=!1,v=f.computeFrenetFrames(o,!1),_=new on,x=new on,y=new on),h||(p=0,c=0,u=0,d=0);const b=t.extractPoints(a);let M=b.shape;const w=b.holes;if(!al.isClockWise(M)){M=M.reverse();for(let t=0,e=w.length;t<e;t++){const e=w[t];al.isClockWise(e)&&(w[t]=e.reverse())}}const C=al.triangulateShape(M,w),T=M;for(let e=0,n=w.length;e<n;e++){const t=w[e];M=M.concat(t)}function E(t,e,n){return t.clone().addScaledVector(e,n)}const A=M.length,P=C.length;function R(t,e,n){let i,r,s;const a=t.x-e.x,o=t.y-e.y,l=n.x-t.x,h=n.y-t.y,c=a*a+o*o,u=a*h-o*l;if(Math.abs(u)>Number.EPSILON){const u=Math.sqrt(c),d=Math.sqrt(l*l+h*h),p=e.x-o/u,f=e.y+a/u,m=((n.x-h/d-p)*h-(n.y+l/d-f)*l)/(a*h-o*l);i=p+a*m-t.x,r=f+o*m-t.y;const g=i*i+r*r;if(g<=2)return new Le(i,r);s=Math.sqrt(g/2)}else{let t=!1;a>Number.EPSILON?l>Number.EPSILON&&(t=!0):a<-Number.EPSILON?l<-Number.EPSILON&&(t=!0):Math.sign(o)===Math.sign(h)&&(t=!0),t?(i=-o,r=a,s=Math.sqrt(c)):(i=a,r=o,s=Math.sqrt(c/2))}return new Le(i/s,r/s)}const W=[];for(let e=0,n=T.length,i=n-1,r=e+1;e<n;e++,i++,r++)i===n&&(i=0),r===n&&(r=0),W[e]=R(T[e],T[i],T[r]);const L=[];let I,k=W.concat();for(let e=0,n=w.length;e<n;e++){const t=w[e];I=[];for(let e=0,n=t.length,i=n-1,r=e+1;e<n;e++,i++,r++)i===n&&(i=0),r===n&&(r=0),I[e]=R(t[e],t[i],t[r]);L.push(I),k=k.concat(I)}for(let e=0;e<p;e++){const t=e/p,n=c*Math.cos(t*Math.PI/2),i=u*Math.sin(t*Math.PI/2)+d;for(let e=0,r=T.length;e<r;e++){const t=E(T[e],W[e],i);U(t.x,t.y,-n)}for(let e=0,r=w.length;e<r;e++){const t=w[e];I=L[e];for(let e=0,r=t.length;e<r;e++){const r=E(t[e],I[e],i);U(r.x,r.y,-n)}}}const N=u+d;for(let e=0;e<A;e++){const t=h?E(M[e],k[e],N):M[e];S?(x.copy(v.normals[0]).multiplyScalar(t.x),_.copy(v.binormals[0]).multiplyScalar(t.y),y.copy(g[0]).add(x).add(_),U(y.x,y.y,y.z)):U(t.x,t.y,0)}for(let e=1;e<=o;e++)for(let t=0;t<A;t++){const n=h?E(M[t],k[t],N):M[t];S?(x.copy(v.normals[e]).multiplyScalar(n.x),_.copy(v.binormals[e]).multiplyScalar(n.y),y.copy(g[e]).add(x).add(_),U(y.x,y.y,y.z)):U(n.x,n.y,l/o*e)}for(let e=p-1;e>=0;e--){const t=e/p,n=c*Math.cos(t*Math.PI/2),i=u*Math.sin(t*Math.PI/2)+d;for(let e=0,r=T.length;e<r;e++){const t=E(T[e],W[e],i);U(t.x,t.y,l+n)}for(let e=0,r=w.length;e<r;e++){const t=w[e];I=L[e];for(let e=0,r=t.length;e<r;e++){const r=E(t[e],I[e],i);S?U(r.x,r.y+g[o-1].y,g[o-1].x+n):U(r.x,r.y,l+n)}}}function O(t,e){let n=t.length;for(;--n>=0;){const i=n;let r=n-1;r<0&&(r=t.length-1);for(let t=0,n=o+2*p;t<n;t++){const n=A*t,s=A*(t+1);F(e+i+n,e+r+n,e+r+s,e+i+s)}}}function U(t,e,n){s.push(t),s.push(e),s.push(n)}function D(t,e,r){B(t),B(e),B(r);const s=i.length/3,a=m.generateTopUV(n,i,s-3,s-2,s-1);z(a[0]),z(a[1]),z(a[2])}function F(t,e,r,s){B(t),B(e),B(s),B(e),B(r),B(s);const a=i.length/3,o=m.generateSideWallUV(n,i,a-6,a-3,a-2,a-1);z(o[0]),z(o[1]),z(o[3]),z(o[1]),z(o[2]),z(o[3])}function B(t){i.push(s[3*t+0]),i.push(s[3*t+1]),i.push(s[3*t+2])}function z(t){r.push(t.x),r.push(t.y)}!function(){const t=i.length/3;if(h){let t=0,e=A*t;for(let n=0;n<P;n++){const t=C[n];D(t[2]+e,t[1]+e,t[0]+e)}t=o+2*p,e=A*t;for(let n=0;n<P;n++){const t=C[n];D(t[0]+e,t[1]+e,t[2]+e)}}else{for(let t=0;t<P;t++){const e=C[t];D(e[2],e[1],e[0])}for(let t=0;t<P;t++){const e=C[t];D(e[0]+A*o,e[1]+A*o,e[2]+A*o)}}n.addGroup(t,i.length/3-t,0)}(),function(){const t=i.length/3;let e=0;O(T,e),e+=T.length;for(let n=0,i=w.length;n<i;n++){const t=w[n];O(t,e),e+=t.length}n.addGroup(t,i.length/3-t,1)}()}this.setAttribute("position",new ki(i,3)),this.setAttribute("uv",new ki(r,2)),this.computeVertexNormals()}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}toJSON(){const t=super.toJSON();return function(t,e,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++){const e=t[i];n.shapes.push(e.uuid)}else n.shapes.push(t.uuid);n.options=Object.assign({},e),void 0!==e.extrudePath&&(n.options.extrudePath=e.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,t)}static fromJSON(t,e){const n=[];for(let r=0,s=t.shapes.length;r<s;r++){const i=e[t.shapes[r]];n.push(i)}const i=t.options.extrudePath;return void 0!==i&&(t.options.extrudePath=(new Wo[i.type]).fromJSON(i)),new hl(n,t.options)}}const cl={generateTopUV:function(t,e,n,i,r){const s=e[3*n],a=e[3*n+1],o=e[3*i],l=e[3*i+1],h=e[3*r],c=e[3*r+1];return[new Le(s,a),new Le(o,l),new Le(h,c)]},generateSideWallUV:function(t,e,n,i,r,s){const a=e[3*n],o=e[3*n+1],l=e[3*n+2],h=e[3*i],c=e[3*i+1],u=e[3*i+2],d=e[3*r],p=e[3*r+1],f=e[3*r+2],m=e[3*s],g=e[3*s+1],v=e[3*s+2];return Math.abs(o-c)<Math.abs(a-h)?[new Le(a,1-l),new Le(h,1-u),new Le(d,1-f),new Le(m,1-v)]:[new Le(o,1-l),new Le(c,1-u),new Le(p,1-f),new Le(g,1-v)]}};class ul extends Ei{constructor(t){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new wi(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Le(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class dl extends ul{constructor(t){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Le(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Te(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new wi(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new wi(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new wi(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(t)}get anisotropy(){return this._anisotropy}set anisotropy(t){this._anisotropy>0!=t>0&&this.version++,this._anisotropy=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!=t>0&&this.version++,this._clearcoat=t}get iridescence(){return this._iridescence}set iridescence(t){this._iridescence>0!=t>0&&this.version++,this._iridescence=t}get sheen(){return this._sheen}set sheen(t){this._sheen>0!=t>0&&this.version++,this._sheen=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!=t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=t.anisotropy,this.anisotropyRotation=t.anisotropyRotation,this.anisotropyMap=t.anisotropyMap,this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.iridescence=t.iridescence,this.iridescenceMap=t.iridescenceMap,this.iridescenceIOR=t.iridescenceIOR,this.iridescenceThicknessRange=[...t.iridescenceThicknessRange],this.iridescenceThicknessMap=t.iridescenceThicknessMap,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}}class pl extends Ei{constructor(t){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new wi(16777215),this.specular=new wi(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Le(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=wt,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class fl extends Ei{constructor(t){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new wi(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new wi(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Le(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}class ml extends Ei{constructor(t){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new wi(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Le(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.flatShading=t.flatShading,this.fog=t.fog,this}}const gl={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class vl{constructor(t,e,n){const i=this;let r,s=!1,a=0,o=0;const l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){o++,!1===s&&void 0!==i.onStart&&i.onStart(t,a,o),s=!0},this.itemEnd=function(t){a++,void 0!==i.onProgress&&i.onProgress(t,a,o),a===o&&(s=!1,void 0!==i.onLoad&&i.onLoad())},this.itemError=function(t){void 0!==i.onError&&i.onError(t)},this.resolveURL=function(t){return r?r(t):t},this.setURLModifier=function(t){return r=t,this},this.addHandler=function(t,e){return l.push(t,e),this},this.removeHandler=function(t){const e=l.indexOf(t);return-1!==e&&l.splice(e,2),this},this.getHandler=function(t){for(let e=0,n=l.length;e<n;e+=2){const n=l[e],i=l[e+1];if(n.global&&(n.lastIndex=0),n.test(t))return i}return null}}}const _l=new vl;class xl{constructor(t){this.manager=void 0!==t?t:_l,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){const n=this;return new Promise((function(i,r){n.load(t,i,e,r)}))}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}xl.DEFAULT_MATERIAL_NAME="__DEFAULT";const yl={};class Sl extends Error{constructor(t,e){super(t),this.response=e}}class bl extends xl{constructor(t){super(t)}load(t,e,n,i){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=gl.get(t);if(void 0!==r)return this.manager.itemStart(t),setTimeout((()=>{e&&e(r),this.manager.itemEnd(t)}),0),r;if(void 0!==yl[t])return void yl[t].push({onLoad:e,onProgress:n,onError:i});yl[t]=[],yl[t].push({onLoad:e,onProgress:n,onError:i});const s=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,o=this.responseType;fetch(s).then((e=>{if(200===e.status||0===e.status){if(e.status,"undefined"==typeof ReadableStream||void 0===e.body||void 0===e.body.getReader)return e;const n=yl[t],i=e.body.getReader(),r=e.headers.get("Content-Length")||e.headers.get("X-File-Size"),s=r?parseInt(r):0,a=0!==s;let o=0;const l=new ReadableStream({start(t){!function e(){i.read().then((({done:i,value:r})=>{if(i)t.close();else{o+=r.byteLength;const i=new ProgressEvent("progress",{lengthComputable:a,loaded:o,total:s});for(let t=0,e=n.length;t<e;t++){const e=n[t];e.onProgress&&e.onProgress(i)}t.enqueue(r),e()}}))}()}});return new Response(l)}throw new Sl(`fetch for "${e.url}" responded with ${e.status}: ${e.statusText}`,e)})).then((t=>{switch(o){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"document":return t.text().then((t=>(new DOMParser).parseFromString(t,a)));case"json":return t.json();default:if(void 0===a)return t.text();{const e=/charset="?([^;"\s]*)"?/i.exec(a),n=e&&e[1]?e[1].toLowerCase():void 0,i=new TextDecoder(n);return t.arrayBuffer().then((t=>i.decode(t)))}}})).then((e=>{gl.add(t,e);const n=yl[t];delete yl[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onLoad&&i.onLoad(e)}})).catch((e=>{const n=yl[t];if(void 0===n)throw this.manager.itemError(t),e;delete yl[t];for(let t=0,i=n.length;t<i;t++){const i=n[t];i.onError&&i.onError(e)}this.manager.itemError(t)})).finally((()=>{this.manager.itemEnd(t)})),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class Ml extends xl{constructor(t){super(t)}load(t,e,n,i){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const r=this,s=gl.get(t);if(void 0!==s)return r.manager.itemStart(t),setTimeout((function(){e&&e(s),r.manager.itemEnd(t)}),0),s;const a=Oe("img");function o(){h(),gl.add(t,this),e&&e(this),r.manager.itemEnd(t)}function l(e){h(),i&&i(e),r.manager.itemError(t),r.manager.itemEnd(t)}function h(){a.removeEventListener("load",o,!1),a.removeEventListener("error",l,!1)}return a.addEventListener("load",o,!1),a.addEventListener("error",l,!1),"data:"!==t.slice(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),r.manager.itemStart(t),a.src=t,a}}class wl extends xl{constructor(t){super(t)}load(t,e,n,i){const r=new $e,s=new Ml(this.manager);return s.setCrossOrigin(this.crossOrigin),s.setPath(this.path),s.load(t,(function(t){r.image=t,r.needsUpdate=!0,void 0!==e&&e(r)}),n,i),r}}class Cl extends li{constructor(t,e=1){super(),this.isLight=!0,this.type="Light",this.color=new wi(t),this.intensity=e}dispose(){}copy(t,e){return super.copy(t,e),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}const Tl=new Un,El=new on,Al=new on;class Pl{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Le(512,512),this.map=null,this.mapPass=null,this.matrix=new Un,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Pr,this._frameExtents=new Le(1,1),this._viewportCount=1,this._viewports=[new tn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const e=this.camera,n=this.matrix;El.setFromMatrixPosition(t.matrixWorld),e.position.copy(El),Al.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(Al),e.updateMatrixWorld(),Tl.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Tl),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Tl)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class Rl extends Pl{constructor(){super(new _r(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(t){const e=this.camera,n=2*we*t.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;n===e.fov&&i===e.aspect&&r===e.far||(e.fov=n,e.aspect=i,e.far=r,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}class Wl extends Cl{constructor(t,e,n=0,i=Math.PI/3,r=0,s=2){super(t,e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(li.DEFAULT_UP),this.updateMatrix(),this.target=new li,this.distance=n,this.angle=i,this.penumbra=r,this.decay=s,this.map=null,this.shadow=new Rl}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}const Ll=new Un,Il=new on,kl=new on;class Nl extends Pl{constructor(){super(new _r(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Le(4,2),this._viewportCount=6,this._viewports=[new tn(2,1,1,1),new tn(0,1,1,1),new tn(3,1,1,1),new tn(1,1,1,1),new tn(3,0,1,1),new tn(1,0,1,1)],this._cubeDirections=[new on(1,0,0),new on(-1,0,0),new on(0,0,1),new on(0,0,-1),new on(0,1,0),new on(0,-1,0)],this._cubeUps=[new on(0,1,0),new on(0,1,0),new on(0,1,0),new on(0,1,0),new on(0,0,1),new on(0,0,-1)]}updateMatrices(t,e=0){const n=this.camera,i=this.matrix,r=t.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),Il.setFromMatrixPosition(t.matrixWorld),n.position.copy(Il),kl.copy(n.position),kl.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(kl),n.updateMatrixWorld(),i.makeTranslation(-Il.x,-Il.y,-Il.z),Ll.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Ll)}}class Ol extends Cl{constructor(t,e,n=0,i=2){super(t,e),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new Nl}get power(){return 4*this.intensity*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}class Ul extends Pl{constructor(){super(new Gr(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Dl extends Cl{constructor(t,e){super(t,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(li.DEFAULT_UP),this.updateMatrix(),this.target=new li,this.shadow=new Ul}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}const Fl=new Le;class Bl{constructor(t=new Le(1/0,1/0),e=new Le(-1/0,-1/0)){this.isBox2=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const n=Fl.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,Fl).distanceTo(t)}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}class zl{constructor(){this.type="ShapePath",this.color=new wi,this.subPaths=[],this.currentPath=null}moveTo(t,e){return this.currentPath=new Io,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this}lineTo(t,e){return this.currentPath.lineTo(t,e),this}quadraticCurveTo(t,e,n,i){return this.currentPath.quadraticCurveTo(t,e,n,i),this}bezierCurveTo(t,e,n,i,r,s){return this.currentPath.bezierCurveTo(t,e,n,i,r,s),this}splineThru(t){return this.currentPath.splineThru(t),this}toShapes(t){function e(t,e){const n=e.length;let i=!1;for(let r=n-1,s=0;s<n;r=s++){let n=e[r],a=e[s],o=a.x-n.x,l=a.y-n.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(n=e[s],o=-o,a=e[r],l=-l),t.y<n.y||t.y>a.y)continue;if(t.y===n.y){if(t.x===n.x)return!0}else{const e=l*(t.x-n.x)-o*(t.y-n.y);if(0===e)return!0;if(e<0)continue;i=!i}}else{if(t.y!==n.y)continue;if(a.x<=t.x&&t.x<=n.x||n.x<=t.x&&t.x<=a.x)return!0}}return i}const n=al.isClockWise,i=this.subPaths;if(0===i.length)return[];let r,s,a;const o=[];if(1===i.length)return s=i[0],a=new ko,a.curves=s.curves,o.push(a),o;let l=!n(i[0].getPoints());l=t?!l:l;const h=[],c=[];let u,d,p=[],f=0;c[f]=void 0,p[f]=[];for(let m=0,g=i.length;m<g;m++)s=i[m],u=s.getPoints(),r=n(u),r=t?!r:r,r?(!l&&c[f]&&f++,c[f]={s:new ko,p:u},c[f].s.curves=s.curves,l&&f++,p[f]=[]):p[f].push({h:s,p:u[0]});if(!c[0])return function(t){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n],r=new ko;r.curves=i.curves,e.push(r)}return e}(i);if(c.length>1){let t=!1,n=0;for(let e=0,i=c.length;e<i;e++)h[e]=[];for(let i=0,r=c.length;i<r;i++){const r=p[i];for(let s=0;s<r.length;s++){const a=r[s];let o=!0;for(let r=0;r<c.length;r++)e(a.p,c[r].p)&&(i!==r&&n++,o?(o=!1,h[r].push(a)):t=!0);o&&h[i].push(a)}}n>0&&!1===t&&(p=h)}for(let m=0,g=c.length;m<g;m++){a=c[m].s,o.push(a),d=p[m];for(let t=0,e=d.length;t<e;t++)a.holes.push(d[t].h)}return o}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:vt}})),"undefined"!=typeof window&&(window.__THREE__||(window.__THREE__=vt));const Vl=le;class Gl extends xl{constructor(t){super(t),this.defaultDPI=90,this.defaultUnit="px"}load(t,e,n,i){const r=this,s=new bl(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(t,(function(n){try{e(r.parse(n))}catch(s){i&&i(s),r.manager.itemError(t)}}),n,i)}parse(t){const e=this;function n(t,e,n,r,s,a,o,l){if(0==e||0==n)return void t.lineTo(l.x,l.y);r=r*Math.PI/180,e=Math.abs(e),n=Math.abs(n);const h=(o.x-l.x)/2,c=(o.y-l.y)/2,u=Math.cos(r)*h+Math.sin(r)*c,d=-Math.sin(r)*h+Math.cos(r)*c;let p=e*e,f=n*n;const m=u*u,g=d*d,v=m/p+g/f;if(v>1){const t=Math.sqrt(v);p=(e*=t)*e,f=(n*=t)*n}const _=p*g+f*m,x=(p*f-_)/_;let y=Math.sqrt(Math.max(0,x));s===a&&(y=-y);const S=y*e*d/n,b=-y*n*u/e,M=Math.cos(r)*S-Math.sin(r)*b+(o.x+l.x)/2,w=Math.sin(r)*S+Math.cos(r)*b+(o.y+l.y)/2,C=i(1,0,(u-S)/e,(d-b)/n),T=i((u-S)/e,(d-b)/n,(-u-S)/e,(-d-b)/n)%(2*Math.PI);t.currentPath.absellipse(M,w,e,n,C,C+T,0===a,r)}function i(t,e,n,i){const r=t*n+e*i,s=Math.sqrt(t*t+e*e)*Math.sqrt(n*n+i*i);let a=Math.acos(Math.max(-1,Math.min(1,r/s)));return t*i-e*n<0&&(a=-a),a}function r(t,e){e=Object.assign({},e);let n={};if(t.hasAttribute("class")){const e=t.getAttribute("class").split(/\s/).filter(Boolean).map((t=>t.trim()));for(let t=0;t<e.length;t++)n=Object.assign(n,m["."+e[t]])}function i(i,r,s){void 0===s&&(s=function(t){return t.startsWith("url"),t}),t.hasAttribute(i)&&(e[r]=s(t.getAttribute(i))),n[i]&&(e[r]=s(n[i])),t.style&&""!==t.style[i]&&(e[r]=s(t.style[i]))}function r(t){return Math.max(0,Math.min(1,h(t)))}function s(t){return Math.max(0,h(t))}return t.hasAttribute("id")&&(n=Object.assign(n,m["#"+t.getAttribute("id")])),i("fill","fill"),i("fill-opacity","fillOpacity",r),i("fill-rule","fillRule"),i("opacity","opacity",r),i("stroke","stroke"),i("stroke-opacity","strokeOpacity",r),i("stroke-width","strokeWidth",s),i("stroke-linejoin","strokeLineJoin"),i("stroke-linecap","strokeLineCap"),i("stroke-miterlimit","strokeMiterLimit",s),i("visibility","visibility"),e}function s(t,e){return t-(e-t)}function a(t,e,n){if("string"!=typeof t)throw new TypeError("Invalid input: "+typeof t);const i={SEPARATOR:/[ \t\r\n\,.\-+]/,WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/};let r=0,s=!0,a="",o="";const l=[];function h(t,e,n){const i=new SyntaxError('Unexpected character "'+t+'" at index '+e+".");throw i.partial=n,i}function c(){""!==a&&(""===o?l.push(Number(a)):l.push(Number(a)*Math.pow(10,Number(o)))),a="",o=""}let u;const d=t.length;for(let p=0;p<d;p++)if(u=t[p],Array.isArray(e)&&e.includes(l.length%n)&&i.FLAGS.test(u))r=1,a=u,c();else{if(0===r){if(i.WHITESPACE.test(u))continue;if(i.DIGIT.test(u)||i.SIGN.test(u)){r=1,a=u;continue}if(i.POINT.test(u)){r=2,a=u;continue}i.COMMA.test(u)&&(s&&h(u,p,l),s=!0)}if(1===r){if(i.DIGIT.test(u)){a+=u;continue}if(i.POINT.test(u)){a+=u,r=2;continue}if(i.EXP.test(u)){r=3;continue}i.SIGN.test(u)&&1===a.length&&i.SIGN.test(a[0])&&h(u,p,l)}if(2===r){if(i.DIGIT.test(u)){a+=u;continue}if(i.EXP.test(u)){r=3;continue}i.POINT.test(u)&&"."===a[a.length-1]&&h(u,p,l)}if(3===r){if(i.DIGIT.test(u)){o+=u;continue}if(i.SIGN.test(u)){if(""===o){o+=u;continue}1===o.length&&i.SIGN.test(o)&&h(u,p,l)}}i.WHITESPACE.test(u)?(c(),r=0,s=!1):i.COMMA.test(u)?(c(),r=0,s=!0):i.SIGN.test(u)?(c(),r=1,a=u):i.POINT.test(u)?(c(),r=2,a=u):h(u,p,l)}return c(),l}const o=["mm","cm","in","pt","pc","px"],l={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:12,pc:1,px:-1},px:{px:1}};function h(t){let n,i="px";if("string"==typeof t||t instanceof String)for(let e=0,r=o.length;e<r;e++){const n=o[e];if(t.endsWith(n)){i=n,t=t.substring(0,t.length-n.length);break}}return"px"===i&&"px"!==e.defaultUnit?n=l.in[e.defaultUnit]/e.defaultDPI:(n=l[i][e.defaultUnit],n<0&&(n=l[i].in*e.defaultDPI)),n*parseFloat(t)}function c(t){const e=t.elements;return e[0]*e[4]-e[1]*e[3]<0}function u(t){const e=t.elements,n=e[0]*e[3]+e[1]*e[4];if(0===n)return!1;const i=d(t),r=p(t);return Math.abs(n/(i*r))>Number.EPSILON}function d(t){const e=t.elements;return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function p(t){const e=t.elements;return Math.sqrt(e[3]*e[3]+e[4]*e[4])}const f=[],m={},g=[],v=new Ie,_=new Ie,x=new Ie,y=new Ie,S=new Le,b=new on,M=new Ie,w=(new DOMParser).parseFromString(t,"image/svg+xml");!function t(e,i){if(1!==e.nodeType)return;const o=function(t){if(!(t.hasAttribute("transform")||"use"===t.nodeName&&(t.hasAttribute("x")||t.hasAttribute("y"))))return null;const e=function(t){const e=new Ie,n=v;if("use"===t.nodeName&&(t.hasAttribute("x")||t.hasAttribute("y"))){const n=h(t.getAttribute("x")),i=h(t.getAttribute("y"));e.translate(n,i)}if(t.hasAttribute("transform")){const i=t.getAttribute("transform").split(")");for(let t=i.length-1;t>=0;t--){const r=i[t].trim();if(""===r)continue;const s=r.indexOf("("),o=r.length;if(s>0&&s<o){const t=r.slice(0,s),e=a(r.slice(s+1));switch(n.identity(),t){case"translate":if(e.length>=1){const t=e[0];let i=0;e.length>=2&&(i=e[1]),n.translate(t,i)}break;case"rotate":if(e.length>=1){let t=0,i=0,r=0;t=e[0]*Math.PI/180,e.length>=3&&(i=e[1],r=e[2]),_.makeTranslation(-i,-r),x.makeRotation(t),y.multiplyMatrices(x,_),_.makeTranslation(i,r),n.multiplyMatrices(_,y)}break;case"scale":if(e.length>=1){const t=e[0];let i=t;e.length>=2&&(i=e[1]),n.scale(t,i)}break;case"skewX":1===e.length&&n.set(1,Math.tan(e[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":1===e.length&&n.set(1,0,0,Math.tan(e[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":6===e.length&&n.set(e[0],e[2],e[4],e[1],e[3],e[5],0,0,1)}}e.premultiply(n)}}return e}(t);g.length>0&&e.premultiply(g[g.length-1]);return M.copy(e),g.push(e),e}(e);let l=!1,w=null;switch(e.nodeName){case"svg":case"g":i=r(e,i);break;case"style":!function(t){if(!t.sheet||!t.sheet.cssRules||!t.sheet.cssRules.length)return;for(let e=0;e<t.sheet.cssRules.length;e++){const n=t.sheet.cssRules[e];if(1!==n.type)continue;const i=n.selectorText.split(/,/gm).filter(Boolean).map((t=>t.trim()));for(let t=0;t<i.length;t++){const e=Object.fromEntries(Object.entries(n.style).filter((([,t])=>""!==t)));m[i[t]]=Object.assign(m[i[t]]||{},e)}}}(e);break;case"path":i=r(e,i),e.hasAttribute("d")&&(w=function(t){const e=new zl,i=new Le,r=new Le,o=new Le;let l=!0,h=!1;const c=t.getAttribute("d");if(""===c||"none"===c)return null;const u=c.match(/[a-df-z][^a-df-z]*/gi);for(let d=0,p=u.length;d<p;d++){const t=u[d],c=t.charAt(0),p=t.slice(1).trim();let f;switch(!0===l&&(h=!0,l=!1),c){case"M":f=a(p);for(let t=0,n=f.length;t<n;t+=2)i.x=f[t+0],i.y=f[t+1],r.x=i.x,r.y=i.y,0===t?e.moveTo(i.x,i.y):e.lineTo(i.x,i.y),0===t&&o.copy(i);break;case"H":f=a(p);for(let t=0,n=f.length;t<n;t++)i.x=f[t],r.x=i.x,r.y=i.y,e.lineTo(i.x,i.y),0===t&&!0===h&&o.copy(i);break;case"V":f=a(p);for(let t=0,n=f.length;t<n;t++)i.y=f[t],r.x=i.x,r.y=i.y,e.lineTo(i.x,i.y),0===t&&!0===h&&o.copy(i);break;case"L":f=a(p);for(let t=0,n=f.length;t<n;t+=2)i.x=f[t+0],i.y=f[t+1],r.x=i.x,r.y=i.y,e.lineTo(i.x,i.y),0===t&&!0===h&&o.copy(i);break;case"C":f=a(p);for(let t=0,n=f.length;t<n;t+=6)e.bezierCurveTo(f[t+0],f[t+1],f[t+2],f[t+3],f[t+4],f[t+5]),r.x=f[t+2],r.y=f[t+3],i.x=f[t+4],i.y=f[t+5],0===t&&!0===h&&o.copy(i);break;case"S":f=a(p);for(let t=0,n=f.length;t<n;t+=4)e.bezierCurveTo(s(i.x,r.x),s(i.y,r.y),f[t+0],f[t+1],f[t+2],f[t+3]),r.x=f[t+0],r.y=f[t+1],i.x=f[t+2],i.y=f[t+3],0===t&&!0===h&&o.copy(i);break;case"Q":f=a(p);for(let t=0,n=f.length;t<n;t+=4)e.quadraticCurveTo(f[t+0],f[t+1],f[t+2],f[t+3]),r.x=f[t+0],r.y=f[t+1],i.x=f[t+2],i.y=f[t+3],0===t&&!0===h&&o.copy(i);break;case"T":f=a(p);for(let t=0,n=f.length;t<n;t+=2){const n=s(i.x,r.x),a=s(i.y,r.y);e.quadraticCurveTo(n,a,f[t+0],f[t+1]),r.x=n,r.y=a,i.x=f[t+0],i.y=f[t+1],0===t&&!0===h&&o.copy(i)}break;case"A":f=a(p,[3,4],7);for(let t=0,s=f.length;t<s;t+=7){if(f[t+5]==i.x&&f[t+6]==i.y)continue;const s=i.clone();i.x=f[t+5],i.y=f[t+6],r.x=i.x,r.y=i.y,n(e,f[t],f[t+1],f[t+2],f[t+3],f[t+4],s,i),0===t&&!0===h&&o.copy(i)}break;case"m":f=a(p);for(let t=0,n=f.length;t<n;t+=2)i.x+=f[t+0],i.y+=f[t+1],r.x=i.x,r.y=i.y,0===t?e.moveTo(i.x,i.y):e.lineTo(i.x,i.y),0===t&&o.copy(i);break;case"h":f=a(p);for(let t=0,n=f.length;t<n;t++)i.x+=f[t],r.x=i.x,r.y=i.y,e.lineTo(i.x,i.y),0===t&&!0===h&&o.copy(i);break;case"v":f=a(p);for(let t=0,n=f.length;t<n;t++)i.y+=f[t],r.x=i.x,r.y=i.y,e.lineTo(i.x,i.y),0===t&&!0===h&&o.copy(i);break;case"l":f=a(p);for(let t=0,n=f.length;t<n;t+=2)i.x+=f[t+0],i.y+=f[t+1],r.x=i.x,r.y=i.y,e.lineTo(i.x,i.y),0===t&&!0===h&&o.copy(i);break;case"c":f=a(p);for(let t=0,n=f.length;t<n;t+=6)e.bezierCurveTo(i.x+f[t+0],i.y+f[t+1],i.x+f[t+2],i.y+f[t+3],i.x+f[t+4],i.y+f[t+5]),r.x=i.x+f[t+2],r.y=i.y+f[t+3],i.x+=f[t+4],i.y+=f[t+5],0===t&&!0===h&&o.copy(i);break;case"s":f=a(p);for(let t=0,n=f.length;t<n;t+=4)e.bezierCurveTo(s(i.x,r.x),s(i.y,r.y),i.x+f[t+0],i.y+f[t+1],i.x+f[t+2],i.y+f[t+3]),r.x=i.x+f[t+0],r.y=i.y+f[t+1],i.x+=f[t+2],i.y+=f[t+3],0===t&&!0===h&&o.copy(i);break;case"q":f=a(p);for(let t=0,n=f.length;t<n;t+=4)e.quadraticCurveTo(i.x+f[t+0],i.y+f[t+1],i.x+f[t+2],i.y+f[t+3]),r.x=i.x+f[t+0],r.y=i.y+f[t+1],i.x+=f[t+2],i.y+=f[t+3],0===t&&!0===h&&o.copy(i);break;case"t":f=a(p);for(let t=0,n=f.length;t<n;t+=2){const n=s(i.x,r.x),a=s(i.y,r.y);e.quadraticCurveTo(n,a,i.x+f[t+0],i.y+f[t+1]),r.x=n,r.y=a,i.x=i.x+f[t+0],i.y=i.y+f[t+1],0===t&&!0===h&&o.copy(i)}break;case"a":f=a(p,[3,4],7);for(let t=0,s=f.length;t<s;t+=7){if(0==f[t+5]&&0==f[t+6])continue;const s=i.clone();i.x+=f[t+5],i.y+=f[t+6],r.x=i.x,r.y=i.y,n(e,f[t],f[t+1],f[t+2],f[t+3],f[t+4],s,i),0===t&&!0===h&&o.copy(i)}break;case"Z":case"z":e.currentPath.autoClose=!0,e.currentPath.curves.length>0&&(i.copy(o),e.currentPath.currentPoint.copy(i),l=!0)}h=!1}return e}(e));break;case"rect":i=r(e,i),w=function(t){const e=h(t.getAttribute("x")||0),n=h(t.getAttribute("y")||0),i=h(t.getAttribute("rx")||t.getAttribute("ry")||0),r=h(t.getAttribute("ry")||t.getAttribute("rx")||0),s=h(t.getAttribute("width")),a=h(t.getAttribute("height")),o=.448084975506,l=new zl;l.moveTo(e+i,n),l.lineTo(e+s-i,n),(0!==i||0!==r)&&l.bezierCurveTo(e+s-i*o,n,e+s,n+r*o,e+s,n+r);l.lineTo(e+s,n+a-r),(0!==i||0!==r)&&l.bezierCurveTo(e+s,n+a-r*o,e+s-i*o,n+a,e+s-i,n+a);l.lineTo(e+i,n+a),(0!==i||0!==r)&&l.bezierCurveTo(e+i*o,n+a,e,n+a-r*o,e,n+a-r);l.lineTo(e,n+r),(0!==i||0!==r)&&l.bezierCurveTo(e,n+r*o,e+i*o,n,e+i,n);return l}(e);break;case"polygon":i=r(e,i),w=function(t){function e(t,e,n){const s=h(e),a=h(n);0===r?i.moveTo(s,a):i.lineTo(s,a),r++}const n=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,i=new zl;let r=0;return t.getAttribute("points").replace(n,e),i.currentPath.autoClose=!0,i}(e);break;case"polyline":i=r(e,i),w=function(t){function e(t,e,n){const s=h(e),a=h(n);0===r?i.moveTo(s,a):i.lineTo(s,a),r++}const n=/([+-]?\d*\.?\d+(?:e[+-]?\d+)?)(?:,|\s)([+-]?\d*\.?\d+(?:e[+-]?\d+)?)/g,i=new zl;let r=0;return t.getAttribute("points").replace(n,e),i.currentPath.autoClose=!1,i}(e);break;case"circle":i=r(e,i),w=function(t){const e=h(t.getAttribute("cx")||0),n=h(t.getAttribute("cy")||0),i=h(t.getAttribute("r")||0),r=new Io;r.absarc(e,n,i,0,2*Math.PI);const s=new zl;return s.subPaths.push(r),s}(e);break;case"ellipse":i=r(e,i),w=function(t){const e=h(t.getAttribute("cx")||0),n=h(t.getAttribute("cy")||0),i=h(t.getAttribute("rx")||0),r=h(t.getAttribute("ry")||0),s=new Io;s.absellipse(e,n,i,r,0,2*Math.PI);const a=new zl;return a.subPaths.push(s),a}(e);break;case"line":i=r(e,i),w=function(t){const e=h(t.getAttribute("x1")||0),n=h(t.getAttribute("y1")||0),i=h(t.getAttribute("x2")||0),r=h(t.getAttribute("y2")||0),s=new zl;return s.moveTo(e,n),s.lineTo(i,r),s.currentPath.autoClose=!1,s}(e);break;case"defs":l=!0;break;case"use":i=r(e,i);const o=(e.getAttributeNS("http://www.w3.org/1999/xlink","href")||"").substring(1),c=e.viewportElement.getElementById(o);c&&t(c,i)}w&&(void 0!==i.fill&&"none"!==i.fill&&w.color.setStyle(i.fill,Vl),function(t,e){function n(t){b.set(t.x,t.y,1).applyMatrix3(e),t.set(b.x,b.y)}function i(t){const n=t.xRadius,i=t.yRadius,r=Math.cos(t.aRotation),s=Math.sin(t.aRotation),a=new on(n*r,n*s,0),o=new on(-i*s,i*r,0),l=a.applyMatrix3(e),h=o.applyMatrix3(e),u=v.set(l.x,h.x,0,l.y,h.y,0,0,0,1),d=_.copy(u).invert(),p=x.copy(d).transpose().multiply(d).elements,f=function(t,e,n){let i,r,s,a,o;const l=t+n,h=t-n,c=Math.sqrt(h*h+4*e*e);l>0?(i=.5*(l+c),o=1/i,r=t*o*n-e*o*e):l<0?r=.5*(l-c):(i=.5*c,r=-.5*c);s=h>0?h+c:h-c;Math.abs(s)>2*Math.abs(e)?(o=-2*e/s,a=1/Math.sqrt(1+o*o),s=o*a):0===Math.abs(e)?(s=1,a=0):(o=-.5*s/e,s=1/Math.sqrt(1+o*o),a=o*s);h>0&&(o=s,s=-a,a=o);return{rt1:i,rt2:r,cs:s,sn:a}}(p[0],p[1],p[4]),m=Math.sqrt(f.rt1),g=Math.sqrt(f.rt2);t.xRadius=1/m,t.yRadius=1/g,t.aRotation=Math.atan2(f.sn,f.cs);if(!((t.aEndAngle-t.aStartAngle)%(2*Math.PI)<Number.EPSILON)){const n=_.set(m,0,0,0,g,0,0,0,1),i=x.set(f.cs,f.sn,0,-f.sn,f.cs,0,0,0,1),r=n.multiply(i).multiply(u),s=t=>{const{x:e,y:n}=new on(Math.cos(t),Math.sin(t),0).applyMatrix3(r);return Math.atan2(n,e)};t.aStartAngle=s(t.aStartAngle),t.aEndAngle=s(t.aEndAngle),c(e)&&(t.aClockwise=!t.aClockwise)}}function r(t){const n=d(e),i=p(e);t.xRadius*=n,t.yRadius*=i;const r=n>Number.EPSILON?Math.atan2(e.elements[1],e.elements[0]):Math.atan2(-e.elements[3],e.elements[4]);t.aRotation+=r,c(e)&&(t.aStartAngle*=-1,t.aEndAngle*=-1,t.aClockwise=!t.aClockwise)}const s=t.subPaths;for(let a=0,o=s.length;a<o;a++){const t=s[a].curves;for(let s=0;s<t.length;s++){const a=t[s];a.isLineCurve?(n(a.v1),n(a.v2)):a.isCubicBezierCurve?(n(a.v0),n(a.v1),n(a.v2),n(a.v3)):a.isQuadraticBezierCurve?(n(a.v0),n(a.v1),n(a.v2)):a.isEllipseCurve&&(S.set(a.aX,a.aY),n(S),a.aX=S.x,a.aY=S.y,u(e)?i(a):r(a))}}}(w,M),f.push(w),w.userData={node:e,style:i});const C=e.childNodes;for(let n=0;n<C.length;n++){const e=C[n];l&&"style"!==e.nodeName&&"defs"!==e.nodeName||t(e,i)}o&&(g.pop(),g.length>0?M.copy(g[g.length-1]):M.identity())}(w.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4});return{paths:f,xml:w.documentElement}}static createShapes(t){const e=999999999,n=0,i=1,r=2,s=3,a=4,o=5,l=6,h={loc:n,t:0};function c(t,e,i,s){const a=t.x,o=e.x,l=i.x,c=s.x,d=t.y,p=e.y,f=i.y,m=s.y,g=(c-l)*(d-f)-(m-f)*(a-l),v=(m-f)*(o-a)-(c-l)*(p-d),_=g/v,x=((o-a)*(d-f)-(p-d)*(a-l))/v;if(0===v&&0!==g||_<=0||_>=1||x<0||x>1)return null;if(0===g&&0===v){for(let l=0;l<2;l++){if(u(0===l?i:s,t,e),h.loc==n){const t=0===l?i:s;return{x:t.x,y:t.y,t:h.t}}if(h.loc==r){return{x:+(a+h.t*(o-a)).toPrecision(10),y:+(d+h.t*(p-d)).toPrecision(10),t:h.t}}}return null}for(let r=0;r<2;r++)if(u(0===r?i:s,t,e),h.loc==n){const t=0===r?i:s;return{x:t.x,y:t.y,t:h.t}}return{x:+(a+_*(o-a)).toPrecision(10),y:+(d+_*(p-d)).toPrecision(10),t:_}}function u(t,e,c){const u=c.x-e.x,d=c.y-e.y,p=t.x-e.x,f=t.y-e.y,m=u*f-p*d;if(t.x===e.x&&t.y===e.y)return h.loc=n,void(h.t=0);if(t.x===c.x&&t.y===c.y)return h.loc=i,void(h.t=1);if(m<-Number.EPSILON)return void(h.loc=s);if(m>Number.EPSILON)return void(h.loc=a);if(u*p<0||d*f<0)return void(h.loc=o);if(Math.sqrt(u*u+d*d)<Math.sqrt(p*p+f*f))return void(h.loc=l);let g;g=0!==u?p/u:f/d,h.loc=r,h.t=g}function d(t,e,n){const i=new Le;e.getCenter(i);const r=[];return n.forEach((e=>{if(e.boundingBox.containsPoint(i)){(function(t,e){const n=[],i=[];for(let r=1;r<t.length;r++){const s=t[r-1],a=t[r];for(let t=1;t<e.length;t++){const r=c(s,a,e[t-1],e[t]);null!==r&&void 0===n.find((t=>t.t<=r.t+Number.EPSILON&&t.t>=r.t-Number.EPSILON))&&(n.push(r),i.push(new Le(r.x,r.y)))}}return i})(t,e.points).forEach((t=>{r.push({identifier:e.identifier,isCW:e.isCW,point:t})}))}})),r.sort(((t,e)=>t.point.x-e.point.x)),r}let p=e,f=-999999999,m=t.subPaths.map((t=>{const n=t.getPoints();let i=-999999999,r=e,s=-999999999,a=e;for(let e=0;e<n.length;e++){const t=n[e];t.y>i&&(i=t.y),t.y<r&&(r=t.y),t.x>s&&(s=t.x),t.x<a&&(a=t.x)}return f<=s&&(f=s+1),p>=a&&(p=a-1),{curves:t.curves,points:n,isCW:al.isClockWise(n),identifier:-1,boundingBox:new Bl(new Le(a,r),new Le(s,i))}}));m=m.filter((t=>t.points.length>1));for(let _=0;_<m.length;_++)m[_].identifier=_;const g=m.map((e=>function(t,e,n,i,r){null!=r&&""!==r||(r="nonzero");const s=new Le;t.boundingBox.getCenter(s);const a=d([new Le(n,s.y),new Le(i,s.y)],t.boundingBox,e);a.sort(((t,e)=>t.point.x-e.point.x));const o=[],l=[];a.forEach((e=>{e.identifier===t.identifier?o.push(e):l.push(e)}));const h=o[0].point.x,c=[];let u=0;for(;u<l.length&&l[u].point.x<h;)c.length>0&&c[c.length-1]===l[u].identifier?c.pop():c.push(l[u].identifier),u++;if(c.push(t.identifier),"evenodd"===r){const e=c.length%2==0,n=c[c.length-2];return{identifier:t.identifier,isHole:e,for:n}}if("nonzero"===r){let n=!0,i=null,r=null;for(let t=0;t<c.length;t++){const s=c[t];n?(r=e[s].isCW,n=!1,i=s):r!==e[s].isCW&&(r=e[s].isCW,n=!0)}return{identifier:t.identifier,isHole:n,for:i}}}(e,m,p,f,t.userData?t.userData.style.fillRule:void 0))),v=[];return m.forEach((t=>{if(!g[t.identifier].isHole){const e=new ko;e.curves=t.curves;g.filter((e=>e.isHole&&e.for===t.identifier)).forEach((t=>{const n=m[t.identifier],i=new Io;i.curves=n.curves,e.holes.push(i)})),v.push(e)}})),v}static getStrokeStyle(t,e,n,i,r){return{strokeColor:e=void 0!==e?e:"#000",strokeWidth:t=void 0!==t?t:1,strokeLineJoin:n=void 0!==n?n:"miter",strokeLineCap:i=void 0!==i?i:"butt",strokeMiterLimit:r=void 0!==r?r:4}}static pointsToStroke(t,e,n,i){const r=[],s=[],a=[];if(0===Gl.pointsToStrokeWithBuffers(t,e,n,i,r,s,a))return null;const o=new Vi;return o.setAttribute("position",new ki(r,3)),o.setAttribute("normal",new ki(s,3)),o.setAttribute("uv",new ki(a,2)),o}static pointsToStrokeWithBuffers(t,e,n,i,r,s,a,o){const l=new Le,h=new Le,c=new Le,u=new Le,d=new Le,p=new Le,f=new Le,m=new Le,g=new Le,v=new Le,_=new Le,x=new Le,y=new Le,S=new Le,b=new Le,M=new Le,w=new Le;n=void 0!==n?n:12,i=void 0!==i?i:.001,o=void 0!==o?o:0;const C=(t=function(t){let e=!1;for(let r=1,s=t.length-1;r<s;r++)if(t[r].distanceTo(t[r+1])<i){e=!0;break}if(!e)return t;const n=[];n.push(t[0]);for(let r=1,s=t.length-1;r<s;r++)t[r].distanceTo(t[r+1])>=i&&n.push(t[r]);return n.push(t[t.length-1]),n}(t)).length;if(C<2)return 0;const T=t[0].equals(t[C-1]);let E,A,P=t[0];const R=e.strokeWidth/2,W=1/(C-1);let L,I,k,N,O=0,U=!1,D=0,F=3*o,B=2*o;z(t[0],t[1],l).multiplyScalar(R),m.copy(t[0]).sub(l),g.copy(t[0]).add(l),v.copy(m),_.copy(g);for(let J=1;J<C;J++){E=t[J],A=J===C-1?T?t[1]:void 0:t[J+1];const n=l;if(z(P,E,n),c.copy(n).multiplyScalar(R),x.copy(E).sub(c),y.copy(E).add(c),L=O+W,I=!1,void 0!==A){z(E,A,h),c.copy(h).multiplyScalar(R),S.copy(E).sub(c),b.copy(E).add(c),k=!0,c.subVectors(A,P),n.dot(c)<0&&(k=!1),1===J&&(U=k),c.subVectors(A,E),c.normalize();const t=Math.abs(n.dot(c));if(t>Number.EPSILON){const n=R/t;c.multiplyScalar(-n),u.subVectors(E,P),d.copy(u).setLength(n).add(c),M.copy(d).negate();const i=d.length(),r=u.length();u.divideScalar(r),p.subVectors(A,E);const s=p.length();switch(p.divideScalar(s),u.dot(M)<r&&p.dot(M)<s&&(I=!0),w.copy(d).add(E),M.add(E),N=!1,I?k?(b.copy(M),y.copy(M)):(S.copy(M),x.copy(M)):H(),e.strokeLineJoin){case"bevel":q(k,I,L);break;case"round":X(k,I),k?G(E,x,S,L,0):G(E,b,y,L,1);break;default:const t=R*e.strokeMiterLimit/i;if(t<1){if("miter-clip"!==e.strokeLineJoin){q(k,I,L);break}X(k,I),k?(p.subVectors(w,x).multiplyScalar(t).add(x),f.subVectors(w,S).multiplyScalar(t).add(S),V(x,L,0),V(p,L,0),V(E,L,.5),V(E,L,.5),V(p,L,0),V(f,L,0),V(E,L,.5),V(f,L,0),V(S,L,0)):(p.subVectors(w,y).multiplyScalar(t).add(y),f.subVectors(w,b).multiplyScalar(t).add(b),V(y,L,1),V(p,L,1),V(E,L,.5),V(E,L,.5),V(p,L,1),V(f,L,1),V(E,L,.5),V(f,L,1),V(b,L,1))}else I?(k?(V(g,O,1),V(m,O,0),V(w,L,0),V(g,O,1),V(w,L,0),V(M,L,1)):(V(g,O,1),V(m,O,0),V(w,L,1),V(m,O,0),V(M,L,0),V(w,L,1)),k?S.copy(w):b.copy(w)):k?(V(x,L,0),V(w,L,0),V(E,L,.5),V(E,L,.5),V(w,L,0),V(S,L,0)):(V(y,L,1),V(w,L,1),V(E,L,.5),V(E,L,.5),V(w,L,1),V(b,L,1)),N=!0}}else H()}else H();T||J!==C-1||j(t[0],v,_,k,!0,O),O=L,P=E,m.copy(S),g.copy(b)}if(T){if(I&&r){let t=w,e=M;U!==k&&(t=M,e=w),k?(N||U)&&(e.toArray(r,0),e.toArray(r,9),N&&t.toArray(r,3)):!N&&U||(e.toArray(r,3),e.toArray(r,9),N&&t.toArray(r,0))}}else j(E,x,y,k,!1,L);return D;function z(t,e,n){return n.subVectors(e,t),n.set(-n.y,n.x).normalize()}function V(t,e,n){r&&(r[F]=t.x,r[F+1]=t.y,r[F+2]=0,s&&(s[F]=0,s[F+1]=0,s[F+2]=1),F+=3,a&&(a[B]=e,a[B+1]=n,B+=2)),D+=3}function G(t,e,i,r,s){l.copy(e).sub(t).normalize(),h.copy(i).sub(t).normalize();let a=Math.PI;const o=l.dot(h);Math.abs(o)<1&&(a=Math.abs(Math.acos(o))),a/=n,c.copy(e);for(let l=0,h=n-1;l<h;l++)u.copy(c).rotateAround(t,a),V(c,r,s),V(u,r,s),V(t,r,.5),c.copy(u);V(u,r,s),V(i,r,s),V(t,r,.5)}function H(){V(g,O,1),V(m,O,0),V(x,L,0),V(g,O,1),V(x,L,0),V(y,L,1)}function q(t,e,n){e?t?(V(g,O,1),V(m,O,0),V(x,L,0),V(g,O,1),V(x,L,0),V(M,L,1),V(x,n,0),V(S,n,0),V(M,n,.5)):(V(g,O,1),V(m,O,0),V(y,L,1),V(m,O,0),V(M,L,0),V(y,L,1),V(y,n,1),V(M,n,0),V(b,n,1)):t?(V(x,n,0),V(S,n,0),V(E,n,.5)):(V(y,n,1),V(b,n,0),V(E,n,.5))}function X(t,e){e&&(t?(V(g,O,1),V(m,O,0),V(x,L,0),V(g,O,1),V(x,L,0),V(M,L,1),V(x,O,0),V(E,L,.5),V(M,L,1),V(E,L,.5),V(S,O,0),V(M,L,1)):(V(g,O,1),V(m,O,0),V(y,L,1),V(m,O,0),V(M,L,0),V(y,L,1),V(y,O,1),V(M,L,0),V(E,L,.5),V(E,L,.5),V(M,L,0),V(b,O,1)))}function j(t,n,i,s,o,d){switch(e.strokeLineCap){case"round":o?G(t,i,n,d,.5):G(t,n,i,d,.5);break;case"square":if(o)l.subVectors(n,t),h.set(l.y,-l.x),c.addVectors(l,h).add(t),u.subVectors(h,l).add(t),s?(c.toArray(r,3),u.toArray(r,0),u.toArray(r,9)):(c.toArray(r,3),1===a[7]?u.toArray(r,9):c.toArray(r,9),u.toArray(r,0));else{l.subVectors(i,t),h.set(l.y,-l.x),c.addVectors(l,h).add(t),u.subVectors(h,l).add(t);const e=r.length;s?(c.toArray(r,e-3),u.toArray(r,e-6),u.toArray(r,e-12)):(u.toArray(r,e-6),c.toArray(r,e-3),u.toArray(r,e-12))}}}}}var Hl,ql,Xl={exports:{}},jl={exports:{}};function Jl(){return Hl||(Hl=1,function(t){var e=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,81,2,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,9,5351,0,7,14,13835,9,87,9,39,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,4706,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,983,6,110,6,6,9,4759,9,787719,239],n=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,68,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,4026,582,8634,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,757,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],i="-----------------------------------------------------------------------------------------------------------------------------------------------------",r="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",s={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},a="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",o={5:a,"5module":a+" export import",6:a+" const class extends export import super"},l=/^in(stanceof)?$/,h=new RegExp("["+r+"]"),c=new RegExp("["+r+i+"]");function u(t,e){for(var n=65536,i=0;i<e.length;i+=2){if((n+=e[i])>t)return!1;if((n+=e[i+1])>=t)return!0}return!1}function d(t,e){return t<65?36===t:t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&h.test(String.fromCharCode(t)):!1!==e&&u(t,n)))}function p(t,i){return t<48?36===t:t<58||!(t<65)&&(t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&c.test(String.fromCharCode(t)):!1!==i&&(u(t,n)||u(t,e)))))}var f=function(t,e){void 0===e&&(e={}),this.label=t,this.keyword=e.keyword,this.beforeExpr=!!e.beforeExpr,this.startsExpr=!!e.startsExpr,this.isLoop=!!e.isLoop,this.isAssign=!!e.isAssign,this.prefix=!!e.prefix,this.postfix=!!e.postfix,this.binop=e.binop||null,this.updateContext=null};function m(t,e){return new f(t,{beforeExpr:!0,binop:e})}var g={beforeExpr:!0},v={startsExpr:!0},_={};function x(t,e){return void 0===e&&(e={}),e.keyword=t,_[t]=new f(t,e)}var y={num:new f("num",v),regexp:new f("regexp",v),string:new f("string",v),name:new f("name",v),privateId:new f("privateId",v),eof:new f("eof"),bracketL:new f("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new f("]"),braceL:new f("{",{beforeExpr:!0,startsExpr:!0}),braceR:new f("}"),parenL:new f("(",{beforeExpr:!0,startsExpr:!0}),parenR:new f(")"),comma:new f(",",g),semi:new f(";",g),colon:new f(":",g),dot:new f("."),question:new f("?",g),questionDot:new f("?."),arrow:new f("=>",g),template:new f("template"),invalidTemplate:new f("invalidTemplate"),ellipsis:new f("...",g),backQuote:new f("`",v),dollarBraceL:new f("${",{beforeExpr:!0,startsExpr:!0}),eq:new f("=",{beforeExpr:!0,isAssign:!0}),assign:new f("_=",{beforeExpr:!0,isAssign:!0}),incDec:new f("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new f("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:m("||",1),logicalAND:m("&&",2),bitwiseOR:m("|",3),bitwiseXOR:m("^",4),bitwiseAND:m("&",5),equality:m("==/!=/===/!==",6),relational:m("</>/<=/>=",7),bitShift:m("<</>>/>>>",8),plusMin:new f("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:m("%",10),star:m("*",10),slash:m("/",10),starstar:new f("**",{beforeExpr:!0}),coalesce:m("??",1),_break:x("break"),_case:x("case",g),_catch:x("catch"),_continue:x("continue"),_debugger:x("debugger"),_default:x("default",g),_do:x("do",{isLoop:!0,beforeExpr:!0}),_else:x("else",g),_finally:x("finally"),_for:x("for",{isLoop:!0}),_function:x("function",v),_if:x("if"),_return:x("return",g),_switch:x("switch"),_throw:x("throw",g),_try:x("try"),_var:x("var"),_const:x("const"),_while:x("while",{isLoop:!0}),_with:x("with"),_new:x("new",{beforeExpr:!0,startsExpr:!0}),_this:x("this",v),_super:x("super",v),_class:x("class",v),_extends:x("extends",g),_export:x("export"),_import:x("import",v),_null:x("null",v),_true:x("true",v),_false:x("false",v),_in:x("in",{beforeExpr:!0,binop:7}),_instanceof:x("instanceof",{beforeExpr:!0,binop:7}),_typeof:x("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:x("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:x("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},S=/\r\n?|\n|\u2028|\u2029/,b=new RegExp(S.source,"g");function M(t){return 10===t||13===t||8232===t||8233===t}function w(t,e,n){void 0===n&&(n=t.length);for(var i=e;i<n;i++){var r=t.charCodeAt(i);if(M(r))return i<n-1&&13===r&&10===t.charCodeAt(i+1)?i+2:i+1}return-1}var C=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,T=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,E=Object.prototype,A=E.hasOwnProperty,P=E.toString,R=Object.hasOwn||function(t,e){return A.call(t,e)},W=Array.isArray||function(t){return"[object Array]"===P.call(t)},L=Object.create(null);function I(t){return L[t]||(L[t]=new RegExp("^(?:"+t.replace(/ /g,"|")+")$"))}function k(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}var N=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,O=function(t,e){this.line=t,this.column=e};O.prototype.offset=function(t){return new O(this.line,this.column+t)};var U=function(t,e,n){this.start=e,this.end=n,null!==t.sourceFile&&(this.source=t.sourceFile)};function D(t,e){for(var n=1,i=0;;){var r=w(t,i,e);if(r<0)return new O(n,e-i);++n,i=r}}var F={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},B=!1;function z(t){var e={};for(var n in F)e[n]=t&&R(t,n)?t[n]:F[n];if("latest"===e.ecmaVersion?e.ecmaVersion=1e8:null==e.ecmaVersion?(!B&&"object"==typeof console&&console.warn&&(B=!0),e.ecmaVersion=11):e.ecmaVersion>=2015&&(e.ecmaVersion-=2009),null==e.allowReserved&&(e.allowReserved=e.ecmaVersion<5),t&&null!=t.allowHashBang||(e.allowHashBang=e.ecmaVersion>=14),W(e.onToken)){var i=e.onToken;e.onToken=function(t){return i.push(t)}}return W(e.onComment)&&(e.onComment=V(e,e.onComment)),e}function V(t,e){return function(n,i,r,s,a,o){var l={type:n?"Block":"Line",value:i,start:r,end:s};t.locations&&(l.loc=new U(this,a,o)),t.ranges&&(l.range=[r,s]),e.push(l)}}var G=1,H=2,q=4,X=8,j=16,J=32,Q=64,K=128,Z=256,Y=G|H|Z;function $(t,e){return H|(t?q:0)|(e?X:0)}var tt=0,et=1,nt=2,it=3,rt=4,st=5,at=function(t,e,n){this.options=t=z(t),this.sourceFile=t.sourceFile,this.keywords=I(o[t.ecmaVersion>=6?6:"module"===t.sourceType?"5module":5]);var i="";!0!==t.allowReserved&&(i=s[t.ecmaVersion>=6?6:5===t.ecmaVersion?5:3],"module"===t.sourceType&&(i+=" await")),this.reservedWords=I(i);var r=(i?i+" ":"")+s.strict;this.reservedWordsStrict=I(r),this.reservedWordsStrictBind=I(r+" "+s.strictBind),this.input=String(e),this.containsEsc=!1,n?(this.pos=n,this.lineStart=this.input.lastIndexOf("\n",n-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(S).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=y.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule="module"===t.sourceType,this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),0===this.pos&&t.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(G),this.regexpState=null,this.privateNameStack=[]},ot={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};at.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)},ot.inFunction.get=function(){return(this.currentVarScope().flags&H)>0},ot.inGenerator.get=function(){return(this.currentVarScope().flags&X)>0&&!this.currentVarScope().inClassFieldInit},ot.inAsync.get=function(){return(this.currentVarScope().flags&q)>0&&!this.currentVarScope().inClassFieldInit},ot.canAwait.get=function(){for(var t=this.scopeStack.length-1;t>=0;t--){var e=this.scopeStack[t];if(e.inClassFieldInit||e.flags&Z)return!1;if(e.flags&H)return(e.flags&q)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction},ot.allowSuper.get=function(){var t=this.currentThisScope(),e=t.flags,n=t.inClassFieldInit;return(e&Q)>0||n||this.options.allowSuperOutsideMethod},ot.allowDirectSuper.get=function(){return(this.currentThisScope().flags&K)>0},ot.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},ot.allowNewDotTarget.get=function(){var t=this.currentThisScope(),e=t.flags,n=t.inClassFieldInit;return(e&(H|Z))>0||n},ot.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&Z)>0},at.extend=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];for(var n=this,i=0;i<t.length;i++)n=t[i](n);return n},at.parse=function(t,e){return new this(e,t).parse()},at.parseExpressionAt=function(t,e,n){var i=new this(n,t,e);return i.nextToken(),i.parseExpression()},at.tokenizer=function(t,e){return new this(e,t)},Object.defineProperties(at.prototype,ot);var lt=at.prototype,ht=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;lt.strictDirective=function(t){if(this.options.ecmaVersion<5)return!1;for(;;){T.lastIndex=t,t+=T.exec(this.input)[0].length;var e=ht.exec(this.input.slice(t));if(!e)return!1;if("use strict"===(e[1]||e[2])){T.lastIndex=t+e[0].length;var n=T.exec(this.input),i=n.index+n[0].length,r=this.input.charAt(i);return";"===r||"}"===r||S.test(n[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(r)||"!"===r&&"="===this.input.charAt(i+1))}t+=e[0].length,T.lastIndex=t,t+=T.exec(this.input)[0].length,";"===this.input[t]&&t++}},lt.eat=function(t){return this.type===t&&(this.next(),!0)},lt.isContextual=function(t){return this.type===y.name&&this.value===t&&!this.containsEsc},lt.eatContextual=function(t){return!!this.isContextual(t)&&(this.next(),!0)},lt.expectContextual=function(t){this.eatContextual(t)||this.unexpected()},lt.canInsertSemicolon=function(){return this.type===y.eof||this.type===y.braceR||S.test(this.input.slice(this.lastTokEnd,this.start))},lt.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},lt.semicolon=function(){this.eat(y.semi)||this.insertSemicolon()||this.unexpected()},lt.afterTrailingComma=function(t,e){if(this.type===t)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),e||this.next(),!0},lt.expect=function(t){this.eat(t)||this.unexpected()},lt.unexpected=function(t){this.raise(null!=t?t:this.start,"Unexpected token")};var ct=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};lt.checkPatternErrors=function(t,e){if(t){t.trailingComma>-1&&this.raiseRecoverable(t.trailingComma,"Comma is not permitted after the rest element");var n=e?t.parenthesizedAssign:t.parenthesizedBind;n>-1&&this.raiseRecoverable(n,e?"Assigning to rvalue":"Parenthesized pattern")}},lt.checkExpressionErrors=function(t,e){if(!t)return!1;var n=t.shorthandAssign,i=t.doubleProto;if(!e)return n>=0||i>=0;n>=0&&this.raise(n,"Shorthand property assignments are valid only in destructuring patterns"),i>=0&&this.raiseRecoverable(i,"Redefinition of __proto__ property")},lt.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},lt.isSimpleAssignTarget=function(t){return"ParenthesizedExpression"===t.type?this.isSimpleAssignTarget(t.expression):"Identifier"===t.type||"MemberExpression"===t.type};var ut=at.prototype;ut.parseTopLevel=function(t){var e=Object.create(null);for(t.body||(t.body=[]);this.type!==y.eof;){var n=this.parseStatement(null,!0,e);t.body.push(n)}if(this.inModule)for(var i=0,r=Object.keys(this.undefinedExports);i<r.length;i+=1){var s=r[i];this.raiseRecoverable(this.undefinedExports[s].start,"Export '"+s+"' is not defined")}return this.adaptDirectivePrologue(t.body),this.next(),t.sourceType=this.options.sourceType,this.finishNode(t,"Program")};var dt={kind:"loop"},pt={kind:"switch"};ut.isLet=function(t){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;T.lastIndex=this.pos;var e=T.exec(this.input),n=this.pos+e[0].length,i=this.input.charCodeAt(n);if(91===i||92===i)return!0;if(t)return!1;if(123===i||i>55295&&i<56320)return!0;if(d(i,!0)){for(var r=n+1;p(i=this.input.charCodeAt(r),!0);)++r;if(92===i||i>55295&&i<56320)return!0;var s=this.input.slice(n,r);if(!l.test(s))return!0}return!1},ut.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;T.lastIndex=this.pos;var t,e=T.exec(this.input),n=this.pos+e[0].length;return!(S.test(this.input.slice(this.pos,n))||"function"!==this.input.slice(n,n+8)||n+8!==this.input.length&&(p(t=this.input.charCodeAt(n+8))||t>55295&&t<56320))},ut.parseStatement=function(t,e,n){var i,r=this.type,s=this.startNode();switch(this.isLet(t)&&(r=y._var,i="let"),r){case y._break:case y._continue:return this.parseBreakContinueStatement(s,r.keyword);case y._debugger:return this.parseDebuggerStatement(s);case y._do:return this.parseDoStatement(s);case y._for:return this.parseForStatement(s);case y._function:return t&&(this.strict||"if"!==t&&"label"!==t)&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(s,!1,!t);case y._class:return t&&this.unexpected(),this.parseClass(s,!0);case y._if:return this.parseIfStatement(s);case y._return:return this.parseReturnStatement(s);case y._switch:return this.parseSwitchStatement(s);case y._throw:return this.parseThrowStatement(s);case y._try:return this.parseTryStatement(s);case y._const:case y._var:return i=i||this.value,t&&"var"!==i&&this.unexpected(),this.parseVarStatement(s,i);case y._while:return this.parseWhileStatement(s);case y._with:return this.parseWithStatement(s);case y.braceL:return this.parseBlock(!0,s);case y.semi:return this.parseEmptyStatement(s);case y._export:case y._import:if(this.options.ecmaVersion>10&&r===y._import){T.lastIndex=this.pos;var a=T.exec(this.input),o=this.pos+a[0].length,l=this.input.charCodeAt(o);if(40===l||46===l)return this.parseExpressionStatement(s,this.parseExpression())}return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),r===y._import?this.parseImport(s):this.parseExport(s,n);default:if(this.isAsyncFunction())return t&&this.unexpected(),this.next(),this.parseFunctionStatement(s,!0,!t);var h=this.value,c=this.parseExpression();return r===y.name&&"Identifier"===c.type&&this.eat(y.colon)?this.parseLabeledStatement(s,h,c,t):this.parseExpressionStatement(s,c)}},ut.parseBreakContinueStatement=function(t,e){var n="break"===e;this.next(),this.eat(y.semi)||this.insertSemicolon()?t.label=null:this.type!==y.name?this.unexpected():(t.label=this.parseIdent(),this.semicolon());for(var i=0;i<this.labels.length;++i){var r=this.labels[i];if(null==t.label||r.name===t.label.name){if(null!=r.kind&&(n||"loop"===r.kind))break;if(t.label&&n)break}}return i===this.labels.length&&this.raise(t.start,"Unsyntactic "+e),this.finishNode(t,n?"BreakStatement":"ContinueStatement")},ut.parseDebuggerStatement=function(t){return this.next(),this.semicolon(),this.finishNode(t,"DebuggerStatement")},ut.parseDoStatement=function(t){return this.next(),this.labels.push(dt),t.body=this.parseStatement("do"),this.labels.pop(),this.expect(y._while),t.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(y.semi):this.semicolon(),this.finishNode(t,"DoWhileStatement")},ut.parseForStatement=function(t){this.next();var e=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(dt),this.enterScope(0),this.expect(y.parenL),this.type===y.semi)return e>-1&&this.unexpected(e),this.parseFor(t,null);var n=this.isLet();if(this.type===y._var||this.type===y._const||n){var i=this.startNode(),r=n?"let":this.value;return this.next(),this.parseVar(i,!0,r),this.finishNode(i,"VariableDeclaration"),(this.type===y._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&1===i.declarations.length?(this.options.ecmaVersion>=9&&(this.type===y._in?e>-1&&this.unexpected(e):t.await=e>-1),this.parseForIn(t,i)):(e>-1&&this.unexpected(e),this.parseFor(t,i))}var s=this.isContextual("let"),a=!1,o=new ct,l=this.parseExpression(!(e>-1)||"await",o);return this.type===y._in||(a=this.options.ecmaVersion>=6&&this.isContextual("of"))?(this.options.ecmaVersion>=9&&(this.type===y._in?e>-1&&this.unexpected(e):t.await=e>-1),s&&a&&this.raise(l.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(l,!1,o),this.checkLValPattern(l),this.parseForIn(t,l)):(this.checkExpressionErrors(o,!0),e>-1&&this.unexpected(e),this.parseFor(t,l))},ut.parseFunctionStatement=function(t,e,n){return this.next(),this.parseFunction(t,mt|(n?0:gt),!1,e)},ut.parseIfStatement=function(t){return this.next(),t.test=this.parseParenExpression(),t.consequent=this.parseStatement("if"),t.alternate=this.eat(y._else)?this.parseStatement("if"):null,this.finishNode(t,"IfStatement")},ut.parseReturnStatement=function(t){return this.inFunction||this.options.allowReturnOutsideFunction||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(y.semi)||this.insertSemicolon()?t.argument=null:(t.argument=this.parseExpression(),this.semicolon()),this.finishNode(t,"ReturnStatement")},ut.parseSwitchStatement=function(t){var e;this.next(),t.discriminant=this.parseParenExpression(),t.cases=[],this.expect(y.braceL),this.labels.push(pt),this.enterScope(0);for(var n=!1;this.type!==y.braceR;)if(this.type===y._case||this.type===y._default){var i=this.type===y._case;e&&this.finishNode(e,"SwitchCase"),t.cases.push(e=this.startNode()),e.consequent=[],this.next(),i?e.test=this.parseExpression():(n&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),n=!0,e.test=null),this.expect(y.colon)}else e||this.unexpected(),e.consequent.push(this.parseStatement(null));return this.exitScope(),e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(t,"SwitchStatement")},ut.parseThrowStatement=function(t){return this.next(),S.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),t.argument=this.parseExpression(),this.semicolon(),this.finishNode(t,"ThrowStatement")};var ft=[];ut.parseCatchClauseParam=function(){var t=this.parseBindingAtom(),e="Identifier"===t.type;return this.enterScope(e?J:0),this.checkLValPattern(t,e?rt:nt),this.expect(y.parenR),t},ut.parseTryStatement=function(t){if(this.next(),t.block=this.parseBlock(),t.handler=null,this.type===y._catch){var e=this.startNode();this.next(),this.eat(y.parenL)?e.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),e.param=null,this.enterScope(0)),e.body=this.parseBlock(!1),this.exitScope(),t.handler=this.finishNode(e,"CatchClause")}return t.finalizer=this.eat(y._finally)?this.parseBlock():null,t.handler||t.finalizer||this.raise(t.start,"Missing catch or finally clause"),this.finishNode(t,"TryStatement")},ut.parseVarStatement=function(t,e,n){return this.next(),this.parseVar(t,!1,e,n),this.semicolon(),this.finishNode(t,"VariableDeclaration")},ut.parseWhileStatement=function(t){return this.next(),t.test=this.parseParenExpression(),this.labels.push(dt),t.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(t,"WhileStatement")},ut.parseWithStatement=function(t){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),t.object=this.parseParenExpression(),t.body=this.parseStatement("with"),this.finishNode(t,"WithStatement")},ut.parseEmptyStatement=function(t){return this.next(),this.finishNode(t,"EmptyStatement")},ut.parseLabeledStatement=function(t,e,n,i){for(var r=0,s=this.labels;r<s.length;r+=1)s[r].name===e&&this.raise(n.start,"Label '"+e+"' is already declared");for(var a=this.type.isLoop?"loop":this.type===y._switch?"switch":null,o=this.labels.length-1;o>=0;o--){var l=this.labels[o];if(l.statementStart!==t.start)break;l.statementStart=this.start,l.kind=a}return this.labels.push({name:e,kind:a,statementStart:this.start}),t.body=this.parseStatement(i?-1===i.indexOf("label")?i+"label":i:"label"),this.labels.pop(),t.label=n,this.finishNode(t,"LabeledStatement")},ut.parseExpressionStatement=function(t,e){return t.expression=e,this.semicolon(),this.finishNode(t,"ExpressionStatement")},ut.parseBlock=function(t,e,n){for(void 0===t&&(t=!0),void 0===e&&(e=this.startNode()),e.body=[],this.expect(y.braceL),t&&this.enterScope(0);this.type!==y.braceR;){var i=this.parseStatement(null);e.body.push(i)}return n&&(this.strict=!1),this.next(),t&&this.exitScope(),this.finishNode(e,"BlockStatement")},ut.parseFor=function(t,e){return t.init=e,this.expect(y.semi),t.test=this.type===y.semi?null:this.parseExpression(),this.expect(y.semi),t.update=this.type===y.parenR?null:this.parseExpression(),this.expect(y.parenR),t.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(t,"ForStatement")},ut.parseForIn=function(t,e){var n=this.type===y._in;return this.next(),"VariableDeclaration"===e.type&&null!=e.declarations[0].init&&(!n||this.options.ecmaVersion<8||this.strict||"var"!==e.kind||"Identifier"!==e.declarations[0].id.type)&&this.raise(e.start,(n?"for-in":"for-of")+" loop variable declaration may not have an initializer"),t.left=e,t.right=n?this.parseExpression():this.parseMaybeAssign(),this.expect(y.parenR),t.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(t,n?"ForInStatement":"ForOfStatement")},ut.parseVar=function(t,e,n,i){for(t.declarations=[],t.kind=n;;){var r=this.startNode();if(this.parseVarId(r,n),this.eat(y.eq)?r.init=this.parseMaybeAssign(e):i||"const"!==n||this.type===y._in||this.options.ecmaVersion>=6&&this.isContextual("of")?i||"Identifier"===r.id.type||e&&(this.type===y._in||this.isContextual("of"))?r.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.unexpected(),t.declarations.push(this.finishNode(r,"VariableDeclarator")),!this.eat(y.comma))break}return t},ut.parseVarId=function(t,e){t.id=this.parseBindingAtom(),this.checkLValPattern(t.id,"var"===e?et:nt,!1)};var mt=1,gt=2,vt=4;function _t(t,e){var n=e.key.name,i=t[n],r="true";return"MethodDefinition"!==e.type||"get"!==e.kind&&"set"!==e.kind||(r=(e.static?"s":"i")+e.kind),"iget"===i&&"iset"===r||"iset"===i&&"iget"===r||"sget"===i&&"sset"===r||"sset"===i&&"sget"===r?(t[n]="true",!1):!!i||(t[n]=r,!1)}function xt(t,e){var n=t.computed,i=t.key;return!n&&("Identifier"===i.type&&i.name===e||"Literal"===i.type&&i.value===e)}ut.parseFunction=function(t,e,n,i,r){this.initFunction(t),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!i)&&(this.type===y.star&&e&gt&&this.unexpected(),t.generator=this.eat(y.star)),this.options.ecmaVersion>=8&&(t.async=!!i),e&mt&&(t.id=e&vt&&this.type!==y.name?null:this.parseIdent(),!t.id||e&gt||this.checkLValSimple(t.id,this.strict||t.generator||t.async?this.treatFunctionsAsVar?et:nt:it));var s=this.yieldPos,a=this.awaitPos,o=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope($(t.async,t.generator)),e&mt||(t.id=this.type===y.name?this.parseIdent():null),this.parseFunctionParams(t),this.parseFunctionBody(t,n,!1,r),this.yieldPos=s,this.awaitPos=a,this.awaitIdentPos=o,this.finishNode(t,e&mt?"FunctionDeclaration":"FunctionExpression")},ut.parseFunctionParams=function(t){this.expect(y.parenL),t.params=this.parseBindingList(y.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},ut.parseClass=function(t,e){this.next();var n=this.strict;this.strict=!0,this.parseClassId(t,e),this.parseClassSuper(t);var i=this.enterClassBody(),r=this.startNode(),s=!1;for(r.body=[],this.expect(y.braceL);this.type!==y.braceR;){var a=this.parseClassElement(null!==t.superClass);a&&(r.body.push(a),"MethodDefinition"===a.type&&"constructor"===a.kind?(s&&this.raiseRecoverable(a.start,"Duplicate constructor in the same class"),s=!0):a.key&&"PrivateIdentifier"===a.key.type&&_t(i,a)&&this.raiseRecoverable(a.key.start,"Identifier '#"+a.key.name+"' has already been declared"))}return this.strict=n,this.next(),t.body=this.finishNode(r,"ClassBody"),this.exitClassBody(),this.finishNode(t,e?"ClassDeclaration":"ClassExpression")},ut.parseClassElement=function(t){if(this.eat(y.semi))return null;var e=this.options.ecmaVersion,n=this.startNode(),i="",r=!1,s=!1,a="method",o=!1;if(this.eatContextual("static")){if(e>=13&&this.eat(y.braceL))return this.parseClassStaticBlock(n),n;this.isClassElementNameStart()||this.type===y.star?o=!0:i="static"}if(n.static=o,!i&&e>=8&&this.eatContextual("async")&&(!this.isClassElementNameStart()&&this.type!==y.star||this.canInsertSemicolon()?i="async":s=!0),!i&&(e>=9||!s)&&this.eat(y.star)&&(r=!0),!i&&!s&&!r){var l=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?a=l:i=l)}if(i?(n.computed=!1,n.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),n.key.name=i,this.finishNode(n.key,"Identifier")):this.parseClassElementName(n),e<13||this.type===y.parenL||"method"!==a||r||s){var h=!n.static&&xt(n,"constructor"),c=h&&t;h&&"method"!==a&&this.raise(n.key.start,"Constructor can't have get/set modifier"),n.kind=h?"constructor":a,this.parseClassMethod(n,r,s,c)}else this.parseClassField(n);return n},ut.isClassElementNameStart=function(){return this.type===y.name||this.type===y.privateId||this.type===y.num||this.type===y.string||this.type===y.bracketL||this.type.keyword},ut.parseClassElementName=function(t){this.type===y.privateId?("constructor"===this.value&&this.raise(this.start,"Classes can't have an element named '#constructor'"),t.computed=!1,t.key=this.parsePrivateIdent()):this.parsePropertyName(t)},ut.parseClassMethod=function(t,e,n,i){var r=t.key;"constructor"===t.kind?(e&&this.raise(r.start,"Constructor can't be a generator"),n&&this.raise(r.start,"Constructor can't be an async method")):t.static&&xt(t,"prototype")&&this.raise(r.start,"Classes may not have a static property named prototype");var s=t.value=this.parseMethod(e,n,i);return"get"===t.kind&&0!==s.params.length&&this.raiseRecoverable(s.start,"getter should have no params"),"set"===t.kind&&1!==s.params.length&&this.raiseRecoverable(s.start,"setter should have exactly one param"),"set"===t.kind&&"RestElement"===s.params[0].type&&this.raiseRecoverable(s.params[0].start,"Setter cannot use rest params"),this.finishNode(t,"MethodDefinition")},ut.parseClassField=function(t){if(xt(t,"constructor")?this.raise(t.key.start,"Classes can't have a field named 'constructor'"):t.static&&xt(t,"prototype")&&this.raise(t.key.start,"Classes can't have a static field named 'prototype'"),this.eat(y.eq)){var e=this.currentThisScope(),n=e.inClassFieldInit;e.inClassFieldInit=!0,t.value=this.parseMaybeAssign(),e.inClassFieldInit=n}else t.value=null;return this.semicolon(),this.finishNode(t,"PropertyDefinition")},ut.parseClassStaticBlock=function(t){t.body=[];var e=this.labels;for(this.labels=[],this.enterScope(Z|Q);this.type!==y.braceR;){var n=this.parseStatement(null);t.body.push(n)}return this.next(),this.exitScope(),this.labels=e,this.finishNode(t,"StaticBlock")},ut.parseClassId=function(t,e){this.type===y.name?(t.id=this.parseIdent(),e&&this.checkLValSimple(t.id,nt,!1)):(!0===e&&this.unexpected(),t.id=null)},ut.parseClassSuper=function(t){t.superClass=this.eat(y._extends)?this.parseExprSubscripts(null,!1):null},ut.enterClassBody=function(){var t={declared:Object.create(null),used:[]};return this.privateNameStack.push(t),t.declared},ut.exitClassBody=function(){var t=this.privateNameStack.pop(),e=t.declared,n=t.used;if(this.options.checkPrivateFields)for(var i=this.privateNameStack.length,r=0===i?null:this.privateNameStack[i-1],s=0;s<n.length;++s){var a=n[s];R(e,a.name)||(r?r.used.push(a):this.raiseRecoverable(a.start,"Private field '#"+a.name+"' must be declared in an enclosing class"))}},ut.parseExportAllDeclaration=function(t,e){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(t.exported=this.parseModuleExportName(),this.checkExport(e,t.exported,this.lastTokStart)):t.exported=null),this.expectContextual("from"),this.type!==y.string&&this.unexpected(),t.source=this.parseExprAtom(),this.semicolon(),this.finishNode(t,"ExportAllDeclaration")},ut.parseExport=function(t,e){if(this.next(),this.eat(y.star))return this.parseExportAllDeclaration(t,e);if(this.eat(y._default))return this.checkExport(e,"default",this.lastTokStart),t.declaration=this.parseExportDefaultDeclaration(),this.finishNode(t,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())t.declaration=this.parseExportDeclaration(t),"VariableDeclaration"===t.declaration.type?this.checkVariableExport(e,t.declaration.declarations):this.checkExport(e,t.declaration.id,t.declaration.id.start),t.specifiers=[],t.source=null;else{if(t.declaration=null,t.specifiers=this.parseExportSpecifiers(e),this.eatContextual("from"))this.type!==y.string&&this.unexpected(),t.source=this.parseExprAtom();else{for(var n=0,i=t.specifiers;n<i.length;n+=1){var r=i[n];this.checkUnreserved(r.local),this.checkLocalExport(r.local),"Literal"===r.local.type&&this.raise(r.local.start,"A string literal cannot be used as an exported binding without `from`.")}t.source=null}this.semicolon()}return this.finishNode(t,"ExportNamedDeclaration")},ut.parseExportDeclaration=function(t){return this.parseStatement(null)},ut.parseExportDefaultDeclaration=function(){var t;if(this.type===y._function||(t=this.isAsyncFunction())){var e=this.startNode();return this.next(),t&&this.next(),this.parseFunction(e,mt|vt,!1,t)}if(this.type===y._class){var n=this.startNode();return this.parseClass(n,"nullableID")}var i=this.parseMaybeAssign();return this.semicolon(),i},ut.checkExport=function(t,e,n){t&&("string"!=typeof e&&(e="Identifier"===e.type?e.name:e.value),R(t,e)&&this.raiseRecoverable(n,"Duplicate export '"+e+"'"),t[e]=!0)},ut.checkPatternExport=function(t,e){var n=e.type;if("Identifier"===n)this.checkExport(t,e,e.start);else if("ObjectPattern"===n)for(var i=0,r=e.properties;i<r.length;i+=1){var s=r[i];this.checkPatternExport(t,s)}else if("ArrayPattern"===n)for(var a=0,o=e.elements;a<o.length;a+=1){var l=o[a];l&&this.checkPatternExport(t,l)}else"Property"===n?this.checkPatternExport(t,e.value):"AssignmentPattern"===n?this.checkPatternExport(t,e.left):"RestElement"===n&&this.checkPatternExport(t,e.argument)},ut.checkVariableExport=function(t,e){if(t)for(var n=0,i=e;n<i.length;n+=1){var r=i[n];this.checkPatternExport(t,r.id)}},ut.shouldParseExportStatement=function(){return"var"===this.type.keyword||"const"===this.type.keyword||"class"===this.type.keyword||"function"===this.type.keyword||this.isLet()||this.isAsyncFunction()},ut.parseExportSpecifier=function(t){var e=this.startNode();return e.local=this.parseModuleExportName(),e.exported=this.eatContextual("as")?this.parseModuleExportName():e.local,this.checkExport(t,e.exported,e.exported.start),this.finishNode(e,"ExportSpecifier")},ut.parseExportSpecifiers=function(t){var e=[],n=!0;for(this.expect(y.braceL);!this.eat(y.braceR);){if(n)n=!1;else if(this.expect(y.comma),this.afterTrailingComma(y.braceR))break;e.push(this.parseExportSpecifier(t))}return e},ut.parseImport=function(t){return this.next(),this.type===y.string?(t.specifiers=ft,t.source=this.parseExprAtom()):(t.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),t.source=this.type===y.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(t,"ImportDeclaration")},ut.parseImportSpecifier=function(){var t=this.startNode();return t.imported=this.parseModuleExportName(),this.eatContextual("as")?t.local=this.parseIdent():(this.checkUnreserved(t.imported),t.local=t.imported),this.checkLValSimple(t.local,nt),this.finishNode(t,"ImportSpecifier")},ut.parseImportDefaultSpecifier=function(){var t=this.startNode();return t.local=this.parseIdent(),this.checkLValSimple(t.local,nt),this.finishNode(t,"ImportDefaultSpecifier")},ut.parseImportNamespaceSpecifier=function(){var t=this.startNode();return this.next(),this.expectContextual("as"),t.local=this.parseIdent(),this.checkLValSimple(t.local,nt),this.finishNode(t,"ImportNamespaceSpecifier")},ut.parseImportSpecifiers=function(){var t=[],e=!0;if(this.type===y.name&&(t.push(this.parseImportDefaultSpecifier()),!this.eat(y.comma)))return t;if(this.type===y.star)return t.push(this.parseImportNamespaceSpecifier()),t;for(this.expect(y.braceL);!this.eat(y.braceR);){if(e)e=!1;else if(this.expect(y.comma),this.afterTrailingComma(y.braceR))break;t.push(this.parseImportSpecifier())}return t},ut.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===y.string){var t=this.parseLiteral(this.value);return N.test(t.value)&&this.raise(t.start,"An export name cannot include a lone surrogate."),t}return this.parseIdent(!0)},ut.adaptDirectivePrologue=function(t){for(var e=0;e<t.length&&this.isDirectiveCandidate(t[e]);++e)t[e].directive=t[e].expression.raw.slice(1,-1)},ut.isDirectiveCandidate=function(t){return this.options.ecmaVersion>=5&&"ExpressionStatement"===t.type&&"Literal"===t.expression.type&&"string"==typeof t.expression.value&&('"'===this.input[t.start]||"'"===this.input[t.start])};var yt=at.prototype;yt.toAssignable=function(t,e,n){if(this.options.ecmaVersion>=6&&t)switch(t.type){case"Identifier":this.inAsync&&"await"===t.name&&this.raise(t.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":t.type="ObjectPattern",n&&this.checkPatternErrors(n,!0);for(var i=0,r=t.properties;i<r.length;i+=1){var s=r[i];this.toAssignable(s,e),"RestElement"!==s.type||"ArrayPattern"!==s.argument.type&&"ObjectPattern"!==s.argument.type||this.raise(s.argument.start,"Unexpected token")}break;case"Property":"init"!==t.kind&&this.raise(t.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(t.value,e);break;case"ArrayExpression":t.type="ArrayPattern",n&&this.checkPatternErrors(n,!0),this.toAssignableList(t.elements,e);break;case"SpreadElement":t.type="RestElement",this.toAssignable(t.argument,e),"AssignmentPattern"===t.argument.type&&this.raise(t.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":"="!==t.operator&&this.raise(t.left.end,"Only '=' operator can be used for specifying default value."),t.type="AssignmentPattern",delete t.operator,this.toAssignable(t.left,e);break;case"ParenthesizedExpression":this.toAssignable(t.expression,e,n);break;case"ChainExpression":this.raiseRecoverable(t.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!e)break;default:this.raise(t.start,"Assigning to rvalue")}else n&&this.checkPatternErrors(n,!0);return t},yt.toAssignableList=function(t,e){for(var n=t.length,i=0;i<n;i++){var r=t[i];r&&this.toAssignable(r,e)}if(n){var s=t[n-1];6===this.options.ecmaVersion&&e&&s&&"RestElement"===s.type&&"Identifier"!==s.argument.type&&this.unexpected(s.argument.start)}return t},yt.parseSpread=function(t){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(!1,t),this.finishNode(e,"SpreadElement")},yt.parseRestBinding=function(){var t=this.startNode();return this.next(),6===this.options.ecmaVersion&&this.type!==y.name&&this.unexpected(),t.argument=this.parseBindingAtom(),this.finishNode(t,"RestElement")},yt.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case y.bracketL:var t=this.startNode();return this.next(),t.elements=this.parseBindingList(y.bracketR,!0,!0),this.finishNode(t,"ArrayPattern");case y.braceL:return this.parseObj(!0)}return this.parseIdent()},yt.parseBindingList=function(t,e,n,i){for(var r=[],s=!0;!this.eat(t);)if(s?s=!1:this.expect(y.comma),e&&this.type===y.comma)r.push(null);else{if(n&&this.afterTrailingComma(t))break;if(this.type===y.ellipsis){var a=this.parseRestBinding();this.parseBindingListItem(a),r.push(a),this.type===y.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(t);break}r.push(this.parseAssignableListItem(i))}return r},yt.parseAssignableListItem=function(t){var e=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(e),e},yt.parseBindingListItem=function(t){return t},yt.parseMaybeDefault=function(t,e,n){if(n=n||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(y.eq))return n;var i=this.startNodeAt(t,e);return i.left=n,i.right=this.parseMaybeAssign(),this.finishNode(i,"AssignmentPattern")},yt.checkLValSimple=function(t,e,n){void 0===e&&(e=tt);var i=e!==tt;switch(t.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(t.name)&&this.raiseRecoverable(t.start,(i?"Binding ":"Assigning to ")+t.name+" in strict mode"),i&&(e===nt&&"let"===t.name&&this.raiseRecoverable(t.start,"let is disallowed as a lexically bound name"),n&&(R(n,t.name)&&this.raiseRecoverable(t.start,"Argument name clash"),n[t.name]=!0),e!==st&&this.declareName(t.name,e,t.start));break;case"ChainExpression":this.raiseRecoverable(t.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":i&&this.raiseRecoverable(t.start,"Binding member expression");break;case"ParenthesizedExpression":return i&&this.raiseRecoverable(t.start,"Binding parenthesized expression"),this.checkLValSimple(t.expression,e,n);default:this.raise(t.start,(i?"Binding":"Assigning to")+" rvalue")}},yt.checkLValPattern=function(t,e,n){switch(void 0===e&&(e=tt),t.type){case"ObjectPattern":for(var i=0,r=t.properties;i<r.length;i+=1){var s=r[i];this.checkLValInnerPattern(s,e,n)}break;case"ArrayPattern":for(var a=0,o=t.elements;a<o.length;a+=1){var l=o[a];l&&this.checkLValInnerPattern(l,e,n)}break;default:this.checkLValSimple(t,e,n)}},yt.checkLValInnerPattern=function(t,e,n){switch(void 0===e&&(e=tt),t.type){case"Property":this.checkLValInnerPattern(t.value,e,n);break;case"AssignmentPattern":this.checkLValPattern(t.left,e,n);break;case"RestElement":this.checkLValPattern(t.argument,e,n);break;default:this.checkLValPattern(t,e,n)}};var St=function(t,e,n,i,r){this.token=t,this.isExpr=!!e,this.preserveSpace=!!n,this.override=i,this.generator=!!r},bt={b_stat:new St("{",!1),b_expr:new St("{",!0),b_tmpl:new St("${",!1),p_stat:new St("(",!1),p_expr:new St("(",!0),q_tmpl:new St("`",!0,!0,(function(t){return t.tryReadTemplateToken()})),f_stat:new St("function",!1),f_expr:new St("function",!0),f_expr_gen:new St("function",!0,!1,null,!0),f_gen:new St("function",!1,!1,null,!0)},Mt=at.prototype;Mt.initialContext=function(){return[bt.b_stat]},Mt.curContext=function(){return this.context[this.context.length-1]},Mt.braceIsBlock=function(t){var e=this.curContext();return e===bt.f_expr||e===bt.f_stat||(t!==y.colon||e!==bt.b_stat&&e!==bt.b_expr?t===y._return||t===y.name&&this.exprAllowed?S.test(this.input.slice(this.lastTokEnd,this.start)):t===y._else||t===y.semi||t===y.eof||t===y.parenR||t===y.arrow||(t===y.braceL?e===bt.b_stat:t!==y._var&&t!==y._const&&t!==y.name&&!this.exprAllowed):!e.isExpr)},Mt.inGeneratorContext=function(){for(var t=this.context.length-1;t>=1;t--){var e=this.context[t];if("function"===e.token)return e.generator}return!1},Mt.updateContext=function(t){var e,n=this.type;n.keyword&&t===y.dot?this.exprAllowed=!1:(e=n.updateContext)?e.call(this,t):this.exprAllowed=n.beforeExpr},Mt.overrideContext=function(t){this.curContext()!==t&&(this.context[this.context.length-1]=t)},y.parenR.updateContext=y.braceR.updateContext=function(){if(1!==this.context.length){var t=this.context.pop();t===bt.b_stat&&"function"===this.curContext().token&&(t=this.context.pop()),this.exprAllowed=!t.isExpr}else this.exprAllowed=!0},y.braceL.updateContext=function(t){this.context.push(this.braceIsBlock(t)?bt.b_stat:bt.b_expr),this.exprAllowed=!0},y.dollarBraceL.updateContext=function(){this.context.push(bt.b_tmpl),this.exprAllowed=!0},y.parenL.updateContext=function(t){var e=t===y._if||t===y._for||t===y._with||t===y._while;this.context.push(e?bt.p_stat:bt.p_expr),this.exprAllowed=!0},y.incDec.updateContext=function(){},y._function.updateContext=y._class.updateContext=function(t){!t.beforeExpr||t===y._else||t===y.semi&&this.curContext()!==bt.p_stat||t===y._return&&S.test(this.input.slice(this.lastTokEnd,this.start))||(t===y.colon||t===y.braceL)&&this.curContext()===bt.b_stat?this.context.push(bt.f_stat):this.context.push(bt.f_expr),this.exprAllowed=!1},y.colon.updateContext=function(){"function"===this.curContext().token&&this.context.pop(),this.exprAllowed=!0},y.backQuote.updateContext=function(){this.curContext()===bt.q_tmpl?this.context.pop():this.context.push(bt.q_tmpl),this.exprAllowed=!1},y.star.updateContext=function(t){if(t===y._function){var e=this.context.length-1;this.context[e]===bt.f_expr?this.context[e]=bt.f_expr_gen:this.context[e]=bt.f_gen}this.exprAllowed=!0},y.name.updateContext=function(t){var e=!1;this.options.ecmaVersion>=6&&t!==y.dot&&("of"===this.value&&!this.exprAllowed||"yield"===this.value&&this.inGeneratorContext())&&(e=!0),this.exprAllowed=e};var wt=at.prototype;function Ct(t){return"MemberExpression"===t.type&&"PrivateIdentifier"===t.property.type||"ChainExpression"===t.type&&Ct(t.expression)}wt.checkPropClash=function(t,e,n){if(!(this.options.ecmaVersion>=9&&"SpreadElement"===t.type||this.options.ecmaVersion>=6&&(t.computed||t.method||t.shorthand))){var i,r=t.key;switch(r.type){case"Identifier":i=r.name;break;case"Literal":i=String(r.value);break;default:return}var s=t.kind;if(this.options.ecmaVersion>=6)"__proto__"===i&&"init"===s&&(e.proto&&(n?n.doubleProto<0&&(n.doubleProto=r.start):this.raiseRecoverable(r.start,"Redefinition of __proto__ property")),e.proto=!0);else{var a=e[i="$"+i];a?("init"===s?this.strict&&a.init||a.get||a.set:a.init||a[s])&&this.raiseRecoverable(r.start,"Redefinition of property"):a=e[i]={init:!1,get:!1,set:!1},a[s]=!0}}},wt.parseExpression=function(t,e){var n=this.start,i=this.startLoc,r=this.parseMaybeAssign(t,e);if(this.type===y.comma){var s=this.startNodeAt(n,i);for(s.expressions=[r];this.eat(y.comma);)s.expressions.push(this.parseMaybeAssign(t,e));return this.finishNode(s,"SequenceExpression")}return r},wt.parseMaybeAssign=function(t,e,n){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(t);this.exprAllowed=!1}var i=!1,r=-1,s=-1,a=-1;e?(r=e.parenthesizedAssign,s=e.trailingComma,a=e.doubleProto,e.parenthesizedAssign=e.trailingComma=-1):(e=new ct,i=!0);var o=this.start,l=this.startLoc;this.type!==y.parenL&&this.type!==y.name||(this.potentialArrowAt=this.start,this.potentialArrowInForAwait="await"===t);var h=this.parseMaybeConditional(t,e);if(n&&(h=n.call(this,h,o,l)),this.type.isAssign){var c=this.startNodeAt(o,l);return c.operator=this.value,this.type===y.eq&&(h=this.toAssignable(h,!1,e)),i||(e.parenthesizedAssign=e.trailingComma=e.doubleProto=-1),e.shorthandAssign>=h.start&&(e.shorthandAssign=-1),this.type===y.eq?this.checkLValPattern(h):this.checkLValSimple(h),c.left=h,this.next(),c.right=this.parseMaybeAssign(t),a>-1&&(e.doubleProto=a),this.finishNode(c,"AssignmentExpression")}return i&&this.checkExpressionErrors(e,!0),r>-1&&(e.parenthesizedAssign=r),s>-1&&(e.trailingComma=s),h},wt.parseMaybeConditional=function(t,e){var n=this.start,i=this.startLoc,r=this.parseExprOps(t,e);if(this.checkExpressionErrors(e))return r;if(this.eat(y.question)){var s=this.startNodeAt(n,i);return s.test=r,s.consequent=this.parseMaybeAssign(),this.expect(y.colon),s.alternate=this.parseMaybeAssign(t),this.finishNode(s,"ConditionalExpression")}return r},wt.parseExprOps=function(t,e){var n=this.start,i=this.startLoc,r=this.parseMaybeUnary(e,!1,!1,t);return this.checkExpressionErrors(e)||r.start===n&&"ArrowFunctionExpression"===r.type?r:this.parseExprOp(r,n,i,-1,t)},wt.parseExprOp=function(t,e,n,i,r){var s=this.type.binop;if(null!=s&&(!r||this.type!==y._in)&&s>i){var a=this.type===y.logicalOR||this.type===y.logicalAND,o=this.type===y.coalesce;o&&(s=y.logicalAND.binop);var l=this.value;this.next();var h=this.start,c=this.startLoc,u=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,r),h,c,s,r),d=this.buildBinary(e,n,t,u,l,a||o);return(a&&this.type===y.coalesce||o&&(this.type===y.logicalOR||this.type===y.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(d,e,n,i,r)}return t},wt.buildBinary=function(t,e,n,i,r,s){"PrivateIdentifier"===i.type&&this.raise(i.start,"Private identifier can only be left side of binary expression");var a=this.startNodeAt(t,e);return a.left=n,a.operator=r,a.right=i,this.finishNode(a,s?"LogicalExpression":"BinaryExpression")},wt.parseMaybeUnary=function(t,e,n,i){var r,s=this.start,a=this.startLoc;if(this.isContextual("await")&&this.canAwait)r=this.parseAwait(i),e=!0;else if(this.type.prefix){var o=this.startNode(),l=this.type===y.incDec;o.operator=this.value,o.prefix=!0,this.next(),o.argument=this.parseMaybeUnary(null,!0,l,i),this.checkExpressionErrors(t,!0),l?this.checkLValSimple(o.argument):this.strict&&"delete"===o.operator&&"Identifier"===o.argument.type?this.raiseRecoverable(o.start,"Deleting local variable in strict mode"):"delete"===o.operator&&Ct(o.argument)?this.raiseRecoverable(o.start,"Private fields can not be deleted"):e=!0,r=this.finishNode(o,l?"UpdateExpression":"UnaryExpression")}else if(e||this.type!==y.privateId){if(r=this.parseExprSubscripts(t,i),this.checkExpressionErrors(t))return r;for(;this.type.postfix&&!this.canInsertSemicolon();){var h=this.startNodeAt(s,a);h.operator=this.value,h.prefix=!1,h.argument=r,this.checkLValSimple(r),this.next(),r=this.finishNode(h,"UpdateExpression")}}else(i||0===this.privateNameStack.length)&&this.options.checkPrivateFields&&this.unexpected(),r=this.parsePrivateIdent(),this.type!==y._in&&this.unexpected();return n||!this.eat(y.starstar)?r:e?void this.unexpected(this.lastTokStart):this.buildBinary(s,a,r,this.parseMaybeUnary(null,!1,!1,i),"**",!1)},wt.parseExprSubscripts=function(t,e){var n=this.start,i=this.startLoc,r=this.parseExprAtom(t,e);if("ArrowFunctionExpression"===r.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd))return r;var s=this.parseSubscripts(r,n,i,!1,e);return t&&"MemberExpression"===s.type&&(t.parenthesizedAssign>=s.start&&(t.parenthesizedAssign=-1),t.parenthesizedBind>=s.start&&(t.parenthesizedBind=-1),t.trailingComma>=s.start&&(t.trailingComma=-1)),s},wt.parseSubscripts=function(t,e,n,i,r){for(var s=this.options.ecmaVersion>=8&&"Identifier"===t.type&&"async"===t.name&&this.lastTokEnd===t.end&&!this.canInsertSemicolon()&&t.end-t.start==5&&this.potentialArrowAt===t.start,a=!1;;){var o=this.parseSubscript(t,e,n,i,s,a,r);if(o.optional&&(a=!0),o===t||"ArrowFunctionExpression"===o.type){if(a){var l=this.startNodeAt(e,n);l.expression=o,o=this.finishNode(l,"ChainExpression")}return o}t=o}},wt.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(y.arrow)},wt.parseSubscriptAsyncArrow=function(t,e,n,i){return this.parseArrowExpression(this.startNodeAt(t,e),n,!0,i)},wt.parseSubscript=function(t,e,n,i,r,s,a){var o=this.options.ecmaVersion>=11,l=o&&this.eat(y.questionDot);i&&l&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var h=this.eat(y.bracketL);if(h||l&&this.type!==y.parenL&&this.type!==y.backQuote||this.eat(y.dot)){var c=this.startNodeAt(e,n);c.object=t,h?(c.property=this.parseExpression(),this.expect(y.bracketR)):this.type===y.privateId&&"Super"!==t.type?c.property=this.parsePrivateIdent():c.property=this.parseIdent("never"!==this.options.allowReserved),c.computed=!!h,o&&(c.optional=l),t=this.finishNode(c,"MemberExpression")}else if(!i&&this.eat(y.parenL)){var u=new ct,d=this.yieldPos,p=this.awaitPos,f=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var m=this.parseExprList(y.parenR,this.options.ecmaVersion>=8,!1,u);if(r&&!l&&this.shouldParseAsyncArrow())return this.checkPatternErrors(u,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=d,this.awaitPos=p,this.awaitIdentPos=f,this.parseSubscriptAsyncArrow(e,n,m,a);this.checkExpressionErrors(u,!0),this.yieldPos=d||this.yieldPos,this.awaitPos=p||this.awaitPos,this.awaitIdentPos=f||this.awaitIdentPos;var g=this.startNodeAt(e,n);g.callee=t,g.arguments=m,o&&(g.optional=l),t=this.finishNode(g,"CallExpression")}else if(this.type===y.backQuote){(l||s)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var v=this.startNodeAt(e,n);v.tag=t,v.quasi=this.parseTemplate({isTagged:!0}),t=this.finishNode(v,"TaggedTemplateExpression")}return t},wt.parseExprAtom=function(t,e,n){this.type===y.slash&&this.readRegexp();var i,r=this.potentialArrowAt===this.start;switch(this.type){case y._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),i=this.startNode(),this.next(),this.type!==y.parenL||this.allowDirectSuper||this.raise(i.start,"super() call outside constructor of a subclass"),this.type!==y.dot&&this.type!==y.bracketL&&this.type!==y.parenL&&this.unexpected(),this.finishNode(i,"Super");case y._this:return i=this.startNode(),this.next(),this.finishNode(i,"ThisExpression");case y.name:var s=this.start,a=this.startLoc,o=this.containsEsc,l=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!o&&"async"===l.name&&!this.canInsertSemicolon()&&this.eat(y._function))return this.overrideContext(bt.f_expr),this.parseFunction(this.startNodeAt(s,a),0,!1,!0,e);if(r&&!this.canInsertSemicolon()){if(this.eat(y.arrow))return this.parseArrowExpression(this.startNodeAt(s,a),[l],!1,e);if(this.options.ecmaVersion>=8&&"async"===l.name&&this.type===y.name&&!o&&(!this.potentialArrowInForAwait||"of"!==this.value||this.containsEsc))return l=this.parseIdent(!1),!this.canInsertSemicolon()&&this.eat(y.arrow)||this.unexpected(),this.parseArrowExpression(this.startNodeAt(s,a),[l],!0,e)}return l;case y.regexp:var h=this.value;return(i=this.parseLiteral(h.value)).regex={pattern:h.pattern,flags:h.flags},i;case y.num:case y.string:return this.parseLiteral(this.value);case y._null:case y._true:case y._false:return(i=this.startNode()).value=this.type===y._null?null:this.type===y._true,i.raw=this.type.keyword,this.next(),this.finishNode(i,"Literal");case y.parenL:var c=this.start,u=this.parseParenAndDistinguishExpression(r,e);return t&&(t.parenthesizedAssign<0&&!this.isSimpleAssignTarget(u)&&(t.parenthesizedAssign=c),t.parenthesizedBind<0&&(t.parenthesizedBind=c)),u;case y.bracketL:return i=this.startNode(),this.next(),i.elements=this.parseExprList(y.bracketR,!0,!0,t),this.finishNode(i,"ArrayExpression");case y.braceL:return this.overrideContext(bt.b_expr),this.parseObj(!1,t);case y._function:return i=this.startNode(),this.next(),this.parseFunction(i,0);case y._class:return this.parseClass(this.startNode(),!1);case y._new:return this.parseNew();case y.backQuote:return this.parseTemplate();case y._import:return this.options.ecmaVersion>=11?this.parseExprImport(n):this.unexpected();default:return this.parseExprAtomDefault()}},wt.parseExprAtomDefault=function(){this.unexpected()},wt.parseExprImport=function(t){var e=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===y.parenL&&!t)return this.parseDynamicImport(e);if(this.type===y.dot){var n=this.startNodeAt(e.start,e.loc&&e.loc.start);return n.name="import",e.meta=this.finishNode(n,"Identifier"),this.parseImportMeta(e)}this.unexpected()},wt.parseDynamicImport=function(t){if(this.next(),t.source=this.parseMaybeAssign(),!this.eat(y.parenR)){var e=this.start;this.eat(y.comma)&&this.eat(y.parenR)?this.raiseRecoverable(e,"Trailing comma is not allowed in import()"):this.unexpected(e)}return this.finishNode(t,"ImportExpression")},wt.parseImportMeta=function(t){this.next();var e=this.containsEsc;return t.property=this.parseIdent(!0),"meta"!==t.property.name&&this.raiseRecoverable(t.property.start,"The only valid meta property for import is 'import.meta'"),e&&this.raiseRecoverable(t.start,"'import.meta' must not contain escaped characters"),"module"===this.options.sourceType||this.options.allowImportExportEverywhere||this.raiseRecoverable(t.start,"Cannot use 'import.meta' outside a module"),this.finishNode(t,"MetaProperty")},wt.parseLiteral=function(t){var e=this.startNode();return e.value=t,e.raw=this.input.slice(this.start,this.end),110===e.raw.charCodeAt(e.raw.length-1)&&(e.bigint=e.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(e,"Literal")},wt.parseParenExpression=function(){this.expect(y.parenL);var t=this.parseExpression();return this.expect(y.parenR),t},wt.shouldParseArrow=function(t){return!this.canInsertSemicolon()},wt.parseParenAndDistinguishExpression=function(t,e){var n,i=this.start,r=this.startLoc,s=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var a,o=this.start,l=this.startLoc,h=[],c=!0,u=!1,d=new ct,p=this.yieldPos,f=this.awaitPos;for(this.yieldPos=0,this.awaitPos=0;this.type!==y.parenR;){if(c?c=!1:this.expect(y.comma),s&&this.afterTrailingComma(y.parenR,!0)){u=!0;break}if(this.type===y.ellipsis){a=this.start,h.push(this.parseParenItem(this.parseRestBinding())),this.type===y.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}h.push(this.parseMaybeAssign(!1,d,this.parseParenItem))}var m=this.lastTokEnd,g=this.lastTokEndLoc;if(this.expect(y.parenR),t&&this.shouldParseArrow(h)&&this.eat(y.arrow))return this.checkPatternErrors(d,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=p,this.awaitPos=f,this.parseParenArrowList(i,r,h,e);h.length&&!u||this.unexpected(this.lastTokStart),a&&this.unexpected(a),this.checkExpressionErrors(d,!0),this.yieldPos=p||this.yieldPos,this.awaitPos=f||this.awaitPos,h.length>1?((n=this.startNodeAt(o,l)).expressions=h,this.finishNodeAt(n,"SequenceExpression",m,g)):n=h[0]}else n=this.parseParenExpression();if(this.options.preserveParens){var v=this.startNodeAt(i,r);return v.expression=n,this.finishNode(v,"ParenthesizedExpression")}return n},wt.parseParenItem=function(t){return t},wt.parseParenArrowList=function(t,e,n,i){return this.parseArrowExpression(this.startNodeAt(t,e),n,!1,i)};var Tt=[];wt.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var t=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===y.dot){var e=this.startNodeAt(t.start,t.loc&&t.loc.start);e.name="new",t.meta=this.finishNode(e,"Identifier"),this.next();var n=this.containsEsc;return t.property=this.parseIdent(!0),"target"!==t.property.name&&this.raiseRecoverable(t.property.start,"The only valid meta property for new is 'new.target'"),n&&this.raiseRecoverable(t.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(t.start,"'new.target' can only be used in functions and class static block"),this.finishNode(t,"MetaProperty")}var i=this.start,r=this.startLoc;return t.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),i,r,!0,!1),this.eat(y.parenL)?t.arguments=this.parseExprList(y.parenR,this.options.ecmaVersion>=8,!1):t.arguments=Tt,this.finishNode(t,"NewExpression")},wt.parseTemplateElement=function(t){var e=t.isTagged,n=this.startNode();return this.type===y.invalidTemplate?(e||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),n.value={raw:this.value,cooked:null}):n.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),n.tail=this.type===y.backQuote,this.finishNode(n,"TemplateElement")},wt.parseTemplate=function(t){void 0===t&&(t={});var e=t.isTagged;void 0===e&&(e=!1);var n=this.startNode();this.next(),n.expressions=[];var i=this.parseTemplateElement({isTagged:e});for(n.quasis=[i];!i.tail;)this.type===y.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(y.dollarBraceL),n.expressions.push(this.parseExpression()),this.expect(y.braceR),n.quasis.push(i=this.parseTemplateElement({isTagged:e}));return this.next(),this.finishNode(n,"TemplateLiteral")},wt.isAsyncProp=function(t){return!t.computed&&"Identifier"===t.key.type&&"async"===t.key.name&&(this.type===y.name||this.type===y.num||this.type===y.string||this.type===y.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===y.star)&&!S.test(this.input.slice(this.lastTokEnd,this.start))},wt.parseObj=function(t,e){var n=this.startNode(),i=!0,r={};for(n.properties=[],this.next();!this.eat(y.braceR);){if(i)i=!1;else if(this.expect(y.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(y.braceR))break;var s=this.parseProperty(t,e);t||this.checkPropClash(s,r,e),n.properties.push(s)}return this.finishNode(n,t?"ObjectPattern":"ObjectExpression")},wt.parseProperty=function(t,e){var n,i,r,s,a=this.startNode();if(this.options.ecmaVersion>=9&&this.eat(y.ellipsis))return t?(a.argument=this.parseIdent(!1),this.type===y.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(a,"RestElement")):(a.argument=this.parseMaybeAssign(!1,e),this.type===y.comma&&e&&e.trailingComma<0&&(e.trailingComma=this.start),this.finishNode(a,"SpreadElement"));this.options.ecmaVersion>=6&&(a.method=!1,a.shorthand=!1,(t||e)&&(r=this.start,s=this.startLoc),t||(n=this.eat(y.star)));var o=this.containsEsc;return this.parsePropertyName(a),!t&&!o&&this.options.ecmaVersion>=8&&!n&&this.isAsyncProp(a)?(i=!0,n=this.options.ecmaVersion>=9&&this.eat(y.star),this.parsePropertyName(a)):i=!1,this.parsePropertyValue(a,t,n,i,r,s,e,o),this.finishNode(a,"Property")},wt.parseGetterSetter=function(t){t.kind=t.key.name,this.parsePropertyName(t),t.value=this.parseMethod(!1);var e="get"===t.kind?0:1;if(t.value.params.length!==e){var n=t.value.start;"get"===t.kind?this.raiseRecoverable(n,"getter should have no params"):this.raiseRecoverable(n,"setter should have exactly one param")}else"set"===t.kind&&"RestElement"===t.value.params[0].type&&this.raiseRecoverable(t.value.params[0].start,"Setter cannot use rest params")},wt.parsePropertyValue=function(t,e,n,i,r,s,a,o){(n||i)&&this.type===y.colon&&this.unexpected(),this.eat(y.colon)?(t.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,a),t.kind="init"):this.options.ecmaVersion>=6&&this.type===y.parenL?(e&&this.unexpected(),t.kind="init",t.method=!0,t.value=this.parseMethod(n,i)):e||o||!(this.options.ecmaVersion>=5)||t.computed||"Identifier"!==t.key.type||"get"!==t.key.name&&"set"!==t.key.name||this.type===y.comma||this.type===y.braceR||this.type===y.eq?this.options.ecmaVersion>=6&&!t.computed&&"Identifier"===t.key.type?((n||i)&&this.unexpected(),this.checkUnreserved(t.key),"await"!==t.key.name||this.awaitIdentPos||(this.awaitIdentPos=r),t.kind="init",e?t.value=this.parseMaybeDefault(r,s,this.copyNode(t.key)):this.type===y.eq&&a?(a.shorthandAssign<0&&(a.shorthandAssign=this.start),t.value=this.parseMaybeDefault(r,s,this.copyNode(t.key))):t.value=this.copyNode(t.key),t.shorthand=!0):this.unexpected():((n||i)&&this.unexpected(),this.parseGetterSetter(t))},wt.parsePropertyName=function(t){if(this.options.ecmaVersion>=6){if(this.eat(y.bracketL))return t.computed=!0,t.key=this.parseMaybeAssign(),this.expect(y.bracketR),t.key;t.computed=!1}return t.key=this.type===y.num||this.type===y.string?this.parseExprAtom():this.parseIdent("never"!==this.options.allowReserved)},wt.initFunction=function(t){t.id=null,this.options.ecmaVersion>=6&&(t.generator=t.expression=!1),this.options.ecmaVersion>=8&&(t.async=!1)},wt.parseMethod=function(t,e,n){var i=this.startNode(),r=this.yieldPos,s=this.awaitPos,a=this.awaitIdentPos;return this.initFunction(i),this.options.ecmaVersion>=6&&(i.generator=t),this.options.ecmaVersion>=8&&(i.async=!!e),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope($(e,i.generator)|Q|(n?K:0)),this.expect(y.parenL),i.params=this.parseBindingList(y.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(i,!1,!0,!1),this.yieldPos=r,this.awaitPos=s,this.awaitIdentPos=a,this.finishNode(i,"FunctionExpression")},wt.parseArrowExpression=function(t,e,n,i){var r=this.yieldPos,s=this.awaitPos,a=this.awaitIdentPos;return this.enterScope($(n,!1)|j),this.initFunction(t),this.options.ecmaVersion>=8&&(t.async=!!n),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,t.params=this.toAssignableList(e,!0),this.parseFunctionBody(t,!0,!1,i),this.yieldPos=r,this.awaitPos=s,this.awaitIdentPos=a,this.finishNode(t,"ArrowFunctionExpression")},wt.parseFunctionBody=function(t,e,n,i){var r=e&&this.type!==y.braceL,s=this.strict,a=!1;if(r)t.body=this.parseMaybeAssign(i),t.expression=!0,this.checkParams(t,!1);else{var o=this.options.ecmaVersion>=7&&!this.isSimpleParamList(t.params);s&&!o||(a=this.strictDirective(this.end))&&o&&this.raiseRecoverable(t.start,"Illegal 'use strict' directive in function with non-simple parameter list");var l=this.labels;this.labels=[],a&&(this.strict=!0),this.checkParams(t,!s&&!a&&!e&&!n&&this.isSimpleParamList(t.params)),this.strict&&t.id&&this.checkLValSimple(t.id,st),t.body=this.parseBlock(!1,void 0,a&&!s),t.expression=!1,this.adaptDirectivePrologue(t.body.body),this.labels=l}this.exitScope()},wt.isSimpleParamList=function(t){for(var e=0,n=t;e<n.length;e+=1)if("Identifier"!==n[e].type)return!1;return!0},wt.checkParams=function(t,e){for(var n=Object.create(null),i=0,r=t.params;i<r.length;i+=1){var s=r[i];this.checkLValInnerPattern(s,et,e?null:n)}},wt.parseExprList=function(t,e,n,i){for(var r=[],s=!0;!this.eat(t);){if(s)s=!1;else if(this.expect(y.comma),e&&this.afterTrailingComma(t))break;var a=void 0;n&&this.type===y.comma?a=null:this.type===y.ellipsis?(a=this.parseSpread(i),i&&this.type===y.comma&&i.trailingComma<0&&(i.trailingComma=this.start)):a=this.parseMaybeAssign(!1,i),r.push(a)}return r},wt.checkUnreserved=function(t){var e=t.start,n=t.end,i=t.name;this.inGenerator&&"yield"===i&&this.raiseRecoverable(e,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&"await"===i&&this.raiseRecoverable(e,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().inClassFieldInit&&"arguments"===i&&this.raiseRecoverable(e,"Cannot use 'arguments' in class field initializer"),!this.inClassStaticBlock||"arguments"!==i&&"await"!==i||this.raise(e,"Cannot use "+i+" in class static initialization block"),this.keywords.test(i)&&this.raise(e,"Unexpected keyword '"+i+"'"),this.options.ecmaVersion<6&&-1!==this.input.slice(e,n).indexOf("\\")||(this.strict?this.reservedWordsStrict:this.reservedWords).test(i)&&(this.inAsync||"await"!==i||this.raiseRecoverable(e,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(e,"The keyword '"+i+"' is reserved"))},wt.parseIdent=function(t){var e=this.parseIdentNode();return this.next(!!t),this.finishNode(e,"Identifier"),t||(this.checkUnreserved(e),"await"!==e.name||this.awaitIdentPos||(this.awaitIdentPos=e.start)),e},wt.parseIdentNode=function(){var t=this.startNode();return this.type===y.name?t.name=this.value:this.type.keyword?(t.name=this.type.keyword,"class"!==t.name&&"function"!==t.name||this.lastTokEnd===this.lastTokStart+1&&46===this.input.charCodeAt(this.lastTokStart)||this.context.pop(),this.type=y.name):this.unexpected(),t},wt.parsePrivateIdent=function(){var t=this.startNode();return this.type===y.privateId?t.name=this.value:this.unexpected(),this.next(),this.finishNode(t,"PrivateIdentifier"),this.options.checkPrivateFields&&(0===this.privateNameStack.length?this.raise(t.start,"Private field '#"+t.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(t)),t},wt.parseYield=function(t){this.yieldPos||(this.yieldPos=this.start);var e=this.startNode();return this.next(),this.type===y.semi||this.canInsertSemicolon()||this.type!==y.star&&!this.type.startsExpr?(e.delegate=!1,e.argument=null):(e.delegate=this.eat(y.star),e.argument=this.parseMaybeAssign(t)),this.finishNode(e,"YieldExpression")},wt.parseAwait=function(t){this.awaitPos||(this.awaitPos=this.start);var e=this.startNode();return this.next(),e.argument=this.parseMaybeUnary(null,!0,!1,t),this.finishNode(e,"AwaitExpression")};var Et=at.prototype;Et.raise=function(t,e){var n=D(this.input,t);e+=" ("+n.line+":"+n.column+")";var i=new SyntaxError(e);throw i.pos=t,i.loc=n,i.raisedAt=this.pos,i},Et.raiseRecoverable=Et.raise,Et.curPosition=function(){if(this.options.locations)return new O(this.curLine,this.pos-this.lineStart)};var At=at.prototype,Pt=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[],this.inClassFieldInit=!1};At.enterScope=function(t){this.scopeStack.push(new Pt(t))},At.exitScope=function(){this.scopeStack.pop()},At.treatFunctionsAsVarInScope=function(t){return t.flags&H||!this.inModule&&t.flags&G},At.declareName=function(t,e,n){var i=!1;if(e===nt){var r=this.currentScope();i=r.lexical.indexOf(t)>-1||r.functions.indexOf(t)>-1||r.var.indexOf(t)>-1,r.lexical.push(t),this.inModule&&r.flags&G&&delete this.undefinedExports[t]}else if(e===rt)this.currentScope().lexical.push(t);else if(e===it){var s=this.currentScope();i=this.treatFunctionsAsVar?s.lexical.indexOf(t)>-1:s.lexical.indexOf(t)>-1||s.var.indexOf(t)>-1,s.functions.push(t)}else for(var a=this.scopeStack.length-1;a>=0;--a){var o=this.scopeStack[a];if(o.lexical.indexOf(t)>-1&&!(o.flags&J&&o.lexical[0]===t)||!this.treatFunctionsAsVarInScope(o)&&o.functions.indexOf(t)>-1){i=!0;break}if(o.var.push(t),this.inModule&&o.flags&G&&delete this.undefinedExports[t],o.flags&Y)break}i&&this.raiseRecoverable(n,"Identifier '"+t+"' has already been declared")},At.checkLocalExport=function(t){-1===this.scopeStack[0].lexical.indexOf(t.name)&&-1===this.scopeStack[0].var.indexOf(t.name)&&(this.undefinedExports[t.name]=t)},At.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},At.currentVarScope=function(){for(var t=this.scopeStack.length-1;;t--){var e=this.scopeStack[t];if(e.flags&Y)return e}},At.currentThisScope=function(){for(var t=this.scopeStack.length-1;;t--){var e=this.scopeStack[t];if(e.flags&Y&&!(e.flags&j))return e}};var Rt=function(t,e,n){this.type="",this.start=e,this.end=0,t.options.locations&&(this.loc=new U(t,n)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[e,0])},Wt=at.prototype;function Lt(t,e,n,i){return t.type=e,t.end=n,this.options.locations&&(t.loc.end=i),this.options.ranges&&(t.range[1]=n),t}Wt.startNode=function(){return new Rt(this,this.start,this.startLoc)},Wt.startNodeAt=function(t,e){return new Rt(this,t,e)},Wt.finishNode=function(t,e){return Lt.call(this,t,e,this.lastTokEnd,this.lastTokEndLoc)},Wt.finishNodeAt=function(t,e,n,i){return Lt.call(this,t,e,n,i)},Wt.copyNode=function(t){var e=new Rt(this,t.start,this.startLoc);for(var n in t)e[n]=t[n];return e};var It="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",kt=It+" Extended_Pictographic",Nt=kt+" EBase EComp EMod EPres ExtPict",Ot={9:It,10:kt,11:kt,12:Nt,13:Nt,14:Nt},Ut={9:"",10:"",11:"",12:"",13:"",14:"Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji"},Dt="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",Ft="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",Bt=Ft+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",zt=Bt+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",Vt=zt+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",Gt=Vt+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",Ht={9:Ft,10:Bt,11:zt,12:Vt,13:Gt,14:Gt+" Hrkt Katakana_Or_Hiragana Kawi Nag_Mundari Nagm Unknown Zzzz"},qt={};function Xt(t){var e=qt[t]={binary:I(Ot[t]+" "+Dt),binaryOfStrings:I(Ut[t]),nonBinary:{General_Category:I(Dt),Script:I(Ht[t])}};e.nonBinary.Script_Extensions=e.nonBinary.Script,e.nonBinary.gc=e.nonBinary.General_Category,e.nonBinary.sc=e.nonBinary.Script,e.nonBinary.scx=e.nonBinary.Script_Extensions}for(var jt=0,Jt=[9,10,11,12,13,14];jt<Jt.length;jt+=1)Xt(Jt[jt]);var Qt=at.prototype,Kt=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":"")+(t.options.ecmaVersion>=13?"d":"")+(t.options.ecmaVersion>=15?"v":""),this.unicodeProperties=qt[t.options.ecmaVersion>=14?14:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};function Zt(t){return 36===t||t>=40&&t<=43||46===t||63===t||t>=91&&t<=94||t>=123&&t<=125}function Yt(t){return d(t,!0)||36===t||95===t}function $t(t){return p(t,!0)||36===t||95===t||8204===t||8205===t}function te(t){return t>=65&&t<=90||t>=97&&t<=122}function ee(t){return t>=0&&t<=1114111}Kt.prototype.reset=function(t,e,n){var i=-1!==n.indexOf("v"),r=-1!==n.indexOf("u");this.start=0|t,this.source=e+"",this.flags=n,i&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=r&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=r&&this.parser.options.ecmaVersion>=9)},Kt.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)},Kt.prototype.at=function(t,e){void 0===e&&(e=!1);var n=this.source,i=n.length;if(t>=i)return-1;var r=n.charCodeAt(t);if(!e&&!this.switchU||r<=55295||r>=57344||t+1>=i)return r;var s=n.charCodeAt(t+1);return s>=56320&&s<=57343?(r<<10)+s-56613888:r},Kt.prototype.nextIndex=function(t,e){void 0===e&&(e=!1);var n=this.source,i=n.length;if(t>=i)return i;var r,s=n.charCodeAt(t);return!e&&!this.switchU||s<=55295||s>=57344||t+1>=i||(r=n.charCodeAt(t+1))<56320||r>57343?t+1:t+2},Kt.prototype.current=function(t){return void 0===t&&(t=!1),this.at(this.pos,t)},Kt.prototype.lookahead=function(t){return void 0===t&&(t=!1),this.at(this.nextIndex(this.pos,t),t)},Kt.prototype.advance=function(t){void 0===t&&(t=!1),this.pos=this.nextIndex(this.pos,t)},Kt.prototype.eat=function(t,e){return void 0===e&&(e=!1),this.current(e)===t&&(this.advance(e),!0)},Kt.prototype.eatChars=function(t,e){void 0===e&&(e=!1);for(var n=this.pos,i=0,r=t;i<r.length;i+=1){var s=r[i],a=this.at(n,e);if(-1===a||a!==s)return!1;n=this.nextIndex(n,e)}return this.pos=n,!0},Qt.validateRegExpFlags=function(t){for(var e=t.validFlags,n=t.flags,i=!1,r=!1,s=0;s<n.length;s++){var a=n.charAt(s);-1===e.indexOf(a)&&this.raise(t.start,"Invalid regular expression flag"),n.indexOf(a,s+1)>-1&&this.raise(t.start,"Duplicate regular expression flag"),"u"===a&&(i=!0),"v"===a&&(r=!0)}this.options.ecmaVersion>=15&&i&&r&&this.raise(t.start,"Invalid regular expression flag")},Qt.validateRegExpPattern=function(t){this.regexp_pattern(t),!t.switchN&&this.options.ecmaVersion>=9&&t.groupNames.length>0&&(t.switchN=!0,this.regexp_pattern(t))},Qt.regexp_pattern=function(t){t.pos=0,t.lastIntValue=0,t.lastStringValue="",t.lastAssertionIsQuantifiable=!1,t.numCapturingParens=0,t.maxBackReference=0,t.groupNames.length=0,t.backReferenceNames.length=0,this.regexp_disjunction(t),t.pos!==t.source.length&&(t.eat(41)&&t.raise("Unmatched ')'"),(t.eat(93)||t.eat(125))&&t.raise("Lone quantifier brackets")),t.maxBackReference>t.numCapturingParens&&t.raise("Invalid escape");for(var e=0,n=t.backReferenceNames;e<n.length;e+=1){var i=n[e];-1===t.groupNames.indexOf(i)&&t.raise("Invalid named capture referenced")}},Qt.regexp_disjunction=function(t){for(this.regexp_alternative(t);t.eat(124);)this.regexp_alternative(t);this.regexp_eatQuantifier(t,!0)&&t.raise("Nothing to repeat"),t.eat(123)&&t.raise("Lone quantifier brackets")},Qt.regexp_alternative=function(t){for(;t.pos<t.source.length&&this.regexp_eatTerm(t););},Qt.regexp_eatTerm=function(t){return this.regexp_eatAssertion(t)?(t.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(t)&&t.switchU&&t.raise("Invalid quantifier"),!0):!!(t.switchU?this.regexp_eatAtom(t):this.regexp_eatExtendedAtom(t))&&(this.regexp_eatQuantifier(t),!0)},Qt.regexp_eatAssertion=function(t){var e=t.pos;if(t.lastAssertionIsQuantifiable=!1,t.eat(94)||t.eat(36))return!0;if(t.eat(92)){if(t.eat(66)||t.eat(98))return!0;t.pos=e}if(t.eat(40)&&t.eat(63)){var n=!1;if(this.options.ecmaVersion>=9&&(n=t.eat(60)),t.eat(61)||t.eat(33))return this.regexp_disjunction(t),t.eat(41)||t.raise("Unterminated group"),t.lastAssertionIsQuantifiable=!n,!0}return t.pos=e,!1},Qt.regexp_eatQuantifier=function(t,e){return void 0===e&&(e=!1),!!this.regexp_eatQuantifierPrefix(t,e)&&(t.eat(63),!0)},Qt.regexp_eatQuantifierPrefix=function(t,e){return t.eat(42)||t.eat(43)||t.eat(63)||this.regexp_eatBracedQuantifier(t,e)},Qt.regexp_eatBracedQuantifier=function(t,e){var n=t.pos;if(t.eat(123)){var i=0,r=-1;if(this.regexp_eatDecimalDigits(t)&&(i=t.lastIntValue,t.eat(44)&&this.regexp_eatDecimalDigits(t)&&(r=t.lastIntValue),t.eat(125)))return-1!==r&&r<i&&!e&&t.raise("numbers out of order in {} quantifier"),!0;t.switchU&&!e&&t.raise("Incomplete quantifier"),t.pos=n}return!1},Qt.regexp_eatAtom=function(t){return this.regexp_eatPatternCharacters(t)||t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)},Qt.regexp_eatReverseSolidusAtomEscape=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatAtomEscape(t))return!0;t.pos=e}return!1},Qt.regexp_eatUncapturingGroup=function(t){var e=t.pos;if(t.eat(40)){if(t.eat(63)&&t.eat(58)){if(this.regexp_disjunction(t),t.eat(41))return!0;t.raise("Unterminated group")}t.pos=e}return!1},Qt.regexp_eatCapturingGroup=function(t){if(t.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(t):63===t.current()&&t.raise("Invalid group"),this.regexp_disjunction(t),t.eat(41))return t.numCapturingParens+=1,!0;t.raise("Unterminated group")}return!1},Qt.regexp_eatExtendedAtom=function(t){return t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)||this.regexp_eatInvalidBracedQuantifier(t)||this.regexp_eatExtendedPatternCharacter(t)},Qt.regexp_eatInvalidBracedQuantifier=function(t){return this.regexp_eatBracedQuantifier(t,!0)&&t.raise("Nothing to repeat"),!1},Qt.regexp_eatSyntaxCharacter=function(t){var e=t.current();return!!Zt(e)&&(t.lastIntValue=e,t.advance(),!0)},Qt.regexp_eatPatternCharacters=function(t){for(var e=t.pos,n=0;-1!==(n=t.current())&&!Zt(n);)t.advance();return t.pos!==e},Qt.regexp_eatExtendedPatternCharacter=function(t){var e=t.current();return!(-1===e||36===e||e>=40&&e<=43||46===e||63===e||91===e||94===e||124===e||(t.advance(),0))},Qt.regexp_groupSpecifier=function(t){if(t.eat(63)){if(this.regexp_eatGroupName(t))return-1!==t.groupNames.indexOf(t.lastStringValue)&&t.raise("Duplicate capture group name"),void t.groupNames.push(t.lastStringValue);t.raise("Invalid group")}},Qt.regexp_eatGroupName=function(t){if(t.lastStringValue="",t.eat(60)){if(this.regexp_eatRegExpIdentifierName(t)&&t.eat(62))return!0;t.raise("Invalid capture group name")}return!1},Qt.regexp_eatRegExpIdentifierName=function(t){if(t.lastStringValue="",this.regexp_eatRegExpIdentifierStart(t)){for(t.lastStringValue+=k(t.lastIntValue);this.regexp_eatRegExpIdentifierPart(t);)t.lastStringValue+=k(t.lastIntValue);return!0}return!1},Qt.regexp_eatRegExpIdentifierStart=function(t){var e=t.pos,n=this.options.ecmaVersion>=11,i=t.current(n);return t.advance(n),92===i&&this.regexp_eatRegExpUnicodeEscapeSequence(t,n)&&(i=t.lastIntValue),Yt(i)?(t.lastIntValue=i,!0):(t.pos=e,!1)},Qt.regexp_eatRegExpIdentifierPart=function(t){var e=t.pos,n=this.options.ecmaVersion>=11,i=t.current(n);return t.advance(n),92===i&&this.regexp_eatRegExpUnicodeEscapeSequence(t,n)&&(i=t.lastIntValue),$t(i)?(t.lastIntValue=i,!0):(t.pos=e,!1)},Qt.regexp_eatAtomEscape=function(t){return!!(this.regexp_eatBackReference(t)||this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)||t.switchN&&this.regexp_eatKGroupName(t))||(t.switchU&&(99===t.current()&&t.raise("Invalid unicode escape"),t.raise("Invalid escape")),!1)},Qt.regexp_eatBackReference=function(t){var e=t.pos;if(this.regexp_eatDecimalEscape(t)){var n=t.lastIntValue;if(t.switchU)return n>t.maxBackReference&&(t.maxBackReference=n),!0;if(n<=t.numCapturingParens)return!0;t.pos=e}return!1},Qt.regexp_eatKGroupName=function(t){if(t.eat(107)){if(this.regexp_eatGroupName(t))return t.backReferenceNames.push(t.lastStringValue),!0;t.raise("Invalid named reference")}return!1},Qt.regexp_eatCharacterEscape=function(t){return this.regexp_eatControlEscape(t)||this.regexp_eatCControlLetter(t)||this.regexp_eatZero(t)||this.regexp_eatHexEscapeSequence(t)||this.regexp_eatRegExpUnicodeEscapeSequence(t,!1)||!t.switchU&&this.regexp_eatLegacyOctalEscapeSequence(t)||this.regexp_eatIdentityEscape(t)},Qt.regexp_eatCControlLetter=function(t){var e=t.pos;if(t.eat(99)){if(this.regexp_eatControlLetter(t))return!0;t.pos=e}return!1},Qt.regexp_eatZero=function(t){return 48===t.current()&&!ue(t.lookahead())&&(t.lastIntValue=0,t.advance(),!0)},Qt.regexp_eatControlEscape=function(t){var e=t.current();return 116===e?(t.lastIntValue=9,t.advance(),!0):110===e?(t.lastIntValue=10,t.advance(),!0):118===e?(t.lastIntValue=11,t.advance(),!0):102===e?(t.lastIntValue=12,t.advance(),!0):114===e&&(t.lastIntValue=13,t.advance(),!0)},Qt.regexp_eatControlLetter=function(t){var e=t.current();return!!te(e)&&(t.lastIntValue=e%32,t.advance(),!0)},Qt.regexp_eatRegExpUnicodeEscapeSequence=function(t,e){void 0===e&&(e=!1);var n=t.pos,i=e||t.switchU;if(t.eat(117)){if(this.regexp_eatFixedHexDigits(t,4)){var r=t.lastIntValue;if(i&&r>=55296&&r<=56319){var s=t.pos;if(t.eat(92)&&t.eat(117)&&this.regexp_eatFixedHexDigits(t,4)){var a=t.lastIntValue;if(a>=56320&&a<=57343)return t.lastIntValue=1024*(r-55296)+(a-56320)+65536,!0}t.pos=s,t.lastIntValue=r}return!0}if(i&&t.eat(123)&&this.regexp_eatHexDigits(t)&&t.eat(125)&&ee(t.lastIntValue))return!0;i&&t.raise("Invalid unicode escape"),t.pos=n}return!1},Qt.regexp_eatIdentityEscape=function(t){if(t.switchU)return!!this.regexp_eatSyntaxCharacter(t)||!!t.eat(47)&&(t.lastIntValue=47,!0);var e=t.current();return!(99===e||t.switchN&&107===e||(t.lastIntValue=e,t.advance(),0))},Qt.regexp_eatDecimalEscape=function(t){t.lastIntValue=0;var e=t.current();if(e>=49&&e<=57){do{t.lastIntValue=10*t.lastIntValue+(e-48),t.advance()}while((e=t.current())>=48&&e<=57);return!0}return!1};var ne=0,ie=1,re=2;function se(t){return 100===t||68===t||115===t||83===t||119===t||87===t}function ae(t){return te(t)||95===t}function oe(t){return ae(t)||ue(t)}function le(t){return 33===t||t>=35&&t<=38||t>=42&&t<=44||46===t||t>=58&&t<=64||94===t||96===t||126===t}function he(t){return 40===t||41===t||45===t||47===t||t>=91&&t<=93||t>=123&&t<=125}function ce(t){return 33===t||35===t||37===t||38===t||44===t||45===t||t>=58&&t<=62||64===t||96===t||126===t}function ue(t){return t>=48&&t<=57}function de(t){return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102}function pe(t){return t>=65&&t<=70?t-65+10:t>=97&&t<=102?t-97+10:t-48}function fe(t){return t>=48&&t<=55}Qt.regexp_eatCharacterClassEscape=function(t){var e=t.current();if(se(e))return t.lastIntValue=-1,t.advance(),ie;var n=!1;if(t.switchU&&this.options.ecmaVersion>=9&&((n=80===e)||112===e)){var i;if(t.lastIntValue=-1,t.advance(),t.eat(123)&&(i=this.regexp_eatUnicodePropertyValueExpression(t))&&t.eat(125))return n&&i===re&&t.raise("Invalid property name"),i;t.raise("Invalid property name")}return ne},Qt.regexp_eatUnicodePropertyValueExpression=function(t){var e=t.pos;if(this.regexp_eatUnicodePropertyName(t)&&t.eat(61)){var n=t.lastStringValue;if(this.regexp_eatUnicodePropertyValue(t)){var i=t.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(t,n,i),ie}}if(t.pos=e,this.regexp_eatLoneUnicodePropertyNameOrValue(t)){var r=t.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(t,r)}return ne},Qt.regexp_validateUnicodePropertyNameAndValue=function(t,e,n){R(t.unicodeProperties.nonBinary,e)||t.raise("Invalid property name"),t.unicodeProperties.nonBinary[e].test(n)||t.raise("Invalid property value")},Qt.regexp_validateUnicodePropertyNameOrValue=function(t,e){return t.unicodeProperties.binary.test(e)?ie:t.switchV&&t.unicodeProperties.binaryOfStrings.test(e)?re:void t.raise("Invalid property name")},Qt.regexp_eatUnicodePropertyName=function(t){var e=0;for(t.lastStringValue="";ae(e=t.current());)t.lastStringValue+=k(e),t.advance();return""!==t.lastStringValue},Qt.regexp_eatUnicodePropertyValue=function(t){var e=0;for(t.lastStringValue="";oe(e=t.current());)t.lastStringValue+=k(e),t.advance();return""!==t.lastStringValue},Qt.regexp_eatLoneUnicodePropertyNameOrValue=function(t){return this.regexp_eatUnicodePropertyValue(t)},Qt.regexp_eatCharacterClass=function(t){if(t.eat(91)){var e=t.eat(94),n=this.regexp_classContents(t);return t.eat(93)||t.raise("Unterminated character class"),e&&n===re&&t.raise("Negated character class may contain strings"),!0}return!1},Qt.regexp_classContents=function(t){return 93===t.current()?ie:t.switchV?this.regexp_classSetExpression(t):(this.regexp_nonEmptyClassRanges(t),ie)},Qt.regexp_nonEmptyClassRanges=function(t){for(;this.regexp_eatClassAtom(t);){var e=t.lastIntValue;if(t.eat(45)&&this.regexp_eatClassAtom(t)){var n=t.lastIntValue;!t.switchU||-1!==e&&-1!==n||t.raise("Invalid character class"),-1!==e&&-1!==n&&e>n&&t.raise("Range out of order in character class")}}},Qt.regexp_eatClassAtom=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatClassEscape(t))return!0;if(t.switchU){var n=t.current();(99===n||fe(n))&&t.raise("Invalid class escape"),t.raise("Invalid escape")}t.pos=e}var i=t.current();return 93!==i&&(t.lastIntValue=i,t.advance(),!0)},Qt.regexp_eatClassEscape=function(t){var e=t.pos;if(t.eat(98))return t.lastIntValue=8,!0;if(t.switchU&&t.eat(45))return t.lastIntValue=45,!0;if(!t.switchU&&t.eat(99)){if(this.regexp_eatClassControlLetter(t))return!0;t.pos=e}return this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)},Qt.regexp_classSetExpression=function(t){var e,n=ie;if(this.regexp_eatClassSetRange(t));else if(e=this.regexp_eatClassSetOperand(t)){e===re&&(n=re);for(var i=t.pos;t.eatChars([38,38]);)38!==t.current()&&(e=this.regexp_eatClassSetOperand(t))?e!==re&&(n=ie):t.raise("Invalid character in character class");if(i!==t.pos)return n;for(;t.eatChars([45,45]);)this.regexp_eatClassSetOperand(t)||t.raise("Invalid character in character class");if(i!==t.pos)return n}else t.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(t)){if(!(e=this.regexp_eatClassSetOperand(t)))return n;e===re&&(n=re)}},Qt.regexp_eatClassSetRange=function(t){var e=t.pos;if(this.regexp_eatClassSetCharacter(t)){var n=t.lastIntValue;if(t.eat(45)&&this.regexp_eatClassSetCharacter(t)){var i=t.lastIntValue;return-1!==n&&-1!==i&&n>i&&t.raise("Range out of order in character class"),!0}t.pos=e}return!1},Qt.regexp_eatClassSetOperand=function(t){return this.regexp_eatClassSetCharacter(t)?ie:this.regexp_eatClassStringDisjunction(t)||this.regexp_eatNestedClass(t)},Qt.regexp_eatNestedClass=function(t){var e=t.pos;if(t.eat(91)){var n=t.eat(94),i=this.regexp_classContents(t);if(t.eat(93))return n&&i===re&&t.raise("Negated character class may contain strings"),i;t.pos=e}if(t.eat(92)){var r=this.regexp_eatCharacterClassEscape(t);if(r)return r;t.pos=e}return null},Qt.regexp_eatClassStringDisjunction=function(t){var e=t.pos;if(t.eatChars([92,113])){if(t.eat(123)){var n=this.regexp_classStringDisjunctionContents(t);if(t.eat(125))return n}else t.raise("Invalid escape");t.pos=e}return null},Qt.regexp_classStringDisjunctionContents=function(t){for(var e=this.regexp_classString(t);t.eat(124);)this.regexp_classString(t)===re&&(e=re);return e},Qt.regexp_classString=function(t){for(var e=0;this.regexp_eatClassSetCharacter(t);)e++;return 1===e?ie:re},Qt.regexp_eatClassSetCharacter=function(t){var e=t.pos;if(t.eat(92))return!(!this.regexp_eatCharacterEscape(t)&&!this.regexp_eatClassSetReservedPunctuator(t)&&(t.eat(98)?(t.lastIntValue=8,0):(t.pos=e,1)));var n=t.current();return!(n<0||n===t.lookahead()&&le(n)||he(n)||(t.advance(),t.lastIntValue=n,0))},Qt.regexp_eatClassSetReservedPunctuator=function(t){var e=t.current();return!!ce(e)&&(t.lastIntValue=e,t.advance(),!0)},Qt.regexp_eatClassControlLetter=function(t){var e=t.current();return!(!ue(e)&&95!==e||(t.lastIntValue=e%32,t.advance(),0))},Qt.regexp_eatHexEscapeSequence=function(t){var e=t.pos;if(t.eat(120)){if(this.regexp_eatFixedHexDigits(t,2))return!0;t.switchU&&t.raise("Invalid escape"),t.pos=e}return!1},Qt.regexp_eatDecimalDigits=function(t){var e=t.pos,n=0;for(t.lastIntValue=0;ue(n=t.current());)t.lastIntValue=10*t.lastIntValue+(n-48),t.advance();return t.pos!==e},Qt.regexp_eatHexDigits=function(t){var e=t.pos,n=0;for(t.lastIntValue=0;de(n=t.current());)t.lastIntValue=16*t.lastIntValue+pe(n),t.advance();return t.pos!==e},Qt.regexp_eatLegacyOctalEscapeSequence=function(t){if(this.regexp_eatOctalDigit(t)){var e=t.lastIntValue;if(this.regexp_eatOctalDigit(t)){var n=t.lastIntValue;e<=3&&this.regexp_eatOctalDigit(t)?t.lastIntValue=64*e+8*n+t.lastIntValue:t.lastIntValue=8*e+n}else t.lastIntValue=e;return!0}return!1},Qt.regexp_eatOctalDigit=function(t){var e=t.current();return fe(e)?(t.lastIntValue=e-48,t.advance(),!0):(t.lastIntValue=0,!1)},Qt.regexp_eatFixedHexDigits=function(t,e){var n=t.pos;t.lastIntValue=0;for(var i=0;i<e;++i){var r=t.current();if(!de(r))return t.pos=n,!1;t.lastIntValue=16*t.lastIntValue+pe(r),t.advance()}return!0};var me=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new U(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},ge=at.prototype;function ve(t,e){return e?parseInt(t,8):parseFloat(t.replace(/_/g,""))}function _e(t){return"function"!=typeof BigInt?null:BigInt(t.replace(/_/g,""))}ge.next=function(t){!t&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new me(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},ge.getToken=function(){return this.next(),new me(this)},"undefined"!=typeof Symbol&&(ge[Symbol.iterator]=function(){var t=this;return{next:function(){var e=t.getToken();return{done:e.type===y.eof,value:e}}}}),ge.nextToken=function(){var t=this.curContext();return t&&t.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(y.eof):t.override?t.override(this):void this.readToken(this.fullCharCodeAtPos())},ge.readToken=function(t){return d(t,this.options.ecmaVersion>=6)||92===t?this.readWord():this.getTokenFromCode(t)},ge.fullCharCodeAtPos=function(){var t=this.input.charCodeAt(this.pos);if(t<=55295||t>=56320)return t;var e=this.input.charCodeAt(this.pos+1);return e<=56319||e>=57344?t:(t<<10)+e-56613888},ge.skipBlockComment=function(){var t=this.options.onComment&&this.curPosition(),e=this.pos,n=this.input.indexOf("*/",this.pos+=2);if(-1===n&&this.raise(this.pos-2,"Unterminated comment"),this.pos=n+2,this.options.locations)for(var i=void 0,r=e;(i=w(this.input,r,this.pos))>-1;)++this.curLine,r=this.lineStart=i;this.options.onComment&&this.options.onComment(!0,this.input.slice(e+2,n),e,this.pos,t,this.curPosition())},ge.skipLineComment=function(t){for(var e=this.pos,n=this.options.onComment&&this.curPosition(),i=this.input.charCodeAt(this.pos+=t);this.pos<this.input.length&&!M(i);)i=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+t,this.pos),e,this.pos,n,this.curPosition())},ge.skipSpace=function(){t:for(;this.pos<this.input.length;){var t=this.input.charCodeAt(this.pos);switch(t){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(!(t>8&&t<14||t>=5760&&C.test(String.fromCharCode(t))))break t;++this.pos}}},ge.finishToken=function(t,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var n=this.type;this.type=t,this.value=e,this.updateContext(n)},ge.readToken_dot=function(){var t=this.input.charCodeAt(this.pos+1);if(t>=48&&t<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===t&&46===e?(this.pos+=3,this.finishToken(y.ellipsis)):(++this.pos,this.finishToken(y.dot))},ge.readToken_slash=function(){var t=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===t?this.finishOp(y.assign,2):this.finishOp(y.slash,1)},ge.readToken_mult_modulo_exp=function(t){var e=this.input.charCodeAt(this.pos+1),n=1,i=42===t?y.star:y.modulo;return this.options.ecmaVersion>=7&&42===t&&42===e&&(++n,i=y.starstar,e=this.input.charCodeAt(this.pos+2)),61===e?this.finishOp(y.assign,n+1):this.finishOp(i,n)},ge.readToken_pipe_amp=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?this.options.ecmaVersion>=12&&61===this.input.charCodeAt(this.pos+2)?this.finishOp(y.assign,3):this.finishOp(124===t?y.logicalOR:y.logicalAND,2):61===e?this.finishOp(y.assign,2):this.finishOp(124===t?y.bitwiseOR:y.bitwiseAND,1)},ge.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(y.assign,2):this.finishOp(y.bitwiseXOR,1)},ge.readToken_plus_min=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?45!==e||this.inModule||62!==this.input.charCodeAt(this.pos+2)||0!==this.lastTokEnd&&!S.test(this.input.slice(this.lastTokEnd,this.pos))?this.finishOp(y.incDec,2):(this.skipLineComment(3),this.skipSpace(),this.nextToken()):61===e?this.finishOp(y.assign,2):this.finishOp(y.plusMin,1)},ge.readToken_lt_gt=function(t){var e=this.input.charCodeAt(this.pos+1),n=1;return e===t?(n=62===t&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+n)?this.finishOp(y.assign,n+1):this.finishOp(y.bitShift,n)):33!==e||60!==t||this.inModule||45!==this.input.charCodeAt(this.pos+2)||45!==this.input.charCodeAt(this.pos+3)?(61===e&&(n=2),this.finishOp(y.relational,n)):(this.skipLineComment(4),this.skipSpace(),this.nextToken())},ge.readToken_eq_excl=function(t){var e=this.input.charCodeAt(this.pos+1);return 61===e?this.finishOp(y.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===t&&62===e&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(y.arrow)):this.finishOp(61===t?y.eq:y.prefix,1)},ge.readToken_question=function(){var t=this.options.ecmaVersion;if(t>=11){var e=this.input.charCodeAt(this.pos+1);if(46===e){var n=this.input.charCodeAt(this.pos+2);if(n<48||n>57)return this.finishOp(y.questionDot,2)}if(63===e)return t>=12&&61===this.input.charCodeAt(this.pos+2)?this.finishOp(y.assign,3):this.finishOp(y.coalesce,2)}return this.finishOp(y.question,1)},ge.readToken_numberSign=function(){var t=35;if(this.options.ecmaVersion>=13&&(++this.pos,d(t=this.fullCharCodeAtPos(),!0)||92===t))return this.finishToken(y.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+k(t)+"'")},ge.getTokenFromCode=function(t){switch(t){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(y.parenL);case 41:return++this.pos,this.finishToken(y.parenR);case 59:return++this.pos,this.finishToken(y.semi);case 44:return++this.pos,this.finishToken(y.comma);case 91:return++this.pos,this.finishToken(y.bracketL);case 93:return++this.pos,this.finishToken(y.bracketR);case 123:return++this.pos,this.finishToken(y.braceL);case 125:return++this.pos,this.finishToken(y.braceR);case 58:return++this.pos,this.finishToken(y.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(y.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(120===e||88===e)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===e||79===e)return this.readRadixNumber(8);if(98===e||66===e)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(t);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(t);case 124:case 38:return this.readToken_pipe_amp(t);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(t);case 60:case 62:return this.readToken_lt_gt(t);case 61:case 33:return this.readToken_eq_excl(t);case 63:return this.readToken_question();case 126:return this.finishOp(y.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+k(t)+"'")},ge.finishOp=function(t,e){var n=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(t,n)},ge.readRegexp=function(){for(var t,e,n=this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated regular expression");var i=this.input.charAt(this.pos);if(S.test(i)&&this.raise(n,"Unterminated regular expression"),t)t=!1;else{if("["===i)e=!0;else if("]"===i&&e)e=!1;else if("/"===i&&!e)break;t="\\"===i}++this.pos}var r=this.input.slice(n,this.pos);++this.pos;var s=this.pos,a=this.readWord1();this.containsEsc&&this.unexpected(s);var o=this.regexpState||(this.regexpState=new Kt(this));o.reset(n,r,a),this.validateRegExpFlags(o),this.validateRegExpPattern(o);var l=null;try{l=new RegExp(r,a)}catch(h){}return this.finishToken(y.regexp,{pattern:r,flags:a,value:l})},ge.readInt=function(t,e,n){for(var i=this.options.ecmaVersion>=12&&void 0===e,r=n&&48===this.input.charCodeAt(this.pos),s=this.pos,a=0,o=0,l=0,h=null==e?1/0:e;l<h;++l,++this.pos){var c=this.input.charCodeAt(this.pos),u=void 0;if(i&&95===c)r&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),95===o&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),0===l&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),o=c;else{if((u=c>=97?c-97+10:c>=65?c-65+10:c>=48&&c<=57?c-48:1/0)>=t)break;o=c,a=a*t+u}}return i&&95===o&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===s||null!=e&&this.pos-s!==e?null:a},ge.readRadixNumber=function(t){var e=this.pos;this.pos+=2;var n=this.readInt(t);return null==n&&this.raise(this.start+2,"Expected number in radix "+t),this.options.ecmaVersion>=11&&110===this.input.charCodeAt(this.pos)?(n=_e(this.input.slice(e,this.pos)),++this.pos):d(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(y.num,n)},ge.readNumber=function(t){var e=this.pos;t||null!==this.readInt(10,void 0,!0)||this.raise(e,"Invalid number");var n=this.pos-e>=2&&48===this.input.charCodeAt(e);n&&this.strict&&this.raise(e,"Invalid number");var i=this.input.charCodeAt(this.pos);if(!n&&!t&&this.options.ecmaVersion>=11&&110===i){var r=_e(this.input.slice(e,this.pos));return++this.pos,d(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(y.num,r)}n&&/[89]/.test(this.input.slice(e,this.pos))&&(n=!1),46!==i||n||(++this.pos,this.readInt(10),i=this.input.charCodeAt(this.pos)),69!==i&&101!==i||n||(43!==(i=this.input.charCodeAt(++this.pos))&&45!==i||++this.pos,null===this.readInt(10)&&this.raise(e,"Invalid number")),d(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var s=ve(this.input.slice(e,this.pos),n);return this.finishToken(y.num,s)},ge.readCodePoint=function(){var t;if(123===this.input.charCodeAt(this.pos)){this.options.ecmaVersion<6&&this.unexpected();var e=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(e,"Code point out of bounds")}else t=this.readHexChar(4);return t},ge.readString=function(t){for(var e="",n=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var i=this.input.charCodeAt(this.pos);if(i===t)break;92===i?(e+=this.input.slice(n,this.pos),e+=this.readEscapedChar(!1),n=this.pos):8232===i||8233===i?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(M(i)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return e+=this.input.slice(n,this.pos++),this.finishToken(y.string,e)};var xe={};ge.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(t){if(t!==xe)throw t;this.readInvalidTemplateToken()}this.inTemplateElement=!1},ge.invalidStringToken=function(t,e){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw xe;this.raise(t,e)},ge.readTmplToken=function(){for(var t="",e=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var n=this.input.charCodeAt(this.pos);if(96===n||36===n&&123===this.input.charCodeAt(this.pos+1))return this.pos!==this.start||this.type!==y.template&&this.type!==y.invalidTemplate?(t+=this.input.slice(e,this.pos),this.finishToken(y.template,t)):36===n?(this.pos+=2,this.finishToken(y.dollarBraceL)):(++this.pos,this.finishToken(y.backQuote));if(92===n)t+=this.input.slice(e,this.pos),t+=this.readEscapedChar(!0),e=this.pos;else if(M(n)){switch(t+=this.input.slice(e,this.pos),++this.pos,n){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:t+="\n";break;default:t+=String.fromCharCode(n)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),e=this.pos}else++this.pos}},ge.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if("{"!==this.input[this.pos+1])break;case"`":return this.finishToken(y.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},ge.readEscapedChar=function(t){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return k(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),t){var n=this.pos-1;this.invalidStringToken(n,"Invalid escape sequence in template string")}default:if(e>=48&&e<=55){var i=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],r=parseInt(i,8);return r>255&&(i=i.slice(0,-1),r=parseInt(i,8)),this.pos+=i.length-1,e=this.input.charCodeAt(this.pos),"0"===i&&56!==e&&57!==e||!this.strict&&!t||this.invalidStringToken(this.pos-1-i.length,t?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(r)}return M(e)?"":String.fromCharCode(e)}},ge.readHexChar=function(t){var e=this.pos,n=this.readInt(16,t);return null===n&&this.invalidStringToken(e,"Bad character escape sequence"),n},ge.readWord1=function(){this.containsEsc=!1;for(var t="",e=!0,n=this.pos,i=this.options.ecmaVersion>=6;this.pos<this.input.length;){var r=this.fullCharCodeAtPos();if(p(r,i))this.pos+=r<=65535?1:2;else{if(92!==r)break;this.containsEsc=!0,t+=this.input.slice(n,this.pos);var s=this.pos;117!==this.input.charCodeAt(++this.pos)&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var a=this.readCodePoint();(e?d:p)(a,i)||this.invalidStringToken(s,"Invalid Unicode escape"),t+=k(a),n=this.pos}e=!1}return t+this.input.slice(n,this.pos)},ge.readWord=function(){var t=this.readWord1(),e=y.name;return this.keywords.test(t)&&(e=_[t]),this.finishToken(e,t)};var ye="8.11.3";function Se(t,e){return at.parse(t,e)}function be(t,e,n){return at.parseExpressionAt(t,e,n)}function Me(t,e){return at.tokenizer(t,e)}at.acorn={Parser:at,version:ye,defaultOptions:F,Position:O,SourceLocation:U,getLineInfo:D,Node:Rt,TokenType:f,tokTypes:y,keywordTypes:_,TokContext:St,tokContexts:bt,isIdentifierChar:p,isIdentifierStart:d,Token:me,isNewLine:M,lineBreak:S,lineBreakG:b,nonASCIIwhitespace:C},t.Node=Rt,t.Parser=at,t.Position=O,t.SourceLocation=U,t.TokContext=St,t.Token=me,t.TokenType=f,t.defaultOptions=F,t.getLineInfo=D,t.isIdentifierChar=p,t.isIdentifierStart=d,t.isNewLine=M,t.keywordTypes=_,t.lineBreak=S,t.lineBreakG=b,t.nonASCIIwhitespace=C,t.parse=Se,t.parseExpressionAt=be,t.tokContexts=bt,t.tokTypes=y,t.tokenizer=Me,t.version=ye}(jl.exports)),jl.exports}ql=Xl,function(t,e){var n=(t=t||Q).window,i=t.document,s=new function(){var t=/^(statics|enumerable|beans|preserve)$/,n=[],i=n.slice,r=Object.create,s=Object.getOwnPropertyDescriptor,a=Object.defineProperty,o=n.forEach||function(t,e){for(var n=0,i=this.length;n<i;n++)t.call(e,this[n],n,this)},l=function(t,e){for(var n in this)this.hasOwnProperty(n)&&t.call(e,this[n],n,this)},h=Object.assign||function(t){for(var e=1,n=arguments.length;e<n;e++){var i=arguments[e];for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])}return t},c=function(t,e,n){if(t){var i=s(t,"length");(i&&"number"==typeof i.value?o:l).call(t,e,n=n||t)}return n};function u(e,n,i,r,o){var l={};function h(t,h){"string"==typeof(h=h||(h=s(n,t))&&(h.get?h:h.value))&&"#"===h[0]&&(h=e[h.substring(1)]||h);var c,u="function"==typeof h,p=h,f=o||u&&!h.base?h&&h.get?t in e:e[t]:null;o&&f||(u&&f&&(h.base=f),u&&!1!==r&&(c=t.match(/^([gs]et|is)(([A-Z])(.*))$/))&&(l[c[3].toLowerCase()+c[4]]=c[2]),p&&!u&&p.get&&"function"==typeof p.get&&d.isPlainObject(p)||(p={value:p,writable:!0}),(s(e,t)||{configurable:!0}).configurable&&(p.configurable=!0,p.enumerable=null!=i?i:!c),a(e,t,p))}if(n){for(var c in n)n.hasOwnProperty(c)&&!t.test(c)&&h(c);for(var c in l){var u=l[c],p=e["set"+u],f=e["get"+u]||p&&e["is"+u];!f||!0!==r&&0!==f.length||h(c,{get:f,set:p})}}return e}function d(){for(var t=0,e=arguments.length;t<e;t++){var n=arguments[t];n&&h(this,n)}return this}return u(d,{inject:function(t){if(t){var e=!0===t.statics?t:t.statics,n=t.beans,i=t.preserve;e!==t&&u(this.prototype,t,t.enumerable,n,i),u(this,e,null,n,i)}for(var r=1,s=arguments.length;r<s;r++)this.inject(arguments[r]);return this},extend:function(){for(var t,e,n,i=this,s=0,o=arguments.length;s<o&&(!t||!e);s++)n=arguments[s],t=t||n.initialize,e=e||n.prototype;return t=t||function(){i.apply(this,arguments)},e=t.prototype=e||r(this.prototype),a(e,"constructor",{value:t,writable:!0,configurable:!0}),u(t,this),arguments.length&&this.inject.apply(t,arguments),t.base=i,t}}).inject({enumerable:!1,initialize:d,set:d,inject:function(){for(var t=0,e=arguments.length;t<e;t++){var n=arguments[t];n&&u(this,n,n.enumerable,n.beans,n.preserve)}return this},extend:function(){var t=r(this);return t.inject.apply(t,arguments)},each:function(t,e){return c(this,t,e)},clone:function(){return new this.constructor(this)},statics:{set:h,each:c,create:r,define:a,describe:s,clone:function(t){return h(new t.constructor,t)},isPlainObject:function(t){var e=null!=t&&t.constructor;return e&&(e===Object||e===d||"Object"===e.name)},pick:function(t,n){return t!==e?t:n},slice:function(t,e,n){return i.call(t,e,n)}}})};ql.exports=s,s.inject({enumerable:!1,toString:function(){return null!=this._id?(this._class||"Object")+(this._name?" '"+this._name+"'":" @"+this._id):"{ "+s.each(this,(function(t,e){if(!/^_/.test(e)){var n=typeof t;this.push(e+": "+("number"===n?c.instance.number(t):"string"===n?"'"+t+"'":t))}}),[]).join(", ")+" }"},getClassName:function(){return this._class||""},importJSON:function(t){return s.importJSON(t,this)},exportJSON:function(t){return s.exportJSON(this,t)},toJSON:function(){return s.serialize(this)},set:function(t,e){return t&&s.filter(this,t,e,this._prioritize),this}},{beans:!1,statics:{exports:{},extend:function t(){var e=t.base.apply(this,arguments),n=e.prototype._class;return n&&!s.exports[n]&&(s.exports[n]=e),e},equals:function(t,e){if(t===e)return!0;if(t&&t.equals)return t.equals(e);if(e&&e.equals)return e.equals(t);if(t&&e&&"object"==typeof t&&"object"==typeof e){if(Array.isArray(t)&&Array.isArray(e)){if((n=t.length)!==e.length)return!1;for(;n--;)if(!s.equals(t[n],e[n]))return!1}else{var n,i=Object.keys(t);if((n=i.length)!==Object.keys(e).length)return!1;for(;n--;){var r=i[n];if(!e.hasOwnProperty(r)||!s.equals(t[r],e[r]))return!1}}return!0}return!1},read:function(t,n,i,r){if(this===s){var a=this.peek(t,n);return t.__index++,a}var o=this.prototype,l=o._readIndex,h=n||l&&t.__index||0,c=t.length,u=t[h];if(r=r||c-h,u instanceof this||i&&i.readNull&&null==u&&r<=1)return l&&(t.__index=h+1),u&&i&&i.clone?u.clone():u;if(u=s.create(o),l&&(u.__read=!0),u=u.initialize.apply(u,h>0||h+r<c?s.slice(t,h,h+r):t)||u,l){t.__index=h+u.__read;var d=u.__filtered;d&&(t.__filtered=d,u.__filtered=e),u.__read=e}return u},peek:function(t,e){return t[t.__index=e||t.__index||0]},remain:function(t){return t.length-(t.__index||0)},readList:function(t,e,n,i){for(var r,s=[],a=e||0,o=i?a+i:t.length,l=a;l<o;l++)s.push(Array.isArray(r=t[l])?this.read(r,0,n):this.read(t,l,n,1));return s},readNamed:function(t,n,i,r,a){var o=this.getNamed(t,n),l=o!==e;if(l){var h=t.__filtered;if(!h){var c=this.getSource(t);(h=t.__filtered=s.create(c)).__unfiltered=c}h[n]=e}return this.read(l?[o]:t,i,r,a)},readSupported:function(t,n){var i=this.getSource(t),r=this,s=!1;return i&&Object.keys(i).forEach((function(i){if(i in n){var a=r.readNamed(t,i);a!==e&&(n[i]=a),s=!0}})),s},getSource:function(t){var n=t.__source;if(n===e){var i=1===t.length&&t[0];n=t.__source=i&&s.isPlainObject(i)?i:null}return n},getNamed:function(t,e){var n=this.getSource(t);if(n)return e?n[e]:t.__filtered||n},hasNamed:function(t,e){return!!this.getNamed(t,e)},filter:function(t,n,i,r){var s;function a(r){if(!(i&&r in i||s&&r in s)){var a=n[r];a!==e&&(t[r]=a)}}if(r){for(var o,l={},h=0,c=r.length;h<c;h++)(o=r[h])in n&&(a(o),l[o]=!0);s=l}return Object.keys(n.__unfiltered||n).forEach(a),t},isPlainValue:function(t,e){return s.isPlainObject(t)||Array.isArray(t)||e&&"string"==typeof t},serialize:function(t,e,n,i){e=e||{};var r,a=!i;if(a&&(e.formatter=new c(e.precision),i={length:0,definitions:{},references:{},add:function(t,e){var n="#"+t._id,i=this.references[n];if(!i){this.length++;var r=e.call(t),s=t._class;s&&r[0]!==s&&r.unshift(s),this.definitions[n]=r,i=this.references[n]=[n]}return i}}),t&&t._serialize){r=t._serialize(e,i);var o=t._class;!o||t._compactSerialize||!a&&n||r[0]===o||r.unshift(o)}else if(Array.isArray(t)){r=[];for(var l=0,h=t.length;l<h;l++)r[l]=s.serialize(t[l],e,n,i)}else if(s.isPlainObject(t)){r={};var u=Object.keys(t);for(l=0,h=u.length;l<h;l++){var d=u[l];r[d]=s.serialize(t[d],e,n,i)}}else r="number"==typeof t?e.formatter.number(t,e.precision):t;return a&&i.length>0?[["dictionary",i.definitions],r]:r},deserialize:function(t,e,n,i,r){var a=t,o=!n,l=o&&t&&t.length&&"dictionary"===t[0][0];if(n=n||{},Array.isArray(t)){var h=t[0],c="dictionary"===h;if(1==t.length&&/^#/.test(h))return n.dictionary[h];a=[];for(var u=(h=s.exports[h])?1:0,d=t.length;u<d;u++)a.push(s.deserialize(t[u],e,n,c,l));if(h){var p=a;a=e?e(h,p,o||r):new h(p)}}else if(s.isPlainObject(t))for(var f in a={},i&&(n.dictionary=a),t)a[f]=s.deserialize(t[f],e,n);return l?a[1]:a},exportJSON:function(t,e){var n=s.serialize(t,e);return e&&0==e.asString?n:JSON.stringify(n)},importJSON:function(t,e){return s.deserialize("string"==typeof t?JSON.parse(t):t,(function(t,n,i){var r=i&&e&&e.constructor===t,a=r?e:s.create(t.prototype);if(1===n.length&&a instanceof b&&(r||!(a instanceof w))){var o=n[0];s.isPlainObject(o)&&(o.insert=!1,r&&(n=n.concat([b.INSERT])))}return(r?a.set:t).apply(a,n),r&&(e=null),a}))},push:function(t,e){var n=e.length;if(n<4096)t.push.apply(t,e);else{var i=t.length;t.length+=n;for(var r=0;r<n;r++)t[i+r]=e[r]}return t},splice:function(t,n,i,r){var a=n&&n.length,o=i===e;(i=o?t.length:i)>t.length&&(i=t.length);for(var l=0;l<a;l++)n[l]._index=i+l;if(o)return s.push(t,n),[];var h=[i,r];n&&s.push(h,n);for(var c=t.splice.apply(t,h),u=(l=0,c.length);l<u;l++)c[l]._index=e;for(l=i+a,u=t.length;l<u;l++)t[l]._index=l;return c},capitalize:function(t){return t.replace(/\b[a-z]/g,(function(t){return t.toUpperCase()}))},camelize:function(t){return t.replace(/-(.)/g,(function(t,e){return e.toUpperCase()}))},hyphenate:function(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}}});var a={on:function(t,e){if("string"!=typeof t)s.each(t,(function(t,e){this.on(e,t)}),this);else{var n=this._eventTypes,i=n&&n[t],r=this._callbacks=this._callbacks||{};-1===(r=r[t]=r[t]||[]).indexOf(e)&&(r.push(e),i&&i.install&&1===r.length&&i.install.call(this,t))}return this},off:function(t,e){if("string"==typeof t){var n,i=this._eventTypes,r=i&&i[t],a=this._callbacks&&this._callbacks[t];return a&&(!e||-1!==(n=a.indexOf(e))&&1===a.length?(r&&r.uninstall&&r.uninstall.call(this,t),delete this._callbacks[t]):-1!==n&&a.splice(n,1)),this}s.each(t,(function(t,e){this.off(e,t)}),this)},once:function(t,e){return this.on(t,(function n(){e.apply(this,arguments),this.off(t,n)}))},emit:function(t,e){var n=this._callbacks&&this._callbacks[t];if(!n)return!1;var i=s.slice(arguments,1),r=e&&e.target&&!e.currentTarget;n=n.slice(),r&&(e.currentTarget=this);for(var a=0,o=n.length;a<o;a++)if(0==n[a].apply(this,i)){e&&e.stop&&e.stop();break}return r&&delete e.currentTarget,!0},responds:function(t){return!(!this._callbacks||!this._callbacks[t])},attach:"#on",detach:"#off",fire:"#emit",_installEvents:function(t){var e=this._eventTypes,n=this._callbacks,i=t?"install":"uninstall";if(e)for(var r in n)if(n[r].length>0){var s=e[r],a=s&&s[i];a&&a.call(this,r)}},statics:{inject:function t(e){var n=e._events;if(n){var i={};s.each(n,(function(t,n){var r="string"==typeof t,a=r?t:n,o=s.capitalize(a),l=a.substring(2).toLowerCase();i[l]=r?{}:t,a="_"+a,e["get"+o]=function(){return this[a]},e["set"+o]=function(t){var e=this[a];e&&this.off(l,e),t&&this.on(l,t),this[a]=t}})),e._eventTypes=i}return t.base.apply(this,arguments)}}},o=s.extend({_class:"PaperScope",initialize:function e(){lt=this,this.settings=new s({applyMatrix:!0,insertItems:!0,handleSize:4,hitTolerance:0}),this.project=null,this.projects=[],this.tools=[],this._id=e._id++,e._scopes[this._id]=this;var n=e.prototype;if(!this.support){var i=rt.getContext(1,1)||{};n.support={nativeDash:"setLineDash"in i||"mozDash"in i,nativeBlendModes:st.nativeModes},rt.release(i)}if(!this.agent){var r=t.navigator.userAgent.toLowerCase(),a=(/(darwin|win|mac|linux|freebsd|sunos)/.exec(r)||[])[0],o="darwin"===a?"mac":a,l=n.agent=n.browser={platform:o};o&&(l[o]=!0),r.replace(/(opera|chrome|safari|webkit|firefox|msie|trident|atom|node|jsdom)\/?\s*([.\d]+)(?:.*version\/([.\d]+))?(?:.*rv\:v?([.\d]+))?/g,(function(t,e,n,i,r){if(!l.chrome){var s="opera"===e?i:/^(node|trident)$/.test(e)?r:n;l.version=s,l.versionNumber=parseFloat(s),e={trident:"msie",jsdom:"node"}[e]||e,l.name=e,l[e]=!0}})),l.chrome&&delete l.webkit,l.atom&&delete l.chrome}},version:"0.12.17",getView:function(){var t=this.project;return t&&t._view},getPaper:function(){return this},execute:function(t,e){var n=lt.PaperScript.execute(t,this,e);return j.updateFocus(),n},install:function(t){var e=this;for(var n in s.each(["project","view","tool"],(function(n){s.define(t,n,{configurable:!0,get:function(){return e[n]}})})),this)!/^_/.test(n)&&this[n]&&(t[n]=this[n])},setup:function(t){return lt=this,this.project=new S(t),this},createCanvas:function(t,e){return rt.getCanvas(t,e)},activate:function(){lt=this},clear:function(){for(var t=this.projects,e=this.tools,n=t.length-1;n>=0;n--)t[n].remove();for(n=e.length-1;n>=0;n--)e[n].remove()},remove:function(){this.clear(),delete o._scopes[this._id]},statics:new function(){function t(t){return t+="Attribute",function(e,n){return e[t](n)||e[t]("data-paper-"+n)}}return{_scopes:{},_id:0,get:function(t){return this._scopes[t]||null},getAttribute:t("get"),hasAttribute:t("has")}}}),l=s.extend(a,{initialize:function(t){this._scope=lt,this._index=this._scope[this._list].push(this)-1,!t&&this._scope[this._reference]||this.activate()},activate:function(){if(!this._scope)return!1;var t=this._scope[this._reference];return t&&t!==this&&t.emit("deactivate"),this._scope[this._reference]=this,this.emit("activate",t),!0},isActive:function(){return this._scope[this._reference]===this},remove:function(){return null!=this._index&&(s.splice(this._scope[this._list],null,this._index,1),this._scope[this._reference]==this&&(this._scope[this._reference]=null),this._scope=null,!0)},getView:function(){return this._scope.getView()}}),h={findItemBoundsCollisions:function(t,e,n){function i(t){for(var e=new Array(t.length),n=0;n<t.length;n++){var i=t[n].getBounds();e[n]=[i.left,i.top,i.right,i.bottom]}return e}var r=i(t),s=e&&e!==t?i(e):r;return this.findBoundsCollisions(r,s,n||0)},findCurveBoundsCollisions:function(t,e,n,i){function r(t){for(var e=Math.min,n=Math.max,i=new Array(t.length),r=0;r<t.length;r++){var s=t[r];i[r]=[e(s[0],s[2],s[4],s[6]),e(s[1],s[3],s[5],s[7]),n(s[0],s[2],s[4],s[6]),n(s[1],s[3],s[5],s[7])]}return i}var s=r(t),a=e&&e!==t?r(e):s;if(i){for(var o=this.findBoundsCollisions(s,a,n||0,!1,!0),l=this.findBoundsCollisions(s,a,n||0,!0,!0),h=[],c=0,u=o.length;c<u;c++)h[c]={hor:o[c],ver:l[c]};return h}return this.findBoundsCollisions(s,a,n||0)},findBoundsCollisions:function(t,e,n,i,r){var s=!e||t===e,a=s?t:t.concat(e),o=t.length,l=a.length;function h(t,e,n){for(var i=0,r=t.length;i<r;){var s=r+i>>>1;a[t[s]][e]<n?i=s+1:r=s}return i-1}for(var c=i?1:0,u=c+2,d=i?0:1,p=d+2,f=new Array(l),m=0;m<l;m++)f[m]=m;f.sort((function(t,e){return a[t][c]-a[e][c]}));var g=[],v=new Array(o);for(m=0;m<l;m++){var _=f[m],x=a[_],y=s?_:_-o,S=_<o,b=s||!S,M=S?[]:null;if(g.length){var w=h(g,u,x[c]-n)+1;if(g.splice(0,w),s&&r){M=M.concat(g);for(var C=0;C<g.length;C++)v[A=g[C]].push(y)}else{var T=x[p],E=x[d];for(C=0;C<g.length;C++){var A=g[C],P=a[A],R=A<o,W=s||A>=o;(r||(S&&W||b&&R)&&T>=P[d]-n&&E<=P[p]+n)&&(S&&W&&M.push(s?A:A-o),b&&R&&v[A].push(y))}}}if(S&&(t===e&&M.push(_),v[_]=M),g.length){var L=h(g,u,x[u]);g.splice(L+1,0,_)}else g.push(_)}for(m=0;m<v.length;m++){var I=v[m];I&&I.sort((function(t,e){return t-e}))}return v}},c=s.extend({initialize:function(t){this.precision=s.pick(t,5),this.multiplier=Math.pow(10,this.precision)},number:function(t){return this.precision<16?Math.round(t*this.multiplier)/this.multiplier:t},pair:function(t,e,n){return this.number(t)+(n||",")+this.number(e)},point:function(t,e){return this.number(t.x)+(e||",")+this.number(t.y)},size:function(t,e){return this.number(t.width)+(e||",")+this.number(t.height)},rectangle:function(t,e){return this.point(t,e)+(e||",")+this.size(t,e)}});c.instance=new c;var u=new function(){var t=[[.5773502691896257],[0,.7745966692414834],[.33998104358485626,.8611363115940526],[0,.5384693101056831,.906179845938664],[.2386191860831969,.6612093864662645,.932469514203152],[0,.4058451513773972,.7415311855993945,.9491079123427585],[.1834346424956498,.525532409916329,.7966664774136267,.9602898564975363],[0,.3242534234038089,.6133714327005904,.8360311073266358,.9681602395076261],[.14887433898163122,.4333953941292472,.6794095682990244,.8650633666889845,.9739065285171717],[0,.26954315595234496,.5190961292068118,.7301520055740494,.8870625997680953,.978228658146057],[.1252334085114689,.3678314989981802,.5873179542866175,.7699026741943047,.9041172563704749,.9815606342467192],[0,.2304583159551348,.44849275103644687,.6423493394403402,.8015780907333099,.9175983992229779,.9841830547185881],[.10805494870734367,.31911236892788974,.5152486363581541,.6872929048116855,.827201315069765,.9284348836635735,.9862838086968123],[0,.20119409399743451,.3941513470775634,.5709721726085388,.7244177313601701,.8482065834104272,.937273392400706,.9879925180204854],[.09501250983763744,.2816035507792589,.45801677765722737,.6178762444026438,.755404408355003,.8656312023878318,.9445750230732326,.9894009349916499]],e=[[1],[.8888888888888888,.5555555555555556],[.6521451548625461,.34785484513745385],[.5688888888888889,.47862867049936647,.23692688505618908],[.46791393457269104,.3607615730481386,.17132449237917036],[.4179591836734694,.3818300505051189,.27970539148927664,.1294849661688697],[.362683783378362,.31370664587788727,.22238103445337448,.10122853629037626],[.3302393550012598,.31234707704000286,.26061069640293544,.1806481606948574,.08127438836157441],[.29552422471475287,.26926671930999635,.21908636251598204,.1494513491505806,.06667134430868814],[.2729250867779006,.26280454451024665,.23319376459199048,.18629021092773426,.1255803694649046,.05566856711617366],[.24914704581340277,.2334925365383548,.20316742672306592,.16007832854334622,.10693932599531843,.04717533638651183],[.2325515532308739,.22628318026289723,.2078160475368885,.17814598076194574,.13887351021978725,.09212149983772845,.04048400476531588],[.2152638534631578,.2051984637212956,.18553839747793782,.15720316715819355,.12151857068790319,.08015808715976021,.03511946033175186],[.2025782419255613,.19843148532711158,.1861610000155622,.16626920581699392,.13957067792615432,.10715922046717194,.07036604748810812,.03075324199611727],[.1894506104550685,.18260341504492358,.16915651939500254,.14959598881657674,.12462897125553388,.09515851168249279,.062253523938647894,.027152459411754096]],n=Math.abs,i=Math.sqrt,r=Math.pow,s=Math.log2||function(t){return Math.log(t)*Math.LOG2E},a=1e-12,o=112e-18;function l(t,e,n){return t<e?e:t>n?n:t}function h(t,e,i){function r(t){var e=134217729*t,n=t-e+e;return[n,t-n]}var s=e*e-t*i,a=e*e+t*i;if(3*n(s)<a){var o=r(t),l=r(e),h=r(i),c=e*e,u=t*i;s=c-u+(l[0]*l[0]-c+2*l[0]*l[1]+l[1]*l[1]-(o[0]*h[0]-u+o[0]*h[1]+o[1]*h[0]+o[1]*h[1]))}return s}function c(){var t=Math.max.apply(Math,arguments);return t&&(t<1e-8||t>1e8)?r(2,-Math.round(s(t))):0}return{EPSILON:a,MACHINE_EPSILON:o,CURVETIME_EPSILON:1e-8,GEOMETRIC_EPSILON:1e-7,TRIGONOMETRIC_EPSILON:1e-8,ANGULAR_EPSILON:1e-5,KAPPA:4*(i(2)-1)/3,isZero:function(t){return t>=-1e-12&&t<=a},isMachineZero:function(t){return t>=-112e-18&&t<=o},clamp:l,integrate:function(n,i,r,s){for(var a=t[s-2],o=e[s-2],l=.5*(r-i),h=l+i,c=0,u=s+1>>1,d=1&s?o[c++]*n(h):0;c<u;){var p=l*a[c];d+=o[c++]*(n(h+p)+n(h-p))}return l*d},findRoot:function(t,e,i,r,s,a,o){for(var h=0;h<a;h++){var c=t(i),u=c/e(i),d=i-u;if(n(u)<o){i=d;break}c>0?(s=i,i=d<=r?.5*(r+s):d):(r=i,i=d>=s?.5*(r+s):d)}return l(i,r,s)},solveQuadratic:function(t,e,r,s,u,d){var p,f=1/0;if(n(t)<a){if(n(e)<a)return n(r)<a?-1:0;p=-r/e}else{var m=h(t,e*=-.5,r);if(m&&n(m)<o){var g=c(n(t),n(e),n(r));g&&(m=h(t*=g,e*=g,r*=g))}if(m>=-112e-18){var v=m<0?0:i(m),_=e+(e<0?-v:v);0===_?f=-(p=r/t):(p=_/t,f=r/_)}}var x=0,y=null==u,S=u-a,b=d+a;return isFinite(p)&&(y||p>S&&p<b)&&(s[x++]=y?p:l(p,u,d)),f!==p&&isFinite(f)&&(y||f>S&&f<b)&&(s[x++]=y?f:l(f,u,d)),x},solveCubic:function(t,e,s,h,d,p,f){var m,g,v,_,x,y=c(n(t),n(e),n(s),n(h));function S(n){var i=t*(m=n);_=(i+(g=i+e))*m+(v=g*m+s),x=v*m+h}if(y&&(t*=y,e*=y,s*=y,h*=y),n(t)<a)t=e,g=s,v=h,m=1/0;else if(n(h)<a)g=e,v=s,m=0;else{S(-e/t/3);var b=x/t,M=r(n(b),1/3),w=b<0?-1:1,C=-_/t,T=C>0?1.324717957244746*Math.max(M,i(C)):M,E=m-w*T;if(E!==m){do{S(E),E=0===_?m:m-x/_/(1+o)}while(w*E>w*m);n(t)*m*m>n(h/m)&&(g=((v=-h/m)-s)/m)}}var A=u.solveQuadratic(t,g,v,d,p,f),P=null==p;return isFinite(m)&&(0===A||A>0&&m!==d[0]&&m!==d[1])&&(P||m>p-a&&m<f+a)&&(d[A++]=P?m:l(m,p,f)),A}}},d={_id:1,_pools:{},get:function(t){if(t){var e=this._pools[t];return e||(e=this._pools[t]={_id:1}),e._id++}return this._id++}},p=s.extend({_class:"Point",_readIndex:!0,initialize:function(t,e){var n=typeof t,i=this.__read,r=0;if("number"===n){var s="number"==typeof e;this._set(t,s?e:t),i&&(r=s?2:1)}else if("undefined"===n||null===t)this._set(0,0),i&&(r=null===t?1:0);else{var a="string"===n?t.split(/[\s,]+/)||[]:t;r=1,Array.isArray(a)?this._set(+a[0],+(a.length>1?a[1]:a[0])):"x"in a?this._set(a.x||0,a.y||0):"width"in a?this._set(a.width||0,a.height||0):"angle"in a?(this._set(a.length||0,0),this.setAngle(a.angle||0)):(this._set(0,0),r=0)}return i&&(this.__read=r),this},set:"#initialize",_set:function(t,e){return this.x=t,this.y=e,this},equals:function(t){return this===t||t&&(this.x===t.x&&this.y===t.y||Array.isArray(t)&&this.x===t[0]&&this.y===t[1])||!1},clone:function(){return new p(this.x,this.y)},toString:function(){var t=c.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.x),e.number(this.y)]},getLength:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},setLength:function(t){if(this.isZero()){var e=this._angle||0;this._set(Math.cos(e)*t,Math.sin(e)*t)}else{var n=t/this.getLength();u.isZero(n)&&this.getAngle(),this._set(this.x*n,this.y*n)}},getAngle:function(){return 180*this.getAngleInRadians.apply(this,arguments)/Math.PI},setAngle:function(t){this.setAngleInRadians.call(this,t*Math.PI/180)},getAngleInDegrees:"#getAngle",setAngleInDegrees:"#setAngle",getAngleInRadians:function(){if(arguments.length){var t=p.read(arguments),e=this.getLength()*t.getLength();if(u.isZero(e))return NaN;var n=this.dot(t)/e;return Math.acos(n<-1?-1:n>1?1:n)}return this.isZero()?this._angle||0:this._angle=Math.atan2(this.y,this.x)},setAngleInRadians:function(t){if(this._angle=t,!this.isZero()){var e=this.getLength();this._set(Math.cos(t)*e,Math.sin(t)*e)}},getQuadrant:function(){return this.x>=0?this.y>=0?1:4:this.y>=0?2:3}},{beans:!1,getDirectedAngle:function(){var t=p.read(arguments);return 180*Math.atan2(this.cross(t),this.dot(t))/Math.PI},getDistance:function(){var t=arguments,e=p.read(t),n=e.x-this.x,i=e.y-this.y,r=n*n+i*i;return s.read(t)?r:Math.sqrt(r)},normalize:function(t){t===e&&(t=1);var n=this.getLength(),i=0!==n?t/n:0,r=new p(this.x*i,this.y*i);return i>=0&&(r._angle=this._angle),r},rotate:function(t,e){if(0===t)return this.clone();t=t*Math.PI/180;var n=e?this.subtract(e):this,i=Math.sin(t),r=Math.cos(t);return n=new p(n.x*r-n.y*i,n.x*i+n.y*r),e?n.add(e):n},transform:function(t){return t?t._transformPoint(this):this},add:function(){var t=p.read(arguments);return new p(this.x+t.x,this.y+t.y)},subtract:function(){var t=p.read(arguments);return new p(this.x-t.x,this.y-t.y)},multiply:function(){var t=p.read(arguments);return new p(this.x*t.x,this.y*t.y)},divide:function(){var t=p.read(arguments);return new p(this.x/t.x,this.y/t.y)},modulo:function(){var t=p.read(arguments);return new p(this.x%t.x,this.y%t.y)},negate:function(){return new p(-this.x,-this.y)},isInside:function(){return v.read(arguments).contains(this)},isClose:function(){var t=arguments,e=p.read(t),n=s.read(t);return this.getDistance(e)<=n},isCollinear:function(){var t=p.read(arguments);return p.isCollinear(this.x,this.y,t.x,t.y)},isColinear:"#isCollinear",isOrthogonal:function(){var t=p.read(arguments);return p.isOrthogonal(this.x,this.y,t.x,t.y)},isZero:function(){var t=u.isZero;return t(this.x)&&t(this.y)},isNaN:function(){return isNaN(this.x)||isNaN(this.y)},isInQuadrant:function(t){return this.x*(t>1&&t<4?-1:1)>=0&&this.y*(t>2?-1:1)>=0},dot:function(){var t=p.read(arguments);return this.x*t.x+this.y*t.y},cross:function(){var t=p.read(arguments);return this.x*t.y-this.y*t.x},project:function(){var t=p.read(arguments),e=t.isZero()?0:this.dot(t)/t.dot(t);return new p(t.x*e,t.y*e)},statics:{min:function(){var t=arguments,e=p.read(t),n=p.read(t);return new p(Math.min(e.x,n.x),Math.min(e.y,n.y))},max:function(){var t=arguments,e=p.read(t),n=p.read(t);return new p(Math.max(e.x,n.x),Math.max(e.y,n.y))},random:function(){return new p(Math.random(),Math.random())},isCollinear:function(t,e,n,i){return Math.abs(t*i-e*n)<=1e-8*Math.sqrt((t*t+e*e)*(n*n+i*i))},isOrthogonal:function(t,e,n,i){return Math.abs(t*n+e*i)<=1e-8*Math.sqrt((t*t+e*e)*(n*n+i*i))}}},s.each(["round","ceil","floor","abs"],(function(t){var e=Math[t];this[t]=function(){return new p(e(this.x),e(this.y))}}),{})),f=p.extend({initialize:function(t,e,n,i){this._x=t,this._y=e,this._owner=n,this._setter=i},_set:function(t,e,n){return this._x=t,this._y=e,n||this._owner[this._setter](this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner[this._setter](this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner[this._setter](this)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){return"setPosition"===this._setter?4:0}}),m=s.extend({_class:"Size",_readIndex:!0,initialize:function(t,e){var n=typeof t,i=this.__read,r=0;if("number"===n){var s="number"==typeof e;this._set(t,s?e:t),i&&(r=s?2:1)}else if("undefined"===n||null===t)this._set(0,0),i&&(r=null===t?1:0);else{var a="string"===n?t.split(/[\s,]+/)||[]:t;r=1,Array.isArray(a)?this._set(+a[0],+(a.length>1?a[1]:a[0])):"width"in a?this._set(a.width||0,a.height||0):"x"in a?this._set(a.x||0,a.y||0):(this._set(0,0),r=0)}return i&&(this.__read=r),this},set:"#initialize",_set:function(t,e){return this.width=t,this.height=e,this},equals:function(t){return t===this||t&&(this.width===t.width&&this.height===t.height||Array.isArray(t)&&this.width===t[0]&&this.height===t[1])||!1},clone:function(){return new m(this.width,this.height)},toString:function(){var t=c.instance;return"{ width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.width),e.number(this.height)]},add:function(){var t=m.read(arguments);return new m(this.width+t.width,this.height+t.height)},subtract:function(){var t=m.read(arguments);return new m(this.width-t.width,this.height-t.height)},multiply:function(){var t=m.read(arguments);return new m(this.width*t.width,this.height*t.height)},divide:function(){var t=m.read(arguments);return new m(this.width/t.width,this.height/t.height)},modulo:function(){var t=m.read(arguments);return new m(this.width%t.width,this.height%t.height)},negate:function(){return new m(-this.width,-this.height)},isZero:function(){var t=u.isZero;return t(this.width)&&t(this.height)},isNaN:function(){return isNaN(this.width)||isNaN(this.height)},statics:{min:function(t,e){return new m(Math.min(t.width,e.width),Math.min(t.height,e.height))},max:function(t,e){return new m(Math.max(t.width,e.width),Math.max(t.height,e.height))},random:function(){return new m(Math.random(),Math.random())}}},s.each(["round","ceil","floor","abs"],(function(t){var e=Math[t];this[t]=function(){return new m(e(this.width),e(this.height))}}),{})),g=m.extend({initialize:function(t,e,n,i){this._width=t,this._height=e,this._owner=n,this._setter=i},_set:function(t,e,n){return this._width=t,this._height=e,n||this._owner[this._setter](this),this},getWidth:function(){return this._width},setWidth:function(t){this._width=t,this._owner[this._setter](this)},getHeight:function(){return this._height},setHeight:function(t){this._height=t,this._owner[this._setter](this)}}),v=s.extend({_class:"Rectangle",_readIndex:!0,beans:!0,initialize:function(t,n,i,r){var a,o=arguments,l=typeof t;if("number"===l?(this._set(t,n,i,r),a=4):"undefined"===l||null===t?(this._set(0,0,0,0),a=null===t?1:0):1===o.length&&(Array.isArray(t)?(this._set.apply(this,t),a=1):t.x!==e||t.width!==e?(this._set(t.x||0,t.y||0,t.width||0,t.height||0),a=1):t.from===e&&t.to===e&&(this._set(0,0,0,0),s.readSupported(o,this)&&(a=1))),a===e){var h,c,u=p.readNamed(o,"from"),d=s.peek(o),f=u.x,g=u.y;if(d&&d.x!==e||s.hasNamed(o,"to")){var v=p.readNamed(o,"to");h=v.x-f,c=v.y-g,h<0&&(f=v.x,h=-h),c<0&&(g=v.y,c=-c)}else{var _=m.read(o);h=_.width,c=_.height}this._set(f,g,h,c),a=o.__index}var x=o.__filtered;return x&&(this.__filtered=x),this.__read&&(this.__read=a),this},set:"#initialize",_set:function(t,e,n,i){return this.x=t,this.y=e,this.width=n,this.height=i,this},clone:function(){return new v(this.x,this.y,this.width,this.height)},equals:function(t){var e=s.isPlainValue(t)?v.read(arguments):t;return e===this||e&&this.x===e.x&&this.y===e.y&&this.width===e.width&&this.height===e.height||!1},toString:function(){var t=c.instance;return"{ x: "+t.number(this.x)+", y: "+t.number(this.y)+", width: "+t.number(this.width)+", height: "+t.number(this.height)+" }"},_serialize:function(t){var e=t.formatter;return[e.number(this.x),e.number(this.y),e.number(this.width),e.number(this.height)]},getPoint:function(t){return new(t?p:f)(this.x,this.y,this,"setPoint")},setPoint:function(){var t=p.read(arguments);this.x=t.x,this.y=t.y},getSize:function(t){return new(t?m:g)(this.width,this.height,this,"setSize")},_fw:1,_fh:1,setSize:function(){var t=m.read(arguments),e=this._sx,n=this._sy,i=t.width,r=t.height;e&&(this.x+=(this.width-i)*e),n&&(this.y+=(this.height-r)*n),this.width=i,this.height=r,this._fw=this._fh=1},getLeft:function(){return this.x},setLeft:function(t){if(!this._fw){var e=t-this.x;this.width-=.5===this._sx?2*e:e}this.x=t,this._sx=this._fw=0},getTop:function(){return this.y},setTop:function(t){if(!this._fh){var e=t-this.y;this.height-=.5===this._sy?2*e:e}this.y=t,this._sy=this._fh=0},getRight:function(){return this.x+this.width},setRight:function(t){if(!this._fw){var e=t-this.x;this.width=.5===this._sx?2*e:e}this.x=t-this.width,this._sx=1,this._fw=0},getBottom:function(){return this.y+this.height},setBottom:function(t){if(!this._fh){var e=t-this.y;this.height=.5===this._sy?2*e:e}this.y=t-this.height,this._sy=1,this._fh=0},getCenterX:function(){return this.x+this.width/2},setCenterX:function(t){this._fw||.5===this._sx?this.x=t-this.width/2:(this._sx&&(this.x+=2*(t-this.x)*this._sx),this.width=2*(t-this.x)),this._sx=.5,this._fw=0},getCenterY:function(){return this.y+this.height/2},setCenterY:function(t){this._fh||.5===this._sy?this.y=t-this.height/2:(this._sy&&(this.y+=2*(t-this.y)*this._sy),this.height=2*(t-this.y)),this._sy=.5,this._fh=0},getCenter:function(t){return new(t?p:f)(this.getCenterX(),this.getCenterY(),this,"setCenter")},setCenter:function(){var t=p.read(arguments);return this.setCenterX(t.x),this.setCenterY(t.y),this},getArea:function(){return this.width*this.height},isEmpty:function(){return 0===this.width||0===this.height},contains:function(t){return t&&t.width!==e||4===(Array.isArray(t)?t:arguments).length?this._containsRectangle(v.read(arguments)):this._containsPoint(p.read(arguments))},_containsPoint:function(t){var e=t.x,n=t.y;return e>=this.x&&n>=this.y&&e<=this.x+this.width&&n<=this.y+this.height},_containsRectangle:function(t){var e=t.x,n=t.y;return e>=this.x&&n>=this.y&&e+t.width<=this.x+this.width&&n+t.height<=this.y+this.height},intersects:function(){var t=v.read(arguments),e=s.read(arguments)||0;return t.x+t.width>this.x-e&&t.y+t.height>this.y-e&&t.x<this.x+this.width+e&&t.y<this.y+this.height+e},intersect:function(){var t=v.read(arguments),e=Math.max(this.x,t.x),n=Math.max(this.y,t.y),i=Math.min(this.x+this.width,t.x+t.width),r=Math.min(this.y+this.height,t.y+t.height);return new v(e,n,i-e,r-n)},unite:function(){var t=v.read(arguments),e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),i=Math.max(this.x+this.width,t.x+t.width),r=Math.max(this.y+this.height,t.y+t.height);return new v(e,n,i-e,r-n)},include:function(){var t=p.read(arguments),e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),i=Math.max(this.x+this.width,t.x),r=Math.max(this.y+this.height,t.y);return new v(e,n,i-e,r-n)},expand:function(){var t=m.read(arguments),e=t.width,n=t.height;return new v(this.x-e/2,this.y-n/2,this.width+e,this.height+n)},scale:function(t,n){return this.expand(this.width*t-this.width,this.height*(n===e?t:n)-this.height)}},s.each([["Top","Left"],["Top","Right"],["Bottom","Left"],["Bottom","Right"],["Left","Center"],["Top","Center"],["Right","Center"],["Bottom","Center"]],(function(t,e){var n=t.join(""),i=/^[RL]/.test(n);e>=4&&(t[1]+=i?"Y":"X");var r=t[i?0:1],s=t[i?1:0],a="get"+r,o="get"+s,l="set"+r,h="set"+s,c="set"+n;this["get"+n]=function(t){return new(t?p:f)(this[a](),this[o](),this,c)},this[c]=function(){var t=p.read(arguments);this[l](t.x),this[h](t.y)}}),{beans:!0})),_=v.extend({initialize:function(t,e,n,i,r,s){this._set(t,e,n,i,!0),this._owner=r,this._setter=s},_set:function(t,e,n,i,r){return this._x=t,this._y=e,this._width=n,this._height=i,r||this._owner[this._setter](this),this}},new function(){var t=v.prototype;return s.each(["x","y","width","height"],(function(t){var e=s.capitalize(t),n="_"+t;this["get"+e]=function(){return this[n]},this["set"+e]=function(t){this[n]=t,this._dontNotify||this._owner[this._setter](this)}}),s.each(["Point","Size","Center","Left","Top","Right","Bottom","CenterX","CenterY","TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],(function(e){var n="set"+e;this[n]=function(){this._dontNotify=!0,t[n].apply(this,arguments),this._dontNotify=!1,this._owner[this._setter](this)}}),{isSelected:function(){return!!(2&this._owner._selection)},setSelected:function(t){var e=this._owner;e._changeSelection&&e._changeSelection(2,t)}}))}),x=s.extend({_class:"Matrix",initialize:function t(e,n){var i=arguments,r=i.length,s=!0;if(r>=6?this._set.apply(this,i):1===r||2===r?e instanceof t?this._set(e._a,e._b,e._c,e._d,e._tx,e._ty,n):Array.isArray(e)?this._set.apply(this,n?e.concat([n]):e):s=!1:r?s=!1:this.reset(),!s)throw new Error("Unsupported matrix parameters");return this},set:"#initialize",_set:function(t,e,n,i,r,s,a){return this._a=t,this._b=e,this._c=n,this._d=i,this._tx=r,this._ty=s,a||this._changed(),this},_serialize:function(t,e){return s.serialize(this.getValues(),t,!0,e)},_changed:function(){var t=this._owner;t&&(t._applyMatrix?t.transform(null,!0):t._changed(25))},clone:function(){return new x(this._a,this._b,this._c,this._d,this._tx,this._ty)},equals:function(t){return t===this||t&&this._a===t._a&&this._b===t._b&&this._c===t._c&&this._d===t._d&&this._tx===t._tx&&this._ty===t._ty},toString:function(){var t=c.instance;return"[["+[t.number(this._a),t.number(this._c),t.number(this._tx)].join(", ")+"], ["+[t.number(this._b),t.number(this._d),t.number(this._ty)].join(", ")+"]]"},reset:function(t){return this._a=this._d=1,this._b=this._c=this._tx=this._ty=0,t||this._changed(),this},apply:function(t,e){var n=this._owner;return!!n&&(n.transform(null,s.pick(t,!0),e),this.isIdentity())},translate:function(){var t=p.read(arguments),e=t.x,n=t.y;return this._tx+=e*this._a+n*this._c,this._ty+=e*this._b+n*this._d,this._changed(),this},scale:function(){var t=arguments,e=p.read(t),n=p.read(t,0,{readNull:!0});return n&&this.translate(n),this._a*=e.x,this._b*=e.x,this._c*=e.y,this._d*=e.y,n&&this.translate(n.negate()),this._changed(),this},rotate:function(t){t*=Math.PI/180;var e=p.read(arguments,1),n=e.x,i=e.y,r=Math.cos(t),s=Math.sin(t),a=n-n*r+i*s,o=i-n*s-i*r,l=this._a,h=this._b,c=this._c,u=this._d;return this._a=r*l+s*c,this._b=r*h+s*u,this._c=-s*l+r*c,this._d=-s*h+r*u,this._tx+=a*l+o*c,this._ty+=a*h+o*u,this._changed(),this},shear:function(){var t=arguments,e=p.read(t),n=p.read(t,0,{readNull:!0});n&&this.translate(n);var i=this._a,r=this._b;return this._a+=e.y*this._c,this._b+=e.y*this._d,this._c+=e.x*i,this._d+=e.x*r,n&&this.translate(n.negate()),this._changed(),this},skew:function(){var t=arguments,e=p.read(t),n=p.read(t,0,{readNull:!0}),i=Math.PI/180,r=new p(Math.tan(e.x*i),Math.tan(e.y*i));return this.shear(r,n)},append:function(t,e){if(t){var n=this._a,i=this._b,r=this._c,s=this._d,a=t._a,o=t._c,l=t._b,h=t._d,c=t._tx,u=t._ty;this._a=a*n+l*r,this._c=o*n+h*r,this._b=a*i+l*s,this._d=o*i+h*s,this._tx+=c*n+u*r,this._ty+=c*i+u*s,e||this._changed()}return this},prepend:function(t,e){if(t){var n=this._a,i=this._b,r=this._c,s=this._d,a=this._tx,o=this._ty,l=t._a,h=t._c,c=t._b,u=t._d,d=t._tx,p=t._ty;this._a=l*n+h*i,this._c=l*r+h*s,this._b=c*n+u*i,this._d=c*r+u*s,this._tx=l*a+h*o+d,this._ty=c*a+u*o+p,e||this._changed()}return this},appended:function(t){return this.clone().append(t)},prepended:function(t){return this.clone().prepend(t)},invert:function(){var t=this._a,e=this._b,n=this._c,i=this._d,r=this._tx,s=this._ty,a=t*i-e*n,o=null;return a&&!isNaN(a)&&isFinite(r)&&isFinite(s)&&(this._a=i/a,this._b=-e/a,this._c=-n/a,this._d=t/a,this._tx=(n*s-i*r)/a,this._ty=(e*r-t*s)/a,o=this),o},inverted:function(){return this.clone().invert()},concatenate:"#append",preConcatenate:"#prepend",chain:"#appended",_shiftless:function(){return new x(this._a,this._b,this._c,this._d,0,0)},_orNullIfIdentity:function(){return this.isIdentity()?null:this},isIdentity:function(){return 1===this._a&&0===this._b&&0===this._c&&1===this._d&&0===this._tx&&0===this._ty},isInvertible:function(){var t=this._a*this._d-this._c*this._b;return t&&!isNaN(t)&&isFinite(this._tx)&&isFinite(this._ty)},isSingular:function(){return!this.isInvertible()},transform:function(t,e,n){return arguments.length<3?this._transformPoint(p.read(arguments)):this._transformCoordinates(t,e,n)},_transformPoint:function(t,e,n){var i=t.x,r=t.y;return e||(e=new p),e._set(i*this._a+r*this._c+this._tx,i*this._b+r*this._d+this._ty,n)},_transformCoordinates:function(t,e,n){for(var i=0,r=2*n;i<r;i+=2){var s=t[i],a=t[i+1];e[i]=s*this._a+a*this._c+this._tx,e[i+1]=s*this._b+a*this._d+this._ty}return e},_transformCorners:function(t){var e=t.x,n=t.y,i=e+t.width,r=n+t.height,s=[e,n,i,n,i,r,e,r];return this._transformCoordinates(s,s,4)},_transformBounds:function(t,e,n){for(var i=this._transformCorners(t),r=i.slice(0,2),s=r.slice(),a=2;a<8;a++){var o=i[a],l=1&a;o<r[l]?r[l]=o:o>s[l]&&(s[l]=o)}return e||(e=new v),e._set(r[0],r[1],s[0]-r[0],s[1]-r[1],n)},inverseTransform:function(){return this._inverseTransform(p.read(arguments))},_inverseTransform:function(t,e,n){var i=this._a,r=this._b,s=this._c,a=this._d,o=this._tx,l=this._ty,h=i*a-r*s,c=null;if(h&&!isNaN(h)&&isFinite(o)&&isFinite(l)){var u=t.x-this._tx,d=t.y-this._ty;e||(e=new p),c=e._set((u*a-d*s)/h,(d*i-u*r)/h,n)}return c},decompose:function(){var t,e,n,i=this._a,r=this._b,s=this._c,a=this._d,o=i*a-r*s,l=Math.sqrt,h=Math.atan2,c=180/Math.PI;if(0!==i||0!==r){var u=l(i*i+r*r);t=Math.acos(i/u)*(r>0?1:-1),e=[u,o/u],n=[h(i*s+r*a,u*u),0]}else if(0!==s||0!==a){var d=l(s*s+a*a);t=Math.asin(s/d)*(a>0?1:-1),e=[o/d,d],n=[0,h(i*s+r*a,d*d)]}else t=0,n=e=[0,0];return{translation:this.getTranslation(),rotation:t*c,scaling:new p(e),skewing:new p(n[0]*c,n[1]*c)}},getValues:function(){return[this._a,this._b,this._c,this._d,this._tx,this._ty]},getTranslation:function(){return new p(this._tx,this._ty)},getScaling:function(){return this.decompose().scaling},getRotation:function(){return this.decompose().rotation},applyToContext:function(t){this.isIdentity()||t.transform(this._a,this._b,this._c,this._d,this._tx,this._ty)}},s.each(["a","b","c","d","tx","ty"],(function(t){var e=s.capitalize(t),n="_"+t;this["get"+e]=function(){return this[n]},this["set"+e]=function(t){this[n]=t,this._changed()}}),{})),y=s.extend({_class:"Line",initialize:function(t,e,n,i,r){var s=!1;arguments.length>=4?(this._px=t,this._py=e,this._vx=n,this._vy=i,s=r):(this._px=t.x,this._py=t.y,this._vx=e.x,this._vy=e.y,s=n),s||(this._vx-=this._px,this._vy-=this._py)},getPoint:function(){return new p(this._px,this._py)},getVector:function(){return new p(this._vx,this._vy)},getLength:function(){return this.getVector().getLength()},intersect:function(t,e){return y.intersect(this._px,this._py,this._vx,this._vy,t._px,t._py,t._vx,t._vy,!0,e)},getSide:function(t,e){return y.getSide(this._px,this._py,this._vx,this._vy,t.x,t.y,!0,e)},getDistance:function(t){return Math.abs(this.getSignedDistance(t))},getSignedDistance:function(t){return y.getSignedDistance(this._px,this._py,this._vx,this._vy,t.x,t.y,!0)},isCollinear:function(t){return p.isCollinear(this._vx,this._vy,t._vx,t._vy)},isOrthogonal:function(t){return p.isOrthogonal(this._vx,this._vy,t._vx,t._vy)},statics:{intersect:function(t,e,n,i,r,s,a,o,l,h){l||(n-=t,i-=e,a-=r,o-=s);var c=n*o-i*a;if(!u.isMachineZero(c)){var d=t-r,f=e-s,m=(a*f-o*d)/c,g=(n*f-i*d)/c,v=-1e-12,_=1+1e-12;if(h||v<m&&m<_&&v<g&&g<_)return h||(m=m<=0?0:m>=1?1:m),new p(t+m*n,e+m*i)}},getSide:function(t,e,n,i,r,s,a,o){a||(n-=t,i-=e);var l=r-t,h=l*i-(s-e)*n;return!o&&u.isMachineZero(h)&&(h=(l*n+l*n)/(n*n+i*i))>=0&&h<=1&&(h=0),h<0?-1:h>0?1:0},getSignedDistance:function(t,e,n,i,r,s,a){return a||(n-=t,i-=e),0===n?i>0?r-t:t-r:0===i?n<0?s-e:e-s:((r-t)*i-(s-e)*n)/(i>n?i*Math.sqrt(1+n*n/(i*i)):n*Math.sqrt(1+i*i/(n*n)))},getDistance:function(t,e,n,i,r,s,a){return Math.abs(y.getSignedDistance(t,e,n,i,r,s,a))}}}),S=l.extend({_class:"Project",_list:"projects",_reference:"project",_compactSerialize:!0,initialize:function(t){l.call(this,!0),this._children=[],this._namedChildren={},this._activeLayer=null,this._currentStyle=new H(null,null,this),this._view=j.create(this,t||rt.getCanvas(1,1)),this._selectionItems={},this._selectionCount=0,this._updateVersion=0},_serialize:function(t,e){return s.serialize(this._children,t,!0,e)},_changed:function(t,e){if(1&t){var n=this._view;n&&(n._needsUpdate=!0,!n._requested&&n._autoUpdate&&n.requestUpdate())}var i=this._changes;if(i&&e){var r=this._changesById,s=e._id,a=r[s];a?a.flags|=t:i.push(r[s]={item:e,flags:t})}},clear:function(){for(var t=this._children,e=t.length-1;e>=0;e--)t[e].remove()},isEmpty:function(){return!this._children.length},remove:function t(){return!!t.base.call(this)&&(this._view&&this._view.remove(),!0)},getView:function(){return this._view},getCurrentStyle:function(){return this._currentStyle},setCurrentStyle:function(t){this._currentStyle.set(t)},getIndex:function(){return this._index},getOptions:function(){return this._scope.settings},getLayers:function(){return this._children},getActiveLayer:function(){return this._activeLayer||new w({project:this,insert:!0})},getSymbolDefinitions:function(){var t=[],e={};return this.getItems({class:E,match:function(n){var i=n._definition,r=i._id;return e[r]||(e[r]=!0,t.push(i)),!1}}),t},getSymbols:"getSymbolDefinitions",getSelectedItems:function(){var t=this._selectionItems,e=[];for(var n in t){var i=t[n],r=i._selection;1&r&&i.isInserted()?e.push(i):r||this._updateSelection(i)}return e},_updateSelection:function(t){var e=t._id,n=this._selectionItems;t._selection?n[e]!==t&&(this._selectionCount++,n[e]=t):n[e]===t&&(this._selectionCount--,delete n[e])},selectAll:function(){for(var t=this._children,e=0,n=t.length;e<n;e++)t[e].setFullySelected(!0)},deselectAll:function(){var t=this._selectionItems;for(var e in t)t[e].setFullySelected(!1)},addLayer:function(t){return this.insertLayer(e,t)},insertLayer:function(t,e){if(e instanceof w){e._remove(!1,!0),s.splice(this._children,[e],t,0),e._setProject(this,!0);var n=e._name;n&&e.setName(n),this._changes&&e._changed(5),this._activeLayer||(this._activeLayer=e)}else e=null;return e},_insertItem:function(t,n,i){return n=this.insertLayer(t,n)||(this._activeLayer||this._insertItem(e,new w(b.NO_INSERT),!0)).insertChild(t,n),i&&n.activate&&n.activate(),n},getItems:function(t){return b._getItems(this,t)},getItem:function(t){return b._getItems(this,t,null,null,!0)[0]||null},importJSON:function(t){this.activate();var e=this._activeLayer;return s.importJSON(t,e&&e.isEmpty()&&e)},removeOn:function(t){var e=this._removeSets;if(e){"mouseup"===t&&(e.mousedrag=null);var n=e[t];if(n){for(var i in n){var r=n[i];for(var s in e){var a=e[s];a&&a!=n&&delete a[r._id]}r.remove()}e[t]=null}}},draw:function(t,e,n){this._updateVersion++,t.save(),e.applyToContext(t);for(var i=this._children,r=new s({offset:new p(0,0),pixelRatio:n,viewMatrix:e.isIdentity()?null:e,matrices:[new x],updateMatrix:!0}),a=0,o=i.length;a<o;a++)i[a].draw(t,r);if(t.restore(),this._selectionCount>0){t.save(),t.strokeWidth=1;var l=this._selectionItems,h=this._scope.settings.handleSize,c=this._updateVersion;for(var u in l)l[u]._drawSelection(t,e,h,l,c);t.restore()}}}),b=s.extend(a,{statics:{extend:function t(e){return e._serializeFields&&(e._serializeFields=s.set({},this.prototype._serializeFields,e._serializeFields)),t.base.apply(this,arguments)},INSERT:{insert:!0},NO_INSERT:{insert:!1}},_class:"Item",_name:null,_applyMatrix:!0,_canApplyMatrix:!0,_canScaleStroke:!1,_pivot:null,_visible:!0,_blendMode:"normal",_opacity:1,_locked:!1,_guide:!1,_clipMask:!1,_selection:0,_selectBounds:!0,_selectChildren:!1,_serializeFields:{name:null,applyMatrix:null,matrix:new x,pivot:null,visible:!0,blendMode:"normal",opacity:1,locked:!1,guide:!1,clipMask:!1,selected:!1,data:{}},_prioritize:["applyMatrix"]},new function(){var t=["onMouseDown","onMouseUp","onMouseDrag","onClick","onDoubleClick","onMouseMove","onMouseEnter","onMouseLeave"];return s.each(t,(function(t){this._events[t]={install:function(t){this.getView()._countItemEvent(t,1)},uninstall:function(t){this.getView()._countItemEvent(t,-1)}}}),{_events:{onFrame:{install:function(){this.getView()._animateItem(this,!0)},uninstall:function(){this.getView()._animateItem(this,!1)}},onLoad:{},onError:{}},statics:{_itemHandlers:t}})},{initialize:function(){},_initialize:function(t,n){var i=t&&s.isPlainObject(t),r=i&&!0===t.internal,a=this._matrix=new x,o=i&&t.project||lt.project,l=lt.settings;return this._id=r?null:d.get(),this._parent=this._index=null,this._applyMatrix=this._canApplyMatrix&&l.applyMatrix,n&&a.translate(n),a._owner=this,this._style=new H(o._currentStyle,this,o),r||i&&0==t.insert||!l.insertItems&&(!i||1!=t.insert)?this._setProject(o):(i&&t.parent||o)._insertItem(e,this,!0),i&&t!==b.NO_INSERT&&t!==b.INSERT&&this.set(t,{internal:!0,insert:!0,project:!0,parent:!0}),i},_serialize:function(t,e){var n={},i=this;function r(r){for(var a in r){var o=i[a];s.equals(o,"leading"===a?1.2*r.fontSize:r[a])||(n[a]=s.serialize(o,t,"data"!==a,e))}}return r(this._serializeFields),this instanceof M||r(this._style._defaults),[this._class,n]},_changed:function(t){var n=this._symbol,i=this._parent||n,r=this._project;8&t&&(this._bounds=this._position=this._decomposed=e),16&t&&(this._globalMatrix=e),i&&72&t&&b._clearBoundsCache(i),2&t&&b._clearBoundsCache(this),r&&r._changed(t,this),n&&n._changed(t)},getId:function(){return this._id},getName:function(){return this._name},setName:function(t){if(this._name&&this._removeNamed(),t===+t+"")throw new Error("Names consisting only of numbers are not supported.");var n=this._getOwner();if(t&&n){var i=n._children,r=n._namedChildren;(r[t]=r[t]||[]).push(this),t in i||(i[t]=this)}this._name=t||e,this._changed(256)},getStyle:function(){return this._style},setStyle:function(t){this.getStyle().set(t)}},s.each(["locked","visible","blendMode","opacity","guide"],(function(t){var e=s.capitalize(t),n="_"+t,i={locked:256,visible:265};this["get"+e]=function(){return this[n]},this["set"+e]=function(e){e!=this[n]&&(this[n]=e,this._changed(i[t]||257))}}),{}),{beans:!0,getSelection:function(){return this._selection},setSelection:function(t){if(t!==this._selection){this._selection=t;var e=this._project;e&&(e._updateSelection(this),this._changed(257))}},_changeSelection:function(t,e){var n=this._selection;this.setSelection(e?n|t:n&~t)},isSelected:function(){if(this._selectChildren)for(var t=this._children,e=0,n=t.length;e<n;e++)if(t[e].isSelected())return!0;return!!(1&this._selection)},setSelected:function(t){if(this._selectChildren)for(var e=this._children,n=0,i=e.length;n<i;n++)e[n].setSelected(t);this._changeSelection(1,t)},isFullySelected:function(){var t=this._children,e=!!(1&this._selection);if(t&&e){for(var n=0,i=t.length;n<i;n++)if(!t[n].isFullySelected())return!1;return!0}return e},setFullySelected:function(t){var e=this._children;if(e)for(var n=0,i=e.length;n<i;n++)e[n].setFullySelected(t);this._changeSelection(1,t)},isClipMask:function(){return this._clipMask},setClipMask:function(t){this._clipMask!=(t=!!t)&&(this._clipMask=t,t&&(this.setFillColor(null),this.setStrokeColor(null)),this._changed(257),this._parent&&this._parent._changed(2048))},getData:function(){return this._data||(this._data={}),this._data},setData:function(t){this._data=t},getPosition:function(t){var e=t?p:f,n=this._position||(this._position=this._getPositionFromBounds());return new e(n.x,n.y,this,"setPosition")},setPosition:function(){this.translate(p.read(arguments).subtract(this.getPosition(!0)))},_getPositionFromBounds:function(t){return this._pivot?this._matrix._transformPoint(this._pivot):(t||this.getBounds()).getCenter(!0)},getPivot:function(){var t=this._pivot;return t?new f(t.x,t.y,this,"setPivot"):null},setPivot:function(){this._pivot=p.read(arguments,0,{clone:!0,readNull:!0}),this._position=e}},s.each({getStrokeBounds:{stroke:!0},getHandleBounds:{handle:!0},getInternalBounds:{internal:!0}},(function(t,e){this[e]=function(e){return this.getBounds(e,t)}}),{beans:!0,getBounds:function(t,e){var n=e||t instanceof x,i=s.set({},n?e:t,this._boundsOptions);i.stroke&&!this.getStrokeScaling()||(i.cacheItem=this);var r=this._getCachedBounds(n&&t,i).rect;return arguments.length?r:new _(r.x,r.y,r.width,r.height,this,"setBounds")},setBounds:function(){var t=v.read(arguments),e=this.getBounds(),n=this._matrix,i=new x,r=t.getCenter();i.translate(r),t.width==e.width&&t.height==e.height||(n.isInvertible()||(n.set(n._backup||(new x).translate(n.getTranslation())),e=this.getBounds()),i.scale(0!==e.width?t.width/e.width:0,0!==e.height?t.height/e.height:0)),r=e.getCenter(),i.translate(-r.x,-r.y),this.transform(i)},_getBounds:function(t,e){var n=this._children;return n&&n.length?(b._updateBoundsCache(this,e.cacheItem),b._getBounds(n,t,e)):new v},_getBoundsCacheKey:function(t,e){return[t.stroke?1:0,t.handle?1:0,e?1:0].join("")},_getCachedBounds:function(t,e,n){t=t&&t._orNullIfIdentity();var i=e.internal&&!n,r=e.cacheItem,s=i?null:this._matrix._orNullIfIdentity(),a=r&&(!t||t.equals(s))&&this._getBoundsCacheKey(e,i),o=this._bounds;if(b._updateBoundsCache(this._parent||this._symbol,r),a&&o&&a in o)return{rect:(d=o[a]).rect.clone(),nonscaling:d.nonscaling};var l=this._getBounds(t||s,e),h=l.rect||l,c=this._style,u=l.nonscaling||c.hasStroke()&&!c.getStrokeScaling();if(a){o||(this._bounds=o={});var d=o[a]={rect:h.clone(),nonscaling:u,internal:i}}return{rect:h,nonscaling:u}},_getStrokeMatrix:function(t,e){var n=this.getStrokeScaling()?null:e&&e.internal?this:this._parent||this._symbol&&this._symbol._item,i=n?n.getViewMatrix().invert():t;return i&&i._shiftless()},statics:{_updateBoundsCache:function(t,e){if(t&&e){var n=e._id,i=t._boundsCache=t._boundsCache||{ids:{},list:[]};i.ids[n]||(i.list.push(e),i.ids[n]=e)}},_clearBoundsCache:function(t){var n=t._boundsCache;if(n){t._bounds=t._position=t._boundsCache=e;for(var i=0,r=n.list,s=r.length;i<s;i++){var a=r[i];a!==t&&(a._bounds=a._position=e,a._boundsCache&&b._clearBoundsCache(a))}}},_getBounds:function(t,e,n){var i=1/0,r=-i,s=i,a=r,o=!1;n=n||{};for(var l=0,h=t.length;l<h;l++){var c=t[l];if(c._visible&&!c.isEmpty(!0)){var u=c._getCachedBounds(e&&e.appended(c._matrix),n,!0),d=u.rect;i=Math.min(d.x,i),s=Math.min(d.y,s),r=Math.max(d.x+d.width,r),a=Math.max(d.y+d.height,a),u.nonscaling&&(o=!0)}}return{rect:isFinite(i)?new v(i,s,r-i,a-s):new v,nonscaling:o}}}}),{beans:!0,_decompose:function(){return this._applyMatrix?null:this._decomposed||(this._decomposed=this._matrix.decompose())},getRotation:function(){var t=this._decompose();return t?t.rotation:0},setRotation:function(t){var e=this.getRotation();if(null!=e&&null!=t){var n=this._decomposed;this.rotate(t-e),n&&(n.rotation=t,this._decomposed=n)}},getScaling:function(){var t=this._decompose(),e=t&&t.scaling;return new f(e?e.x:1,e?e.y:1,this,"setScaling")},setScaling:function(){var t=this.getScaling(),e=p.read(arguments,0,{clone:!0,readNull:!0});if(t&&e&&!t.equals(e)){var n=this.getRotation(),i=this._decomposed,r=new x,s=u.isZero;if(s(t.x)||s(t.y))r.translate(i.translation),n&&r.rotate(n),r.scale(e.x,e.y),this._matrix.set(r);else{var a=this.getPosition(!0);r.translate(a),n&&r.rotate(n),r.scale(e.x/t.x,e.y/t.y),n&&r.rotate(-n),r.translate(a.negate()),this.transform(r)}i&&(i.scaling=e,this._decomposed=i)}},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},getGlobalMatrix:function(t){var e=this._globalMatrix;if(e)for(var n=this._parent,i=[];n;){if(!n._globalMatrix){e=null;for(var r=0,s=i.length;r<s;r++)i[r]._globalMatrix=null;break}i.push(n),n=n._parent}return e||(e=this._globalMatrix=this._matrix.clone(),(n=this._parent)&&e.prepend(n.getGlobalMatrix(!0))),t?e:e.clone()},getViewMatrix:function(){return this.getGlobalMatrix().prepend(this.getView()._matrix)},getApplyMatrix:function(){return this._applyMatrix},setApplyMatrix:function(t){(this._applyMatrix=this._canApplyMatrix&&!!t)&&this.transform(null,!0)},getTransformContent:"#getApplyMatrix",setTransformContent:"#setApplyMatrix"},{getProject:function(){return this._project},_setProject:function(t,e){if(this._project!==t){this._project&&this._installEvents(!1),this._project=t;for(var n=this._children,i=0,r=n&&n.length;i<r;i++)n[i]._setProject(t);e=!0}e&&this._installEvents(!0)},getView:function(){return this._project._view},_installEvents:function t(e){t.base.call(this,e);for(var n=this._children,i=0,r=n&&n.length;i<r;i++)n[i]._installEvents(e)},getLayer:function(){for(var t=this;t=t._parent;)if(t instanceof w)return t;return null},getParent:function(){return this._parent},setParent:function(t){return t.addChild(this)},_getOwner:"#getParent",getChildren:function(){return this._children},setChildren:function(t){this.removeChildren(),this.addChildren(t)},getFirstChild:function(){return this._children&&this._children[0]||null},getLastChild:function(){return this._children&&this._children[this._children.length-1]||null},getNextSibling:function(){var t=this._getOwner();return t&&t._children[this._index+1]||null},getPreviousSibling:function(){var t=this._getOwner();return t&&t._children[this._index-1]||null},getIndex:function(){return this._index},equals:function(t){return t===this||t&&this._class===t._class&&this._style.equals(t._style)&&this._matrix.equals(t._matrix)&&this._locked===t._locked&&this._visible===t._visible&&this._blendMode===t._blendMode&&this._opacity===t._opacity&&this._clipMask===t._clipMask&&this._guide===t._guide&&this._equals(t)||!1},_equals:function(t){return s.equals(this._children,t._children)},clone:function(t){var n=new this.constructor(b.NO_INSERT),i=this._children,r=s.pick(t?t.insert:e,t===e||!0===t),a=s.pick(t?t.deep:e,!0);i&&n.copyAttributes(this),i&&!a||n.copyContent(this),i||n.copyAttributes(this),r&&n.insertAbove(this);var o=this._name,l=this._parent;if(o&&l){i=l._children;for(var h=o,c=1;i[o];)o=h+" "+c++;o!==h&&n.setName(o)}return n},copyContent:function(t){for(var e=t._children,n=0,i=e&&e.length;n<i;n++)this.addChild(e[n].clone(!1),!0)},copyAttributes:function(t,e){this.setStyle(t._style);for(var n=["_locked","_visible","_blendMode","_opacity","_clipMask","_guide"],i=0,r=n.length;i<r;i++){var a=n[i];t.hasOwnProperty(a)&&(this[a]=t[a])}e||this._matrix.set(t._matrix,!0),this.setApplyMatrix(t._applyMatrix),this.setPivot(t._pivot),this.setSelection(t._selection);var o=t._data,l=t._name;this._data=o?s.clone(o):null,l&&this.setName(l)},rasterize:function(t,n){var i,r,a;s.isPlainObject(t)?(i=t.resolution,r=t.insert,a=t.raster):(i=t,r=n),a||(a=new T(b.NO_INSERT));var o=this.getStrokeBounds(),l=(i||this.getView().getResolution())/72,h=o.getTopLeft().floor(),c=o.getBottomRight().ceil(),u=new m(c.subtract(h)),d=u.multiply(l);if(a.setSize(d,!0),!d.isZero()){var p=a.getContext(!0),f=(new x).scale(l).translate(h.negate());p.save(),f.applyToContext(p),this.draw(p,new s({matrices:[f]})),p.restore()}return a._matrix.set((new x).translate(h.add(u.divide(2))).scale(1/l)),(r===e||r)&&a.insertAbove(this),a},contains:function(){var t=this._matrix;return t.isInvertible()&&!!this._contains(t._inverseTransform(p.read(arguments)))},_contains:function(t){var e=this._children;if(e){for(var n=e.length-1;n>=0;n--)if(e[n].contains(t))return!0;return!1}return t.isInside(this.getInternalBounds())},isInside:function(){return v.read(arguments).contains(this.getBounds())},_asPathItem:function(){return new N.Rectangle({rectangle:this.getInternalBounds(),matrix:this._matrix,insert:!1})},intersects:function(t,e){return t instanceof b&&this._asPathItem().getIntersections(t._asPathItem(),null,e,!0).length>0}},new function(){function t(){var t=arguments;return this._hitTest(p.read(t),P.getOptions(t))}function e(){var t=arguments,e=p.read(t),n=P.getOptions(t),i=[];return this._hitTest(e,new s({all:i},n)),i}function n(t,e,n,i){var r=this._children;if(r)for(var s=r.length-1;s>=0;s--){var a=r[s],o=a!==i&&a._hitTest(t,e,n);if(o&&!e.all)return o}return null}return S.inject({hitTest:t,hitTestAll:e,_hitTest:n}),{hitTest:t,hitTestAll:e,_hitTestChildren:n}},{_hitTest:function(t,e,n){if(this._locked||!this._visible||this._guide&&!e.guides||this.isEmpty())return null;var i=this._matrix,r=n?n.appended(i):this.getGlobalMatrix().prepend(this.getView()._matrix),a=Math.max(e.tolerance,1e-12),o=e._tolerancePadding=new m(N._getStrokePadding(a,i._shiftless().invert()));if(!(t=i._inverseTransform(t))||!this._children&&!this.getBounds({internal:!0,stroke:!0,handle:!0}).expand(o.multiply(2))._containsPoint(t))return null;var l,h,c=!(e.guides&&!this._guide||e.selected&&!this.isSelected()||e.type&&e.type!==s.hyphenate(this._class)||e.class&&!(this instanceof e.class)),u=e.match,d=this;function p(t){return t&&u&&!u(t)&&(t=null),t&&e.all&&e.all.push(t),t}function f(e,n){var i=n?l["get"+n]():d.getPosition();if(t.subtract(i).divide(o).length<=1)return new P(e,d,{name:n?s.hyphenate(n):e,point:i})}var g=e.position,v=e.center,_=e.bounds;if(c&&this._parent&&(g||v||_)){if((v||_)&&(l=this.getInternalBounds()),!(h=g&&f("position")||v&&f("center","Center"))&&_)for(var x=["TopLeft","TopRight","BottomLeft","BottomRight","LeftCenter","TopCenter","RightCenter","BottomCenter"],y=0;y<8&&!h;y++)h=f("bounds",x[y]);h=p(h)}return h||(h=this._hitTestChildren(t,e,r)||c&&p(this._hitTestSelf(t,e,r,this.getStrokeScaling()?null:r._shiftless().invert()))||null),h&&h.point&&(h.point=i.transform(h.point)),h},_hitTestSelf:function(t,e){if(e.fill&&this.hasFill()&&this._contains(t))return new P("fill",this)},matches:function(t,e){var n=typeof t;if("object"===n){for(var i in t)if(t.hasOwnProperty(i)&&!this.matches(i,t[i]))return!1;return!0}if("function"===n)return t(this);if("match"===t)return e(this);var r=/^(empty|editable)$/.test(t)?this["is"+s.capitalize(t)]():"type"===t?s.hyphenate(this._class):this[t];if("class"===t){if("function"==typeof e)return this instanceof e;r=this._class}if("function"==typeof e)return!!e(r);if(e){if(e.test)return e.test(r);if(s.isPlainObject(e))return function t(e,n){for(var i in e)if(e.hasOwnProperty(i)){var r=e[i],a=n[i];if(s.isPlainObject(r)&&s.isPlainObject(a)){if(!t(r,a))return!1}else if(!s.equals(r,a))return!1}return!0}(e,r)}return s.equals(r,e)},getItems:function(t){return b._getItems(this,t,this._matrix)},getItem:function(t){return b._getItems(this,t,this._matrix,null,!0)[0]||null},statics:{_getItems:function t(e,n,i,r,a){if(!r){var o="object"==typeof n&&n,l=o&&o.overlapping,h=o&&o.inside,c=(y=l||h)&&v.read([y]);r={items:[],recursive:o&&!1!==o.recursive,inside:!!h,overlapping:!!l,rect:c,path:l&&new N.Rectangle({rectangle:c,insert:!1})},o&&(n=s.filter({},n,{recursive:!0,inside:!0,overlapping:!0}))}var u=e._children,d=r.items;i=(c=r.rect)&&(i||new x);for(var p=0,f=u&&u.length;p<f;p++){var m=u[p],g=i&&i.appended(m._matrix),_=!0;if(c){var y=m.getBounds(g);if(!c.intersects(y))continue;c.contains(y)||r.overlapping&&(y.contains(c)||r.path.intersects(m,g))||(_=!1)}if(_&&m.matches(n)&&(d.push(m),a))break;if(!1!==r.recursive&&t(m,n,g,r,a),a&&d.length>0)break}return d}}},{importJSON:function(t){var e=s.importJSON(t,this);return e!==this?this.addChild(e):e},addChild:function(t){return this.insertChild(e,t)},insertChild:function(t,e){var n=e?this.insertChildren(t,[e]):null;return n&&n[0]},addChildren:function(t){return this.insertChildren(this._children.length,t)},insertChildren:function(t,e){var n=this._children;if(n&&e&&e.length>0){for(var i={},r=(e=s.slice(e)).length-1;r>=0;r--){var a=(c=e[r])&&c._id;!c||i[a]?e.splice(r,1):(c._remove(!1,!0),i[a]=!0)}s.splice(n,e,t,0);for(var o=this._project,l=o._changes,h=(r=0,e.length);r<h;r++){var c,u=(c=e[r])._name;c._parent=this,c._setProject(o,!0),u&&c.setName(u),l&&c._changed(5)}this._changed(11)}else e=null;return e},_insertItem:"#insertChild",_insertAt:function(t,e){var n=t&&t._getOwner(),i=t!==this&&n?this:null;return i&&(i._remove(!1,!0),n._insertItem(t._index+e,i)),i},insertAbove:function(t){return this._insertAt(t,1)},insertBelow:function(t){return this._insertAt(t,0)},sendToBack:function(){var t=this._getOwner();return t?t._insertItem(0,this):null},bringToFront:function(){var t=this._getOwner();return t?t._insertItem(e,this):null},appendTop:"#addChild",appendBottom:function(t){return this.insertChild(0,t)},moveAbove:"#insertAbove",moveBelow:"#insertBelow",addTo:function(t){return t._insertItem(e,this)},copyTo:function(t){return this.clone(!1).addTo(t)},reduce:function(t){var e=this._children;if(e&&1===e.length){var n=e[0].reduce(t);return this._parent?(n.insertAbove(this),this.remove()):n.remove(),n}return this},_removeNamed:function(){var t=this._getOwner();if(t){var e=t._children,n=t._namedChildren,i=this._name,r=n[i],s=r?r.indexOf(this):-1;-1!==s&&(e[i]==this&&delete e[i],r.splice(s,1),r.length?e[i]=r[0]:delete n[i])}},_remove:function(t,e){var n=this._getOwner(),i=this._project,r=this._index;return this._style&&this._style._dispose(),!!n&&(this._name&&this._removeNamed(),null!=r&&(i._activeLayer===this&&(i._activeLayer=this.getNextSibling()||this.getPreviousSibling()),s.splice(n._children,null,r,1)),this._installEvents(!1),t&&i._changes&&this._changed(5),e&&n._changed(11,this),this._parent=null,!0)},remove:function(){return this._remove(!0,!0)},replaceWith:function(t){var e=t&&t.insertBelow(this);return e&&this.remove(),e},removeChildren:function(t,e){if(!this._children)return null;t=t||0,e=s.pick(e,this._children.length);for(var n=s.splice(this._children,null,t,e-t),i=n.length-1;i>=0;i--)n[i]._remove(!0,!1);return n.length>0&&this._changed(11),n},clear:"#removeChildren",reverseChildren:function(){if(this._children){this._children.reverse();for(var t=0,e=this._children.length;t<e;t++)this._children[t]._index=t;this._changed(11)}},isEmpty:function(t){var e=this._children,n=e?e.length:0;if(t){for(var i=0;i<n;i++)if(!e[i].isEmpty(t))return!1;return!0}return!n},isEditable:function(){for(var t=this;t;){if(!t._visible||t._locked)return!1;t=t._parent}return!0},hasFill:function(){return this.getStyle().hasFill()},hasStroke:function(){return this.getStyle().hasStroke()},hasShadow:function(){return this.getStyle().hasShadow()},_getOrder:function(t){function e(t){var e=[];do{e.unshift(t)}while(t=t._parent);return e}for(var n=e(this),i=e(t),r=0,s=Math.min(n.length,i.length);r<s;r++)if(n[r]!=i[r])return n[r]._index<i[r]._index?1:-1;return 0},hasChildren:function(){return this._children&&this._children.length>0},isInserted:function(){return!!this._parent&&this._parent.isInserted()},isAbove:function(t){return-1===this._getOrder(t)},isBelow:function(t){return 1===this._getOrder(t)},isParent:function(t){return this._parent===t},isChild:function(t){return t&&t._parent===this},isDescendant:function(t){for(var e=this;e=e._parent;)if(e===t)return!0;return!1},isAncestor:function(t){return!!t&&t.isDescendant(this)},isSibling:function(t){return this._parent===t._parent},isGroupedWith:function(t){for(var e=this._parent;e;){if(e._parent&&/^(Group|Layer|CompoundPath)$/.test(e._class)&&t.isDescendant(e))return!0;e=e._parent}return!1}},s.each(["rotate","scale","shear","skew"],(function(t){var e="rotate"===t;this[t]=function(){var n=arguments,i=(e?s:p).read(n),r=p.read(n,0,{readNull:!0});return this.transform((new x)[t](i,r||this.getPosition(!0)))}}),{translate:function(){var t=new x;return this.transform(t.translate.apply(t,arguments))},transform:function(t,e,n){var i=this._matrix,r=t&&!t.isIdentity(),s=n&&this._canApplyMatrix||this._applyMatrix&&(r||!i.isIdentity()||e&&this._children);if(!r&&!s)return this;if(r){!t.isInvertible()&&i.isInvertible()&&(i._backup=i.getValues()),i.prepend(t,!0);var a=this._style,o=a.getFillColor(!0),l=a.getStrokeColor(!0);o&&o.transform(t),l&&l.transform(t)}if(s&&(s=this._transformContent(i,e,n))){var h=this._pivot;h&&i._transformPoint(h,h,!0),i.reset(!0),n&&this._canApplyMatrix&&(this._applyMatrix=!0)}var c=this._bounds,u=this._position;(r||s)&&this._changed(25);var d=r&&c&&t.decompose();if(d&&d.skewing.isZero()&&d.rotation%90==0){for(var p in c){var f=c[p];if(f.nonscaling)delete c[p];else if(s||!f.internal){var m=f.rect;t._transformBounds(m,m)}}this._bounds=c;var g=c[this._getBoundsCacheKey(this._boundsOptions||{})];g&&(this._position=this._getPositionFromBounds(g.rect))}else r&&u&&this._pivot&&(this._position=t._transformPoint(u,u));return this},_transformContent:function(t,e,n){var i=this._children;if(i){for(var r=0,s=i.length;r<s;r++)i[r].transform(t,e,n);return!0}},globalToLocal:function(){return this.getGlobalMatrix(!0)._inverseTransform(p.read(arguments))},localToGlobal:function(){return this.getGlobalMatrix(!0)._transformPoint(p.read(arguments))},parentToLocal:function(){return this._matrix._inverseTransform(p.read(arguments))},localToParent:function(){return this._matrix._transformPoint(p.read(arguments))},fitBounds:function(t,e){t=v.read(arguments);var n=this.getBounds(),i=n.height/n.width,r=t.height/t.width,s=(e?i>r:i<r)?t.width/n.width:t.height/n.height,a=new v(new p,new m(n.width*s,n.height*s));a.setCenter(t.getCenter()),this.setBounds(a)}}),{_setStyles:function(t,e,n){var i=this._style,r=this._matrix;if(i.hasFill()&&(t.fillStyle=i.getFillColor().toCanvasStyle(t,r)),i.hasStroke()){t.strokeStyle=i.getStrokeColor().toCanvasStyle(t,r),t.lineWidth=i.getStrokeWidth();var s=i.getStrokeJoin(),a=i.getStrokeCap(),o=i.getMiterLimit();if(s&&(t.lineJoin=s),a&&(t.lineCap=a),o&&(t.miterLimit=o),lt.support.nativeDash){var l=i.getDashArray(),h=i.getDashOffset();l&&l.length&&("setLineDash"in t?(t.setLineDash(l),t.lineDashOffset=h):(t.mozDash=l,t.mozDashOffset=h))}}if(i.hasShadow()){var c=e.pixelRatio||1,u=n._shiftless().prepend((new x).scale(c,c)),d=u.transform(new p(i.getShadowBlur(),0)),f=u.transform(this.getShadowOffset());t.shadowColor=i.getShadowColor().toCanvasStyle(t),t.shadowBlur=d.getLength(),t.shadowOffsetX=f.x,t.shadowOffsetY=f.y}},draw:function(t,e,n){if(this._updateVersion=this._project._updateVersion,this._visible&&0!==this._opacity){var i=e.matrices,r=e.viewMatrix,s=this._matrix,a=i[i.length-1].appended(s);if(a.isInvertible()){r=r?r.appended(a):a,i.push(a),e.updateMatrix&&(this._globalMatrix=a);var o,l,h,c=this._blendMode,d=u.clamp(this._opacity,0,1),p="normal"===c,f=st.nativeModes[c],m=p&&1===d||e.dontStart||e.clip||(f||p&&d<1)&&this._canComposite(),g=e.pixelRatio||1;if(!m){var v=this.getStrokeBounds(r);if(!v.width||!v.height)return void i.pop();h=e.offset,l=e.offset=v.getTopLeft().floor(),o=t,t=rt.getContext(v.getSize().ceil().add(1).multiply(g)),1!==g&&t.scale(g,g)}t.save();var _=n?n.appended(s):this._canScaleStroke&&!this.getStrokeScaling(!0)&&r,x=!m&&e.clipItem,y=!_||x;if(m?(t.globalAlpha=d,f&&(t.globalCompositeOperation=c)):y&&t.translate(-l.x,-l.y),y&&(m?s:r).applyToContext(t),x&&e.clipItem.draw(t,e.extend({clip:!0})),_){t.setTransform(g,0,0,g,0,0);var S=e.offset;S&&t.translate(-S.x,-S.y)}this._draw(t,e,r,_),t.restore(),i.pop(),e.clip&&!e.dontFinish&&t.clip(this.getFillRule()),m||(st.process(c,t,o,d,l.subtract(h).multiply(g)),rt.release(t),e.offset=h)}}},_isUpdated:function(t){var e=this._parent;if(e instanceof O)return e._isUpdated(t);var n=this._updateVersion===t;return!n&&e&&e._visible&&e._isUpdated(t)&&(this._updateVersion=t,n=!0),n},_drawSelection:function(t,e,n,i,r){var s=this._selection,a=1&s,o=2&s||a&&this._selectBounds,l=4&s;if(this._drawSelected||(a=!1),(a||o||l)&&this._isUpdated(r)){var h,c=this.getSelectedColor(!0)||(h=this.getLayer())&&h.getSelectedColor(!0),u=e.appended(this.getGlobalMatrix(!0)),d=n/2;if(t.strokeStyle=t.fillStyle=c?c.toCanvasStyle(t):"#009dec",a&&this._drawSelected(t,u,i),l){var p=this.getPosition(!0),f=this._parent,m=f?f.localToGlobal(p):p,g=m.x,v=m.y;t.beginPath(),t.arc(g,v,d,0,2*Math.PI,!0),t.stroke();for(var _=[[0,-1],[1,0],[0,1],[-1,0]],x=d,y=n+1,S=0;S<4;S++){var b=_[S],M=b[0],w=b[1];t.moveTo(g+M*x,v+w*x),t.lineTo(g+M*y,v+w*y),t.stroke()}}if(o){var C=u._transformCorners(this.getInternalBounds());for(t.beginPath(),S=0;S<8;S++)t[S?"lineTo":"moveTo"](C[S],C[++S]);for(t.closePath(),t.stroke(),S=0;S<8;S++)t.fillRect(C[S]-d,C[++S]-d,n,n)}}},_canComposite:function(){return!1}},s.each(["down","drag","up","move"],(function(t){this["removeOn"+s.capitalize(t)]=function(){var e={};return e[t]=!0,this.removeOn(e)}}),{removeOn:function(t){for(var e in t)if(t[e]){var n="mouse"+e,i=this._project,r=i._removeSets=i._removeSets||{};r[n]=r[n]||{},r[n][this._id]=this}return this}}),{tween:function(t,e,n){n||(n=e,e=t,t=null,n||(n=e,e=null));var i=n&&n.easing,r=n&&n.start,s=null!=n&&("number"==typeof n?n:n.duration),a=new nt(this,t,e,s,i,r);return s&&this.on("frame",(function t(e){a._handleFrame(1e3*e.time),a.running||this.off("frame",t)})),a},tweenTo:function(t,e){return this.tween(null,t,e)},tweenFrom:function(t,e){return this.tween(t,null,e)}}),M=b.extend({_class:"Group",_selectBounds:!1,_selectChildren:!0,_serializeFields:{children:[]},initialize:function(t){this._children=[],this._namedChildren={},this._initialize(t)||this.addChildren(Array.isArray(t)?t:arguments)},_changed:function t(n){t.base.call(this,n),2050&n&&(this._clipItem=e)},_getClipItem:function(){var t=this._clipItem;if(t===e){t=null;for(var n=this._children,i=0,r=n.length;i<r;i++)if(n[i]._clipMask){t=n[i];break}this._clipItem=t}return t},isClipped:function(){return!!this._getClipItem()},setClipped:function(t){var e=this.getFirstChild();e&&e.setClipMask(t)},_getBounds:function t(e,n){var i=this._getClipItem();return i?i._getCachedBounds(i._matrix.prepended(e),s.set({},n,{stroke:!1})):t.base.call(this,e,n)},_hitTestChildren:function t(e,n,i){var r=this._getClipItem();return(!r||r.contains(e))&&t.base.call(this,e,n,i,r)},_draw:function(t,e){var n=e.clip,i=!n&&this._getClipItem();e=e.extend({clipItem:i,clip:!1}),n?(t.beginPath(),e.dontStart=e.dontFinish=!0):i&&i.draw(t,e.extend({clip:!0}));for(var r=this._children,s=0,a=r.length;s<a;s++){var o=r[s];o!==i&&o.draw(t,e)}}}),w=M.extend({_class:"Layer",initialize:function(){M.apply(this,arguments)},_getOwner:function(){return this._parent||null!=this._index&&this._project},isInserted:function t(){return this._parent?t.base.call(this):null!=this._index},activate:function(){this._project._activeLayer=this},_hitTestSelf:function(){}}),C=b.extend({_class:"Shape",_applyMatrix:!1,_canApplyMatrix:!1,_canScaleStroke:!0,_serializeFields:{type:null,size:null,radius:null},initialize:function(t,e){this._initialize(t,e)},_equals:function(t){return this._type===t._type&&this._size.equals(t._size)&&s.equals(this._radius,t._radius)},copyContent:function(t){this.setType(t._type),this.setSize(t._size),this.setRadius(t._radius)},getType:function(){return this._type},setType:function(t){this._type=t},getShape:"#getType",setShape:"#setType",getSize:function(){var t=this._size;return new g(t.width,t.height,this,"setSize")},setSize:function(){var t=m.read(arguments);if(this._size){if(!this._size.equals(t)){var e=this._type,n=t.width,i=t.height;"rectangle"===e?this._radius.set(m.min(this._radius,t.divide(2).abs())):"circle"===e?(n=i=(n+i)/2,this._radius=n/2):"ellipse"===e&&this._radius._set(n/2,i/2),this._size._set(n,i),this._changed(9)}}else this._size=t.clone()},getRadius:function(){var t=this._radius;return"circle"===this._type?t:new g(t.width,t.height,this,"setRadius")},setRadius:function(t){var e=this._type;if("circle"===e){if(t===this._radius)return;var n=2*t;this._radius=t,this._size._set(n,n)}else if(t=m.read(arguments),this._radius){if(this._radius.equals(t))return;this._radius.set(t),"rectangle"===e?(n=m.max(this._size,t.multiply(2)),this._size.set(n)):"ellipse"===e&&this._size._set(2*t.width,2*t.height)}else this._radius=t.clone();this._changed(9)},isEmpty:function(){return!1},toPath:function(t){var n=new(N[s.capitalize(this._type)])({center:new p,size:this._size,radius:this._radius,insert:!1});return n.copyAttributes(this),lt.settings.applyMatrix&&n.setApplyMatrix(!0),(t===e||t)&&n.insertAbove(this),n},toShape:"#clone",_asPathItem:function(){return this.toPath(!1)},_draw:function(t,e,n,i){var r=this._style,s=r.hasFill(),a=r.hasStroke(),o=e.dontFinish||e.clip,l=!i;if(s||a||o){var h=this._type,c=this._radius,u="circle"===h;if(e.dontStart||t.beginPath(),l&&u)t.arc(0,0,c,0,2*Math.PI,!0);else{var d=u?c:c.width,p=u?c:c.height,f=this._size,m=f.width,g=f.height;if(l&&"rectangle"===h&&0===d&&0===p)t.rect(-m/2,-g/2,m,g);else{var v=m/2,_=g/2,x=.44771525016920644,y=d*x,S=p*x,b=[-v,-_+p,-v,-_+S,-v+y,-_,-v+d,-_,v-d,-_,v-y,-_,v,-_+S,v,-_+p,v,_-p,v,_-S,v-y,_,v-d,_,-v+d,_,-v+y,_,-v,_-S,-v,_-p];i&&i.transform(b,b,32),t.moveTo(b[0],b[1]),t.bezierCurveTo(b[2],b[3],b[4],b[5],b[6],b[7]),v!==d&&t.lineTo(b[8],b[9]),t.bezierCurveTo(b[10],b[11],b[12],b[13],b[14],b[15]),_!==p&&t.lineTo(b[16],b[17]),t.bezierCurveTo(b[18],b[19],b[20],b[21],b[22],b[23]),v!==d&&t.lineTo(b[24],b[25]),t.bezierCurveTo(b[26],b[27],b[28],b[29],b[30],b[31])}}t.closePath()}o||!s&&!a||(this._setStyles(t,e,n),s&&(t.fill(r.getFillRule()),t.shadowColor="rgba(0,0,0,0)"),a&&t.stroke())},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_getBounds:function(t,e){var n=new v(this._size).setCenter(0,0),i=this._style,r=e.stroke&&i.hasStroke()&&i.getStrokeWidth();return t&&(n=t._transformBounds(n)),r?n.expand(N._getStrokePadding(r,this._getStrokeMatrix(t,e))):n}},new function(){function t(t,e,n){var i=t._radius;if(!i.isZero())for(var r=t._size.divide(2),s=1;s<=4;s++){var a=new p(s>1&&s<4?-1:1,s>2?-1:1),o=a.multiply(r),l=o.subtract(a.multiply(i));if(new v(n?o.add(a.multiply(n)):o,l).contains(e))return{point:l,quadrant:s}}}function e(t,e,n,i){var r=t.divide(e);return(!i||r.isInQuadrant(i))&&r.subtract(r.normalize()).multiply(e).divide(n).length<=1}return{_contains:function e(n){if("rectangle"===this._type){var i=t(this,n);return i?n.subtract(i.point).divide(this._radius).getLength()<=1:e.base.call(this,n)}return n.divide(this.size).getLength()<=.5},_hitTestSelf:function n(i,r,s,a){var o=!1,l=this._style,h=r.stroke&&l.hasStroke(),c=r.fill&&l.hasFill();if(h||c){var u=this._type,d=this._radius,p=h?l.getStrokeWidth()/2:0,f=r._tolerancePadding.add(N._getStrokePadding(p,!l.getStrokeScaling()&&a));if("rectangle"===u){var m=f.multiply(2),g=t(this,i,m);if(g)o=e(i.subtract(g.point),d,f,g.quadrant);else{var _=new v(this._size).setCenter(0,0),x=_.expand(m),y=_.expand(m.negate());o=x._containsPoint(i)&&!y._containsPoint(i)}}else o=e(i,d,f)}return o?new P(h?"stroke":"fill",this):n.base.apply(this,arguments)}}},{statics:new function(){function t(t,e,n,i,r){var a=s.create(C.prototype);return a._type=t,a._size=n,a._radius=i,a._initialize(s.getNamed(r),e),a}return{Circle:function(){var e=arguments,n=p.readNamed(e,"center"),i=s.readNamed(e,"radius");return t("circle",n,new m(2*i),i,e)},Rectangle:function(){var e=arguments,n=v.readNamed(e,"rectangle"),i=m.min(m.readNamed(e,"radius"),n.getSize(!0).divide(2));return t("rectangle",n.getCenter(!0),n.getSize(!0),i,e)},Ellipse:function(){var e=arguments,n=C._readEllipse(e),i=n.radius;return t("ellipse",n.center,i.multiply(2),i,e)},_readEllipse:function(t){var e,n;if(s.hasNamed(t,"radius"))e=p.readNamed(t,"center"),n=m.readNamed(t,"radius");else{var i=v.readNamed(t,"rectangle");e=i.getCenter(!0),n=i.getSize(!0).divide(2)}return{center:e,radius:n}}}}}),T=b.extend({_class:"Raster",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!1,handle:!1},_serializeFields:{crossOrigin:null,source:null},_prioritize:["crossOrigin"],_smoothing:"low",beans:!0,initialize:function(t,n){if(!this._initialize(t,n!==e&&p.read(arguments))){var r,s=typeof t,a="string"===s?i.getElementById(t):"object"===s?t:null;if(a&&a!==b.NO_INSERT)if(a.getContext||null!=a.naturalHeight)r=a;else if(a){var o=m.read(arguments);o.isZero()||(r=rt.getCanvas(o))}r?this.setImage(r):this.setSource(t)}this._size||(this._size=new m,this._loaded=!1)},_equals:function(t){return this.getSource()===t.getSource()},copyContent:function(t){var e=t._image,n=t._canvas;if(e)this._setImage(e);else if(n){var i=rt.getCanvas(t._size);i.getContext("2d").drawImage(n,0,0),this._setImage(i)}this._crossOrigin=t._crossOrigin},getSize:function(){var t=this._size;return new g(t?t.width:0,t?t.height:0,this,"setSize")},setSize:function(t,e){var n=m.read(arguments);if(n.equals(this._size))e&&this.clear();else if(n.width>0&&n.height>0){var i=!e&&this.getElement();this._setImage(rt.getCanvas(n)),i&&this.getContext(!0).drawImage(i,0,0,n.width,n.height)}else this._canvas&&rt.release(this._canvas),this._size=n.clone()},getWidth:function(){return this._size?this._size.width:0},setWidth:function(t){this.setSize(t,this.getHeight())},getHeight:function(){return this._size?this._size.height:0},setHeight:function(t){this.setSize(this.getWidth(),t)},getLoaded:function(){return this._loaded},isEmpty:function(){var t=this._size;return!t||0===t.width&&0===t.height},getResolution:function(){var t=this._matrix,e=new p(0,0).transform(t),n=new p(1,0).transform(t).subtract(e),i=new p(0,1).transform(t).subtract(e);return new m(72/n.getLength(),72/i.getLength())},getPpi:"#getResolution",getImage:function(){return this._image},setImage:function(t){var e=this;function n(t){var n=e.getView(),i=t&&t.type||"load";n&&e.responds(i)&&(lt=n._scope,e.emit(i,new K(t)))}this._setImage(t),this._loaded?setTimeout(n,0):t&&X.add(t,{load:function(i){e._setImage(t),n(i)},error:n})},_setImage:function(t){this._canvas&&rt.release(this._canvas),t&&t.getContext?(this._image=null,this._canvas=t,this._loaded=!0):(this._image=t,this._canvas=null,this._loaded=!!(t&&t.src&&t.complete)),this._size=new m(t?t.naturalWidth||t.width:0,t?t.naturalHeight||t.height:0),this._context=null,this._changed(1033)},getCanvas:function(){if(!this._canvas){var t=rt.getContext(this._size);try{this._image&&t.drawImage(this._image,0,0),this._canvas=t.canvas}catch(e){rt.release(t)}}return this._canvas},setCanvas:"#setImage",getContext:function(t){return this._context||(this._context=this.getCanvas().getContext("2d")),t&&(this._image=null,this._changed(1025)),this._context},setContext:function(t){this._context=t},getSource:function(){var t=this._image;return t&&t.src||this.toDataURL()},setSource:function(e){var n=new t.Image,i=this._crossOrigin;i&&(n.crossOrigin=i),e&&(n.src=e),this.setImage(n)},getCrossOrigin:function(){var t=this._image;return t&&t.crossOrigin||this._crossOrigin||""},setCrossOrigin:function(t){this._crossOrigin=t;var e=this._image;e&&(e.crossOrigin=t)},getSmoothing:function(){return this._smoothing},setSmoothing:function(t){this._smoothing="string"==typeof t?t:t?"low":"off",this._changed(257)},getElement:function(){return this._canvas||this._loaded&&this._image}},{beans:!1,getSubCanvas:function(){var t=v.read(arguments),e=rt.getContext(t.getSize());return e.drawImage(this.getCanvas(),t.x,t.y,t.width,t.height,0,0,t.width,t.height),e.canvas},getSubRaster:function(){var t=v.read(arguments),e=new T(b.NO_INSERT);return e._setImage(this.getSubCanvas(t)),e.translate(t.getCenter().subtract(this.getSize().divide(2))),e._matrix.prepend(this._matrix),e.insertAbove(this),e},toDataURL:function(){var t=this._image,e=t&&t.src;if(/^data:/.test(e))return e;var n=this.getCanvas();return n?n.toDataURL.apply(n,arguments):null},drawImage:function(t){var e=p.read(arguments,1);this.getContext(!0).drawImage(t,e.x,e.y)},getAverageColor:function(t){var e,n;if(t?t instanceof k?(n=t,e=t.getBounds()):"object"==typeof t&&("width"in t?e=new v(t):"x"in t&&(e=new v(t.x-.5,t.y-.5,1,1))):e=this.getBounds(),!e)return null;var i=Math.min(e.width,32),r=Math.min(e.height,32),a=T._sampleContext;a?a.clearRect(0,0,33,33):a=T._sampleContext=rt.getContext(new m(32)),a.save();var o=(new x).scale(i/e.width,r/e.height).translate(-e.x,-e.y);o.applyToContext(a),n&&n.draw(a,new s({clip:!0,matrices:[o]})),this._matrix.applyToContext(a);var l=this.getElement(),h=this._size;l&&a.drawImage(l,-h.width/2,-h.height/2),a.restore();for(var c=a.getImageData(.5,.5,Math.ceil(i),Math.ceil(r)).data,u=[0,0,0],d=0,p=0,f=c.length;p<f;p+=4){var g=c[p+3];d+=g,g/=255,u[0]+=c[p]*g,u[1]+=c[p+1]*g,u[2]+=c[p+2]*g}for(p=0;p<3;p++)u[p]/=d;return d?z.read(u):null},getPixel:function(){var t=p.read(arguments),e=this.getContext().getImageData(t.x,t.y,1,1).data;return new z("rgb",[e[0]/255,e[1]/255,e[2]/255],e[3]/255)},setPixel:function(){var t=arguments,e=p.read(t),n=z.read(t),i=n._convert("rgb"),r=n._alpha,s=this.getContext(!0),a=s.createImageData(1,1),o=a.data;o[0]=255*i[0],o[1]=255*i[1],o[2]=255*i[2],o[3]=null!=r?255*r:255,s.putImageData(a,e.x,e.y)},clear:function(){var t=this._size;this.getContext(!0).clearRect(0,0,t.width+1,t.height+1)},createImageData:function(){var t=m.read(arguments);return this.getContext().createImageData(t.width,t.height)},getImageData:function(){var t=v.read(arguments);return t.isEmpty()&&(t=new v(this._size)),this.getContext().getImageData(t.x,t.y,t.width,t.height)},putImageData:function(t){var e=p.read(arguments,1);this.getContext(!0).putImageData(t,e.x,e.y)},setImageData:function(t){this.setSize(t),this.getContext(!0).putImageData(t,0,0)},_getBounds:function(t,e){var n=new v(this._size).setCenter(0,0);return t?t._transformBounds(n):n},_hitTestSelf:function(t){if(this._contains(t)){var e=this;return new P("pixel",e,{offset:t.add(e._size.divide(2)).round(),color:{get:function(){return e.getPixel(this.offset)}}})}},_draw:function(t,e,n){var i=this.getElement();if(i&&i.width>0&&i.height>0){t.globalAlpha=u.clamp(this._opacity,0,1),this._setStyles(t,e,n);var r=this._smoothing,s="off"===r;q.setPrefixed(t,s?"imageSmoothingEnabled":"imageSmoothingQuality",!s&&r),t.drawImage(i,-this._size.width/2,-this._size.height/2)}},_canComposite:function(){return!0}}),E=b.extend({_class:"SymbolItem",_applyMatrix:!1,_canApplyMatrix:!1,_boundsOptions:{stroke:!0},_serializeFields:{symbol:null},initialize:function(t,n){this._initialize(t,n!==e&&p.read(arguments,1))||this.setDefinition(t instanceof A?t:new A(t))},_equals:function(t){return this._definition===t._definition},copyContent:function(t){this.setDefinition(t._definition)},getDefinition:function(){return this._definition},setDefinition:function(t){this._definition=t,this._changed(9)},getSymbol:"#getDefinition",setSymbol:"#setDefinition",isEmpty:function(){return this._definition._item.isEmpty()},_getBounds:function(t,e){var n=this._definition._item;return n._getCachedBounds(n._matrix.prepended(t),e)},_hitTestSelf:function(t,e,n){var i=e.extend({all:!1}),r=this._definition._item._hitTest(t,i,n);return r&&(r.item=this),r},_draw:function(t,e){this._definition._item.draw(t,e)}}),A=s.extend({_class:"SymbolDefinition",initialize:function(t,e){this._id=d.get(),this.project=lt.project,t&&this.setItem(t,e)},_serialize:function(t,e){return e.add(this,(function(){return s.serialize([this._class,this._item],t,!1,e)}))},_changed:function(t){8&t&&b._clearBoundsCache(this),1&t&&this.project._changed(t)},getItem:function(){return this._item},setItem:function(t,e){t._symbol&&(t=t.clone()),this._item&&(this._item._symbol=null),this._item=t,t.remove(),t.setSelected(!1),e||t.setPosition(new p),t._symbol=this,this._changed(9)},getDefinition:"#getItem",setDefinition:"#setItem",place:function(t){return new E(this,t)},clone:function(){return new A(this._item.clone(!1))},equals:function(t){return t===this||t&&this._item.equals(t._item)||!1}}),P=s.extend({_class:"HitResult",initialize:function(t,e,n){this.type=t,this.item=e,n&&this.inject(n)},statics:{getOptions:function(t){var e=t&&s.read(t);return new s({type:null,tolerance:lt.settings.hitTolerance,fill:!e,stroke:!e,segments:!e,handles:!1,ends:!1,position:!1,center:!1,bounds:!1,guides:!1,selected:!1},e)}}}),R=s.extend({_class:"Segment",beans:!0,_selection:0,initialize:function(t,n,i,r,s,a){var o,l,h,c,u=arguments.length;u>0&&(null==t||"object"==typeof t?1===u&&t&&"point"in t?(o=t.point,l=t.handleIn,h=t.handleOut,c=t.selection):(o=t,l=n,h=i,c=r):(o=[t,n],l=i!==e?[i,r]:null,h=s!==e?[s,a]:null)),new W(o,this,"_point"),new W(l,this,"_handleIn"),new W(h,this,"_handleOut"),c&&this.setSelection(c)},_serialize:function(t,e){var n=this._point,i=this._selection,r=i||this.hasHandles()?[n,this._handleIn,this._handleOut]:n;return i&&r.push(i),s.serialize(r,t,!0,e)},_changed:function(t){var e=this._path;if(e){var n,i=e._curves,r=this._index;i&&(t&&t!==this._point&&t!==this._handleIn||!(n=r>0?i[r-1]:e._closed?i[i.length-1]:null)||n._changed(),t&&t!==this._point&&t!==this._handleOut||!(n=i[r])||n._changed()),e._changed(41)}},getPoint:function(){return this._point},setPoint:function(){this._point.set(p.read(arguments))},getHandleIn:function(){return this._handleIn},setHandleIn:function(){this._handleIn.set(p.read(arguments))},getHandleOut:function(){return this._handleOut},setHandleOut:function(){this._handleOut.set(p.read(arguments))},hasHandles:function(){return!this._handleIn.isZero()||!this._handleOut.isZero()},isSmooth:function(){var t=this._handleIn,e=this._handleOut;return!t.isZero()&&!e.isZero()&&t.isCollinear(e)},clearHandles:function(){this._handleIn._set(0,0),this._handleOut._set(0,0)},getSelection:function(){return this._selection},setSelection:function(t){var e=this._selection,n=this._path;this._selection=t=t||0,n&&t!==e&&(n._updateSelection(this,e,t),n._changed(257))},_changeSelection:function(t,e){var n=this._selection;this.setSelection(e?n|t:n&~t)},isSelected:function(){return!!(7&this._selection)},setSelected:function(t){this._changeSelection(7,t)},getIndex:function(){return this._index!==e?this._index:null},getPath:function(){return this._path||null},getCurve:function(){var t=this._path,e=this._index;return t?(e>0&&!t._closed&&e===t._segments.length-1&&e--,t.getCurves()[e]||null):null},getLocation:function(){var t=this.getCurve();return t?new I(t,this===t._segment1?0:1):null},getNext:function(){var t=this._path&&this._path._segments;return t&&(t[this._index+1]||this._path._closed&&t[0])||null},smooth:function(t,n,i){var r=t||{},s=r.type,a=r.factor,o=this.getPrevious(),l=this.getNext(),h=(o||this)._point,c=this._point,u=(l||this)._point,d=h.getDistance(c),f=c.getDistance(u);if(s&&"catmull-rom"!==s){if("geometric"!==s)throw new Error("Smoothing method '"+s+"' not supported.");if(o&&l){var m=h.subtract(u),g=a===e?.4:a,v=g*d/(d+f);n||this.setHandleIn(m.multiply(v)),i||this.setHandleOut(m.multiply(v-g))}}else{var _=a===e?.5:a,x=Math.pow(d,_),y=x*x,S=Math.pow(f,_),b=S*S;if(!n&&o){var M=2*b+3*S*x+y,w=3*S*(S+x);this.setHandleIn(0!==w?new p((b*h._x+M*c._x-y*u._x)/w-c._x,(b*h._y+M*c._y-y*u._y)/w-c._y):new p)}!i&&l&&(M=2*y+3*x*S+b,w=3*x*(x+S),this.setHandleOut(0!==w?new p((y*u._x+M*c._x-b*h._x)/w-c._x,(y*u._y+M*c._y-b*h._y)/w-c._y):new p))}},getPrevious:function(){var t=this._path&&this._path._segments;return t&&(t[this._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._index},isLast:function(){var t=this._path;return t&&this._index===t._segments.length-1||!1},reverse:function(){var t=this._handleIn,e=this._handleOut,n=t.clone();t.set(e),e.set(n)},reversed:function(){return new R(this._point,this._handleOut,this._handleIn)},remove:function(){return!!this._path&&!!this._path.removeSegment(this._index)},clone:function(){return new R(this._point,this._handleIn,this._handleOut)},equals:function(t){return t===this||t&&this._class===t._class&&this._point.equals(t._point)&&this._handleIn.equals(t._handleIn)&&this._handleOut.equals(t._handleOut)||!1},toString:function(){var t=["point: "+this._point];return this._handleIn.isZero()||t.push("handleIn: "+this._handleIn),this._handleOut.isZero()||t.push("handleOut: "+this._handleOut),"{ "+t.join(", ")+" }"},transform:function(t){this._transformCoordinates(t,new Array(6),!0),this._changed()},interpolate:function(t,e,n){var i=1-n,r=n,s=t._point,a=e._point,o=t._handleIn,l=e._handleIn,h=e._handleOut,c=t._handleOut;this._point._set(i*s._x+r*a._x,i*s._y+r*a._y,!0),this._handleIn._set(i*o._x+r*l._x,i*o._y+r*l._y,!0),this._handleOut._set(i*c._x+r*h._x,i*c._y+r*h._y,!0),this._changed()},_transformCoordinates:function(t,e,n){var i=this._point,r=n&&this._handleIn.isZero()?null:this._handleIn,s=n&&this._handleOut.isZero()?null:this._handleOut,a=i._x,o=i._y,l=2;return e[0]=a,e[1]=o,r&&(e[l++]=r._x+a,e[l++]=r._y+o),s&&(e[l++]=s._x+a,e[l++]=s._y+o),t&&(t._transformCoordinates(e,e,l/2),a=e[0],o=e[1],n?(i._x=a,i._y=o,l=2,r&&(r._x=e[l++]-a,r._y=e[l++]-o),s&&(s._x=e[l++]-a,s._y=e[l++]-o)):(r||(e[l++]=a,e[l++]=o),s||(e[l++]=a,e[l++]=o))),e}}),W=p.extend({initialize:function(t,n,i){var r,s,a;if(t)if((r=t[0])!==e)s=t[1];else{var o=t;(r=o.x)===e&&(r=(o=p.read(arguments)).x),s=o.y,a=o.selected}else r=s=0;this._x=r,this._y=s,this._owner=n,n[i]=this,a&&this.setSelected(!0)},_set:function(t,e){return this._x=t,this._y=e,this._owner._changed(this),this},getX:function(){return this._x},setX:function(t){this._x=t,this._owner._changed(this)},getY:function(){return this._y},setY:function(t){this._y=t,this._owner._changed(this)},isZero:function(){var t=u.isZero;return t(this._x)&&t(this._y)},isSelected:function(){return!!(this._owner._selection&this._getSelection())},setSelected:function(t){this._owner._changeSelection(this._getSelection(),t)},_getSelection:function(){var t=this._owner;return this===t._point?1:this===t._handleIn?2:this===t._handleOut?4:0}}),L=s.extend({_class:"Curve",beans:!0,initialize:function(t,e,n,i,r,s,a,o){var l,h,c,u,d,p,f=arguments.length;3===f?(this._path=t,l=e,h=n):f?1===f?"segment1"in t?(l=new R(t.segment1),h=new R(t.segment2)):"point1"in t?(c=t.point1,d=t.handle1,p=t.handle2,u=t.point2):Array.isArray(t)&&(c=[t[0],t[1]],u=[t[6],t[7]],d=[t[2]-t[0],t[3]-t[1]],p=[t[4]-t[6],t[5]-t[7]]):2===f?(l=new R(t),h=new R(e)):4===f?(c=t,d=e,p=n,u=i):8===f&&(c=[t,e],u=[a,o],d=[n-t,i-e],p=[r-a,s-o]):(l=new R,h=new R),this._segment1=l||new R(c,null,d),this._segment2=h||new R(u,p,null)},_serialize:function(t,e){return s.serialize(this.hasHandles()?[this.getPoint1(),this.getHandle1(),this.getHandle2(),this.getPoint2()]:[this.getPoint1(),this.getPoint2()],t,!0,e)},_changed:function(){this._length=this._bounds=e},clone:function(){return new L(this._segment1,this._segment2)},toString:function(){var t=["point1: "+this._segment1._point];return this._segment1._handleOut.isZero()||t.push("handle1: "+this._segment1._handleOut),this._segment2._handleIn.isZero()||t.push("handle2: "+this._segment2._handleIn),t.push("point2: "+this._segment2._point),"{ "+t.join(", ")+" }"},classify:function(){return L.classify(this.getValues())},remove:function(){var t=!1;if(this._path){var e=this._segment2,n=e._handleOut;(t=e.remove())&&this._segment1._handleOut.set(n)}return t},getPoint1:function(){return this._segment1._point},setPoint1:function(){this._segment1._point.set(p.read(arguments))},getPoint2:function(){return this._segment2._point},setPoint2:function(){this._segment2._point.set(p.read(arguments))},getHandle1:function(){return this._segment1._handleOut},setHandle1:function(){this._segment1._handleOut.set(p.read(arguments))},getHandle2:function(){return this._segment2._handleIn},setHandle2:function(){this._segment2._handleIn.set(p.read(arguments))},getSegment1:function(){return this._segment1},getSegment2:function(){return this._segment2},getPath:function(){return this._path},getIndex:function(){return this._segment1._index},getNext:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index+1]||this._path._closed&&t[0])||null},getPrevious:function(){var t=this._path&&this._path._curves;return t&&(t[this._segment1._index-1]||this._path._closed&&t[t.length-1])||null},isFirst:function(){return!this._segment1._index},isLast:function(){var t=this._path;return t&&this._segment1._index===t._curves.length-1||!1},isSelected:function(){return this.getPoint1().isSelected()&&this.getHandle1().isSelected()&&this.getHandle2().isSelected()&&this.getPoint2().isSelected()},setSelected:function(t){this.getPoint1().setSelected(t),this.getHandle1().setSelected(t),this.getHandle2().setSelected(t),this.getPoint2().setSelected(t)},getValues:function(t){return L.getValues(this._segment1,this._segment2,t)},getPoints:function(){for(var t=this.getValues(),e=[],n=0;n<8;n+=2)e.push(new p(t[n],t[n+1]));return e}},{getLength:function(){return null==this._length&&(this._length=L.getLength(this.getValues(),0,1)),this._length},getArea:function(){return L.getArea(this.getValues())},getLine:function(){return new y(this._segment1._point,this._segment2._point)},getPart:function(t,e){return new L(L.getPart(this.getValues(),t,e))},getPartLength:function(t,e){return L.getLength(this.getValues(),t,e)},divideAt:function(t){return this.divideAtTime(t&&t.curve===this?t.time:this.getTimeAt(t))},divideAtTime:function(t,e){var n=null;if(t>=1e-8&&t<=.99999999){var i=L.subdivide(this.getValues(),t),r=i[0],s=i[1],a=e||this.hasHandles(),o=this._segment1,l=this._segment2,h=this._path;a&&(o._handleOut._set(r[2]-r[0],r[3]-r[1]),l._handleIn._set(s[4]-s[6],s[5]-s[7]));var c=r[6],u=r[7],d=new R(new p(c,u),a&&new p(r[4]-c,r[5]-u),a&&new p(s[2]-c,s[3]-u));h?(h.insert(o._index+1,d),n=this.getNext()):(this._segment2=d,this._changed(),n=new L(d,l))}return n},splitAt:function(t){var e=this._path;return e?e.splitAt(t):null},splitAtTime:function(t){return this.splitAt(this.getLocationAtTime(t))},divide:function(t,n){return this.divideAtTime(t===e?.5:n?t:this.getTimeAt(t))},split:function(t,n){return this.splitAtTime(t===e?.5:n?t:this.getTimeAt(t))},reversed:function(){return new L(this._segment2.reversed(),this._segment1.reversed())},clearHandles:function(){this._segment1._handleOut._set(0,0),this._segment2._handleIn._set(0,0)},statics:{getValues:function(t,e,n,i){var r=t._point,s=t._handleOut,a=e._handleIn,o=e._point,l=r.x,h=r.y,c=o.x,u=o.y,d=i?[l,h,l,h,c,u,c,u]:[l,h,l+s._x,h+s._y,c+a._x,u+a._y,c,u];return n&&n._transformCoordinates(d,d,4),d},subdivide:function(t,n){var i=t[0],r=t[1],s=t[2],a=t[3],o=t[4],l=t[5],h=t[6],c=t[7];n===e&&(n=.5);var u=1-n,d=u*i+n*s,p=u*r+n*a,f=u*s+n*o,m=u*a+n*l,g=u*o+n*h,v=u*l+n*c,_=u*d+n*f,x=u*p+n*m,y=u*f+n*g,S=u*m+n*v,b=u*_+n*y,M=u*x+n*S;return[[i,r,d,p,_,x,b,M],[b,M,y,S,g,v,h,c]]},getMonoCurves:function(t,e){var n=[],i=e?0:1,r=t[i+0],s=t[i+2],a=t[i+4],o=t[i+6];if(r>=s==s>=a&&s>=a==a>=o||L.isStraight(t))n.push(t);else{var l=3*(s-a)-r+o,h=2*(r+a)-4*s,c=s-r,d=[],p=u.solveQuadratic(l,h,c,d,1e-8,.99999999);if(p){d.sort();var f=d[0],m=L.subdivide(t,f);n.push(m[0]),p>1&&(f=(d[1]-f)/(1-f),m=L.subdivide(m[1],f),n.push(m[0])),n.push(m[1])}else n.push(t)}return n},solveCubic:function(t,e,n,i,r,s){var a=t[e],o=t[e+2],l=t[e+4],h=t[e+6],c=0;if(!(a<n&&h<n&&o<n&&l<n||a>n&&h>n&&o>n&&l>n)){var d=3*(o-a),p=3*(l-o)-d,f=h-a-d-p;c=u.solveCubic(f,p,d,a-n,i,r,s)}return c},getTimeOf:function(t,e){var n=new p(t[0],t[1]),i=new p(t[6],t[7]),r=1e-7;if(null===(e.isClose(n,1e-12)?0:e.isClose(i,1e-12)?1:null))for(var s=[e.x,e.y],a=[],o=0;o<2;o++)for(var l=L.solveCubic(t,o,s[o],a,0,1),h=0;h<l;h++){var c=a[h];if(e.isClose(L.getPoint(t,c),r))return c}return e.isClose(n,r)?0:e.isClose(i,r)?1:null},getNearestTime:function(t,e){if(L.isStraight(t)){var n=t[0],i=t[1],r=t[6]-n,s=t[7]-i,a=r*r+s*s;if(0===a)return 0;var o=((e.x-n)*r+(e.y-i)*s)/a;return o<1e-12?0:o>.999999999999?1:L.getTimeOf(t,new p(n+o*r,i+o*s))}var l=1/0,h=0;function c(n){if(n>=0&&n<=1){var i=e.getDistance(L.getPoint(t,n),!0);if(i<l)return l=i,h=n,!0}}for(var u=0;u<=100;u++)c(u/100);for(var d=.005;d>1e-8;)c(h-d)||c(h+d)||(d/=2);return h},getPart:function(t,e,n){var i=e>n;if(i){var r=e;e=n,n=r}return e>0&&(t=L.subdivide(t,e)[1]),n<1&&(t=L.subdivide(t,(n-e)/(1-e))[0]),i?[t[6],t[7],t[4],t[5],t[2],t[3],t[0],t[1]]:t},isFlatEnough:function(t,e){var n=t[0],i=t[1],r=t[2],s=t[3],a=t[4],o=t[5],l=t[6],h=t[7],c=3*r-2*n-l,u=3*s-2*i-h,d=3*a-2*l-n,p=3*o-2*h-i;return Math.max(c*c,d*d)+Math.max(u*u,p*p)<=16*e*e},getArea:function(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],l=t[7];return 3*((l-n)*(i+s)-(o-e)*(r+a)+r*(e-s)-i*(n-a)+l*(s+e/3)-o*(a+n/3))/20},getBounds:function(t){for(var e=t.slice(0,2),n=e.slice(),i=[0,0],r=0;r<2;r++)L._addBounds(t[r],t[r+2],t[r+4],t[r+6],r,0,e,n,i);return new v(e[0],e[1],n[0]-e[0],n[1]-e[1])},_addBounds:function(t,e,n,i,r,s,a,o,l){function h(t,e){var n=t-e,i=t+e;n<a[r]&&(a[r]=n),i>o[r]&&(o[r]=i)}s/=2;var c=a[r]+s,d=o[r]-s;if(t<c||e<c||n<c||i<c||t>d||e>d||n>d||i>d)if(e<t!=e<i&&n<t!=n<i)h(t,0),h(i,0);else{var p=3*(e-n)-t+i,f=2*(t+n)-4*e,m=e-t,g=u.solveQuadratic(p,f,m,l);h(i,0);for(var v=0;v<g;v++){var _=l[v],x=1-_;1e-8<=_&&_<=.99999999&&h(x*x*x*t+3*x*x*_*e+3*x*_*_*n+_*_*_*i,s)}}}}},s.each(["getBounds","getStrokeBounds","getHandleBounds"],(function(t){this[t]=function(){this._bounds||(this._bounds={});var e=this._bounds[t];return e||(e=this._bounds[t]=N[t]([this._segment1,this._segment2],!1,this._path)),e.clone()}}),{}),s.each({isStraight:function(t,e,n,i){if(e.isZero()&&n.isZero())return!0;var r=i.subtract(t);if(r.isZero())return!1;if(r.isCollinear(e)&&r.isCollinear(n)){var s=new y(t,i);if(s.getDistance(t.add(e))<1e-7&&s.getDistance(i.add(n))<1e-7){var a=r.dot(r),o=r.dot(e)/a,l=r.dot(n)/a;return o>=0&&o<=1&&l<=0&&l>=-1}}return!1},isLinear:function(t,e,n,i){var r=i.subtract(t).divide(3);return e.equals(r)&&n.negate().equals(r)}},(function(t,e){this[e]=function(e){var n=this._segment1,i=this._segment2;return t(n._point,n._handleOut,i._handleIn,i._point,e)},this.statics[e]=function(e,n){var i=e[0],r=e[1],s=e[6],a=e[7];return t(new p(i,r),new p(e[2]-i,e[3]-r),new p(e[4]-s,e[5]-a),new p(s,a),n)}}),{statics:{},hasHandles:function(){return!this._segment1._handleOut.isZero()||!this._segment2._handleIn.isZero()},hasLength:function(t){return(!this.getPoint1().equals(this.getPoint2())||this.hasHandles())&&this.getLength()>(t||0)},isCollinear:function(t){return t&&this.isStraight()&&t.isStraight()&&this.getLine().isCollinear(t.getLine())},isHorizontal:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).y)<1e-8},isVertical:function(){return this.isStraight()&&Math.abs(this.getTangentAtTime(.5).x)<1e-8}}),{beans:!1,getLocationAt:function(t,e){return this.getLocationAtTime(e?t:this.getTimeAt(t))},getLocationAtTime:function(t){return null!=t&&t>=0&&t<=1?new I(this,t):null},getTimeAt:function(t,e){return L.getTimeAt(this.getValues(),t,e)},getParameterAt:"#getTimeAt",getTimesWithTangent:function(){var t=p.read(arguments);return t.isZero()?[]:L.getTimesWithTangent(this.getValues(),t)},getOffsetAtTime:function(t){return this.getPartLength(0,t)},getLocationOf:function(){return this.getLocationAtTime(this.getTimeOf(p.read(arguments)))},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getTimeOf:function(){return L.getTimeOf(this.getValues(),p.read(arguments))},getParameterOf:"#getTimeOf",getNearestLocation:function(){var t=p.read(arguments),e=this.getValues(),n=L.getNearestTime(e,t),i=L.getPoint(e,n);return new I(this,n,i,null,t.getDistance(i))},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t?t.getPoint():t}},new function(){var t=["getPoint","getTangent","getNormal","getWeightedTangent","getWeightedNormal","getCurvature"];return s.each(t,(function(t){this[t+"At"]=function(e,n){var i=this.getValues();return L[t](i,n?e:L.getTimeAt(i,e))},this[t+"AtTime"]=function(e){return L[t](this.getValues(),e)}}),{statics:{_evaluateMethods:t}})},new function(){function t(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=t[6],l=t[7],h=9*(i-s)+3*(o-e),c=6*(e+s)-12*i,u=3*(i-e),d=9*(r-a)+3*(l-n),p=6*(n+a)-12*r,f=3*(r-n);return function(t){var e=(h*t+c)*t+u,n=(d*t+p)*t+f;return Math.sqrt(e*e+n*n)}}function n(t,e){return Math.max(2,Math.min(16,Math.ceil(32*Math.abs(e-t))))}function i(t,e,n,i){if(null==e||e<0||e>1)return null;var r=t[0],s=t[1],a=t[2],o=t[3],l=t[4],h=t[5],c=t[6],d=t[7],f=u.isZero;f(a-r)&&f(o-s)&&(a=r,o=s),f(l-c)&&f(h-d)&&(l=c,h=d);var m,g,v=3*(a-r),_=3*(l-a)-v,x=c-r-v-_,y=3*(o-s),S=3*(h-o)-y,b=d-s-y-S;if(0===n)m=0===e?r:1===e?c:((x*e+_)*e+v)*e+r,g=0===e?s:1===e?d:((b*e+S)*e+y)*e+s;else{var M=1e-8,w=1-M;if(e<M?(m=v,g=y):e>w?(m=3*(c-l),g=3*(d-h)):(m=(3*x*e+2*_)*e+v,g=(3*b*e+2*S)*e+y),i){0===m&&0===g&&(e<M||e>w)&&(m=l-a,g=h-o);var C=Math.sqrt(m*m+g*g);C&&(m/=C,g/=C)}if(3===n){l=6*x*e+2*_,h=6*b*e+2*S;var T=Math.pow(m*m+g*g,1.5);m=0!==T?(m*h-g*l)/T:0,g=0}}return 2===n?new p(g,-m):new p(m,g)}return{statics:{classify:function(t){var n=t[0],i=t[1],r=t[2],s=t[3],a=t[4],o=t[5],l=t[6],h=t[7],c=r*(i-h)+s*(l-n)+n*h-i*l,d=3*(a*(s-i)+o*(n-r)+r*i-s*n),p=d-c,f=p-c+(n*(h-o)+i*(a-l)+l*o-h*a),m=Math.sqrt(f*f+p*p+d*d),g=0!==m?1/m:0,v=u.isZero,_="serpentine";function x(t,n,i){var r=n!==e,s=r&&n>0&&n<1,a=r&&i>0&&i<1;return!r||(s||a)&&("loop"!==t||s&&a)||(t="arch",s=a=!1),{type:t,roots:s||a?s&&a?n<i?[n,i]:[i,n]:[s?n:i]:null}}if(p*=g,d*=g,v(f*=g))return v(p)?x(v(d)?"line":"quadratic"):x(_,d/(3*p));var y=3*p*p-4*f*d;if(v(y))return x("cusp",p/(2*f));var S=y>0?Math.sqrt(y/3):Math.sqrt(-y),b=2*f;return x(y>0?_:"loop",(p+S)/b,(p-S)/b)},getLength:function(i,r,s,a){if(r===e&&(r=0),s===e&&(s=1),L.isStraight(i)){var o=i;s<1&&(o=L.subdivide(o,s)[0],r/=s),r>0&&(o=L.subdivide(o,r)[1]);var l=o[6]-o[0],h=o[7]-o[1];return Math.sqrt(l*l+h*h)}return u.integrate(a||t(i),r,s,n(r,s))},getTimeAt:function(i,r,s){if(s===e&&(s=r<0?1:0),0===r)return s;var a=Math.abs,o=r>0,l=o?s:0,h=o?1:s,c=t(i),d=L.getLength(i,l,h,c),p=a(r)-d;if(a(p)<1e-12)return o?h:l;if(p>1e-12)return null;var f=r/d,m=0;return u.findRoot((function(t){return m+=u.integrate(c,s,t,n(s,t)),s=t,m-r}),c,s+f,l,h,32,1e-12)},getPoint:function(t,e){return i(t,e,0,!1)},getTangent:function(t,e){return i(t,e,1,!0)},getWeightedTangent:function(t,e){return i(t,e,1,!1)},getNormal:function(t,e){return i(t,e,2,!0)},getWeightedNormal:function(t,e){return i(t,e,2,!1)},getCurvature:function(t,e){return i(t,e,3,!1).x},getPeaks:function(t){var e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],a=t[5],o=3*i-e-3*s+t[6],l=3*e-6*i+3*s,h=-3*e+3*i,c=3*r-n-3*a+t[7],d=3*n-6*r+3*a,p=-3*n+3*r,f=[];return u.solveCubic(9*(o*o+c*c),9*(o*l+d*c),2*(l*l+d*d)+3*(h*o+p*c),h*l+d*p,f,1e-8,.99999999),f.sort()}}}},new function(){function t(t,e,n,i,r,s,a){var o=!a&&n.getPrevious()===r,l=!a&&n!==r&&n.getNext()===r,h=1e-8,c=1-h;if(null!==i&&i>=(o?h:0)&&i<=(l?c:1)&&null!==s&&s>=(l?h:0)&&s<=(o?c:1)){var u=new I(n,i,null,a),d=new I(r,s,null,a);u._intersection=d,d._intersection=u,e&&!e(u)||I.insert(t,u,!0)}}function e(i,r,s,a,o,l,h,c,u,d,p,f,m){if(++u>=4096||++c>=40)return u;var g,v,_=r[0],x=r[1],S=r[6],b=r[7],M=y.getSignedDistance,w=M(_,x,S,b,r[2],r[3]),C=M(_,x,S,b,r[4],r[5]),T=w*C>0?3/4:4/9,E=T*Math.min(0,w,C),A=T*Math.max(0,w,C),P=M(_,x,S,b,i[0],i[1]),R=M(_,x,S,b,i[2],i[3]),W=M(_,x,S,b,i[4],i[5]),I=M(_,x,S,b,i[6],i[7]),k=function(t,e,n,i){var r,s=[0,t],a=[1/3,e],o=[2/3,n],l=[1,i],h=e-(2*t+i)/3,c=n-(t+2*i)/3;if(h*c<0)r=[[s,a,l],[s,o,l]];else{var u=h/c;r=[u>=2?[s,a,l]:u<=.5?[s,o,l]:[s,a,o,l],[s,l]]}return(h||c)<0?r.reverse():r}(P,R,W,I),N=k[0],O=k[1];if(0===w&&0===C&&0===P&&0===R&&0===W&&0===I||null==(g=n(N,O,E,A))||null==(v=n(N.reverse(),O.reverse(),E,A)))return u;var U=d+(p-d)*g,D=d+(p-d)*v;if(Math.max(m-f,D-U)<1e-9){var F=(U+D)/2,B=(f+m)/2;t(o,l,h?a:s,h?B:F,h?s:a,h?F:B)}else{i=L.getPart(i,g,v);var z=m-f;if(v-g>.8)if(D-U>z)F=(U+D)/2,u=e(r,(V=L.subdivide(i,.5))[0],a,s,o,l,!h,c,u,f,m,U,F),u=e(r,V[1],a,s,o,l,!h,c,u,f,m,F,D);else{var V;B=(f+m)/2,u=e((V=L.subdivide(r,.5))[0],i,a,s,o,l,!h,c,u,f,B,U,D),u=e(V[1],i,a,s,o,l,!h,c,u,B,m,U,D)}else u=0===z||z>=1e-9?e(r,i,a,s,o,l,!h,c,u,f,m,U,D):e(i,r,s,a,o,l,h,c,u,U,D,f,m)}return u}function n(t,e,n,r){return t[0][1]<n?i(t,!0,n):e[0][1]>r?i(e,!1,r):t[0][0]}function i(t,e,n){for(var i=t[0][0],r=t[0][1],s=1,a=t.length;s<a;s++){var o=t[s][0],l=t[s][1];if(e?l>=n:l<=n)return l===n?o:i+(n-r)*(o-i)/(l-r);i=o,r=l}return null}function r(t,e,n,i,r){var s=u.isZero;if(s(i)&&s(r)){var a=L.getTimeOf(t,new p(e,n));return null===a?[]:[a]}for(var o=Math.atan2(-r,i),l=Math.sin(o),h=Math.cos(o),c=[],d=[],f=0;f<8;f+=2){var m=t[f]-e,g=t[f+1]-n;c.push(m*h-g*l,m*l+g*h)}return L.solveCubic(c,1,0,d,0,1),d}function s(e,n,i,s,a,o,l){for(var h=n[0],c=n[1],u=r(e,h,c,n[6]-h,n[7]-c),d=0,p=u.length;d<p;d++){var f=u[d],m=L.getPoint(e,f),g=L.getTimeOf(n,m);null!==g&&t(a,o,l?s:i,l?g:f,l?i:s,l?f:g)}}function a(e,n,i,r,s,a){var o=y.intersect(e[0],e[1],e[6],e[7],n[0],n[1],n[6],n[7]);o&&t(s,a,i,L.getTimeOf(e,o),r,L.getTimeOf(n,o))}function o(n,i,r,o,l,h){var u=1e-12,d=Math.min,f=Math.max;if(f(n[0],n[2],n[4],n[6])+u>d(i[0],i[2],i[4],i[6])&&d(n[0],n[2],n[4],n[6])-u<f(i[0],i[2],i[4],i[6])&&f(n[1],n[3],n[5],n[7])+u>d(i[1],i[3],i[5],i[7])&&d(n[1],n[3],n[5],n[7])-u<f(i[1],i[3],i[5],i[7])){var m=c(n,i);if(m)for(var g=0;g<2;g++){var v=m[g];t(l,h,r,v[0],o,v[1],!0)}else{var _=L.isStraight(n),x=L.isStraight(i),y=_&&x,S=_&&!x,b=l.length;if((y?a:_||x?s:e)(S?i:n,S?n:i,S?o:r,S?r:o,l,h,S,0,0,0,1,0,1),!y||l.length===b)for(g=0;g<4;g++){var M=g>>1,w=1&g,C=6*M,T=6*w,E=new p(n[C],n[C+1]),A=new p(i[T],i[T+1]);E.isClose(A,u)&&t(l,h,r,M,o,w)}}}return l}function l(e,n,i,r){var s=L.classify(e);if("loop"===s.type){var a=s.roots;t(i,r,n,a[0],n,a[1])}return i}function c(t,e){function n(t){var e=t[6]-t[0],n=t[7]-t[1];return e*e+n*n}var i=Math.abs,r=y.getDistance,s=1e-7,a=L.isStraight(t),o=L.isStraight(e),l=a&&o,h=n(t)<n(e),c=h?e:t,u=h?t:e,d=c[0],f=c[1],m=c[6]-d,g=c[7]-f;if(r(d,f,m,g,u[0],u[1],!0)<s&&r(d,f,m,g,u[6],u[7],!0)<s)!l&&r(d,f,m,g,c[2],c[3],!0)<s&&r(d,f,m,g,c[4],c[5],!0)<s&&r(d,f,m,g,u[2],u[3],!0)<s&&r(d,f,m,g,u[4],u[5],!0)<s&&(a=o=l=!0);else if(l)return null;if(a^o)return null;for(var v=[t,e],_=[],x=0;x<4&&_.length<2;x++){var S=1&x,b=1^S,M=x>>1,w=L.getTimeOf(v[S],new p(v[b][M?6:0],v[b][M?7:1]));if(null!=w){var C=S?[M,w]:[w,M];(!_.length||i(C[0]-_[0][0])>1e-8&&i(C[1]-_[0][1])>1e-8)&&_.push(C)}if(x>2&&!_.length)break}if(2!==_.length)_=null;else if(!l){var T=L.getPart(t,_[0][0],_[1][0]),E=L.getPart(e,_[0][1],_[1][1]);(i(E[2]-T[2])>s||i(E[3]-T[3])>s||i(E[4]-T[4])>s||i(E[5]-T[5])>s)&&(_=null)}return _}return{getIntersections:function(t){var e=this.getValues(),n=t&&t!==this&&t.getValues();return n?o(e,n,this,t,[]):l(e,this,[])},statics:{getOverlaps:c,getIntersections:function(t,e,n,i,r,s){var a=!e;a&&(e=t);for(var c=t.length,u=e.length,d=new Array(c),p=a?d:new Array(u),f=[],m=0;m<c;m++)d[m]=t[m].getValues(i);if(!a)for(m=0;m<u;m++)p[m]=e[m].getValues(r);for(var g=h.findCurveBoundsCollisions(d,p,1e-7),v=0;v<c;v++){var _=t[v],x=d[v];a&&l(x,_,f,n);var y=g[v];if(y)for(var S=0;S<y.length;S++){if(s&&f.length)return f;var b=y[S];if(!a||b>v){var M=e[b];o(x,p[b],_,M,f,n)}}}return f},getCurveLineIntersections:r,getTimesWithTangent:function(t,e){var n=t[0],i=t[1],r=t[2],s=t[3],a=t[4],o=t[5],l=t[6],h=t[7],c=e.normalize(),d=c.x,p=c.y,f=3*l-9*a+9*r-3*n,m=3*h-9*o+9*s-3*i,g=6*a-12*r+6*n,v=6*o-12*s+6*i,_=3*r-3*n,x=3*s-3*i,y=2*f*p-2*m*d,S=[];if(Math.abs(y)<u.CURVETIME_EPSILON){if(0!=(y=f*v-m*g)){var b=-(f*x-m*_)/y;b>=0&&b<=1&&S.push(b)}}else{var M=(g*g-4*f*_)*p*p+(-2*g*v+4*m*_+4*f*x)*d*p+(v*v-4*m*x)*d*d,w=g*p-v*d;if(M>=0&&0!=y){var C=Math.sqrt(M),T=-(w+C)/y,E=(-w+C)/y;T>=0&&T<=1&&S.push(T),E>=0&&E<=1&&S.push(E)}}return S}}}}),I=s.extend({_class:"CurveLocation",initialize:function(t,e,n,i,r){if(e>=.99999999){var s=t.getNext();s&&(e=0,t=s)}this._setCurve(t),this._time=e,this._point=n||t.getPointAtTime(e),this._overlap=i,this._distance=r,this._intersection=this._next=this._previous=null},_setPath:function(t){this._path=t,this._version=t?t._version:0},_setCurve:function(t){this._setPath(t._path),this._curve=t,this._segment=null,this._segment1=t._segment1,this._segment2=t._segment2},_setSegment:function(t){var e=t.getCurve();e?this._setCurve(e):(this._setPath(t._path),this._segment1=t,this._segment2=null),this._segment=t,this._time=t===this._segment1?0:1,this._point=t._point.clone()},getSegment:function(){var t=this._segment;if(!t){var e=this.getCurve(),n=this.getTime();0===n?t=e._segment1:1===n?t=e._segment2:null!=n&&(t=e.getPartLength(0,n)<e.getPartLength(n,1)?e._segment1:e._segment2),this._segment=t}return t},getCurve:function(){var t=this._path,e=this;function n(t){var n=t&&t.getCurve();if(n&&null!=(e._time=n.getTimeOf(e._point)))return e._setCurve(n),n}return t&&t._version!==this._version&&(this._time=this._offset=this._curveOffset=this._curve=null),this._curve||n(this._segment)||n(this._segment1)||n(this._segment2.getPrevious())},getPath:function(){var t=this.getCurve();return t&&t._path},getIndex:function(){var t=this.getCurve();return t&&t.getIndex()},getTime:function(){var t=this.getCurve(),e=this._time;return t&&null==e?this._time=t.getTimeOf(this._point):e},getParameter:"#getTime",getPoint:function(){return this._point},getOffset:function(){var t=this._offset;if(null==t){t=0;var e=this.getPath(),n=this.getIndex();if(e&&null!=n)for(var i=e.getCurves(),r=0;r<n;r++)t+=i[r].getLength();this._offset=t+=this.getCurveOffset()}return t},getCurveOffset:function(){var t=this._curveOffset;if(null==t){var e=this.getCurve(),n=this.getTime();this._curveOffset=t=null!=n&&e&&e.getPartLength(0,n)}return t},getIntersection:function(){return this._intersection},getDistance:function(){return this._distance},divide:function(){var t=this.getCurve(),e=t&&t.divideAtTime(this.getTime());return e&&this._setSegment(e._segment1),e},split:function(){var t=this.getCurve(),e=t._path,n=t&&t.splitAtTime(this.getTime());return n&&this._setSegment(e.getLastSegment()),n},equals:function(t,e){var n=this===t;if(!n&&t instanceof I){var i=this.getCurve(),r=t.getCurve(),s=i._path;if(s===r._path){var a=Math.abs,o=a(this.getOffset()-t.getOffset()),l=!e&&this._intersection,h=!e&&t._intersection;n=(o<1e-7||s&&a(s.getLength()-o)<1e-7)&&(!l&&!h||l&&h&&l.equals(h,!0))}}return n},toString:function(){var t=[],e=this.getPoint(),n=c.instance;e&&t.push("point: "+e);var i=this.getIndex();null!=i&&t.push("index: "+i);var r=this.getTime();return null!=r&&t.push("time: "+n.number(r)),null!=this._distance&&t.push("distance: "+n.number(this._distance)),"{ "+t.join(", ")+" }"},isTouching:function(){var t=this._intersection;if(t&&this.getTangent().isCollinear(t.getTangent())){var e=this.getCurve(),n=t.getCurve();return!(e.isStraight()&&n.isStraight()&&e.getLine().intersect(n.getLine()))}return!1},isCrossing:function(){var t=this._intersection;if(!t)return!1;var e=this.getTime(),n=t.getTime(),i=1e-8,r=1-i,s=e>=i&&e<=r,a=n>=i&&n<=r;if(s&&a)return!this.isTouching();var o=this.getCurve(),l=o&&e<i?o.getPrevious():o,h=t.getCurve(),c=h&&n<i?h.getPrevious():h;if(e>r&&(o=o.getNext()),n>r&&(h=h.getNext()),!(l&&o&&c&&h))return!1;var u=[];function d(t,e){var n=t.getValues(),i=L.classify(n).roots||L.getPeaks(n),r=i.length,s=L.getLength(n,e&&r?i[r-1]:0,!e&&r?i[0]:1);u.push(r?s:s/32)}function p(t,e,n){return e<n?t>e&&t<n:t>e||t<n}s||(d(l,!0),d(o,!1)),a||(d(c,!0),d(h,!1));var f=this.getPoint(),m=Math.min.apply(Math,u),g=s?o.getTangentAtTime(e):o.getPointAt(m).subtract(f),v=s?g.negate():l.getPointAt(-m).subtract(f),_=a?h.getTangentAtTime(n):h.getPointAt(m).subtract(f),x=a?_.negate():c.getPointAt(-m).subtract(f),y=v.getAngle(),S=g.getAngle(),b=x.getAngle(),M=_.getAngle();return!!(s?p(y,b,M)^p(S,b,M)&&p(y,M,b)^p(S,M,b):p(b,y,S)^p(M,y,S)&&p(b,S,y)^p(M,S,y))},hasOverlap:function(){return!!this._overlap}},s.each(L._evaluateMethods,(function(t){var e=t+"At";this[t]=function(){var t=this.getCurve(),n=this.getTime();return null!=n&&t&&t[e](n,!0)}}),{preserve:!0}),new function(){function t(t,e,n){var i=t.length,r=0,s=i-1;function a(n,r){for(var s=n+r;s>=-1&&s<=i;s+=r){var a=t[(s%i+i)%i];if(!e.getPoint().isClose(a.getPoint(),1e-7))break;if(e.equals(a))return a}return null}for(;r<=s;){var o,l=r+s>>>1,h=t[l];if(n&&(o=e.equals(h)?h:a(l,-1)||a(l,1)))return e._overlap&&(o._overlap=o._intersection._overlap=!0),o;var c=e.getPath(),u=h.getPath();(c!==u?c._id-u._id:e.getIndex()+e.getTime()-(h.getIndex()+h.getTime()))<0?s=l-1:r=l+1}return t.splice(r,0,e),e}return{statics:{insert:t,expand:function(e){for(var n=e.slice(),i=e.length-1;i>=0;i--)t(n,e[i]._intersection,!1);return n}}}}),k=b.extend({_class:"PathItem",_selectBounds:!1,_canScaleStroke:!0,beans:!0,initialize:function(){},statics:{create:function(t){var e,n,i;if(s.isPlainObject(t)?(n=t.segments,e=t.pathData):Array.isArray(t)?n=t:"string"==typeof t&&(e=t),n){var r=n[0];i=r&&Array.isArray(r[0])}else e&&(i=(e.match(/m/gi)||[]).length>1||/z\s*\S+/i.test(e));return new(i?O:N)(t)}},_asPathItem:function(){return this},isClockwise:function(){return this.getArea()>=0},setClockwise:function(t){this.isClockwise()!=(t=!!t)&&this.reverse()},setPathData:function(t){var e,n,i,r=t&&t.match(/[mlhvcsqtaz][^mlhvcsqtaz]*/gi),s=!1,a=new p,o=new p;function l(t,n){var i=+e[t];return s&&(i+=a[n]),i}function h(t){return new p(l(t,"x"),l(t+1,"y"))}this.clear();for(var c=0,u=r&&r.length;c<u;c++){var d=r[c],f=d[0],g=f.toLowerCase(),v=(e=d.match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g))&&e.length;switch(s=f===g,"z"!==n||/[mz]/.test(g)||this.moveTo(a),g){case"m":case"l":for(var _="m"===g,x=0;x<v;x+=2)this[_?"moveTo":"lineTo"](a=h(x)),_&&(o=a,_=!1);i=a;break;case"h":case"v":var y="h"===g?"x":"y";for(a=a.clone(),x=0;x<v;x++)a[y]=l(x,y),this.lineTo(a);i=a;break;case"c":for(x=0;x<v;x+=6)this.cubicCurveTo(h(x),i=h(x+2),a=h(x+4));break;case"s":for(x=0;x<v;x+=4)this.cubicCurveTo(/[cs]/.test(n)?a.multiply(2).subtract(i):a,i=h(x),a=h(x+2)),n=g;break;case"q":for(x=0;x<v;x+=4)this.quadraticCurveTo(i=h(x),a=h(x+2));break;case"t":for(x=0;x<v;x+=2)this.quadraticCurveTo(i=/[qt]/.test(n)?a.multiply(2).subtract(i):a,a=h(x)),n=g;break;case"a":for(x=0;x<v;x+=7)this.arcTo(a=h(x+5),new m(+e[x],+e[x+1]),+e[x+2],+e[x+4],+e[x+3]);break;case"z":this.closePath(1e-12),a=o}n=g}},_canComposite:function(){return!(this.hasFill()&&this.hasStroke())},_contains:function(t){var e=t.isInside(this.getBounds({internal:!0,handle:!0}))?this._getWinding(t):{};return e.onPath||!!("evenodd"===this.getFillRule()?1&e.windingL||1&e.windingR:e.winding)},getIntersections:function(t,e,n,i){var r=this===t||!t,s=this._matrix._orNullIfIdentity(),a=r?s:(n||t._matrix)._orNullIfIdentity();return r||this.getBounds(s).intersects(t.getBounds(a),1e-12)?L.getIntersections(this.getCurves(),!r&&t.getCurves(),e,s,a,i):[]},getCrossings:function(t){return this.getIntersections(t,(function(t){return t.isCrossing()}))},getNearestLocation:function(){for(var t=p.read(arguments),e=this.getCurves(),n=1/0,i=null,r=0,s=e.length;r<s;r++){var a=e[r].getNearestLocation(t);a._distance<n&&(n=a._distance,i=a)}return i},getNearestPoint:function(){var t=this.getNearestLocation.apply(this,arguments);return t?t.getPoint():t},interpolate:function(t,e,n){var i=!this._children,r=i?"_segments":"_children",s=t[r],a=e[r],o=this[r];if(!s||!a||s.length!==a.length)throw new Error("Invalid operands in interpolate() call: "+t+", "+e);var l=o.length,h=a.length;if(l<h)for(var c=i?R:N,u=l;u<h;u++)this.add(new c);else l>h&&this[i?"removeSegments":"removeChildren"](h,l);for(u=0;u<h;u++)o[u].interpolate(s[u],a[u],n);i&&(this.setClosed(t._closed),this._changed(9))},compare:function(t){var e=!1;if(t){var n=this._children||[this],i=t._children?t._children.slice():[t],r=n.length,s=i.length,a=[],o=0;e=!0;for(var l=h.findItemBoundsCollisions(n,i,u.GEOMETRIC_EPSILON),c=r-1;c>=0&&e;c--){var d=n[c];e=!1;var p=l[c];if(p)for(var f=p.length-1;f>=0&&!e;f--)d.compare(i[p[f]])&&(a[p[f]]||(a[p[f]]=!0,o++),e=!0)}e=e&&o===s}return e}}),N=k.extend({_class:"Path",_serializeFields:{segments:[],closed:!1},initialize:function(t){this._closed=!1,this._segments=[],this._version=0;var n=arguments,i=Array.isArray(t)?"object"==typeof t[0]?t:n:!t||t.size!==e||t.x===e&&t.point===e?null:n;i&&i.length>0?this.setSegments(i):(this._curves=e,this._segmentSelection=0,i||"string"!=typeof t||(this.setPathData(t),t=null)),this._initialize(!i&&t)},_equals:function(t){return this._closed===t._closed&&s.equals(this._segments,t._segments)},copyContent:function(t){this.setSegments(t._segments),this._closed=t._closed},_changed:function t(n){if(t.base.call(this,n),8&n){if(this._length=this._area=e,32&n)this._version++;else if(this._curves)for(var i=0,r=this._curves.length;i<r;i++)this._curves[i]._changed()}else 64&n&&(this._bounds=e)},getStyle:function(){var t=this._parent;return(t instanceof O?t:this)._style},getSegments:function(){return this._segments},setSegments:function(t){var n=this.isFullySelected(),i=t&&t.length;if(this._segments.length=0,this._segmentSelection=0,this._curves=e,i){var r=t[i-1];"boolean"==typeof r&&(this.setClosed(r),i--),this._add(R.readList(t,0,{},i))}n&&this.setFullySelected(!0)},getFirstSegment:function(){return this._segments[0]},getLastSegment:function(){return this._segments[this._segments.length-1]},getCurves:function(){var t=this._curves,e=this._segments;if(!t){var n=this._countCurves();t=this._curves=new Array(n);for(var i=0;i<n;i++)t[i]=new L(this,e[i],e[i+1]||e[0])}return t},getFirstCurve:function(){return this.getCurves()[0]},getLastCurve:function(){var t=this.getCurves();return t[t.length-1]},isClosed:function(){return this._closed},setClosed:function(t){if(this._closed!=(t=!!t)){if(this._closed=t,this._curves){var e=this._curves.length=this._countCurves();t&&(this._curves[e-1]=new L(this,this._segments[e-1],this._segments[0]))}this._changed(41)}}},{beans:!0,getPathData:function(t,e){var n,i,r,s,a,o,l,h,u=this._segments,d=u.length,p=new c(e),f=new Array(6),m=!0,g=[];function v(e,c){if(e._transformCoordinates(t,f),n=f[0],i=f[1],m)g.push("M"+p.pair(n,i)),m=!1;else if(a=f[2],o=f[3],a===n&&o===i&&l===r&&h===s){if(!c){var u=n-r,d=i-s;g.push(0===u?"v"+p.number(d):0===d?"h"+p.number(u):"l"+p.pair(u,d))}}else g.push("c"+p.pair(l-r,h-s)+" "+p.pair(a-r,o-s)+" "+p.pair(n-r,i-s));r=n,s=i,l=f[4],h=f[5]}if(!d)return"";for(var _=0;_<d;_++)v(u[_]);return this._closed&&d>0&&(v(u[0],!0),g.push("z")),g.join("")},isEmpty:function(){return!this._segments.length},_transformContent:function(t){for(var e=this._segments,n=new Array(6),i=0,r=e.length;i<r;i++)e[i]._transformCoordinates(t,n,!0);return!0},_add:function(t,e){for(var n=this._segments,i=this._curves,r=t.length,a=null==e,o=(e=a?n.length:e,0);o<r;o++){var l=t[o];l._path&&(l=t[o]=l.clone()),l._path=this,l._index=e+o,l._selection&&this._updateSelection(l,0,l._selection)}if(a)s.push(n,t);else{n.splice.apply(n,[e,0].concat(t)),o=e+r;for(var h=n.length;o<h;o++)n[o]._index=o}if(i){var c=this._countCurves(),u=e>0&&e+r-1===c?e-1:e,d=u,p=Math.min(u+r,c);for(t._curves&&(i.splice.apply(i,[u,0].concat(t._curves)),d+=t._curves.length),o=d;o<p;o++)i.splice(o,0,new L(this,null,null));this._adjustCurves(u,p)}return this._changed(41),t},_adjustCurves:function(t,e){for(var n,i=this._segments,r=this._curves,s=t;s<e;s++)(n=r[s])._path=this,n._segment1=i[s],n._segment2=i[s+1]||i[0],n._changed();(n=r[this._closed&&!t?i.length-1:t-1])&&(n._segment2=i[t]||i[0],n._changed()),(n=r[e])&&(n._segment1=i[e],n._changed())},_countCurves:function(){var t=this._segments.length;return!this._closed&&t>0?t-1:t},add:function(t){var e=arguments;return e.length>1&&"number"!=typeof t?this._add(R.readList(e)):this._add([R.read(e)])[0]},insert:function(t,e){var n=arguments;return n.length>2&&"number"!=typeof e?this._add(R.readList(n,1),t):this._add([R.read(n,1)],t)[0]},addSegment:function(){return this._add([R.read(arguments)])[0]},insertSegment:function(t){return this._add([R.read(arguments,1)],t)[0]},addSegments:function(t){return this._add(R.readList(t))},insertSegments:function(t,e){return this._add(R.readList(e),t)},removeSegment:function(t){return this.removeSegments(t,t+1)[0]||null},removeSegments:function(t,e,n){t=t||0,e=s.pick(e,this._segments.length);var i=this._segments,r=this._curves,a=i.length,o=i.splice(t,e-t),l=o.length;if(!l)return o;for(var h=0;h<l;h++){var c=o[h];c._selection&&this._updateSelection(c,c._selection,0),c._index=c._path=null}h=t;for(var u=i.length;h<u;h++)i[h]._index=h;if(r){var d=t>0&&e===a+(this._closed?1:0)?t-1:t;for(h=(r=r.splice(d,l)).length-1;h>=0;h--)r[h]._path=null;n&&(o._curves=r.slice(1)),this._adjustCurves(d,d)}return this._changed(41),o},clear:"#removeSegments",hasHandles:function(){for(var t=this._segments,e=0,n=t.length;e<n;e++)if(t[e].hasHandles())return!0;return!1},clearHandles:function(){for(var t=this._segments,e=0,n=t.length;e<n;e++)t[e].clearHandles()},getLength:function(){if(null==this._length){for(var t=this.getCurves(),e=0,n=0,i=t.length;n<i;n++)e+=t[n].getLength();this._length=e}return this._length},getArea:function(){var t=this._area;if(null==t){var e=this._segments,n=this._closed;t=0;for(var i=0,r=e.length;i<r;i++){var s=i+1===r;t+=L.getArea(L.getValues(e[i],e[s?0:i+1],null,s&&!n))}this._area=t}return t},isFullySelected:function(){var t=this._segments.length;return this.isSelected()&&t>0&&this._segmentSelection===7*t},setFullySelected:function(t){t&&this._selectSegments(!0),this.setSelected(t)},setSelection:function t(e){1&e||this._selectSegments(!1),t.base.call(this,e)},_selectSegments:function(t){var e=this._segments,n=e.length,i=t?7:0;this._segmentSelection=i*n;for(var r=0;r<n;r++)e[r]._selection=i},_updateSelection:function(t,e,n){t._selection=n,(this._segmentSelection+=n-e)>0&&this.setSelected(!0)},divideAt:function(t){var e,n=this.getLocationAt(t);return n&&(e=n.getCurve().divideAt(n.getCurveOffset()))?e._segment1:null},splitAt:function(t){var e=this.getLocationAt(t),n=e&&e.index,i=e&&e.time;i>.99999999&&(n++,i=0);var r=this.getCurves();if(n>=0&&n<r.length){i>=1e-8&&r[n++].divideAtTime(i);var s,a=this.removeSegments(n,this._segments.length,!0);return this._closed?(this.setClosed(!1),s=this):((s=new N(b.NO_INSERT)).insertAbove(this),s.copyAttributes(this)),s._add(a,0),this.addSegment(a[0]),s}return null},split:function(t,n){var i,r=n===e?t:(i=this.getCurves()[t])&&i.getLocationAtTime(n);return null!=r?this.splitAt(r):null},join:function(t,e){var n=e||0;if(t&&t!==this){var i=t._segments,r=this.getLastSegment(),s=t.getLastSegment();if(!s)return this;r&&r._point.isClose(s._point,n)&&t.reverse();var a=t.getFirstSegment();if(r&&r._point.isClose(a._point,n))r.setHandleOut(a._handleOut),this._add(i.slice(1));else{var o=this.getFirstSegment();o&&o._point.isClose(a._point,n)&&t.reverse(),s=t.getLastSegment(),o&&o._point.isClose(s._point,n)?(o.setHandleIn(s._handleIn),this._add(i.slice(0,i.length-1),0)):this._add(i.slice())}t._closed&&this._add([i[0]]),t.remove()}var l=this.getFirstSegment(),h=this.getLastSegment();return l!==h&&l._point.isClose(h._point,n)&&(l.setHandleIn(h._handleIn),h.remove(),this.setClosed(!0)),this},reduce:function(t){for(var e=this.getCurves(),n=t&&t.simplify,i=n?1e-7:0,r=e.length-1;r>=0;r--){var s=e[r];!s.hasHandles()&&(!s.hasLength(i)||n&&s.isCollinear(s.getNext()))&&s.remove()}return this},reverse:function(){this._segments.reverse();for(var t=0,e=this._segments.length;t<e;t++){var n=this._segments[t],i=n._handleIn;n._handleIn=n._handleOut,n._handleOut=i,n._index=t}this._curves=null,this._changed(9)},flatten:function(t){for(var e=new U(this,t||.25,256,!0).parts,n=e.length,i=[],r=0;r<n;r++)i.push(new R(e[r].curve.slice(0,2)));!this._closed&&n>0&&i.push(new R(e[n-1].curve.slice(6))),this.setSegments(i)},simplify:function(t){var e=new D(this).fit(t||2.5);return e&&this.setSegments(e),!!e},smooth:function(t){var n=this,i=t||{},r=i.type||"asymmetric",s=this._segments,a=s.length,o=this._closed;function l(t,e){var i=t&&t.index;if(null!=i){var r=t.path;if(r&&r!==n)throw new Error(t._class+" "+i+" of "+r+" is not part of "+n);e&&t instanceof L&&i++}else i="number"==typeof t?t:e;return Math.min(i<0&&o?i%a:i<0?i+a:i,a-1)}var h=o&&i.from===e&&i.to===e,c=l(i.from,0),u=l(i.to,a-1);if(c>u)if(o)c-=a;else{var d=c;c=u,u=d}if(/^(?:asymmetric|continuous)$/.test(r)){var p="asymmetric"===r,f=Math.min,m=u-c+1,g=m-1,v=h?f(m,4):1,_=v,x=v,y=[];if(o||(_=f(1,c),x=f(1,a-u-1)),(g+=_+x)<=1)return;for(var S=0,b=c-_;S<=g;S++,b++)y[S]=s[(b<0?b+a:b)%a]._point;var M=y[0]._x+2*y[1]._x,w=y[0]._y+2*y[1]._y,C=2,T=g-1,E=[M],A=[w],P=[C],R=[],W=[];for(S=1;S<g;S++){var I=S<T,k=I?4:p?2:7,N=I?4:p?3:8,O=I?2:p?0:1,U=(I||p?1:2)/C;C=P[S]=k-U,M=E[S]=N*y[S]._x+O*y[S+1]._x-U*M,w=A[S]=N*y[S]._y+O*y[S+1]._y-U*w}for(R[T]=E[T]/P[T],W[T]=A[T]/P[T],S=g-2;S>=0;S--)R[S]=(E[S]-R[S+1])/P[S],W[S]=(A[S]-W[S+1])/P[S];R[g]=(3*y[g]._x-R[T])/2,W[g]=(3*y[g]._y-W[T])/2,S=_;var D=g-x;for(b=c;S<=D;S++,b++){var F=s[b<0?b+a:b],B=F._point,z=R[S]-B._x,V=W[S]-B._y;(h||S<D)&&F.setHandleOut(z,V),(h||S>_)&&F.setHandleIn(-z,-V)}}else for(S=c;S<=u;S++)s[S<0?S+a:S].smooth(i,!h&&S===c,!h&&S===u)},toShape:function(t){if(!this._closed)return null;var n,i,r,s,a,o,l,h=this._segments;function c(t,e){var n=h[t],i=n.getNext(),r=h[e],s=r.getNext();return n._handleOut.isZero()&&i._handleIn.isZero()&&r._handleOut.isZero()&&s._handleIn.isZero()&&i._point.subtract(n._point).isCollinear(s._point.subtract(r._point))}function d(t){var e=h[t],n=e.getNext(),i=e._handleOut,r=n._handleIn,s=.5522847498307936;if(i.isOrthogonal(r)){var a=e._point,o=n._point,l=new y(a,i,!0).intersect(new y(o,r,!0),!0);return l&&u.isZero(i.getLength()/l.subtract(a).getLength()-s)&&u.isZero(r.getLength()/l.subtract(o).getLength()-s)}return!1}function p(t,e){return h[t]._point.getDistance(h[e]._point)}if(!this.hasHandles()&&4===h.length&&c(0,2)&&c(1,3)&&(a=h[1],o=a.getPrevious(),l=a.getNext(),o._handleOut.isZero()&&a._handleIn.isZero()&&a._handleOut.isZero()&&l._handleIn.isZero()&&a._point.subtract(o._point).isOrthogonal(l._point.subtract(a._point)))?(n=C.Rectangle,i=new m(p(0,3),p(0,1)),s=h[1]._point.add(h[2]._point).divide(2)):8===h.length&&d(0)&&d(2)&&d(4)&&d(6)&&c(1,5)&&c(3,7)?(n=C.Rectangle,r=(i=new m(p(1,6),p(0,3))).subtract(new m(p(0,7),p(1,2))).divide(2),s=h[3]._point.add(h[4]._point).divide(2)):4===h.length&&d(0)&&d(1)&&d(2)&&d(3)&&(u.isZero(p(0,2)-p(1,3))?(n=C.Circle,r=p(0,2)/2):(n=C.Ellipse,r=new m(p(2,0)/2,p(3,1)/2)),s=h[1]._point),n){var f=this.getPosition(!0),g=new n({center:f,size:i,radius:r,insert:!1});return g.copyAttributes(this,!0),g._matrix.prepend(this._matrix),g.rotate(s.subtract(f).getAngle()+90),(t===e||t)&&g.insertAbove(this),g}return null},toPath:"#clone",compare:function t(e){if(!e||e instanceof O)return t.base.call(this,e);var n=this.getCurves(),i=e.getCurves(),r=n.length,s=i.length;if(!r||!s)return r==s;for(var a,o,l=n[0].getValues(),h=[],c=0,u=0,d=0;d<s;d++){var p=i[d].getValues();if(h.push(p),g=L.getOverlaps(l,p)){a=!d&&g[0][0]>0?s-1:d,o=g[0][1];break}}var f,m=Math.abs;for(p=h[a];l&&p;){var g;if((g=L.getOverlaps(l,p))&&m(g[0][0]-u)<1e-8){1===(u=g[1][0])&&(l=++c<r?n[c].getValues():null,u=0);var v=g[0][1];if(m(v-o)<1e-8){if(f||(f=[a,v]),1===(o=g[1][1])&&(++a>=s&&(a=0),p=h[a]||i[a].getValues(),o=0),!l)return f[0]===a&&f[1]===o;continue}}break}return!1},_hitTestSelf:function(t,e,n,i){var r,s,a,o,l,h,c=this,u=this.getStyle(),d=this._segments,p=d.length,f=this._closed,m=e._tolerancePadding,g=m,v=e.stroke&&u.hasStroke(),_=e.fill&&u.hasFill(),x=e.curves,y=v?u.getStrokeWidth()/2:_&&e.tolerance>0||x?0:null;function S(e,n){return t.subtract(e).divide(n).length<=1}function b(t,n,i){if(!e.selected||n.isSelected()){var r=t._point;if(n!==r&&(n=n.add(r)),S(n,g))return new P(i,c,{segment:t,point:n})}}function M(t,n){return(n||e.segments)&&b(t,t._point,"segment")||!n&&e.handles&&(b(t,t._handleIn,"handle-in")||b(t,t._handleOut,"handle-out"))}function w(t){o.add(t)}function C(e){var n,l=f||e._index>0&&e._index<p-1;return"round"===(l?r:s)?S(e._point,g):(o=new N({internal:!0,closed:!0}),l?e.isSmooth()||N._addBevelJoin(e,r,y,a,null,i,w,!0):"square"===s&&N._addSquareCap(e,s,y,null,i,w,!0),o.isEmpty()?void 0:o.contains(t)||(n=o.getNearestLocation(t))&&S(n.getPoint(),m))}if(null!==y&&(y>0?(r=u.getStrokeJoin(),s=u.getStrokeCap(),a=u.getMiterLimit(),g=g.add(N._getStrokePadding(y,i))):r=s="round"),!e.ends||e.segments||f){if(e.segments||e.handles)for(var T=0;T<p;T++)if(h=M(d[T]))return h}else if(h=M(d[0],!0)||M(d[p-1],!0))return h;if(null!==y){if(l=this.getNearestLocation(t)){var E=l.getTime();0===E||1===E&&p>1?C(l.getSegment())||(l=null):S(l.getPoint(),g)||(l=null)}if(!l&&"miter"===r&&p>1)for(T=0;T<p;T++){var A=d[T];if(t.getDistance(A._point)<=a*y&&C(A)){l=A.getLocation();break}}}return!l&&_&&this._contains(t)||l&&!v&&!x?new P("fill",this):l?new P(v?"stroke":"curve",this,{location:l,point:l.getPoint()}):null}},s.each(L._evaluateMethods,(function(t){this[t+"At"]=function(e){var n=this.getLocationAt(e);return n&&n[t]()}}),{beans:!1,getLocationOf:function(){for(var t=p.read(arguments),e=this.getCurves(),n=0,i=e.length;n<i;n++){var r=e[n].getLocationOf(t);if(r)return r}return null},getOffsetOf:function(){var t=this.getLocationOf.apply(this,arguments);return t?t.getOffset():null},getLocationAt:function(t){if("number"==typeof t){for(var e=this.getCurves(),n=0,i=0,r=e.length;i<r;i++){var s=n,a=e[i];if((n+=a.getLength())>t)return a.getLocationAt(t-s)}if(e.length>0&&t<=this.getLength())return new I(e[e.length-1],1)}else if(t&&t.getPath&&t.getPath()===this)return t;return null},getOffsetsWithTangent:function(){var t=p.read(arguments);if(t.isZero())return[];for(var e=[],n=0,i=this.getCurves(),r=0,s=i.length;r<s;r++){for(var a=i[r],o=a.getTimesWithTangent(t),l=0,h=o.length;l<h;l++){var c=n+a.getOffsetAtTime(o[l]);e.indexOf(c)<0&&e.push(c)}n+=a.length}return e}}),new function(){function t(t,e,n){var i,r,s,a,o,l,h,c,u=e._segments,d=u.length,p=new Array(6),f=!0;function m(e){if(n)e._transformCoordinates(n,p),i=p[0],r=p[1];else{var u=e._point;i=u._x,r=u._y}if(f)t.moveTo(i,r),f=!1;else{if(n)o=p[2],l=p[3];else{var d=e._handleIn;o=i+d._x,l=r+d._y}o===i&&l===r&&h===s&&c===a?t.lineTo(i,r):t.bezierCurveTo(h,c,o,l,i,r)}s=i,a=r,n?(h=p[4],c=p[5]):(d=e._handleOut,h=s+d._x,c=a+d._y)}for(var g=0;g<d;g++)m(u[g]);e._closed&&d>0&&m(u[0])}return{_draw:function(e,n,i,r){var s=n.dontStart,a=n.dontFinish||n.clip,o=this.getStyle(),l=o.hasFill(),h=o.hasStroke(),c=o.getDashArray(),u=!lt.support.nativeDash&&h&&c&&c.length;function d(t){return c[(t%u+u)%u]}if(s||e.beginPath(),(l||h&&!u||a)&&(t(e,this,r),this._closed&&e.closePath()),!a&&(l||h)&&(this._setStyles(e,n,i),l&&(e.fill(o.getFillRule()),e.shadowColor="rgba(0,0,0,0)"),h)){if(u){s||e.beginPath();for(var p,f=new U(this,.25,32,!1,r),m=f.length,g=-o.getDashOffset(),v=0;g>0;)g-=d(v--)+d(v--);for(;g<m;)p=g+d(v++),(g>0||p>0)&&f.drawPart(e,Math.max(g,0),Math.max(p,0)),g=p+d(v++)}e.stroke()}},_drawSelected:function(e,n){e.beginPath(),t(e,this,n),e.stroke(),function(t,e,n,i){if(!(i<=0))for(var r,s,a=i/2,o=i-2,l=a-1,h=new Array(6),c=0,u=e.length;c<u;c++){var d=e[c],p=d._selection;if(d._transformCoordinates(n,h),r=h[0],s=h[1],2&p&&m(2),4&p&&m(4),t.fillRect(r-a,s-a,i,i),o>0&&!(1&p)){var f=t.fillStyle;t.fillStyle="#ffffff",t.fillRect(r-l,s-l,o,o),t.fillStyle=f}}function m(e){var n=h[e],i=h[e+1];r==n&&s==i||(t.beginPath(),t.moveTo(r,s),t.lineTo(n,i),t.stroke(),t.beginPath(),t.arc(n,i,a,0,2*Math.PI,!0),t.fill())}}(e,this._segments,n,lt.settings.handleSize)}}},new function(){function t(t){var e=t._segments;if(!e.length)throw new Error("Use a moveTo() command first");return e[e.length-1]}return{moveTo:function(){var t=this._segments;1===t.length&&this.removeSegment(0),t.length||this._add([new R(p.read(arguments))])},moveBy:function(){throw new Error("moveBy() is unsupported on Path items.")},lineTo:function(){this._add([new R(p.read(arguments))])},cubicCurveTo:function(){var e=arguments,n=p.read(e),i=p.read(e),r=p.read(e),s=t(this);s.setHandleOut(n.subtract(s._point)),this._add([new R(r,i.subtract(r))])},quadraticCurveTo:function(){var e=arguments,n=p.read(e),i=p.read(e),r=t(this)._point;this.cubicCurveTo(n.add(r.subtract(n).multiply(1/3)),n.add(i.subtract(n).multiply(1/3)),i)},curveTo:function(){var e=arguments,n=p.read(e),i=p.read(e),r=s.pick(s.read(e),.5),a=1-r,o=t(this)._point,l=n.subtract(o.multiply(a*a)).subtract(i.multiply(r*r)).divide(2*r*a);if(l.isNaN())throw new Error("Cannot put a curve through points with parameter = "+r);this.quadraticCurveTo(l,i)},arcTo:function(){var e,n,i,r,a=arguments,o=Math.abs,l=Math.sqrt,h=t(this),c=h._point,d=p.read(a),f=s.peek(a);if("boolean"==typeof(b=s.pick(f,!0)))var g=(w=c.add(d).divide(2)).add(w.subtract(c).rotate(b?-90:90));else if(s.remain(a)<=2)g=d,d=p.read(a);else if(!c.equals(d)){var v=m.read(a),_=u.isZero;if(_(v.width)||_(v.height))return this.lineTo(d);var S=s.read(a),b=!!s.read(a),M=!!s.read(a),w=c.add(d).divide(2),C=(j=c.subtract(w).rotate(-S)).x,T=j.y,E=o(v.width),A=o(v.height),P=E*E,W=A*A,L=C*C,I=T*T,k=l(L/P+I/W);if(k>1&&(P=(E*=k)*E,W=(A*=k)*A),o(k=(P*W-P*I-W*L)/(P*I+W*L))<1e-12&&(k=0),k<0)throw new Error("Cannot create an arc with the given arguments");e=new p(E*T/A,-A*C/E).multiply((M===b?-1:1)*l(k)).rotate(S).add(w),n=(i=(r=(new x).translate(e).rotate(S).scale(E,A))._inverseTransform(c)).getDirectedAngle(r._inverseTransform(d)),!b&&n>0?n-=360:b&&n<0&&(n+=360)}if(g){var N=new y(c.add(g).divide(2),g.subtract(c).rotate(90),!0),O=new y(g.add(d).divide(2),d.subtract(g).rotate(90),!0),U=new y(c,d),D=U.getSide(g);if(!(e=N.intersect(O,!0))){if(!D)return this.lineTo(d);throw new Error("Cannot create an arc with the given arguments")}n=(i=c.subtract(e)).getDirectedAngle(d.subtract(e));var F=U.getSide(e,!0);0===F?n=D*o(n):D===F&&(n+=n<0?360:-360)}if(n){for(var B=o(n),z=B>=360?4:Math.ceil((B-1e-5)/90),V=n/z,G=V*Math.PI/360,H=4/3*Math.sin(G)/(1+Math.cos(G)),q=[],X=0;X<=z;X++){var j=d,J=null;if(X<z&&(J=i.rotate(90).multiply(H),r?(j=r._transformPoint(i),J=r._transformPoint(i.add(J)).subtract(j)):j=e.add(i)),X){var Q=i.rotate(-90).multiply(H);r&&(Q=r._transformPoint(i.add(Q)).subtract(j)),q.push(new R(j,Q,J))}else h.setHandleOut(J);i=i.rotate(V)}this._add(q)}},lineBy:function(){var e=p.read(arguments),n=t(this)._point;this.lineTo(n.add(e))},curveBy:function(){var e=arguments,n=p.read(e),i=p.read(e),r=s.read(e),a=t(this)._point;this.curveTo(a.add(n),a.add(i),r)},cubicCurveBy:function(){var e=arguments,n=p.read(e),i=p.read(e),r=p.read(e),s=t(this)._point;this.cubicCurveTo(s.add(n),s.add(i),s.add(r))},quadraticCurveBy:function(){var e=arguments,n=p.read(e),i=p.read(e),r=t(this)._point;this.quadraticCurveTo(r.add(n),r.add(i))},arcBy:function(){var e=arguments,n=t(this)._point,i=n.add(p.read(e)),r=s.pick(s.peek(e),!0);"boolean"==typeof r?this.arcTo(i,r):this.arcTo(i,n.add(p.read(e)))},closePath:function(t){this.setClosed(!0),this.join(this,t)}}},{_getBounds:function(t,e){var n=e.handle?"getHandleBounds":e.stroke?"getStrokeBounds":"getBounds";return N[n](this._segments,this._closed,this,t,e)},statics:{getBounds:function(t,e,n,i,r,s){var a=t[0];if(!a)return new v;var o=new Array(6),l=a._transformCoordinates(i,new Array(6)),h=l.slice(0,2),c=h.slice(),u=new Array(2);function d(t){t._transformCoordinates(i,o);for(var e=0;e<2;e++)L._addBounds(l[e],l[e+4],o[e+2],o[e],e,s?s[e]:0,h,c,u);var n=l;l=o,o=n}for(var p=1,f=t.length;p<f;p++)d(t[p]);return e&&d(a),new v(h[0],h[1],c[0]-h[0],c[1]-h[1])},getStrokeBounds:function(t,e,n,i,r){var s=n.getStyle(),a=s.hasStroke(),o=s.getStrokeWidth(),l=a&&n._getStrokeMatrix(i,r),h=a&&N._getStrokePadding(o,l),c=N.getBounds(t,e,n,i,r,h);if(!a)return c;var u=o/2,d=s.getStrokeJoin(),p=s.getStrokeCap(),f=s.getMiterLimit(),g=new v(new m(h));function _(t){c=c.include(t)}function x(t){c=c.unite(g.setCenter(t._point.transform(i)))}function y(t,e){"round"===e||t.isSmooth()?x(t):N._addBevelJoin(t,e,u,f,i,l,_)}function S(t,e){"round"===e?x(t):N._addSquareCap(t,e,u,i,l,_)}var b=t.length-(e?0:1);if(b>0){for(var M=1;M<b;M++)y(t[M],d);e?y(t[0],d):(S(t[0],p),S(t[t.length-1],p))}return c},_getStrokePadding:function(t,e){if(!e)return[t,t];var n=new p(t,0).transform(e),i=new p(0,t).transform(e),r=n.getAngleInRadians(),s=n.getLength(),a=i.getLength(),o=Math.sin(r),l=Math.cos(r),h=Math.tan(r),c=Math.atan2(a*h,s),u=Math.atan2(a,h*s);return[Math.abs(s*Math.cos(c)*l+a*Math.sin(c)*o),Math.abs(a*Math.sin(u)*l+s*Math.cos(u)*o)]},_addBevelJoin:function(t,e,n,i,r,s,a,o){var l=t.getCurve(),h=l.getPrevious(),c=l.getPoint1().transform(r),u=h.getNormalAtTime(1).multiply(n).transform(s),d=l.getNormalAtTime(0).multiply(n).transform(s),f=u.getDirectedAngle(d);if((f<0||f>=180)&&(u=u.negate(),d=d.negate()),o&&a(c),a(c.add(u)),"miter"===e){var m=new y(c.add(u),new p(-u.y,u.x),!0).intersect(new y(c.add(d),new p(-d.y,d.x),!0),!0);m&&c.getDistance(m)<=i*n&&a(m)}a(c.add(d))},_addSquareCap:function(t,e,n,i,r,s,a){var o=t._point.transform(i),l=t.getLocation(),h=l.getNormal().multiply(0===l.getTime()?n:-n).transform(r);"square"===e&&(a&&(s(o.subtract(h)),s(o.add(h))),o=o.add(h.rotate(-90))),s(o.add(h)),s(o.subtract(h))},getHandleBounds:function(t,e,n,i,r){var s,a,o=n.getStyle();if(r.stroke&&o.hasStroke()){var l=n._getStrokeMatrix(i,r),h=o.getStrokeWidth()/2,c=h;"miter"===o.getStrokeJoin()&&(c=h*o.getMiterLimit()),"square"===o.getStrokeCap()&&(c=Math.max(c,h*Math.SQRT2)),s=N._getStrokePadding(h,l),a=N._getStrokePadding(c,l)}for(var u=new Array(6),d=1/0,p=-d,f=d,m=p,g=0,_=t.length;g<_;g++){t[g]._transformCoordinates(i,u);for(var x=0;x<6;x+=2){var y=x?s:a,S=y?y[0]:0,b=y?y[1]:0,M=u[x],w=u[x+1],C=M-S,T=M+S,E=w-b,A=w+b;C<d&&(d=C),T>p&&(p=T),E<f&&(f=E),A>m&&(m=A)}}return new v(d,f,p-d,m-f)}}});N.inject({statics:new function(){var t=.5522847498307936,e=[new R([-1,0],[0,t],[0,-t]),new R([0,-1],[-t,0],[t,0]),new R([1,0],[0,-t],[0,t]),new R([0,1],[t,0],[-t,0])];function n(t,e,n){var i=s.getNamed(n),r=new N(i&&(1==i.insert?b.INSERT:0==i.insert?b.NO_INSERT:null));return r._add(t),r._closed=e,r.set(i,b.INSERT)}function i(t,i,r){for(var s=new Array(4),a=0;a<4;a++){var o=e[a];s[a]=new R(o._point.multiply(i).add(t),o._handleIn.multiply(i),o._handleOut.multiply(i))}return n(s,!0,r)}return{Line:function(){var t=arguments;return n([new R(p.readNamed(t,"from")),new R(p.readNamed(t,"to"))],!1,t)},Circle:function(){var t=arguments,e=p.readNamed(t,"center"),n=s.readNamed(t,"radius");return i(e,new m(n),t)},Rectangle:function(){var e,i=arguments,r=v.readNamed(i,"rectangle"),s=m.readNamed(i,"radius",0,{readNull:!0}),a=r.getBottomLeft(!0),o=r.getTopLeft(!0),l=r.getTopRight(!0),h=r.getBottomRight(!0);if(!s||s.isZero())e=[new R(a),new R(o),new R(l),new R(h)];else{var c=(s=m.min(s,r.getSize(!0).divide(2))).width,u=s.height,d=c*t,p=u*t;e=[new R(a.add(c,0),null,[-d,0]),new R(a.subtract(0,u),[0,p]),new R(o.add(0,u),null,[0,-p]),new R(o.add(c,0),[-d,0],null),new R(l.subtract(c,0),null,[d,0]),new R(l.add(0,u),[0,-p],null),new R(h.subtract(0,u),null,[0,p]),new R(h.subtract(c,0),[d,0])]}return n(e,!0,i)},RoundRectangle:"#Rectangle",Ellipse:function(){var t=arguments,e=C._readEllipse(t);return i(e.center,e.radius,t)},Oval:"#Ellipse",Arc:function(){var t=arguments,e=p.readNamed(t,"from"),n=p.readNamed(t,"through"),i=p.readNamed(t,"to"),r=s.getNamed(t),a=new N(r&&0==r.insert&&b.NO_INSERT);return a.moveTo(e),a.arcTo(n,i),a.set(r)},RegularPolygon:function(){for(var t=arguments,e=p.readNamed(t,"center"),i=s.readNamed(t,"sides"),r=s.readNamed(t,"radius"),a=360/i,o=i%3==0,l=new p(0,o?-r:r),h=o?-1:.5,c=new Array(i),u=0;u<i;u++)c[u]=new R(e.add(l.rotate((u+h)*a)));return n(c,!0,t)},Star:function(){for(var t=arguments,e=p.readNamed(t,"center"),i=2*s.readNamed(t,"points"),r=s.readNamed(t,"radius1"),a=s.readNamed(t,"radius2"),o=360/i,l=new p(0,-1),h=new Array(i),c=0;c<i;c++)h[c]=new R(e.add(l.rotate(o*c).multiply(c%2?a:r)));return n(h,!0,t)}}}});var O=k.extend({_class:"CompoundPath",_serializeFields:{children:[]},beans:!0,initialize:function(t){this._children=[],this._namedChildren={},this._initialize(t)||("string"==typeof t?this.setPathData(t):this.addChildren(Array.isArray(t)?t:arguments))},insertChildren:function t(e,n){var i=n,r=i[0];r&&"number"==typeof r[0]&&(i=[i]);for(var a=n.length-1;a>=0;a--){var o=i[a];i!==n||o instanceof N||(i=s.slice(i)),Array.isArray(o)?i[a]=new N({segments:o,insert:!1}):o instanceof O&&(i.splice.apply(i,[a,1].concat(o.removeChildren())),o.remove())}return t.base.call(this,e,i)},reduce:function t(e){for(var n=this._children,i=n.length-1;i>=0;i--){var r;(r=n[i].reduce(e)).isEmpty()&&r.remove()}return n.length?t.base.call(this):((r=new N(b.NO_INSERT)).copyAttributes(this),r.insertAbove(this),this.remove(),r)},isClosed:function(){for(var t=this._children,e=0,n=t.length;e<n;e++)if(!t[e]._closed)return!1;return!0},setClosed:function(t){for(var e=this._children,n=0,i=e.length;n<i;n++)e[n].setClosed(t)},getFirstSegment:function(){var t=this.getFirstChild();return t&&t.getFirstSegment()},getLastSegment:function(){var t=this.getLastChild();return t&&t.getLastSegment()},getCurves:function(){for(var t=this._children,e=[],n=0,i=t.length;n<i;n++)s.push(e,t[n].getCurves());return e},getFirstCurve:function(){var t=this.getFirstChild();return t&&t.getFirstCurve()},getLastCurve:function(){var t=this.getLastChild();return t&&t.getLastCurve()},getArea:function(){for(var t=this._children,e=0,n=0,i=t.length;n<i;n++)e+=t[n].getArea();return e},getLength:function(){for(var t=this._children,e=0,n=0,i=t.length;n<i;n++)e+=t[n].getLength();return e},getPathData:function(t,e){for(var n=this._children,i=[],r=0,s=n.length;r<s;r++){var a=n[r],o=a._matrix;i.push(a.getPathData(t&&!o.isIdentity()?t.appended(o):t,e))}return i.join("")},_hitTestChildren:function t(e,n,i){return t.base.call(this,e,n.class===N||"path"===n.type?n:s.set({},n,{fill:!1}),i)},_draw:function(t,e,n,i){var r=this._children;if(r.length){e=e.extend({dontStart:!0,dontFinish:!0}),t.beginPath();for(var s=0,a=r.length;s<a;s++)r[s].draw(t,e,i);if(!e.clip){this._setStyles(t,e,n);var o=this._style;o.hasFill()&&(t.fill(o.getFillRule()),t.shadowColor="rgba(0,0,0,0)"),o.hasStroke()&&t.stroke()}}},_drawSelected:function(t,e,n){for(var i=this._children,r=0,s=i.length;r<s;r++){var a=i[r],o=a._matrix;n[a._id]||a._drawSelected(t,o.isIdentity()?e:e.appended(o))}}},new function(){function t(t,e){var n=t._children;if(e&&!n.length)throw new Error("Use a moveTo() command first");return n[n.length-1]}return s.each(["lineTo","cubicCurveTo","quadraticCurveTo","curveTo","arcTo","lineBy","cubicCurveBy","quadraticCurveBy","curveBy","arcBy"],(function(e){this[e]=function(){var n=t(this,!0);n[e].apply(n,arguments)}}),{moveTo:function(){var e=t(this),n=e&&e.isEmpty()?e:new N(b.NO_INSERT);n!==e&&this.addChild(n),n.moveTo.apply(n,arguments)},moveBy:function(){var e=t(this,!0),n=e&&e.getLastSegment(),i=p.read(arguments);this.moveTo(n?i.add(n._point):i)},closePath:function(e){t(this,!0).closePath(e)}})},s.each(["reverse","flatten","simplify","smooth"],(function(t){this[t]=function(e){for(var n,i=this._children,r=0,s=i.length;r<s;r++)n=i[r][t](e)||n;return n}}),{}));k.inject(new function(){var t=Math.min,n=Math.max,i=Math.abs,r={unite:{1:!0,2:!0},intersect:{2:!0},subtract:{1:!0},exclude:{1:!0,"-1":!0}};function a(t){return t._children||[t]}function o(t,e){var n=t.clone(!1).reduce({simplify:!0}).transform(null,!0,!0);if(e){for(var i=a(n),r=0,s=i.length;r<s;r++)(t=i[r])._closed||t.isEmpty()||(t.closePath(1e-12),t.getFirstSegment().setHandleIn(0,0),t.getLastSegment().setHandleOut(0,0));n=n.resolveCrossings().reorient("nonzero"===n.getFillRule(),!0)}return n}function l(t,e,n,i,r){var s=new O(b.NO_INSERT);return s.addChildren(t,!0),s=s.reduce({simplify:e}),r&&0==r.insert||s.insertAbove(i&&n.isSibling(i)&&n.getIndex()<i.getIndex()?i:n),s.copyAttributes(n,!0),s}function c(t){return t.hasOverlap()||t.isCrossing()}function d(t,e,n,i){if(i&&(0==i.trace||i.stroke)&&/^(subtract|intersect)$/.test(n))return p(t,e,n);var u=o(t,!0),d=e&&t!==e&&o(e,!0),f=r[n];f[n]=!0,d&&(f.subtract||f.exclude)^d.isClockwise()^u.isClockwise()&&d.reverse();var m,_=v(I.expand(u.getIntersections(d,c))),S=a(u),b=d&&a(d),M=[],w=[];function C(t){for(var e=0,n=t.length;e<n;e++){var i=t[e];s.push(M,i._segments),s.push(w,i.getCurves()),i._overlapsOnly=!0}}function T(t){for(var e=[],n=0,i=t&&t.length;n<i;n++)e.push(w[t[n]]);return e}if(_.length){C(S),b&&C(b);for(var E=new Array(w.length),A=0,P=w.length;A<P;A++)E[A]=w[A].getValues();var R=h.findCurveBoundsCollisions(E,E,0,!0),W={};for(A=0;A<w.length;A++){var L=w[A],k=L._path._id;(W[k]=W[k]||{})[L.getIndex()]={hor:T(R[A].hor),ver:T(R[A].ver)}}for(A=0,P=_.length;A<P;A++)x(_[A]._segment,u,d,W,f);for(A=0,P=M.length;A<P;A++){var N=M[A],O=N._intersection;N._winding||x(N,u,d,W,f),O&&O._overlap||(N._path._overlapsOnly=!1)}m=y(M,f)}else m=g(b?S.concat(b):S.slice(),(function(t){return!!f[t]}));return l(m,!0,t,e,i)}function p(t,e,n){var i=o(t),r=o(e),s=i.getIntersections(r,c),a="subtract"===n,h="divide"===n,u={},d=[];function p(t){if(!u[t._id]&&(h||r.contains(t.getPointAt(t.getLength()/2))^a))return d.unshift(t),u[t._id]=!0}for(var f=s.length-1;f>=0;f--){var m=s[f].split();m&&(p(m)&&m.getFirstSegment().setHandleIn(0,0),i.getLastSegment().setHandleOut(0,0))}return p(i),l(d,!1,t,e)}function f(t,e){for(var n=t;n;){if(n===e)return;n=n._previous}for(;t._next&&t._next!==e;)t=t._next;if(!t._next){for(;e._previous;)e=e._previous;t._next=e,e._previous=t}}function m(t){for(var e=t.length-1;e>=0;e--)t[e].clearHandles()}function g(t,e,n){var r=t&&t.length;if(r){var a=s.each(t,(function(t,e){this[t._id]={container:null,winding:t.isClockwise()?1:-1,index:e}}),{}),o=t.slice().sort((function(t,e){return i(e.getArea())-i(t.getArea())})),l=o[0],c=h.findItemBoundsCollisions(o,null,u.GEOMETRIC_EPSILON);null==n&&(n=l.isClockwise());for(var d=0;d<r;d++){var p=o[d],f=a[p._id],m=0,g=c[d];if(g)for(var v=null,_=g.length-1;_>=0;_--)if(g[_]<d){v=v||p.getInteriorPoint();var x=o[g[_]];if(x.contains(v)){var y=a[x._id];m=y.winding,f.winding+=m,f.container=y.exclude?y.container:x;break}}if(e(f.winding)===e(m))f.exclude=!0,t[f.index]=null;else{var S=f.container;p.setClockwise(S?!S.isClockwise():n)}}}return t}function v(t,e,n){var i,r,s,a=e&&[],o=1e-8,l=!1,h=n||[],c=n&&{};function u(t){return t._path._id+"."+t._segment1._index}for(var d=(n&&n.length)-1;d>=0;d--)(p=n[d])._path&&(c[u(p)]=!0);for(d=t.length-1;d>=0;d--){var p,g,v=t[d],_=v._time,x=_,y=e&&!e(v);if((p=v._curve)&&(p!==r?(l=!p.hasHandles()||c&&c[u(p)],i=[],s=null,r=p):s>=o&&(_/=s)),y)i&&i.push(v);else{if(e&&a.unshift(v),s=x,_<o)g=p._segment1;else if(_>.99999999)g=p._segment2;else{var S=p.divideAtTime(_,!0);l&&h.push(p,S),g=S._segment1;for(var b=i.length-1;b>=0;b--){var M=i[b];M._time=(M._time-_)/(1-_)}}v._setSegment(g);var w=g._intersection,C=v._intersection;if(w){f(w,C);for(var T=w;T;)f(T._intersection,w),T=T._next}else g._intersection=C}}return n||m(h),a||t}function _(e,r,s,a,o){var l,h,c=Array.isArray(r)?r:r[s?"hor":"ver"],u=s?1:0,d=1^u,p=[e.x,e.y],f=p[u],m=p[d],g=1e-6,v=f-1e-9,x=f+1e-9,y=0,S=0,b=0,M=0,w=!1,C=!1,T=1,E=[];function A(i){var h=i[d+0],c=i[d+6];if(!(m<t(h,c)||m>n(h,c))){var p=i[u+0],y=i[u+2],S=i[u+4],C=i[u+6];if(h!==c){var A=m===h?0:m===c||v>n(p,y,S,C)||x<t(p,y,S,C)?1:L.solveCubic(i,d,m,E,0,1)>0?E[0]:1,P=0===A?p:1===A?C:L.getPoint(i,A)[s?"y":"x"],R=h>c?1:-1,W=l[d]>l[d+6]?1:-1,I=l[u+6];return m!==h?(P<v?b+=R:P>x?M+=R:w=!0,P>f-g&&P<f+g&&(T/=2)):(R!==W?p<v?b+=R:p>x&&(M+=R):p!=I&&(I<x&&P>x?(M+=R,w=!0):I>v&&P<v&&(b+=R,w=!0)),T/=4),l=i,!o&&P>v&&P<x&&0===L.getTangent(i,A)[s?"x":"y"]&&_(e,r,!s,a,!0)}(p<x&&C>v||C<x&&p>v)&&(w=!0)}}function P(e){var i=e[d+0],r=e[d+2],a=e[d+4],o=e[d+6];if(m<=n(i,r,a,o)&&m>=t(i,r,a,o))for(var l,h=e[u+0],c=e[u+2],p=e[u+4],f=e[u+6],g=v>n(h,c,p,f)||x<t(h,c,p,f)?[e]:L.getMonoCurves(e,s),_=0,y=g.length;_<y;_++)if(l=A(g[_]))return l}for(var R=0,W=c.length;R<W;R++){var I,k=c[R],N=k._path,O=k.getValues();if(!(R&&c[R-1]._path===N||(l=null,N._closed||(h=L.getValues(N.getLastCurve().getSegment2(),k.getSegment1(),null,!a))[d]!==h[d+6]&&(l=h),l))){l=O;for(var U=N.getLastCurve();U&&U!==k;){var D=U.getValues();if(D[d]!==D[d+6]){l=D;break}U=U.getPrevious()}}if(I=P(O))return I;if(R+1===W||c[R+1]._path!==N){if(h&&(I=P(h)))return I;!w||b||M||(b=M=N.isClockwise(a)^s?1:-1),y+=b,S+=M,b=M=0,w&&(C=!0,w=!1),h=null}}return y=i(y),S=i(S),{winding:n(y,S),windingL:y,windingR:S,quality:T,onPath:C}}function x(t,e,n,r,s){var a=[],o=t,l=0;do{if(x=t.getCurve()){var h=x.getLength();a.push({segment:t,curve:x,length:h}),l+=h}t=t.getNext()}while(t&&!t._intersection&&t!==o);for(var c=[.5,.25,.75],d={winding:0,quality:-1},p=0;p<c.length&&d.quality<.5;p++){h=l*c[p];for(var f=0,m=a.length;f<m;f++){var g=a[f],v=g.length;if(h<=v){var x,y=(x=g.curve)._path,S=y._parent,b=S instanceof O?S:y,M=u.clamp(x.getTimeAt(h),.001,.999),w=x.getPointAtTime(M),C=i(x.getTangentAtTime(M).y)<Math.SQRT1_2,T=null;if(s.subtract&&n){var E=(b===e?n:e)._getWinding(w,C,!0);if(b===e&&E.winding||b===n&&!E.winding){if(E.quality<1)continue;T={winding:0,quality:1}}}(T=T||_(w,r[y._id][x.getIndex()],C,!0)).quality>d.quality&&(d=T);break}h-=v}}for(f=a.length-1;f>=0;f--)a[f].segment._winding=d}function y(t,e){var n,i=[];function r(t){var n;return!(!t||t._visited||e&&(!e[(n=t._winding||{}).winding]||e.unite&&2===n.winding&&n.windingL&&n.windingR))}function s(t){if(t)for(var e=0,i=n.length;e<i;e++)if(t===n[e])return!0;return!1}function a(t){for(var e=t._segments,n=0,i=e.length;n<i;n++)e[n]._visited=!0}function o(t,e){var i=t._intersection,a=i,o=[];function l(i,a){for(;i&&i!==a;){var l=i._segment,h=l&&l._path;if(h){var c=l.getNext()||h.getFirstSegment(),u=c._intersection;l!==t&&(s(l)||s(c)||c&&r(l)&&(r(c)||u&&r(u._segment)))&&o.push(l),e&&n.push(l)}i=i._next}}if(e&&(n=[t]),i){for(l(i);i&&i._previous;)i=i._previous;l(i,a)}return o}t.sort((function(t,e){var n=t._intersection,i=e._intersection,r=!(!n||!n._overlap),s=!(!i||!i._overlap),a=t._path,o=e._path;return r^s?r?1:-1:!n^!i?n?1:-1:a!==o?a._id-o._id:t._index-e._index}));for(var l=0,h=t.length;l<h;l++){var c,u,d,p=t[l],f=r(p),m=null,g=!1,v=!0,_=[];if(f&&p._path._overlapsOnly){var x=p._path,y=p._intersection._segment._path;x.compare(y)&&(x.getArea()&&i.push(x.clone(!1)),a(x),a(y),f=!1)}for(;f;){var S=!m,M=o(p,S),w=M.shift(),C=!(g=!S&&(s(p)||s(w)))&&w;if(S&&(m=new N(b.NO_INSERT),c=null),g){(p.isFirst()||p.isLast())&&(v=p._path._closed),p._visited=!0;break}if(C&&c&&(_.push(c),c=null),c||(C&&M.push(p),c={start:m._segments.length,crossings:M,visited:u=[],handleIn:d}),C&&(p=w),!r(p)){m.removeSegments(c.start);for(var T=0,E=u.length;T<E;T++)u[T]._visited=!1;u.length=0;do{(p=c&&c.crossings.shift())&&p._path||(p=null,(c=_.pop())&&(u=c.visited,d=c.handleIn))}while(c&&!r(p));if(!p)break}var A=p.getNext();m.add(new R(p._point,d,A&&p._handleOut)),p._visited=!0,u.push(p),p=A||p._path.getFirstSegment(),d=A&&A._handleIn}g&&(v&&(m.getFirstSegment().setHandleIn(d),m.setClosed(v)),0!==m.getArea()&&i.push(m))}return i}return{_getWinding:function(t,e,n){return _(t,this.getCurves(),e,n)},unite:function(t,e){return d(this,t,"unite",e)},intersect:function(t,e){return d(this,t,"intersect",e)},subtract:function(t,e){return d(this,t,"subtract",e)},exclude:function(t,e){return d(this,t,"exclude",e)},divide:function(t,e){return e&&(0==e.trace||e.stroke)?p(this,t,"divide"):l([this.subtract(t,e),this.intersect(t,e)],!0,this,t,e)},resolveCrossings:function(){var t=this._children,e=t||[this];function n(t,e){var n=t&&t._intersection;return n&&n._overlap&&n._path===e}var i=!1,r=!1,a=this.getIntersections(null,(function(t){return t.hasOverlap()&&(i=!0)||t.isCrossing()&&(r=!0)})),o=i&&r&&[];if(a=I.expand(a),i)for(var l=v(a,(function(t){return t.hasOverlap()}),o),h=l.length-1;h>=0;h--){var c=l[h],u=c._path,d=c._segment,p=d.getPrevious(),f=d.getNext();n(p,u)&&n(f,u)&&(d.remove(),p._handleOut._set(0,0),f._handleIn._set(0,0),p===d||p.getCurve().hasLength()||(f._handleIn.set(p._handleIn),p.remove()))}r&&(v(a,i&&function(t){var e=t.getCurve(),n=t.getSegment(),i=t._intersection,r=i._curve,s=i._segment;if(e&&r&&e._path&&r._path)return!0;n&&(n._intersection=null),s&&(s._intersection=null)},o),o&&m(o),e=y(s.each(e,(function(t){s.push(this,t._segments)}),[])));var g,_=e.length;return _>1&&t?(e!==t&&this.setChildren(e),g=this):1!==_||t||(e[0]!==this&&this.setSegments(e[0].removeSegments()),g=this),g||((g=new O(b.NO_INSERT)).addChildren(e),(g=g.reduce()).copyAttributes(this),this.replaceWith(g)),g},reorient:function(t,n){var i=this._children;return i&&i.length?this.setChildren(g(this.removeChildren(),(function(e){return!!(t?e:1&e)}),n)):n!==e&&this.setClockwise(n),this},getInteriorPoint:function(){var e=this.getBounds().getCenter(!0);if(!this.contains(e)){for(var i=this.getCurves(),r=e.y,s=[],a=[],o=0,l=i.length;o<l;o++){var h=i[o].getValues(),c=h[1],u=h[3],d=h[5],p=h[7];if(r>=t(c,u,d,p)&&r<=n(c,u,d,p))for(var f=L.getMonoCurves(h),m=0,g=f.length;m<g;m++){var v=f[m],_=v[1],x=v[7];if(_!==x&&(r>=_&&r<=x||r>=x&&r<=_)){var y=r===_?v[0]:r===x?v[6]:1===L.solveCubic(v,1,r,a,0,1)?L.getPoint(v,a[0]).x:(v[0]+v[6])/2;s.push(y)}}}s.length>1&&(s.sort((function(t,e){return t-e})),e.x=(s[0]+s[1])/2)}return e}}});var U=s.extend({_class:"PathFlattener",initialize:function(t,e,n,i,r){var s,a=[],o=[],l=0,h=1/(n||32),c=t._segments,u=c[0];function d(t,e){var n=L.getValues(t,e,r);a.push(n),p(n,t._index,0,1)}function p(t,n,r,s){if(!(s-r>h)||i&&L.isStraight(t)||L.isFlatEnough(t,e||.25)){var a=t[6]-t[0],c=t[7]-t[1],u=Math.sqrt(a*a+c*c);u>0&&(l+=u,o.push({offset:l,curve:t,index:n,time:s}))}else{var d=L.subdivide(t,.5),f=(r+s)/2;p(d[0],n,r,f),p(d[1],n,f,s)}}for(var f=1,m=c.length;f<m;f++)d(u,s=c[f]),u=s;t._closed&&d(s||u,c[0]),this.curves=a,this.parts=o,this.length=l,this.index=0},_get:function(t){for(var e,n=this.parts,i=n.length,r=this.index;e=r,r&&!(n[--r].offset<t););for(;e<i;e++){var s=n[e];if(s.offset>=t){this.index=e;var a=n[e-1],o=a&&a.index===s.index?a.time:0,l=a?a.offset:0;return{index:s.index,time:o+(s.time-o)*(t-l)/(s.offset-l)}}}return{index:n[i-1].index,time:1}},drawPart:function(t,e,n){for(var i=this._get(e),r=this._get(n),s=i.index,a=r.index;s<=a;s++){var o=L.getPart(this.curves[s],s===i.index?i.time:0,s===r.index?r.time:1);s===i.index&&t.moveTo(o[0],o[1]),t.bezierCurveTo.apply(t,o.slice(2))}}},s.each(L._evaluateMethods,(function(t){this[t+"At"]=function(e){var n=this._get(e);return L[t](this.curves[n.index],n.time)}}),{})),D=s.extend({initialize:function(t){for(var e,n=this.points=[],i=t._segments,r=t._closed,s=0,a=i.length;s<a;s++){var o=i[s].point;e&&e.equals(o)||n.push(e=o.clone())}r&&(n.unshift(n[n.length-1]),n.push(n[1])),this.closed=r},fit:function(t){var e=this.points,n=e.length,i=null;return n>0&&(i=[new R(e[0])],n>1&&(this.fitCubic(i,t,0,n-1,e[1].subtract(e[0]),e[n-2].subtract(e[n-1])),this.closed&&(i.shift(),i.pop()))),i},fitCubic:function(t,e,n,i,r,s){var a=this.points;if(i-n!=1){for(var o,l=this.chordLengthParameterize(n,i),h=Math.max(e,e*e),c=!0,u=0;u<=4;u++){var d=this.generateBezier(n,i,l,r,s),p=this.findMaxError(n,i,d,l);if(p.error<e&&c)return void this.addCurve(t,d);if(o=p.index,p.error>=h)break;c=this.reparameterize(n,i,l,d),h=p.error}var f=a[o-1].subtract(a[o+1]);this.fitCubic(t,e,n,o,r,f),this.fitCubic(t,e,o,i,f.negate(),s)}else{var m=a[n],g=a[i],v=m.getDistance(g)/3;this.addCurve(t,[m,m.add(r.normalize(v)),g.add(s.normalize(v)),g])}},addCurve:function(t,e){t[t.length-1].setHandleOut(e[1].subtract(e[0])),t.push(new R(e[3],e[2].subtract(e[3])))},generateBezier:function(t,e,n,i,r){for(var s=1e-12,a=Math.abs,o=this.points,l=o[t],h=o[e],c=[[0,0],[0,0]],u=[0,0],d=0,p=e-t+1;d<p;d++){var f=n[d],m=1-f,g=3*f*m,v=m*m*m,_=g*m,x=g*f,y=f*f*f,S=i.normalize(_),b=r.normalize(x),M=o[t+d].subtract(l.multiply(v+_)).subtract(h.multiply(x+y));c[0][0]+=S.dot(S),c[0][1]+=S.dot(b),c[1][0]=c[0][1],c[1][1]+=b.dot(b),u[0]+=S.dot(M),u[1]+=b.dot(M)}var w,C,T=c[0][0]*c[1][1]-c[1][0]*c[0][1];if(a(T)>s){var E=c[0][0]*u[1]-c[1][0]*u[0];w=(u[0]*c[1][1]-u[1]*c[0][1])/T,C=E/T}else{var A=c[0][0]+c[0][1],P=c[1][0]+c[1][1];w=C=a(A)>s?u[0]/A:a(P)>s?u[1]/P:0}var R,W,L=h.getDistance(l),I=s*L;if(w<I||C<I)w=C=L/3;else{var k=h.subtract(l);R=i.normalize(w),W=r.normalize(C),R.dot(k)-W.dot(k)>L*L&&(w=C=L/3,R=W=null)}return[l,l.add(R||i.normalize(w)),h.add(W||r.normalize(C)),h]},reparameterize:function(t,e,n,i){for(var r=t;r<=e;r++)n[r-t]=this.findRoot(i,this.points[r],n[r-t]);r=1;for(var s=n.length;r<s;r++)if(n[r]<=n[r-1])return!1;return!0},findRoot:function(t,e,n){for(var i=[],r=[],s=0;s<=2;s++)i[s]=t[s+1].subtract(t[s]).multiply(3);for(s=0;s<=1;s++)r[s]=i[s+1].subtract(i[s]).multiply(2);var a=this.evaluate(3,t,n),o=this.evaluate(2,i,n),l=this.evaluate(1,r,n),h=a.subtract(e),c=o.dot(o)+h.dot(l);return u.isMachineZero(c)?n:n-h.dot(o)/c},evaluate:function(t,e,n){for(var i=e.slice(),r=1;r<=t;r++)for(var s=0;s<=t-r;s++)i[s]=i[s].multiply(1-n).add(i[s+1].multiply(n));return i[0]},chordLengthParameterize:function(t,e){for(var n=[0],i=t+1;i<=e;i++)n[i-t]=n[i-t-1]+this.points[i].getDistance(this.points[i-1]);i=1;for(var r=e-t;i<=r;i++)n[i]/=n[r];return n},findMaxError:function(t,e,n,i){for(var r=Math.floor((e-t+1)/2),s=0,a=t+1;a<e;a++){var o=this.evaluate(3,n,i[a-t]).subtract(this.points[a]),l=o.x*o.x+o.y*o.y;l>=s&&(s=l,r=a)}return{error:s,index:r}}}),F=b.extend({_class:"TextItem",_applyMatrix:!1,_canApplyMatrix:!1,_serializeFields:{content:null},_boundsOptions:{stroke:!1,handle:!1},initialize:function(t){this._content="",this._lines=[];var n=t&&s.isPlainObject(t)&&t.x===e&&t.y===e;this._initialize(n&&t,!n&&p.read(arguments))},_equals:function(t){return this._content===t._content},copyContent:function(t){this.setContent(t._content)},getContent:function(){return this._content},setContent:function(t){this._content=""+t,this._lines=this._content.split(/\r\n|\n|\r/gm),this._changed(521)},isEmpty:function(){return!this._content},getCharacterStyle:"#getStyle",setCharacterStyle:"#setStyle",getParagraphStyle:"#getStyle",setParagraphStyle:"#setStyle"}),B=F.extend({_class:"PointText",initialize:function(){F.apply(this,arguments)},getPoint:function(){var t=this._matrix.getTranslation();return new f(t.x,t.y,this,"setPoint")},setPoint:function(){var t=p.read(arguments);this.translate(t.subtract(this._matrix.getTranslation()))},_draw:function(t,e,n){if(this._content){this._setStyles(t,e,n);var i=this._lines,r=this._style,s=r.hasFill(),a=r.hasStroke(),o=r.getLeading(),l=t.shadowColor;t.font=r.getFontStyle(),t.textAlign=r.getJustification();for(var h=0,c=i.length;h<c;h++){t.shadowColor=l;var u=i[h];s&&(t.fillText(u,0,0),t.shadowColor="rgba(0,0,0,0)"),a&&t.strokeText(u,0,0),t.translate(0,o)}}},_getBounds:function(t,e){var n=this._style,i=this._lines,r=i.length,s=n.getJustification(),a=n.getLeading(),o=this.getView().getTextWidth(n.getFontStyle(),i),l=0;"left"!==s&&(l-=o/("center"===s?2:1));var h=new v(l,r?-.75*a:0,o,r*a);return t?t._transformBounds(h,h):h}}),z=s.extend(new function(){var t,e={gray:["gray"],rgb:["red","green","blue"],hsb:["hue","saturation","brightness"],hsl:["hue","saturation","lightness"],gradient:["gradient","origin","destination","highlight"]},i={},r={transparent:[0,0,0,0]},a=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]],o={"rgb-hsb":function(t,e,n){var i=Math.max(t,e,n),r=i-Math.min(t,e,n);return[0===r?0:60*(i==t?(e-n)/r+(e<n?6:0):i==e?(n-t)/r+2:(t-e)/r+4),0===i?0:r/i,i]},"hsb-rgb":function(t,e,n){var i,r=(t=(t/60%6+6)%6)-(i=Math.floor(t)),s=[n,n*(1-e),n*(1-e*r),n*(1-e*(1-r))];return[s[(i=a[i])[0]],s[i[1]],s[i[2]]]},"rgb-hsl":function(t,e,n){var i=Math.max(t,e,n),r=Math.min(t,e,n),s=i-r,a=0===s,o=(i+r)/2;return[a?0:60*(i==t?(e-n)/s+(e<n?6:0):i==e?(n-t)/s+2:(t-e)/s+4),a?0:o<.5?s/(i+r):s/(2-i-r),o]},"hsl-rgb":function(t,e,n){if(0===e)return[n,n,n];for(var i=[(t=(t/360%1+1)%1)+1/3,t,t-1/3],r=n<.5?n*(1+e):n+e-n*e,s=2*n-r,a=[],o=0;o<3;o++){var l=i[o];l<0&&(l+=1),l>1&&(l-=1),a[o]=6*l<1?s+6*(r-s)*l:2*l<1?r:3*l<2?s+(r-s)*(2/3-l)*6:s}return a},"rgb-gray":function(t,e,n){return[.2989*t+.587*e+.114*n]},"gray-rgb":function(t){return[t,t,t]},"gray-hsb":function(t){return[0,0,t]},"gray-hsl":function(t){return[0,0,t]},"gradient-rgb":function(){return[]},"rgb-gradient":function(){return[]}};return s.each(e,(function(t,n){i[n]=[],s.each(t,(function(t,r){var a=s.capitalize(t),o=/^(hue|saturation)$/.test(t),l=i[n][r]="gradient"===n?"gradient"===t?function(t){var e=this._components[0];return e!==(t=V.read(Array.isArray(t)?t:arguments,0,{readNull:!0}))&&(e&&e._removeOwner(this),t&&t._addOwner(this)),t}:function(){return p.read(arguments,0,{readNull:"highlight"===t,clone:!0})}:function(t){return null==t||isNaN(t)?0:+t};this["get"+a]=function(){return this._type===n||o&&/^hs[bl]$/.test(this._type)?this._components[r]:this._convert(n)[r]},this["set"+a]=function(t){this._type===n||o&&/^hs[bl]$/.test(this._type)||(this._components=this._convert(n),this._properties=e[n],this._type=n),this._components[r]=l.call(this,t),this._changed()}}),this)}),{_class:"Color",_readIndex:!0,initialize:function a(o){var l,h,c,u,d=arguments,p=this.__read,f=0;Array.isArray(o)&&(o=(d=o)[0]);var m=null!=o&&typeof o;if("string"===m&&o in e&&(l=o,o=d[1],Array.isArray(o)?(h=o,c=d[2]):(p&&(f=1),d=s.slice(d,1),m=typeof o)),!h){if(u="number"===m?d:"object"===m&&null!=o.length?o:null){l||(l=u.length>=3?"rgb":"gray");var g=e[l].length;c=u[g],p&&(f+=u===arguments?g+(null!=c?1:0):1),u.length>g&&(u=s.slice(u,0,g))}else if("string"===m){var v=function(e){var i,s=e.match(/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i)||e.match(/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i),a="rgb";if(s){var o=s[4]?4:3;i=new Array(o);for(var l=0;l<o;l++){var h=s[l+1];i[l]=parseInt(1==h.length?h+h:h,16)/255}}else if(s=e.match(/^(rgb|hsl)a?\((.*)\)$/)){a=s[1],i=s[2].trim().split(/[,\s]+/g);for(var c="hsl"===a,u=(l=0,Math.min(i.length,4));l<u;l++){var d=i[l];if(h=parseFloat(d),c)if(0===l){var p=d.match(/([a-z]*)$/)[1];h*={turn:360,rad:180/Math.PI,grad:.9}[p]||1}else l<3&&(h/=100);else l<3&&(h/=/%$/.test(d)?100:255);i[l]=h}}else{var f=r[e];if(!f)if(n){t||((t=rt.getContext(1,1,{willReadFrequently:!0})).globalCompositeOperation="copy"),t.fillStyle="rgba(0,0,0,0)",t.fillStyle=e,t.fillRect(0,0,1,1);var m=t.getImageData(0,0,1,1).data;f=r[e]=[m[0]/255,m[1]/255,m[2]/255]}else f=[0,0,0];i=f.slice()}return[a,i]}(o);l=v[0],4===(h=v[1]).length&&(c=h[3],h.length--)}else if("object"===m)if(o.constructor===a){if(l=o._type,h=o._components.slice(),c=o._alpha,"gradient"===l)for(var _=1,x=h.length;_<x;_++){var y=h[_];y&&(h[_]=y.clone())}}else if(o.constructor===V)l="gradient",u=d;else{var S=e[l="hue"in o?"lightness"in o?"hsl":"hsb":"gradient"in o||"stops"in o||"radial"in o?"gradient":"gray"in o?"gray":"rgb"],b=i[l];for(this._components=h=[],_=0,x=S.length;_<x;_++)null==(M=o[S[_]])&&!_&&"gradient"===l&&"stops"in o&&(M={stops:o.stops,radial:o.radial}),null!=(M=b[_].call(this,M))&&(h[_]=M);c=o.alpha}p&&l&&(f=1)}if(this._type=l||"rgb",!h)for(this._components=h=[],_=0,x=(b=i[this._type]).length;_<x;_++){var M;null!=(M=b[_].call(this,u&&u[_]))&&(h[_]=M)}return this._components=h,this._properties=e[this._type],this._alpha=c,p&&(this.__read=f),this},set:"#initialize",_serialize:function(t,e){var n=this.getComponents();return s.serialize(/^(gray|rgb)$/.test(this._type)?n:[this._type].concat(n),t,!0,e)},_changed:function(){this._canvasStyle=null,this._owner&&(this._setter?this._owner[this._setter](this):this._owner._changed(129))},_convert:function(t){var e;return this._type===t?this._components.slice():(e=o[this._type+"-"+t])?e.apply(this,this._components):o["rgb-"+t].apply(this,o[this._type+"-rgb"].apply(this,this._components))},convert:function(t){return new z(t,this._convert(t),this._alpha)},getType:function(){return this._type},setType:function(t){this._components=this._convert(t),this._properties=e[t],this._type=t},getComponents:function(){var t=this._components.slice();return null!=this._alpha&&t.push(this._alpha),t},getAlpha:function(){return null!=this._alpha?this._alpha:1},setAlpha:function(t){this._alpha=null==t?null:Math.min(Math.max(t,0),1),this._changed()},hasAlpha:function(){return null!=this._alpha},equals:function(t){var e=s.isPlainValue(t,!0)?z.read(arguments):t;return e===this||e&&this._class===e._class&&this._type===e._type&&this.getAlpha()===e.getAlpha()&&s.equals(this._components,e._components)||!1},toString:function(){for(var t=this._properties,e=[],n="gradient"===this._type,i=c.instance,r=0,s=t.length;r<s;r++){var a=this._components[r];null!=a&&e.push(t[r]+": "+(n?a:i.number(a)))}return null!=this._alpha&&e.push("alpha: "+i.number(this._alpha)),"{ "+e.join(", ")+" }"},toCSS:function(t){var e=this._convert("rgb"),n=t||null==this._alpha?1:this._alpha;function i(t){return Math.round(255*(t<0?0:t>1?1:t))}return e=[i(e[0]),i(e[1]),i(e[2])],n<1&&e.push(n<0?0:n),t?"#"+((1<<24)+(e[0]<<16)+(e[1]<<8)+e[2]).toString(16).slice(1):(4==e.length?"rgba(":"rgb(")+e.join(",")+")"},toCanvasStyle:function(t,e){if(this._canvasStyle)return this._canvasStyle;if("gradient"!==this._type)return this._canvasStyle=this.toCSS();var n,i=this._components,r=i[0],s=r._stops,a=i[1],o=i[2],l=i[3],h=e&&e.inverted();if(h&&(a=h._transformPoint(a),o=h._transformPoint(o),l&&(l=h._transformPoint(l))),r._radial){var c=o.getDistance(a);if(l){var u=l.subtract(a);u.getLength()>c&&(l=a.add(u.normalize(c-.1)))}var d=l||a;n=t.createRadialGradient(d.x,d.y,0,a.x,a.y,c)}else n=t.createLinearGradient(a.x,a.y,o.x,o.y);for(var p=0,f=s.length;p<f;p++){var m=s[p],g=m._offset;n.addColorStop(null==g?p/(f-1):g,m._color.toCanvasStyle())}return this._canvasStyle=n},transform:function(t){if("gradient"===this._type){for(var e=this._components,n=1,i=e.length;n<i;n++){var r=e[n];t._transformPoint(r,r,!0)}this._changed()}},statics:{_types:e,random:function(){var t=Math.random;return new z(t(),t(),t())},_setOwner:function(t,e,n){return t&&(t._owner&&e&&t._owner!==e&&(t=t.clone()),!t._owner^!e&&(t._owner=e||null,t._setter=n||null)),t}}})},new function(){return s.each({add:function(t,e){return t+e},subtract:function(t,e){return t-e},multiply:function(t,e){return t*e},divide:function(t,e){return t/e}},(function(t,e){this[e]=function(e){e=z.read(arguments);for(var n=this._type,i=this._components,r=e._convert(n),s=0,a=i.length;s<a;s++)r[s]=t(i[s],r[s]);return new z(n,r,null!=this._alpha?t(this._alpha,e.getAlpha()):null)}}),{})}),V=s.extend({_class:"Gradient",initialize:function(t,e){this._id=d.get(),t&&s.isPlainObject(t)&&(this.set(t),t=e=null),null==this._stops&&this.setStops(t||["white","black"]),null==this._radial&&this.setRadial("string"==typeof e&&"radial"===e||e||!1)},_serialize:function(t,e){return e.add(this,(function(){return s.serialize([this._stops,this._radial],t,!0,e)}))},_changed:function(){for(var t=0,e=this._owners&&this._owners.length;t<e;t++)this._owners[t]._changed()},_addOwner:function(t){this._owners||(this._owners=[]),this._owners.push(t)},_removeOwner:function(t){var n=this._owners?this._owners.indexOf(t):-1;-1!=n&&(this._owners.splice(n,1),this._owners.length||(this._owners=e))},clone:function(){for(var t=[],e=0,n=this._stops.length;e<n;e++)t[e]=this._stops[e].clone();return new V(t,this._radial)},getStops:function(){return this._stops},setStops:function(t){if(t.length<2)throw new Error("Gradient stop list needs to contain at least two stops.");var n=this._stops;if(n)for(var i=0,r=n.length;i<r;i++)n[i]._owner=e;for(i=0,r=(n=this._stops=G.readList(t,0,{clone:!0})).length;i<r;i++)n[i]._owner=this;this._changed()},getRadial:function(){return this._radial},setRadial:function(t){this._radial=t,this._changed()},equals:function(t){if(t===this)return!0;if(t&&this._class===t._class){var e=this._stops,n=t._stops,i=e.length;if(i===n.length){for(var r=0;r<i;r++)if(!e[r].equals(n[r]))return!1;return!0}}return!1}}),G=s.extend({_class:"GradientStop",initialize:function(t,n){var i=t,r=n;"object"==typeof t&&n===e&&(Array.isArray(t)&&"number"!=typeof t[0]?(i=t[0],r=t[1]):("color"in t||"offset"in t||"rampPoint"in t)&&(i=t.color,r=t.offset||t.rampPoint||0)),this.setColor(i),this.setOffset(r)},clone:function(){return new G(this._color.clone(),this._offset)},_serialize:function(t,e){var n=this._color,i=this._offset;return s.serialize(null==i?[n]:[n,i],t,!0,e)},_changed:function(){this._owner&&this._owner._changed(129)},getOffset:function(){return this._offset},setOffset:function(t){this._offset=t,this._changed()},getRampPoint:"#getOffset",setRampPoint:"#setOffset",getColor:function(){return this._color},setColor:function(){z._setOwner(this._color,null),this._color=z._setOwner(z.read(arguments,0),this,"setColor"),this._changed()},equals:function(t){return t===this||t&&this._class===t._class&&this._color.equals(t._color)&&this._offset==t._offset||!1}}),H=s.extend(new function(){var t={fillColor:null,fillRule:"nonzero",strokeColor:null,strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",strokeScaling:!0,miterLimit:10,dashOffset:0,dashArray:[],shadowColor:null,shadowBlur:0,shadowOffset:new p,selectedColor:null},n=s.set({},t,{fontFamily:"sans-serif",fontWeight:"normal",fontSize:12,leading:null,justification:"left"}),i=s.set({},n,{fillColor:new z}),r={strokeWidth:193,strokeCap:193,strokeJoin:193,strokeScaling:201,miterLimit:193,fontFamily:9,fontWeight:9,fontSize:9,font:9,leading:9,justification:9},a={beans:!0},o={_class:"Style",beans:!0,initialize:function(e,r,s){this._values={},this._owner=r,this._project=r&&r._project||s||lt.project,this._defaults=!r||r instanceof M?n:r instanceof F?i:t,e&&this.set(e)}};return s.each(n,(function(t,n){var i=/Color$/.test(n),l="shadowOffset"===n,h=s.capitalize(n),c=r[n],u="set"+h,d="get"+h;o[u]=function(t){var e=this._owner,r=e&&e._children,s=r&&r.length>0&&!(e instanceof O);if(s)for(var a=0,o=r.length;a<o;a++)r[a]._style[u](t);if(("selectedColor"===n||!s)&&n in this._defaults){var l=this._values[n];l!==t&&(i&&(l&&(z._setOwner(l,null),l._canvasStyle=null),t&&t.constructor===z&&(t=z._setOwner(t,e,s&&u))),this._values[n]=t,e&&e._changed(c||129))}},o[d]=function(t){var r=this._owner,a=r&&r._children,o=a&&a.length>0&&!(r instanceof O);if(o&&!t)for(var h=0,c=a.length;h<c;h++){var f=a[h]._style[d]();if(h){if(!s.equals(m,f))return e}else m=f}else if(n in this._defaults){var m;if((m=this._values[n])===e)(m=this._defaults[n])&&m.clone&&(m=m.clone());else{var g=i?z:l?p:null;!g||m&&m.constructor===g||(this._values[n]=m=g.read([m],0,{readNull:!0,clone:!0}))}}return m&&i&&(m=z._setOwner(m,r,o&&u)),m},a[d]=function(t){return this._style[d](t)},a[u]=function(t){this._style[u](t)}})),s.each({Font:"FontFamily",WindingRule:"FillRule"},(function(t,e){var n="get"+e,i="set"+e;o[n]=a[n]="#get"+t,o[i]=a[i]="#set"+t})),b.inject(a),o},{set:function(t){var e=t instanceof H,n=e?t._values:t;if(n)for(var i in n)if(i in this._defaults){var r=n[i];this[i]=r&&e&&r.clone?r.clone():r}},equals:function(t){function n(t,n,i){var r=t._values,a=n._values,o=n._defaults;for(var l in r){var h=r[l],c=a[l];if(!(i&&l in a||s.equals(h,c===e?o[l]:c)))return!1}return!0}return t===this||t&&this._class===t._class&&n(this,t)&&n(t,this,!0)||!1},_dispose:function(){var t;(t=this.getFillColor())&&(t._canvasStyle=null),(t=this.getStrokeColor())&&(t._canvasStyle=null),(t=this.getShadowColor())&&(t._canvasStyle=null)},hasFill:function(){var t=this.getFillColor();return!!t&&t.alpha>0},hasStroke:function(){var t=this.getStrokeColor();return!!t&&t.alpha>0&&this.getStrokeWidth()>0},hasShadow:function(){var t=this.getShadowColor();return!!t&&t.alpha>0&&(this.getShadowBlur()>0||!this.getShadowOffset().isZero())},getView:function(){return this._project._view},getFontStyle:function(){var t=this.getFontSize();return this.getFontWeight()+" "+t+(/[a-z]/i.test(t+"")?" ":"px ")+this.getFontFamily()},getFont:"#getFontFamily",setFont:"#setFontFamily",getLeading:function t(){var e=t.base.call(this),n=this.getFontSize();return/pt|em|%|px/.test(n)&&(n=this.getView().getPixelSize(n)),null!=e?e:1.2*n}}),q=new function(){function t(t,e,n,i){for(var r=["","webkit","moz","Moz","ms","o"],s=e[0].toUpperCase()+e.substring(1),a=0;a<6;a++){var o=r[a],l=o?o+s:e;if(l in t){if(!n)return t[l];t[l]=i;break}}}return{getStyles:function(t){var e=t&&9!==t.nodeType?t.ownerDocument:t,n=e&&e.defaultView;return n&&n.getComputedStyle(t,"")},getBounds:function(t,e){var n,i=t.ownerDocument,r=i.body,s=i.documentElement;try{n=t.getBoundingClientRect()}catch(h){n={left:0,top:0,width:0,height:0}}var a=n.left-(s.clientLeft||r.clientLeft||0),o=n.top-(s.clientTop||r.clientTop||0);if(!e){var l=i.defaultView;a+=l.pageXOffset||s.scrollLeft||r.scrollLeft,o+=l.pageYOffset||s.scrollTop||r.scrollTop}return new v(a,o,n.width,n.height)},getViewportBounds:function(t){var e=t.ownerDocument,n=e.defaultView,i=e.documentElement;return new v(0,0,n.innerWidth||i.clientWidth,n.innerHeight||i.clientHeight)},getOffset:function(t,e){return q.getBounds(t,e).getPoint()},getSize:function(t){return q.getBounds(t,!0).getSize()},isInvisible:function(t){return q.getSize(t).equals(new m(0,0))},isInView:function(t){return!q.isInvisible(t)&&q.getViewportBounds(t).intersects(q.getBounds(t,!0))},isInserted:function(t){return i.body.contains(t)},getPrefixed:function(e,n){return e&&t(e,n)},setPrefixed:function(e,n,i){if("object"==typeof n)for(var r in n)t(e,r,!0,n[r]);else t(e,n,!0,i)}}},X={add:function(t,e){if(t)for(var n in e)for(var r=e[n],s=n.split(/[\s,]+/g),a=0,o=s.length;a<o;a++){var l=s[a],h=t===i&&("touchstart"===l||"touchmove"===l)&&{passive:!1};t.addEventListener(l,r,h)}},remove:function(t,e){if(t)for(var n in e)for(var i=e[n],r=n.split(/[\s,]+/g),s=0,a=r.length;s<a;s++)t.removeEventListener(r[s],i,!1)},getPoint:function(t){var e=t.targetTouches?t.targetTouches.length?t.targetTouches[0]:t.changedTouches[0]:t;return new p(e.pageX||e.clientX+i.documentElement.scrollLeft,e.pageY||e.clientY+i.documentElement.scrollTop)},getTarget:function(t){return t.target||t.srcElement},getRelatedTarget:function(t){return t.relatedTarget||t.toElement},getOffset:function(t,e){return X.getPoint(t).subtract(q.getOffset(e||X.getTarget(t)))}};X.requestAnimationFrame=new function(){var t,e=q.getPrefixed(n,"requestAnimationFrame"),i=!1,r=[];function s(){var t=r;r=[];for(var n=0,a=t.length;n<a;n++)t[n]();(i=e&&r.length)&&e(s)}return function(n){r.push(n),e?i||(e(s),i=!0):t||(t=setInterval(s,1e3/60))}};var j=s.extend(a,{_class:"View",initialize:function t(e,r){function s(t){return r[t]||parseInt(r.getAttribute(t),10)}function a(){var t=q.getSize(r);return t.isNaN()||t.isZero()?new m(s("width"),s("height")):t}var l;if(n&&r){this._id=r.getAttribute("id"),null==this._id&&r.setAttribute("id",this._id="paper-view-"+t._id++),X.add(r,this._viewEvents);var h="none";if(q.setPrefixed(r.style,{userDrag:h,userSelect:h,touchCallout:h,contentZooming:h,tapHighlightColor:"rgba(0,0,0,0)"}),o.hasAttribute(r,"resize")){var c=this;X.add(n,this._windowEvents={resize:function(){c.setViewSize(a())}})}if(l=a(),o.hasAttribute(r,"stats")&&"undefined"!=typeof Stats){this._stats=new Stats;var u=this._stats.domElement,d=u.style,p=q.getOffset(r);d.position="absolute",d.left=p.x+"px",d.top=p.y+"px",i.body.appendChild(u)}}else l=new m(r),r=null;this._project=e,this._scope=e._scope,this._element=r,this._pixelRatio||(this._pixelRatio=n&&n.devicePixelRatio||1),this._setElementSize(l.width,l.height),this._viewSize=l,t._views.push(this),t._viewsById[this._id]=this,(this._matrix=new x)._owner=this,t._focused||(t._focused=this),this._frameItems={},this._frameItemCount=0,this._itemEvents={native:{},virtual:{}},this._autoUpdate=!lt.agent.node,this._needsUpdate=!1},remove:function(){if(!this._project)return!1;j._focused===this&&(j._focused=null),j._views.splice(j._views.indexOf(this),1),delete j._viewsById[this._id];var t=this._project;return t._view===this&&(t._view=null),X.remove(this._element,this._viewEvents),X.remove(n,this._windowEvents),this._element=this._project=null,this.off("frame"),this._animate=!1,this._frameItems={},!0},_events:s.each(b._itemHandlers.concat(["onResize","onKeyDown","onKeyUp"]),(function(t){this[t]={}}),{onFrame:{install:function(){this.play()},uninstall:function(){this.pause()}}}),_animate:!1,_time:0,_count:0,getAutoUpdate:function(){return this._autoUpdate},setAutoUpdate:function(t){this._autoUpdate=t,t&&this.requestUpdate()},update:function(){},draw:function(){this.update()},requestUpdate:function(){if(!this._requested){var t=this;X.requestAnimationFrame((function(){if(t._requested=!1,t._animate){t.requestUpdate();var e=t._element;q.getPrefixed(i,"hidden")&&"true"!==o.getAttribute(e,"keepalive")||!q.isInView(e)||t._handleFrame()}t._autoUpdate&&t.update()})),this._requested=!0}},play:function(){this._animate=!0,this.requestUpdate()},pause:function(){this._animate=!1},_handleFrame:function(){lt=this._scope;var t=Date.now()/1e3,e=this._last?t-this._last:0;this._last=t,this.emit("frame",new s({delta:e,time:this._time+=e,count:this._count++})),this._stats&&this._stats.update()},_animateItem:function(t,e){var n=this._frameItems;e?(n[t._id]={item:t,time:0,count:0},1==++this._frameItemCount&&this.on("frame",this._handleFrameItems)):(delete n[t._id],0==--this._frameItemCount&&this.off("frame",this._handleFrameItems))},_handleFrameItems:function(t){for(var e in this._frameItems){var n=this._frameItems[e];n.item.emit("frame",new s(t,{time:n.time+=t.delta,count:n.count++}))}},_changed:function(){this._project._changed(4097),this._bounds=this._decomposed=e},getElement:function(){return this._element},getPixelRatio:function(){return this._pixelRatio},getResolution:function(){return 72*this._pixelRatio},getViewSize:function(){var t=this._viewSize;return new g(t.width,t.height,this,"setViewSize")},setViewSize:function(){var t=m.read(arguments),e=t.subtract(this._viewSize);e.isZero()||(this._setElementSize(t.width,t.height),this._viewSize.set(t),this._changed(),this.emit("resize",{size:t,delta:e}),this._autoUpdate&&this.update())},_setElementSize:function(t,e){var n=this._element;n&&(n.width!==t&&(n.width=t),n.height!==e&&(n.height=e))},getBounds:function(){return this._bounds||(this._bounds=this._matrix.inverted()._transformBounds(new v(new p,this._viewSize))),this._bounds},getSize:function(){return this.getBounds().getSize()},isVisible:function(){return q.isInView(this._element)},isInserted:function(){return q.isInserted(this._element)},getPixelSize:function(t){var e,n=this._element;if(n){var r=n.parentNode,s=i.createElement("div");s.style.fontSize=t,r.appendChild(s),e=parseFloat(q.getStyles(s).fontSize),r.removeChild(s)}else e=parseFloat(e);return e},getTextWidth:function(t,e){return 0}},s.each(["rotate","scale","shear","skew"],(function(t){var e="rotate"===t;this[t]=function(){var n=arguments,i=(e?s:p).read(n),r=p.read(n,0,{readNull:!0});return this.transform((new x)[t](i,r||this.getCenter(!0)))}}),{_decompose:function(){return this._decomposed||(this._decomposed=this._matrix.decompose())},translate:function(){var t=new x;return this.transform(t.translate.apply(t,arguments))},getCenter:function(){return this.getBounds().getCenter()},setCenter:function(){var t=p.read(arguments);this.translate(this.getCenter().subtract(t))},getZoom:function(){var t=this._decompose().scaling;return(t.x+t.y)/2},setZoom:function(t){this.transform((new x).scale(t/this.getZoom(),this.getCenter()))},getRotation:function(){return this._decompose().rotation},setRotation:function(t){var e=this.getRotation();null!=e&&null!=t&&this.rotate(t-e)},getScaling:function(){var t=this._decompose().scaling;return new f(t.x,t.y,this,"setScaling")},setScaling:function(){var t=this.getScaling(),e=p.read(arguments,0,{clone:!0,readNull:!0});t&&e&&this.scale(e.x/t.x,e.y/t.y)},getMatrix:function(){return this._matrix},setMatrix:function(){var t=this._matrix;t.set.apply(t,arguments)},transform:function(t){this._matrix.append(t)},scrollBy:function(){this.translate(p.read(arguments).negate())}}),{projectToView:function(){return this._matrix._transformPoint(p.read(arguments))},viewToProject:function(){return this._matrix._inverseTransform(p.read(arguments))},getEventPoint:function(t){return this.viewToProject(X.getOffset(t,this._element))}},{statics:{_views:[],_viewsById:{},_id:0,create:function(t,e){return i&&"string"==typeof e&&(e=i.getElementById(e)),new(n?J:j)(t,e)}}},new function(){if(n){var t,e,r,s,a,o=!1,l=!1,h=n.navigator;h.pointerEnabled||h.msPointerEnabled?(r="pointerdown MSPointerDown",s="pointermove MSPointerMove",a="pointerup pointercancel MSPointerUp MSPointerCancel"):(r="touchstart",s="touchmove",a="touchend touchcancel","ontouchstart"in n&&h.userAgent.match(/mobile|tablet|ip(ad|hone|od)|android|silk/i)||(r+=" mousedown",s+=" mousemove",a+=" mouseup"));var c={},u={mouseout:function(t){var e=j._focused,n=X.getRelatedTarget(t);if(e&&(!n||"HTML"===n.nodeName)){var i=X.getOffset(t,e._element),r=i.x,s=Math.abs,a=s(r),o=a-(1<<25);i.x=s(o)<a?o*(r<0?-1:1):r,E(e,t,e.viewToProject(i))}},scroll:T};c[r]=function(t){var e=j._focused=C(t);o||(o=!0,e._handleMouseEvent("mousedown",t))},u[s]=function(n){var i=j._focused;if(!l){var r=C(n);r?i!==r&&(i&&E(i,n),t||(t=i),i=j._focused=e=r):e&&e===i&&(t&&!t.isInserted()&&(t=null),i=j._focused=t,t=null,T())}i&&E(i,n)},u[r]=function(){l=!0},u[a]=function(t){var e=j._focused;e&&o&&e._handleMouseEvent("mouseup",t),l=o=!1},X.add(i,u),X.add(n,{load:T});var d,p,f,m,g,v,_,x,y=!1,S=!1,b={doubleclick:"click",mousedrag:"mousemove"},M=!1,w={mousedown:{mousedown:1,mousedrag:1,click:1,doubleclick:1},mouseup:{mouseup:1,mousedrag:1,click:1,doubleclick:1},mousemove:{mousedrag:1,mousemove:1,mouseenter:1,mouseleave:1}};return{_viewEvents:c,_handleMouseEvent:function(t,e,n){var i=this._itemEvents,r=i.native[t],s="mousemove"===t,a=this._scope.tool,l=this;function h(t){return i.virtual[t]||l.responds(t)||a&&a.responds(t)}s&&o&&h("mousedrag")&&(t="mousedrag"),n||(n=this.getEventPoint(e));var c=this.getBounds().contains(n),u=r&&c&&l._project.hitTest(n,{tolerance:0,fill:!0,stroke:!0}),b=u&&u.item||null,w=!1,C={};if(C[t.substr(5)]=!0,r&&b!==m&&(m&&A(m,null,"mouseleave",e,n),b&&A(b,null,"mouseenter",e,n),m=b),M^c&&(A(this,null,c?"mouseenter":"mouseleave",e,n),w=!0),!c&&!C.drag||n.equals(p)||(P(this,b,s?t:"mousemove",e,n,p),w=!0),M=c,C.down&&c||C.up&&d){if(P(this,b,t,e,n,d),C.down){if(x=b===v&&Date.now()-_<300,f=v=b,!S&&b){for(var T=b;T&&!T.responds("mousedrag");)T=T._parent;T&&(g=b)}d=n}else C.up&&(S||b!==f||(_=Date.now(),P(this,b,x?"doubleclick":"click",e,n,d),x=!1),f=g=null);M=!1,w=!0}p=n,w&&a&&(y=a._handleMouseEvent(t,e,n,C)||y),!1!==e.cancelable&&(y&&!C.move||C.down&&h("mouseup"))&&e.preventDefault()},_handleKeyEvent:function(t,e,n,i){var r,s=this._scope,a=s.tool;function o(a){a.responds(t)&&(lt=s,a.emit(t,r=r||new Z(t,e,n,i)))}this.isVisible()&&(o(this),a&&a.responds(t)&&o(a))},_countItemEvent:function(t,e){var n=this._itemEvents,i=n.native,r=n.virtual;for(var s in w)i[s]=(i[s]||0)+(w[s][t]||0)*e;r[t]=(r[t]||0)+e},statics:{updateFocus:T,_resetState:function(){o=l=y=M=!1,t=e=d=p=f=m=g=v=_=x=null}}}}function C(t){var e=X.getTarget(t);return e.getAttribute&&j._viewsById[e.getAttribute("id")]}function T(){var t=j._focused;if(!t||!t.isVisible())for(var n=0,i=j._views.length;n<i;n++)if((t=j._views[n]).isVisible()){j._focused=e=t;break}}function E(t,e,n){t._handleMouseEvent("mousemove",e,n)}function A(t,e,n,i,r,s,a){var o,l=!1;function h(t,n){if(t.responds(n)){if(o||(o=new $(n,i,r,e||t,s?r.subtract(s):null)),t.emit(n,o)&&(y=!0,o.prevented&&(S=!0),o.stopped))return l=!0}else{var a=b[n];if(a)return h(t,a)}}for(;t&&t!==a&&!h(t,n);)t=t._parent;return l}function P(t,e,n,i,r,s){return t._project.removeOn(n),S=y=!1,g&&A(g,null,n,i,r,s)||e&&e!==g&&!e.isDescendant(g)&&A(e,null,"mousedrag"===n?"mousemove":n,i,r,s,g)||A(t,g||e||t,n,i,r,s)}}),J=j.extend({_class:"CanvasView",initialize:function(t,e){if(!(e instanceof n.HTMLCanvasElement)){var i=m.read(arguments,1);if(i.isZero())throw new Error("Cannot create CanvasView with the provided argument: "+s.slice(arguments,1));e=rt.getCanvas(i)}var r=this._context=e.getContext("2d");if(r.save(),this._pixelRatio=1,!/^off|false$/.test(o.getAttribute(e,"hidpi"))){var a=n.devicePixelRatio||1,l=q.getPrefixed(r,"backingStorePixelRatio")||1;this._pixelRatio=a/l}j.call(this,t,e),this._needsUpdate=!0},remove:function t(){return this._context.restore(),t.base.call(this)},_setElementSize:function t(e,n){var i=this._pixelRatio;if(t.base.call(this,e*i,n*i),1!==i){var r=this._element,s=this._context;if(!o.hasAttribute(r,"resize")){var a=r.style;a.width=e+"px",a.height=n+"px"}s.restore(),s.save(),s.scale(i,i)}},getContext:function(){return this._context},getPixelSize:function t(e){var n,i=lt.agent;if(i&&i.firefox)n=t.base.call(this,e);else{var r=this._context,s=r.font;r.font=e+" serif",n=parseFloat(r.font),r.font=s}return n},getTextWidth:function(t,e){var n=this._context,i=n.font,r=0;n.font=t;for(var s=0,a=e.length;s<a;s++)r=Math.max(r,n.measureText(e[s]).width);return n.font=i,r},update:function(){if(!this._needsUpdate)return!1;var t=this._project,e=this._context,n=this._viewSize;return e.clearRect(0,0,n.width+1,n.height+1),t&&t.draw(e,this._matrix,this._pixelRatio),this._needsUpdate=!1,!0}}),K=s.extend({_class:"Event",initialize:function(t){this.event=t,this.type=t&&t.type},prevented:!1,stopped:!1,preventDefault:function(){this.prevented=!0,this.event.preventDefault()},stopPropagation:function(){this.stopped=!0,this.event.stopPropagation()},stop:function(){this.stopPropagation(),this.preventDefault()},getTimeStamp:function(){return this.event.timeStamp},getModifiers:function(){return Y.modifiers}}),Z=K.extend({_class:"KeyEvent",initialize:function(t,e,n,i){this.type=t,this.event=e,this.key=n,this.character=i},toString:function(){return"{ type: '"+this.type+"', key: '"+this.key+"', character: '"+this.character+"', modifiers: "+this.getModifiers()+" }"}}),Y=new function(){var t,r,a={"\t":"tab"," ":"space","\b":"backspace","":"delete",Spacebar:"space",Del:"delete",Win:"meta",Esc:"escape"},o={tab:"\t",space:" ",enter:"\r"},l={},h={},c=new s({shift:!1,control:!1,alt:!1,meta:!1,capsLock:!1,space:!1}).inject({option:{get:function(){return this.alt}},command:{get:function(){var t=lt&&lt.agent;return t&&t.mac?this.meta:this.control}}});function u(t){var n=t.key||t.keyIdentifier;return n=/^U\+/.test(n)?String.fromCharCode(parseInt(n.substr(2),16)):/^Arrow[A-Z]/.test(n)?n.substr(5):"Unidentified"===n||n===e?String.fromCharCode(t.keyCode):n,a[n]||(n.length>1?s.hyphenate(n):n.toLowerCase())}function d(e,n,i,r){var a,o=j._focused;if(l[n]=e,e?h[n]=i:delete h[n],n.length>1&&(a=s.camelize(n))in c){c[a]=e;var u=lt&&lt.agent;if("meta"===a&&u&&u.mac)if(e)t={};else{for(var p in t)p in h&&d(!1,p,t[p],r);t=null}}else e&&t&&(t[n]=i);o&&o._handleKeyEvent(e?"keydown":"keyup",r,n,i)}return X.add(i,{keydown:function(t){var e=u(t),n=lt&&lt.agent;e.length>1||n&&n.chrome&&(t.altKey||n.mac&&t.metaKey||!n.mac&&t.ctrlKey)?d(!0,e,o[e]||(e.length>1?"":e),t):r=e},keypress:function(t){if(r){var e=u(t),n=t.charCode,i=n>=32?String.fromCharCode(n):e.length>1?"":e;e!==r&&(e=i.toLowerCase()),d(!0,e,i,t),r=null}},keyup:function(t){var e=u(t);e in h&&d(!1,e,h[e],t)}}),X.add(n,{blur:function(t){for(var e in h)d(!1,e,h[e],t)}}),{modifiers:c,isDown:function(t){return!!l[t]}}},$=K.extend({_class:"MouseEvent",initialize:function(t,e,n,i,r){this.type=t,this.event=e,this.point=n,this.target=i,this.delta=r},toString:function(){return"{ type: '"+this.type+"', point: "+this.point+", target: "+this.target+(this.delta?", delta: "+this.delta:"")+", modifiers: "+this.getModifiers()+" }"}}),tt=K.extend({_class:"ToolEvent",_item:null,initialize:function(t,e,n){this.tool=t,this.type=e,this.event=n},_choosePoint:function(t,e){return t||(e?e.clone():null)},getPoint:function(){return this._choosePoint(this._point,this.tool._point)},setPoint:function(t){this._point=t},getLastPoint:function(){return this._choosePoint(this._lastPoint,this.tool._lastPoint)},setLastPoint:function(t){this._lastPoint=t},getDownPoint:function(){return this._choosePoint(this._downPoint,this.tool._downPoint)},setDownPoint:function(t){this._downPoint=t},getMiddlePoint:function(){return!this._middlePoint&&this.tool._lastPoint?this.tool._point.add(this.tool._lastPoint).divide(2):this._middlePoint},setMiddlePoint:function(t){this._middlePoint=t},getDelta:function(){return!this._delta&&this.tool._lastPoint?this.tool._point.subtract(this.tool._lastPoint):this._delta},setDelta:function(t){this._delta=t},getCount:function(){return this.tool[/^mouse(down|up)$/.test(this.type)?"_downCount":"_moveCount"]},setCount:function(t){this.tool[/^mouse(down|up)$/.test(this.type)?"downCount":"count"]=t},getItem:function(){if(!this._item){var t=this.tool._scope.project.hitTest(this.getPoint());if(t){for(var e=t.item,n=e._parent;/^(Group|CompoundPath)$/.test(n._class);)e=n,n=n._parent;this._item=e}}return this._item},setItem:function(t){this._item=t},toString:function(){return"{ type: "+this.type+", point: "+this.getPoint()+", count: "+this.getCount()+", modifiers: "+this.getModifiers()+" }"}}),et=l.extend({_class:"Tool",_list:"tools",_reference:"tool",_events:["onMouseDown","onMouseUp","onMouseDrag","onMouseMove","onActivate","onDeactivate","onEditOptions","onKeyDown","onKeyUp"],initialize:function(t){l.call(this),this._moveCount=-1,this._downCount=-1,this.set(t)},getMinDistance:function(){return this._minDistance},setMinDistance:function(t){this._minDistance=t,null!=t&&null!=this._maxDistance&&t>this._maxDistance&&(this._maxDistance=t)},getMaxDistance:function(){return this._maxDistance},setMaxDistance:function(t){this._maxDistance=t,null!=this._minDistance&&null!=t&&t<this._minDistance&&(this._minDistance=t)},getFixedDistance:function(){return this._minDistance==this._maxDistance?this._minDistance:null},setFixedDistance:function(t){this._minDistance=this._maxDistance=t},_handleMouseEvent:function(t,e,n,i){lt=this._scope,i.drag&&!this.responds(t)&&(t="mousemove");var r=i.move||i.drag,s=this.responds(t),a=this.minDistance,o=this.maxDistance,l=!1,h=this;function c(t,e){var s=n,a=r?h._point:h._downPoint||s;if(r){if(h._moveCount>=0&&s.equals(a))return!1;if(a&&(null!=t||null!=e)){var o=s.subtract(a),l=o.getLength();if(l<(t||0))return!1;e&&(s=a.add(o.normalize(Math.min(l,e))))}h._moveCount++}return h._point=s,h._lastPoint=a||s,i.down&&(h._moveCount=-1,h._downPoint=s,h._downCount++),!0}function u(){s&&(l=h.emit(t,new tt(h,t,e))||l)}if(i.down)c(),u();else if(i.up)c(null,o),u();else if(s)for(;c(a,o);)u();return l}}),nt=s.extend(a,{_class:"Tween",statics:{easings:new s({linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return t*(2-t)},easeInOutQuad:function(t){return t<.5?2*t*t:2*(2-t)*t-1},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return--t*t*t+1},easeInOutCubic:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return 1- --t*t*t*t},easeInOutQuart:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},easeInQuint:function(t){return t*t*t*t*t},easeOutQuint:function(t){return 1+--t*t*t*t*t},easeInOutQuint:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}})},initialize:function t(e,n,i,r,s,a){this.object=e;var o=typeof s,l="function"===o;this.type=l?o:"string"===o?s:"linear",this.easing=l?s:t.easings[this.type],this.duration=r,this.running=!1,this._then=null,this._startTime=null;var h=n||i;this._keys=h?Object.keys(h):[],this._parsedKeys=this._parseKeys(this._keys),this._from=h&&this._getState(n),this._to=h&&this._getState(i),!1!==a&&this.start()},then:function(t){return this._then=t,this},start:function(){return this._startTime=null,this.running=!0,this},stop:function(){return this.running=!1,this},update:function(t){if(this.running){t>=1&&(t=1,this.running=!1);for(var e=this.easing(t),n=this._keys,i=function(n){return"function"==typeof n?n(e,t):n},r=0,a=n&&n.length;r<a;r++){var o=n[r],l=i(this._from[o]),h=i(this._to[o]),c=l&&h&&l.__add&&h.__add?h.__subtract(l).__multiply(e).__add(l):(h-l)*e+l;this._setProperty(this._parsedKeys[o],c)}this.responds("update")&&this.emit("update",new s({progress:t,factor:e})),!this.running&&this._then&&this._then(this.object)}return this},_events:{onUpdate:{}},_handleFrame:function(t){var e=this._startTime,n=e?(t-e)/this.duration:0;e||(this._startTime=t),this.update(n)},_getState:function(t){for(var e=this._keys,n={},i=0,r=e.length;i<r;i++){var s,a=e[i],o=this._parsedKeys[a],l=this._getProperty(o);if(t){var h=this._resolveValue(l,t[a]);this._setProperty(o,h),s=(s=this._getProperty(o))&&s.clone?s.clone():s,this._setProperty(o,l)}else s=l&&l.clone?l.clone():l;n[a]=s}return n},_resolveValue:function(t,e){if(e){if(Array.isArray(e)&&2===e.length){var n=e[0];return n&&n.match&&n.match(/^[+\-\*\/]=/)?this._calculate(t,n[0],e[1]):e}if("string"==typeof e){var i=e.match(/^[+\-*/]=(.*)/);if(i){var r=JSON.parse(i[1].replace(/(['"])?([a-zA-Z0-9_]+)(['"])?:/g,'"$2": '));return this._calculate(t,e[0],r)}}}return e},_calculate:function(t,e,n){return lt.PaperScript.calculateBinary(t,e,n)},_parseKeys:function(t){for(var e={},n=0,i=t.length;n<i;n++){var r=t[n],s=r.replace(/\.([^.]*)/g,"/$1").replace(/\[['"]?([^'"\]]*)['"]?\]/g,"/$1");e[r]=s.split("/")}return e},_getProperty:function(t,e){for(var n=this.object,i=0,r=t.length-(e||0);i<r&&n;i++)n=n[t[i]];return n},_setProperty:function(t,e){var n=this._getProperty(t,1);n&&(n[t[t.length-1]]=e)}}),it=function(e){var n=new t.XMLHttpRequest;return n.open((e.method||"get").toUpperCase(),e.url,s.pick(e.async,!0)),e.mimeType&&n.overrideMimeType(e.mimeType),n.onload=function(){var t=n.status;0===t||200===t?e.onLoad&&e.onLoad.call(n,n.responseText):n.onerror()},n.onerror=function(){var t=n.status,i='Could not load "'+e.url+'" (Status: '+t+")";if(!e.onError)throw new Error(i);e.onError(i,t)},n.send(null)},rt=s.exports.CanvasProvider={canvases:[],getCanvas:function(t,e,r){if(!n)return null;var s,a=!0;"object"==typeof t&&(e=t.height,t=t.width),this.canvases.length?s=this.canvases.pop():(s=i.createElement("canvas"),a=!1);var o=s.getContext("2d",r||{});if(!o)throw new Error("Canvas "+s+" is unable to provide a 2D context.");return s.width===t&&s.height===e?a&&o.clearRect(0,0,t+1,e+1):(s.width=t,s.height=e),o.save(),s},getContext:function(t,e,n){var i=this.getCanvas(t,e,n);return i?i.getContext("2d",n||{}):null},release:function(t){var e=t&&t.canvas?t.canvas:t;e&&e.getContext&&(e.getContext("2d").restore(),this.canvases.push(e))}},st=new function(){var t,e,n,i,r,a,o,l,h,c,u,d=Math.min,p=Math.max,f=Math.abs;function m(t,e,n){return.2989*t+.587*e+.114*n}function g(t,e,n,i){var r=i-m(t,e,n),s=(i=m(h=t+r,c=e+r,u=n+r),d(h,c,u)),a=p(h,c,u);if(s<0){var o=i-s;h=i+(h-i)*i/o,c=i+(c-i)*i/o,u=i+(u-i)*i/o}if(a>255){var l=255-i,f=a-i;h=i+(h-i)*l/f,c=i+(c-i)*l/f,u=i+(u-i)*l/f}}function v(t,e,n){return p(t,e,n)-d(t,e,n)}function _(t,e,n,i){var r,s=[t,e,n],a=p(t,e,n),o=d(t,e,n);r=0===d(o=o===t?0:o===e?1:2,a=a===t?0:a===e?1:2)?1===p(o,a)?2:1:0,s[a]>s[o]?(s[r]=(s[r]-s[o])*i/(s[a]-s[o]),s[a]=i):s[r]=s[a]=0,s[o]=0,h=s[0],c=s[1],u=s[2]}var x={multiply:function(){h=r*t/255,c=a*e/255,u=o*n/255},screen:function(){h=r+t-r*t/255,c=a+e-a*e/255,u=o+n-o*n/255},overlay:function(){h=r<128?2*r*t/255:255-2*(255-r)*(255-t)/255,c=a<128?2*a*e/255:255-2*(255-a)*(255-e)/255,u=o<128?2*o*n/255:255-2*(255-o)*(255-n)/255},"soft-light":function(){var i=t*r/255;h=i+r*(255-(255-r)*(255-t)/255-i)/255,c=(i=e*a/255)+a*(255-(255-a)*(255-e)/255-i)/255,u=(i=n*o/255)+o*(255-(255-o)*(255-n)/255-i)/255},"hard-light":function(){h=t<128?2*t*r/255:255-2*(255-t)*(255-r)/255,c=e<128?2*e*a/255:255-2*(255-e)*(255-a)/255,u=n<128?2*n*o/255:255-2*(255-n)*(255-o)/255},"color-dodge":function(){h=0===r?0:255===t?255:d(255,255*r/(255-t)),c=0===a?0:255===e?255:d(255,255*a/(255-e)),u=0===o?0:255===n?255:d(255,255*o/(255-n))},"color-burn":function(){h=255===r?255:0===t?0:p(0,255-255*(255-r)/t),c=255===a?255:0===e?0:p(0,255-255*(255-a)/e),u=255===o?255:0===n?0:p(0,255-255*(255-o)/n)},darken:function(){h=r<t?r:t,c=a<e?a:e,u=o<n?o:n},lighten:function(){h=r>t?r:t,c=a>e?a:e,u=o>n?o:n},difference:function(){(h=r-t)<0&&(h=-h),(c=a-e)<0&&(c=-c),(u=o-n)<0&&(u=-u)},exclusion:function(){h=r+t*(255-r-r)/255,c=a+e*(255-a-a)/255,u=o+n*(255-o-o)/255},hue:function(){_(t,e,n,v(r,a,o)),g(h,c,u,m(r,a,o))},saturation:function(){_(r,a,o,v(t,e,n)),g(h,c,u,m(r,a,o))},luminosity:function(){g(r,a,o,m(t,e,n))},color:function(){g(t,e,n,m(r,a,o))},add:function(){h=d(r+t,255),c=d(a+e,255),u=d(o+n,255)},subtract:function(){h=p(r-t,0),c=p(a-e,0),u=p(o-n,0)},average:function(){h=(r+t)/2,c=(a+e)/2,u=(o+n)/2},negation:function(){h=255-f(255-t-r),c=255-f(255-e-a),u=255-f(255-n-o)}},y=this.nativeModes=s.each(["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],(function(t){this[t]=!0}),{}),S=rt.getContext(1,1,{willReadFrequently:!0});S&&(s.each(x,(function(t,e){var n="darken"===e,i=!1;S.save();try{S.fillStyle=n?"#300":"#a00",S.fillRect(0,0,1,1),S.globalCompositeOperation=e,S.globalCompositeOperation===e&&(S.fillStyle=n?"#a00":"#300",S.fillRect(0,0,1,1),i=S.getImageData(0,0,1,1).data[0]!==n?170:51)}catch(r){}S.restore(),y[e]=i})),rt.release(S)),this.process=function(s,d,p,f,m){var g=d.canvas,v="normal"===s;if(v||y[s])p.save(),p.setTransform(1,0,0,1,0,0),p.globalAlpha=f,v||(p.globalCompositeOperation=s),p.drawImage(g,m.x,m.y),p.restore();else{var _=x[s];if(!_)return;for(var S=p.getImageData(m.x,m.y,g.width,g.height),b=S.data,M=d.getImageData(0,0,g.width,g.height).data,w=0,C=b.length;w<C;w+=4){t=M[w],r=b[w],e=M[w+1],a=b[w+1],n=M[w+2],o=b[w+2],i=M[w+3],l=b[w+3],_();var T=i*f/255,E=1-T;b[w]=T*h+E*r,b[w+1]=T*c+E*a,b[w+2]=T*u+E*o,b[w+3]=i*f+E*l}p.putImageData(S,m.x,m.y)}}},at=new function(){var t="http://www.w3.org/2000/svg",e="http://www.w3.org/2000/xmlns",n="http://www.w3.org/1999/xlink",r={href:n,xlink:e,xmlns:e+"/","xmlns:xlink":e+"/"};function s(t,e,n){for(var i in e){var s=e[i],a=r[i];"number"==typeof s&&n&&(s=n.number(s)),a?t.setAttributeNS(a,i,s):t.setAttribute(i,s)}return t}return{svg:t,xmlns:e,xlink:n,create:function(e,n,r){return s(i.createElementNS(t,e),n,r)},get:function(t,e){var n=r[e],i=n?t.getAttributeNS(n,e):t.getAttribute(e);return"null"===i?null:i},set:s}},ot=s.each({fillColor:["fill","color"],fillRule:["fill-rule","string"],strokeColor:["stroke","color"],strokeWidth:["stroke-width","number"],strokeCap:["stroke-linecap","string"],strokeJoin:["stroke-linejoin","string"],strokeScaling:["vector-effect","lookup",{true:"none",false:"non-scaling-stroke"},function(t,e){return!e&&(t instanceof k||t instanceof C||t instanceof F)}],miterLimit:["stroke-miterlimit","number"],dashArray:["stroke-dasharray","array"],dashOffset:["stroke-dashoffset","number"],fontFamily:["font-family","string"],fontWeight:["font-weight","string"],fontSize:["font-size","number"],justification:["text-anchor","lookup",{left:"start",center:"middle",right:"end"}],opacity:["opacity","number"],blendMode:["mix-blend-mode","style"]},(function(t,e){var n=s.capitalize(e),i=t[2];this[e]={type:t[1],property:e,attribute:t[0],toSVG:i,fromSVG:i&&s.each(i,(function(t,e){this[t]=e}),{}),exportFilter:t[3],get:"get"+n,set:"set"+n}}),{});new function(){var e;function n(t,n,i){var r,a=new s,o=t.getTranslation();if(n&&(t.isInvertible()?(r=(t=t._shiftless())._inverseTransform(o),o=null):r=new p,a[i?"cx":"x"]=r.x,a[i?"cy":"y"]=r.y),!t.isIdentity()){var l=t.decompose();if(l){var h=[],c=l.rotation,d=l.scaling,f=l.skewing;o&&!o.isZero()&&h.push("translate("+e.point(o)+")"),c&&h.push("rotate("+e.number(c)+")"),u.isZero(d.x-1)&&u.isZero(d.y-1)||h.push("scale("+e.point(d)+")"),f.x&&h.push("skewX("+e.number(f.x)+")"),f.y&&h.push("skewY("+e.number(f.y)+")"),a.transform=h.join(" ")}else a.transform="matrix("+t.getValues().join(",")+")"}return a}function i(t,i){for(var r=n(t._matrix),s=t._children,a=at.create("g",r,e),o=0,l=s.length;o<l;o++){var h=s[o],c=g(h,i);if(c)if(h.isClipMask()){var u=at.create("clipPath");u.appendChild(c),f(h,u,"clip"),at.set(a,{"clip-path":"url(#"+u.id+")"})}else a.appendChild(c)}return a}function r(t){var i=t._type,r=t._radius,s=n(t._matrix,!0,"rectangle"!==i);if("rectangle"===i){i="rect";var a=t._size,o=a.width,l=a.height;s.x-=o/2,s.y-=l/2,s.width=o,s.height=l,r.isZero()&&(r=null)}return r&&("circle"===i?s.r=r:(s.rx=r.width,s.ry=r.height)),at.create(i,s,e)}var a,o={Group:i,Layer:i,Raster:function(t,i){var r=n(t._matrix,!0),s=t.getSize(),a=t.getImage();return r.x-=s.width/2,r.y-=s.height/2,r.width=s.width,r.height=s.height,r.href=0==i.embedImages&&a&&a.src||t.toDataURL(),at.create("image",r,e)},Path:function(t,i){var s=i.matchShapes;if(s){var a=t.toShape(!1);if(a)return r(a)}var o,l=t._segments,h=l.length,c=n(t._matrix);if(s&&h>=2&&!t.hasHandles())if(h>2){o=t._closed?"polygon":"polyline";for(var u=[],d=0;d<h;d++)u.push(e.point(l[d]._point));c.points=u.join(" ")}else{o="line";var p=l[0]._point,f=l[1]._point;c.set({x1:p.x,y1:p.y,x2:f.x,y2:f.y})}else o="path",c.d=t.getPathData(null,i.precision);return at.create(o,c,e)},Shape:r,CompoundPath:function(t,i){var r=n(t._matrix),s=t.getPathData(null,i.precision);return s&&(r.d=s),at.create("path",r,e)},SymbolItem:function(t,i){var r=n(t._matrix,!0),s=t._definition,a=h(s,"symbol"),o=s._item,l=o.getStrokeBounds();return a||((a=at.create("symbol",{viewBox:e.rectangle(l)})).appendChild(g(o,i)),f(s,a,"symbol")),r.href="#"+a.id,r.x+=l.x,r.y+=l.y,r.width=l.width,r.height=l.height,r.overflow="visible",at.create("use",r,e)},PointText:function(t){var i=at.create("text",n(t._matrix,!0),e);return i.textContent=t._content,i}};function l(t,n,i){var r={},a=!i&&t.getParent(),o=[];return null!=t._name&&(r.id=t._name),s.each(ot,(function(n){var i=n.get,l=n.type,c=t[i]();if(n.exportFilter?n.exportFilter(t,c):!a||!s.equals(a[i](),c)){if("color"===l&&null!=c){var u=c.getAlpha();u<1&&(r[n.attribute+"-opacity"]=u)}"style"===l?o.push(n.attribute+": "+c):r[n.attribute]=null==c?"none":"color"===l?c.gradient?function(t){var n=h(t,"color");if(!n){var i,r=t.getGradient(),s=r._radial,a=t.getOrigin(),o=t.getDestination();if(s){i={cx:a.x,cy:a.y,r:a.getDistance(o)};var l=t.getHighlight();l&&(i.fx=l.x,i.fy=l.y)}else i={x1:a.x,y1:a.y,x2:o.x,y2:o.y};i.gradientUnits="userSpaceOnUse",n=at.create((s?"radial":"linear")+"Gradient",i,e);for(var c=r._stops,u=0,d=c.length;u<d;u++){var p=c[u],m=p._color,g=m.getAlpha(),v=p._offset;i={offset:null==v?u/(d-1):v},m&&(i["stop-color"]=m.toCSS(!0)),g<1&&(i["stop-opacity"]=g),n.appendChild(at.create("stop",i,e))}f(t,n,"color")}return"url(#"+n.id+")"}(c):c.toCSS(!0):"array"===l?c.join(","):"lookup"===l?n.toSVG[c]:c}})),o.length&&(r.style=o.join(";")),1===r.opacity&&delete r.opacity,t._visible||(r.visibility="hidden"),at.set(n,r,e)}function h(t,e){return a||(a={ids:{},svgs:{}}),t&&a.svgs[e+"-"+(t._id||t.__id||(t.__id=d.get("svg")))]}function f(t,e,n){a||h();var i=a.ids[n]=(a.ids[n]||0)+1;e.id=n+"-"+i,a.svgs[n+"-"+(t._id||t.__id)]=e}function m(e,n){var i=e,r=null;if(a){for(var s in i="svg"===e.nodeName.toLowerCase()&&e,a.svgs)r||(i||(i=at.create("svg")).appendChild(e),r=i.insertBefore(at.create("defs"),i.firstChild)),r.appendChild(a.svgs[s]);a=null}return n.asString?(new t.XMLSerializer).serializeToString(i):i}function g(t,e,n){var i=o[t._class],r=i&&i(t,e);if(r){var s=e.onExport;s&&(r=s(t,r,e)||r);var a=JSON.stringify(t._data);a&&"{}"!==a&&"null"!==a&&r.setAttribute("data-paper-data",a)}return r&&l(t,r,n)}function _(t){return t||(t={}),e=new c(t.precision),t}b.inject({exportSVG:function(t){return m(g(this,t=_(t),!0),t)}}),S.inject({exportSVG:function(t){t=_(t);var i=this._children,r=this.getView(),a=s.pick(t.bounds,"view"),o=t.matrix||"view"===a&&r._matrix,l=o&&x.read([o]),h="view"===a?new v([0,0],r.getViewSize()):"content"===a?b._getBounds(i,l,{stroke:!0}).rect:v.read([a],0,{readNull:!0}),c={version:"1.1",xmlns:at.svg,"xmlns:xlink":at.xlink};h&&(c.width=h.width,c.height=h.height,(h.x||0===h.x||h.y||0===h.y)&&(c.viewBox=e.rectangle(h)));var u=at.create("svg",c,e),d=u;l&&!l.isIdentity()&&(d=u.appendChild(at.create("g",n(l),e)));for(var p=0,f=i.length;p<f;p++)d.appendChild(g(i[p],t,!0));return m(u,t)}})},new function(){var r,a={};function o(t,e,n,i,s,a){var o=at.get(t,e)||a,l=null==o?i?null:n?"":0:n?o:parseFloat(o);return/%\s*$/.test(o)?l/100*(s?1:r[/x|^width/.test(e)?"width":"height"]):l}function l(t,e,n,i,r,s,a){return e=o(t,e||"x",!1,i,r,s),n=o(t,n||"y",!1,i,r,a),!i||null!=e&&null!=n?new p(e,n):null}function h(t,e,n,i,r){return e=o(t,e||"width",!1,i,r),n=o(t,n||"height",!1,i,r),!i||null!=e&&null!=n?new m(e,n):null}function c(t,e,n){return"none"===t?null:"number"===e?parseFloat(t):"array"===e?t?t.split(/[\s,]+/g).map(parseFloat):[]:"color"===e?R(t)||t:"lookup"===e?n[t]:t}function u(t,e,n,i){var r=t.childNodes,s="clippath"===e,a="defs"===e,o=new M,l=o._project,h=l._currentStyle,c=[];if(s||a||(o=P(o,t,i),l._currentStyle=o._style.clone()),i)for(var u=t.querySelectorAll("defs"),d=0,p=u.length;d<p;d++)W(u[d],n,!1);for(d=0,p=r.length;d<p;d++){var f,m=r[d];1!==m.nodeType||/^defs$/i.test(m.nodeName)||!(f=W(m,n,!1))||f instanceof A||c.push(f)}return o.addChildren(c),s&&(o=P(o.reduce(),t,i)),l._currentStyle=h,(s||a)&&(o.remove(),o=null),o}function d(t,e){for(var n=t.getAttribute("points").match(/[+-]?(?:\d*\.\d+|\d+\.?)(?:[eE][+-]?\d+)?/g),i=[],r=0,s=n.length;r<s;r+=2)i.push(new p(parseFloat(n[r]),parseFloat(n[r+1])));var a=new N(i);return"polygon"===e&&a.closePath(),a}function f(t,e){var n,i=(o(t,"href",!0)||"").substring(1),r="radialgradient"===e;if(i)(n=a[i].getGradient())._radial^r&&((n=n.clone())._radial=r);else{for(var s=t.childNodes,h=[],c=0,u=s.length;c<u;c++){var d=s[c];1===d.nodeType&&h.push(P(new G,d))}n=new V(h,r)}var p,f,m,g="userSpaceOnUse"!==o(t,"gradientUnits",!0);return r?(f=(p=l(t,"cx","cy",!1,g,"50%","50%")).add(o(t,"r",!1,!1,g,"50%"),0),m=l(t,"fx","fy",!0,g)):(p=l(t,"x1","y1",!1,g,"0%","0%"),f=l(t,"x2","y2",!1,g,"100%","0%")),P(new z(n,p,f,m),t)._scaleToBounds=g,null}var g={"#document":function(t,e,n,i){for(var r=t.childNodes,s=0,a=r.length;s<a;s++){var o=r[s];if(1===o.nodeType)return W(o,n,i)}},g:u,svg:u,clippath:u,polygon:d,polyline:d,path:function(t){return k.create(t.getAttribute("d"))},lineargradient:f,radialgradient:f,image:function(t){var e=new T(o(t,"href",!0));return e.on("load",(function(){var e=h(t);this.setSize(e);var n=l(t).add(e.divide(2));this._matrix.append((new x).translate(n))})),e},symbol:function(t,e,n,i){return new A(u(t,e,n,i),!0)},defs:u,use:function(t){var e=(o(t,"href",!0)||"").substring(1),n=a[e],i=l(t);return n?n instanceof A?n.place(i):n.clone().translate(i):null},circle:function(t){return new C.Circle(l(t,"cx","cy"),o(t,"r"))},ellipse:function(t){return new C.Ellipse({center:l(t,"cx","cy"),radius:h(t,"rx","ry")})},rect:function(t){return new C.Rectangle(new v(l(t),h(t)),h(t,"rx","ry"))},line:function(t){return new N.Line(l(t,"x1","y1"),l(t,"x2","y2"))},text:function(t){var e=new B(l(t).add(l(t,"dx","dy")));return e.setContent(t.textContent.trim()||""),e},switch:u};function _(t,e,n,i){if(t.transform){for(var r=(i.getAttribute(n)||"").split(/\)\s*/g),s=new x,a=0,o=r.length;a<o;a++){var l=r[a];if(!l)break;for(var h=l.split(/\(\s*/),c=h[0],u=h[1].split(/[\s,]+/g),d=0,p=u.length;d<p;d++)u[d]=parseFloat(u[d]);switch(c){case"matrix":s.append(new x(u[0],u[1],u[2],u[3],u[4],u[5]));break;case"rotate":s.rotate(u[0],u[1]||0,u[2]||0);break;case"translate":s.translate(u[0],u[1]||0);break;case"scale":s.scale(u);break;case"skewX":s.skew(u[0],0);break;case"skewY":s.skew(0,u[0])}}t.transform(s)}}function y(t,e,n){var i="fill-opacity"===n?"getFillColor":"getStrokeColor",r=t[i]&&t[i]();r&&r.setAlpha(parseFloat(e))}var w=s.set(s.each(ot,(function(t){this[t.attribute]=function(e,n){if(e[t.set]&&(e[t.set](c(n,t.type,t.fromSVG)),"color"===t.type)){var i=e[t.get]();if(i&&i._scaleToBounds){var r=e.getBounds();i.transform((new x).translate(r.getPoint()).scale(r.getSize()))}}}}),{}),{id:function(t,e){a[e]=t,t.setName&&t.setName(e)},"clip-path":function(t,e){var n=R(e);if(n){if((n=n.clone()).setClipMask(!0),!(t instanceof M))return new M(n,t);t.insertChild(0,n)}},gradientTransform:_,transform:_,"fill-opacity":y,"stroke-opacity":y,visibility:function(t,e){t.setVisible&&t.setVisible("visible"===e)},display:function(t,e){t.setVisible&&t.setVisible(null!==e)},"stop-color":function(t,e){t.setColor&&t.setColor(e)},"stop-opacity":function(t,e){t._color&&t._color.setAlpha(parseFloat(e))},offset:function(t,e){if(t.setOffset){var n=e.match(/(.*)%$/);t.setOffset(n?n[1]/100:parseFloat(e))}},viewBox:function(t,e,n,i,r){var s,a=new v(c(e,"array")),o=h(i,null,null,!0);if(t instanceof M){var l=o?o.divide(a.getSize()):1,u=(new x).scale(l).translate(a.getPoint().negate());s=t}else t instanceof A&&(o&&a.setSize(o),s=t._item);if(s){if("visible"!==E(i,"overflow",r)){var d=new C.Rectangle(a);d.setClipMask(!0),s.addChild(d)}u&&s.transform(u)}}});function E(t,n,i){var r=t.attributes[n],a=r&&r.value;if(!a&&t.style){var o=s.camelize(n);(a=t.style[o])||i.node[o]===i.parent[o]||(a=i.node[o])}return a?"none"===a?null:a:e}function P(t,n,i){var r=n.parentNode,a={node:q.getStyles(n)||{},parent:!i&&!/^defs$/i.test(r.tagName)&&q.getStyles(r)||{}};return s.each(w,(function(i,r){var s=E(n,r,a);t=s!==e&&i(t,s,r,n,a)||t})),t}function R(t){var e=t&&t.match(/\((?:["'#]*)([^"')]+)/),i=e&&e[1],r=i&&a[n?i.replace(n.location.href.split("#")[0]+"#",""):i];return r&&r._scaleToBounds&&((r=r.clone())._scaleToBounds=!0),r}function W(t,e,n){var o,l,c,u=t.nodeName.toLowerCase(),d="#document"!==u,p=i.body;n&&d&&(r=lt.getView().getSize(),r=h(t,null,null,!0)||r,o=at.create("svg",{style:"stroke-width: 1px; stroke-miterlimit: 10"}),l=t.parentNode,c=t.nextSibling,o.appendChild(t),p.appendChild(o));var f=lt.settings,m=f.applyMatrix,v=f.insertItems;f.applyMatrix=!1,f.insertItems=!1;var _=g[u],x=_&&_(t,u,e,n)||null;if(f.insertItems=v,f.applyMatrix=m,x){!d||x instanceof M||(x=P(x,t,n));var y=e.onImport,S=d&&t.getAttribute("data-paper-data");y&&(x=y(t,x,e)||x),e.expandShapes&&x instanceof C&&(x.remove(),x=x.toPath()),S&&(x._data=JSON.parse(S))}return o&&(p.removeChild(o),l&&(c?l.insertBefore(t,c):l.appendChild(t))),n&&(a={},x&&s.pick(e.applyMatrix,m)&&x.matrix.apply(!0,!0)),x}function L(n,r,s){if(!n)return null;r="function"==typeof r?{onLoad:r}:r||{};var a=lt,o=null;function l(i){try{var l="object"==typeof i?i:(new t.DOMParser).parseFromString(i.trim(),"image/svg+xml");if(!l.nodeName)throw l=null,new Error("Unsupported SVG source: "+n);lt=a,o=W(l,r,!0),r&&!1===r.insert||s._insertItem(e,o);var c=r.onLoad;c&&c(o,i)}catch(u){h(u)}}function h(t,e){var n=r.onError;if(!n)throw new Error(t);n(t,e)}if("string"!=typeof n||/^[\s\S]*</.test(n)){if("undefined"!=typeof File&&n instanceof File){var c=new FileReader;return c.onload=function(){l(c.result)},c.onerror=function(){h(c.error)},c.readAsText(n)}l(n)}else{var u=i.getElementById(n);u?l(u):it({url:n,async:!0,onLoad:l,onError:h})}return o}b.inject({importSVG:function(t,e){return L(t,e,this)}}),S.inject({importSVG:function(t,e){return this.activate(),L(t,e,this)}})},s.exports.PaperScript=function(){var a,l,h,c,u=this,d=u.acorn;if(!d&&void 0!==r)try{d=Jl()}catch(C){}function f(t,e){return(u.acorn||d).parse(t,e)}d||(d=a=l={},h=this,c=function(t){var e,n,i,r;t.version="0.5.0",t.parse=function(t,r){return n=String(t),i=n.length,a(r),jt(),function(t){v=_=o,e.locations&&(x=new Xt),y=b=null,S=[],$t();var n=t||ue(),i=!0;for(t||(n.body=[]);d!==W;){var r=Me();n.body.push(r),i&&fe(r)&&le(!0),i=!1}return pe(n,"Program")}(e.program)};var s=t.defaultOptions={ecmaVersion:5,strictSemicolons:!1,allowTrailingCommas:!0,forbidReserved:!1,allowReturnOutsideFunction:!1,locations:!1,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null};function a(t){for(var n in e=t||{},s)Object.prototype.hasOwnProperty.call(e,n)||(e[n]=s[n]);r=e.sourceFile||null}var o,l,h,c,u,d,p,f,m,g,v,_,x,y,S,b,M=t.getLineInfo=function(t,e){for(var n=1,i=0;;){Gt.lastIndex=i;var r=Gt.exec(t);if(!(r&&r.index<e))break;++n,i=r.index+r[0].length}return{line:n,column:e-i}};function w(t,e){var i=M(n,t);e+=" ("+i.line+":"+i.column+")";var r=new SyntaxError(e);throw r.pos=t,r.loc=i,r.raisedAt=o,r}t.tokenize=function(t,r){n=String(t),i=n.length,a(r),jt();var s={};function v(t){return _=h,$t(t),s.start=l,s.end=h,s.startLoc=c,s.endLoc=u,s.type=d,s.value=p,s}return v.jumpTo=function(t,i){var r;if(o=t,e.locations)for(m=1,g=Gt.lastIndex=0;(r=Gt.exec(n))&&r.index<t;)++m,g=r.index+r[0].length;f=i,Zt()},v};var T=[],E={type:"num"},A={type:"regexp"},P={type:"string"},R={type:"name"},W={type:"eof"},L={keyword:"break"},I={keyword:"case",beforeExpr:!0},k={keyword:"catch"},N={keyword:"continue"},O={keyword:"debugger"},U={keyword:"default"},D={keyword:"do",isLoop:!0},F={keyword:"else",beforeExpr:!0},B={keyword:"finally"},z={keyword:"for",isLoop:!0},V={keyword:"function"},G={keyword:"if"},H={keyword:"return",beforeExpr:!0},q={keyword:"switch"},X={keyword:"throw",beforeExpr:!0},j={keyword:"try"},J={keyword:"var"},Q={keyword:"while",isLoop:!0},K={keyword:"with"},Z={keyword:"new",beforeExpr:!0},Y={keyword:"this"},$={keyword:"null",atomValue:null},tt={keyword:"true",atomValue:!0},et={keyword:"false",atomValue:!1},nt={keyword:"in",binop:7,beforeExpr:!0},it={break:L,case:I,catch:k,continue:N,debugger:O,default:U,do:D,else:F,finally:B,for:z,function:V,if:G,return:H,switch:q,throw:X,try:j,var:J,while:Q,with:K,null:$,true:tt,false:et,new:Z,in:nt,instanceof:{keyword:"instanceof",binop:7,beforeExpr:!0},this:Y,typeof:{keyword:"typeof",prefix:!0,beforeExpr:!0},void:{keyword:"void",prefix:!0,beforeExpr:!0},delete:{keyword:"delete",prefix:!0,beforeExpr:!0}},rt={type:"[",beforeExpr:!0},st={type:"]"},at={type:"{",beforeExpr:!0},ot={type:"}"},lt={type:"(",beforeExpr:!0},ht={type:")"},ct={type:",",beforeExpr:!0},ut={type:";",beforeExpr:!0},dt={type:":",beforeExpr:!0},pt={type:"."},ft={type:"?",beforeExpr:!0},mt={binop:10,beforeExpr:!0},gt={isAssign:!0,beforeExpr:!0},vt={isAssign:!0,beforeExpr:!0},_t={postfix:!0,prefix:!0,isUpdate:!0},xt={prefix:!0,beforeExpr:!0},yt={binop:1,beforeExpr:!0},St={binop:2,beforeExpr:!0},bt={binop:3,beforeExpr:!0},Mt={binop:4,beforeExpr:!0},wt={binop:5,beforeExpr:!0},Ct={binop:6,beforeExpr:!0},Tt={binop:7,beforeExpr:!0},Et={binop:8,beforeExpr:!0},At={binop:9,prefix:!0,beforeExpr:!0},Pt={binop:10,beforeExpr:!0};for(var Rt in t.tokTypes={bracketL:rt,bracketR:st,braceL:at,braceR:ot,parenL:lt,parenR:ht,comma:ct,semi:ut,colon:dt,dot:pt,question:ft,slash:mt,eq:gt,name:R,eof:W,num:E,regexp:A,string:P},it)t.tokTypes["_"+Rt]=it[Rt];function Wt(t){t=t.split(" ");var e="",n=[];t:for(var i=0;i<t.length;++i){for(var r=0;r<n.length;++r)if(n[r][0].length==t[i].length){n[r].push(t[i]);continue t}n.push([t[i]])}function s(t){if(1==t.length)return e+="return str === "+JSON.stringify(t[0])+";";e+="switch(str){";for(var n=0;n<t.length;++n)e+="case "+JSON.stringify(t[n])+":";e+="return true}return false;"}if(n.length>3){for(n.sort((function(t,e){return e.length-t.length})),e+="switch(str.length){",i=0;i<n.length;++i){var a=n[i];e+="case "+a[0].length+":",s(a)}e+="}"}else s(t);return new Function("str",e)}var Lt,It=Wt("abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile"),kt=Wt("class enum extends super const export import"),Nt=Wt("implements interface let package private protected public static yield"),Ot=Wt("eval arguments"),Ut=Wt("break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this"),Dt=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Ft="------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",Bt=new RegExp("["+Ft+"]"),zt=new RegExp("["+Ft+"------------------------------------------------------------------------------------------------------------------------------------------]"),Vt=/[\n\r\u2028\u2029]/,Gt=/\r\n|[\n\r\u2028\u2029]/g,Ht=t.isIdentifierStart=function(t){return t<65?36===t:t<91||(t<97?95===t:t<123||t>=170&&Bt.test(String.fromCharCode(t)))},qt=t.isIdentifierChar=function(t){return t<48?36===t:t<58||!(t<65)&&(t<91||(t<97?95===t:t<123||t>=170&&zt.test(String.fromCharCode(t))))};function Xt(){this.line=m,this.column=o-g}function jt(){m=1,o=g=0,f=!0,Zt()}function Jt(t,n){h=o,e.locations&&(u=new Xt),d=t,Zt(),p=n,f=t.beforeExpr}function Qt(){var t,i=e.onComment&&e.locations&&new Xt,r=o,s=n.indexOf("*/",o+=2);if(-1===s&&w(o-2,"Unterminated comment"),o=s+2,e.locations)for(Gt.lastIndex=r;(t=Gt.exec(n))&&t.index<o;)++m,g=t.index+t[0].length;e.onComment&&e.onComment(!0,n.slice(r+2,s),r,o,i,e.locations&&new Xt)}function Kt(){for(var t=o,r=e.onComment&&e.locations&&new Xt,s=n.charCodeAt(o+=2);o<i&&10!==s&&13!==s&&8232!==s&&8233!==s;)++o,s=n.charCodeAt(o);e.onComment&&e.onComment(!1,n.slice(t+2,o),t,o,r,e.locations&&new Xt)}function Zt(){for(;o<i;){var t=n.charCodeAt(o);if(32===t)++o;else if(13===t)++o,10===(r=n.charCodeAt(o))&&++o,e.locations&&(++m,g=o);else if(10===t||8232===t||8233===t)++o,e.locations&&(++m,g=o);else if(t>8&&t<14)++o;else if(47===t){var r;if(42===(r=n.charCodeAt(o+1)))Qt();else{if(47!==r)break;Kt()}}else if(160===t)++o;else{if(!(t>=5760&&Dt.test(String.fromCharCode(t))))break;++o}}}function Yt(t){switch(t){case 46:return function(){var t=n.charCodeAt(o+1);return t>=48&&t<=57?ie(!0):(++o,Jt(pt))}();case 40:return++o,Jt(lt);case 41:return++o,Jt(ht);case 59:return++o,Jt(ut);case 44:return++o,Jt(ct);case 91:return++o,Jt(rt);case 93:return++o,Jt(st);case 123:return++o,Jt(at);case 125:return++o,Jt(ot);case 58:return++o,Jt(dt);case 63:return++o,Jt(ft);case 48:var r=n.charCodeAt(o+1);if(120===r||88===r)return function(){o+=2;var t=ne(16);return null==t&&w(l+2,"Expected hexadecimal number"),Ht(n.charCodeAt(o))&&w(o,"Identifier directly after number"),Jt(E,t)}();case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return ie(!1);case 34:case 39:return function(t){o++;for(var r="";;){o>=i&&w(l,"Unterminated string constant");var s=n.charCodeAt(o);if(s===t)return++o,Jt(P,r);if(92===s){s=n.charCodeAt(++o);var a=/^[0-7]+/.exec(n.slice(o,o+3));for(a&&(a=a[0]);a&&parseInt(a,8)>255;)a=a.slice(0,-1);if("0"===a&&(a=null),++o,a)b&&w(o-2,"Octal literal in strict mode"),r+=String.fromCharCode(parseInt(a,8)),o+=a.length-1;else switch(s){case 110:r+="\n";break;case 114:r+="\r";break;case 120:r+=String.fromCharCode(re(2));break;case 117:r+=String.fromCharCode(re(4));break;case 85:r+=String.fromCharCode(re(8));break;case 116:r+="\t";break;case 98:r+="\b";break;case 118:r+="\v";break;case 102:r+="\f";break;case 48:r+="\0";break;case 13:10===n.charCodeAt(o)&&++o;case 10:e.locations&&(g=o,++m);break;default:r+=String.fromCharCode(s)}}else 13!==s&&10!==s&&8232!==s&&8233!==s||w(l,"Unterminated string constant"),r+=String.fromCharCode(s),++o}}(t);case 47:return function(){var t=n.charCodeAt(o+1);return f?(++o,ee()):61===t?te(vt,2):te(mt,1)}();case 37:case 42:return 61===n.charCodeAt(o+1)?te(vt,2):te(Pt,1);case 124:case 38:return function(t){var e=n.charCodeAt(o+1);return e===t?te(124===t?yt:St,2):61===e?te(vt,2):te(124===t?bt:wt,1)}(t);case 94:return 61===n.charCodeAt(o+1)?te(vt,2):te(Mt,1);case 43:case 45:return function(t){var e=n.charCodeAt(o+1);return e===t?45==e&&62==n.charCodeAt(o+2)&&Vt.test(n.slice(_,o))?(o+=3,Kt(),Zt(),$t()):te(_t,2):61===e?te(vt,2):te(At,1)}(t);case 60:case 62:return function(t){var e=n.charCodeAt(o+1),i=1;return e===t?(i=62===t&&62===n.charCodeAt(o+2)?3:2,61===n.charCodeAt(o+i)?te(vt,i+1):te(Et,i)):33==e&&60==t&&45==n.charCodeAt(o+2)&&45==n.charCodeAt(o+3)?(o+=4,Kt(),Zt(),$t()):(61===e&&(i=61===n.charCodeAt(o+2)?3:2),te(Tt,i))}(t);case 61:case 33:return function(t){return 61===n.charCodeAt(o+1)?te(Ct,61===n.charCodeAt(o+2)?3:2):te(61===t?gt:xt,1)}(t);case 126:return te(xt,1)}return!1}function $t(t){if(t?o=l+1:l=o,e.locations&&(c=new Xt),t)return ee();if(o>=i)return Jt(W);var r=n.charCodeAt(o);if(Ht(r)||92===r)return ae();var s=Yt(r);if(!1===s){var a=String.fromCharCode(r);if("\\"===a||Bt.test(a))return ae();w(o,"Unexpected character '"+a+"'")}return s}function te(t,e){var i=n.slice(o,o+e);o+=e,Jt(t,i)}function ee(){for(var t,e,r=o;;){o>=i&&w(r,"Unterminated regular expression");var s=n.charAt(o);if(Vt.test(s)&&w(r,"Unterminated regular expression"),t)t=!1;else{if("["===s)e=!0;else if("]"===s&&e)e=!1;else if("/"===s&&!e)break;t="\\"===s}++o}var a=n.slice(r,o);++o;var l=se();l&&!/^[gmsiy]*$/.test(l)&&w(r,"Invalid regexp flag");try{var h=new RegExp(a,l)}catch(C){C instanceof SyntaxError&&w(r,C.message),w(C)}return Jt(A,h)}function ne(t,e){for(var i=o,r=0,s=0,a=null==e?1/0:e;s<a;++s){var l,h=n.charCodeAt(o);if((l=h>=97?h-97+10:h>=65?h-65+10:h>=48&&h<=57?h-48:1/0)>=t)break;++o,r=r*t+l}return o===i||null!=e&&o-i!==e?null:r}function ie(t){var e=o,i=!1,r=48===n.charCodeAt(o);t||null!==ne(10)||w(e,"Invalid number"),46===n.charCodeAt(o)&&(++o,ne(10),i=!0);var s=n.charCodeAt(o);69!==s&&101!==s||(43!==(s=n.charCodeAt(++o))&&45!==s||++o,null===ne(10)&&w(e,"Invalid number"),i=!0),Ht(n.charCodeAt(o))&&w(o,"Identifier directly after number");var a,l=n.slice(e,o);return i?a=parseFloat(l):r&&1!==l.length?/[89]/.test(l)||b?w(e,"Invalid number"):a=parseInt(l,8):a=parseInt(l,10),Jt(E,a)}function re(t){var e=ne(16,t);return null===e&&w(l,"Bad character escape sequence"),e}function se(){Lt=!1;for(var t,e=!0,i=o;;){var r=n.charCodeAt(o);if(qt(r))Lt&&(t+=n.charAt(o)),++o;else{if(92!==r)break;Lt||(t=n.slice(i,o)),Lt=!0,117!=n.charCodeAt(++o)&&w(o,"Expecting Unicode escape sequence \\uXXXX"),++o;var s=re(4),a=String.fromCharCode(s);a||w(o-1,"Invalid Unicode escape"),(e?Ht(s):qt(s))||w(o-4,"Invalid Unicode escape"),t+=a}e=!1}return Lt?t:n.slice(i,o)}function ae(){var t=se(),e=R;return!Lt&&Ut(t)&&(e=it[t]),Jt(e,t)}function oe(){v=l,_=h,x=u,$t()}function le(t){if(b=t,o=l,e.locations)for(;o<g;)g=n.lastIndexOf("\n",g-2)+1,--m;Zt(),$t()}function he(){this.type=null,this.start=l,this.end=null}function ce(){this.start=c,this.end=null,null!==r&&(this.source=r)}function ue(){var t=new he;return e.locations&&(t.loc=new ce),e.directSourceFile&&(t.sourceFile=e.directSourceFile),e.ranges&&(t.range=[l,0]),t}function de(t){var n=new he;return n.start=t.start,e.locations&&(n.loc=new ce,n.loc.start=t.loc.start),e.ranges&&(n.range=[t.range[0],0]),n}function pe(t,n){return t.type=n,t.end=_,e.locations&&(t.loc.end=x),e.ranges&&(t.range[1]=_),t}function fe(t){return e.ecmaVersion>=5&&"ExpressionStatement"===t.type&&"Literal"===t.expression.type&&"use strict"===t.expression.value}function me(t){if(d===t)return oe(),!0}function ge(){return!e.strictSemicolons&&(d===W||d===ot||Vt.test(n.slice(_,l)))}function ve(){me(ut)||ge()||xe()}function _e(t){d===t?oe():xe()}function xe(){w(l,"Unexpected token")}function ye(t){"Identifier"!==t.type&&"MemberExpression"!==t.type&&w(t.start,"Assigning to rvalue"),b&&"Identifier"===t.type&&Ot(t.name)&&w(t.start,"Assigning to "+t.name+" in strict mode")}var Se={kind:"loop"},be={kind:"switch"};function Me(){(d===mt||d===vt&&"/="==p)&&$t(!0);var t=d,i=ue();switch(t){case L:case N:oe();var r=t===L;me(ut)||ge()?i.label=null:d!==R?xe():(i.label=De(),ve());for(var s=0;s<S.length;++s){var a=S[s];if(null==i.label||a.name===i.label.name){if(null!=a.kind&&(r||"loop"===a.kind))break;if(i.label&&r)break}}return s===S.length&&w(i.start,"Unsyntactic "+t.keyword),pe(i,r?"BreakStatement":"ContinueStatement");case O:return oe(),ve(),pe(i,"DebuggerStatement");case D:return oe(),S.push(Se),i.body=Me(),S.pop(),_e(Q),i.test=we(),ve(),pe(i,"DoWhileStatement");case z:if(oe(),S.push(Se),_e(lt),d===ut)return Te(i,null);if(d===J){var o=ue();return oe(),Ae(o,!0),pe(o,"VariableDeclaration"),1===o.declarations.length&&me(nt)?Ee(i,o):Te(i,o)}return o=Pe(!1,!0),me(nt)?(ye(o),Ee(i,o)):Te(i,o);case V:return oe(),Oe(i,!0);case G:return oe(),i.test=we(),i.consequent=Me(),i.alternate=me(F)?Me():null,pe(i,"IfStatement");case H:return y||e.allowReturnOutsideFunction||w(l,"'return' outside of function"),oe(),me(ut)||ge()?i.argument=null:(i.argument=Pe(),ve()),pe(i,"ReturnStatement");case q:oe(),i.discriminant=we(),i.cases=[],_e(at),S.push(be);for(var h,c;d!=ot;)if(d===I||d===U){var u=d===I;h&&pe(h,"SwitchCase"),i.cases.push(h=ue()),h.consequent=[],oe(),u?h.test=Pe():(c&&w(v,"Multiple default clauses"),c=!0,h.test=null),_e(dt)}else h||xe(),h.consequent.push(Me());return h&&pe(h,"SwitchCase"),oe(),S.pop(),pe(i,"SwitchStatement");case X:return oe(),Vt.test(n.slice(_,l))&&w(_,"Illegal newline after throw"),i.argument=Pe(),ve(),pe(i,"ThrowStatement");case j:if(oe(),i.block=Ce(),i.handler=null,d===k){var f=ue();oe(),_e(lt),f.param=De(),b&&Ot(f.param.name)&&w(f.param.start,"Binding "+f.param.name+" in strict mode"),_e(ht),f.guard=null,f.body=Ce(),i.handler=pe(f,"CatchClause")}return i.guardedHandlers=T,i.finalizer=me(B)?Ce():null,i.handler||i.finalizer||w(i.start,"Missing catch or finally clause"),pe(i,"TryStatement");case J:return oe(),Ae(i),ve(),pe(i,"VariableDeclaration");case Q:return oe(),i.test=we(),S.push(Se),i.body=Me(),S.pop(),pe(i,"WhileStatement");case K:return b&&w(l,"'with' in strict mode"),oe(),i.object=we(),i.body=Me(),pe(i,"WithStatement");case at:return Ce();case ut:return oe(),pe(i,"EmptyStatement");default:var m=p,g=Pe();if(t===R&&"Identifier"===g.type&&me(dt)){for(s=0;s<S.length;++s)S[s].name===m&&w(g.start,"Label '"+m+"' is already declared");var x=d.isLoop?"loop":d===q?"switch":null;return S.push({name:m,kind:x}),i.body=Me(),S.pop(),i.label=g,pe(i,"LabeledStatement")}return i.expression=g,ve(),pe(i,"ExpressionStatement")}}function we(){_e(lt);var t=Pe();return _e(ht),t}function Ce(t){var e,n=ue(),i=!0,r=!1;for(n.body=[],_e(at);!me(ot);){var s=Me();n.body.push(s),i&&t&&fe(s)&&(e=r,le(r=!0)),i=!1}return r&&!e&&le(!1),pe(n,"BlockStatement")}function Te(t,e){return t.init=e,_e(ut),t.test=d===ut?null:Pe(),_e(ut),t.update=d===ht?null:Pe(),_e(ht),t.body=Me(),S.pop(),pe(t,"ForStatement")}function Ee(t,e){return t.left=e,t.right=Pe(),_e(ht),t.body=Me(),S.pop(),pe(t,"ForInStatement")}function Ae(t,e){for(t.declarations=[],t.kind="var";;){var n=ue();if(n.id=De(),b&&Ot(n.id.name)&&w(n.id.start,"Binding "+n.id.name+" in strict mode"),n.init=me(gt)?Pe(!0,e):null,t.declarations.push(pe(n,"VariableDeclarator")),!me(ct))break}return t}function Pe(t,e){var n=Re(e);if(!t&&d===ct){var i=de(n);for(i.expressions=[n];me(ct);)i.expressions.push(Re(e));return pe(i,"SequenceExpression")}return n}function Re(t){var e=function(t){var e=function(t){return We(Le(),-1,t)}(t);if(me(ft)){var n=de(e);return n.test=e,n.consequent=Pe(!0),_e(dt),n.alternate=Pe(!0,t),pe(n,"ConditionalExpression")}return e}(t);if(d.isAssign){var n=de(e);return n.operator=p,n.left=e,oe(),n.right=Re(t),ye(e),pe(n,"AssignmentExpression")}return e}function We(t,e,n){var i=d.binop;if(null!=i&&(!n||d!==nt)&&i>e){var r=de(t);r.left=t,r.operator=p;var s=d;return oe(),r.right=We(Le(),i,n),We(pe(r,s===yt||s===St?"LogicalExpression":"BinaryExpression"),e,n)}return t}function Le(){if(d.prefix){var t=ue(),e=d.isUpdate;return t.operator=p,t.prefix=!0,f=!0,oe(),t.argument=Le(),e?ye(t.argument):b&&"delete"===t.operator&&"Identifier"===t.argument.type&&w(t.start,"Deleting local variable in strict mode"),pe(t,e?"UpdateExpression":"UnaryExpression")}for(var n=Ie(ke());d.postfix&&!ge();)(t=de(n)).operator=p,t.prefix=!1,t.argument=n,ye(n),oe(),n=pe(t,"UpdateExpression");return n}function Ie(t,e){var n;return me(pt)?((n=de(t)).object=t,n.property=De(!0),n.computed=!1,Ie(pe(n,"MemberExpression"),e)):me(rt)?((n=de(t)).object=t,n.property=Pe(),n.computed=!0,_e(st),Ie(pe(n,"MemberExpression"),e)):!e&&me(lt)?((n=de(t)).callee=t,n.arguments=Ue(ht,!1),Ie(pe(n,"CallExpression"),e)):t}function ke(){switch(d){case Y:var t=ue();return oe(),pe(t,"ThisExpression");case R:return De();case E:case P:case A:return(t=ue()).value=p,t.raw=n.slice(l,h),oe(),pe(t,"Literal");case $:case tt:case et:return(t=ue()).value=d.atomValue,t.raw=d.keyword,oe(),pe(t,"Literal");case lt:var i=c,r=l;oe();var s=Pe();return s.start=r,s.end=h,e.locations&&(s.loc.start=i,s.loc.end=u),e.ranges&&(s.range=[r,h]),_e(ht),s;case rt:return t=ue(),oe(),t.elements=Ue(st,!0,!0),pe(t,"ArrayExpression");case at:return function(){var t=ue(),n=!0,i=!1;for(t.properties=[],oe();!me(ot);){if(n)n=!1;else if(_e(ct),e.allowTrailingCommas&&me(ot))break;var r,s={key:Ne()},a=!1;if(me(dt)?(s.value=Pe(!0),r=s.kind="init"):e.ecmaVersion>=5&&"Identifier"===s.key.type&&("get"===s.key.name||"set"===s.key.name)?(a=i=!0,r=s.kind=s.key.name,s.key=Ne(),d!==lt&&xe(),s.value=Oe(ue(),!1)):xe(),"Identifier"===s.key.type&&(b||i))for(var o=0;o<t.properties.length;++o){var l=t.properties[o];if(l.key.name===s.key.name){var h=r==l.kind||a&&"init"===l.kind||"init"===r&&("get"===l.kind||"set"===l.kind);h&&!b&&"init"===r&&"init"===l.kind&&(h=!1),h&&w(s.key.start,"Redefinition of property")}}t.properties.push(s)}return pe(t,"ObjectExpression")}();case V:return t=ue(),oe(),Oe(t,!1);case Z:return function(){var t=ue();return oe(),t.callee=Ie(ke(),!0),me(lt)?t.arguments=Ue(ht,!1):t.arguments=T,pe(t,"NewExpression")}();default:xe()}}function Ne(){return d===E||d===P?ke():De(!0)}function Oe(t,e){d===R?t.id=De():e?xe():t.id=null,t.params=[];var n=!0;for(_e(lt);!me(ht);)n?n=!1:_e(ct),t.params.push(De());var i=y,r=S;if(y=!0,S=[],t.body=Ce(!0),y=i,S=r,b||t.body.body.length&&fe(t.body.body[0]))for(var s=t.id?-1:0;s<t.params.length;++s){var a=s<0?t.id:t.params[s];if((Nt(a.name)||Ot(a.name))&&w(a.start,"Defining '"+a.name+"' in strict mode"),s>=0)for(var o=0;o<s;++o)a.name===t.params[o].name&&w(a.start,"Argument name clash in strict mode")}return pe(t,e?"FunctionDeclaration":"FunctionExpression")}function Ue(t,n,i){for(var r=[],s=!0;!me(t);){if(s)s=!1;else if(_e(ct),n&&e.allowTrailingCommas&&me(t))break;i&&d===ct?r.push(null):r.push(Pe(!0))}return r}function De(t){var i=ue();return t&&"everywhere"==e.forbidReserved&&(t=!1),d===R?(!t&&(e.forbidReserved&&(3===e.ecmaVersion?It:kt)(p)||b&&Nt(p))&&-1==n.slice(l,h).indexOf("\\")&&w(l,"The keyword '"+p+"' is reserved"),i.name=p):t&&d.keyword?i.name=d.keyword:xe(),f=!1,oe(),pe(i,"Identifier")}},"object"==typeof a&&"object"==typeof l?c(a):"function"==typeof e&&e.amd?e(["exports"],c):c(h.acorn||(h.acorn={})),d.version||(d=null));var g={"+":"__add","-":"__subtract","*":"__multiply","/":"__divide","%":"__modulo","==":"__equals","!=":"__equals"},v={"-":"__negate","+":"__self"},_=s.each(["add","subtract","multiply","divide","modulo","equals","negate"],(function(t){this["__"+t]="#"+t}),{__self:function(){return this}});function x(t,e,n){var i=g[e];if(t&&t[i]){var r=t[i](n);return"!="===e?!r:r}switch(e){case"+":return t+n;case"-":return t-n;case"*":return t*n;case"/":return t/n;case"%":return t%n;case"==":return t==n;case"!=":return t!=n}}function y(t,e){var n=v[t];if(e&&e[n])return e[n]();switch(t){case"+":return+e;case"-":return-e}}function S(e,r){if(!e)return"";var s=[];function a(t){for(var e=0,n=s.length;e<n;e++){var i=s[e];if(i[0]>=t)break;t+=i[1]}return t}function o(t){return e.substring(a(t.range[0]),a(t.range[1]))}function l(t,n){for(var i=a(t.range[0]),r=a(t.range[1]),o=0,l=s.length-1;l>=0;l--)if(i>s[l][0]){o=l+1;break}s.splice(o,0,[i,n.length-r+i]),e=e.substring(0,i)+n+e.substring(r)}function h(t,n){switch(t.type){case"UnaryExpression":if(t.operator in v&&"Literal"!==t.argument.type){var i=o(t.argument);l(t,'$__("'+t.operator+'", '+i+")")}break;case"BinaryExpression":if(t.operator in g&&"Literal"!==t.left.type){var r=o(t.left),s=o(t.right),h=function(t,n){return e.substring(a(t.range[1]),a(n.range[0]))}(t.left,t.right),c=t.operator;l(t,"__$__("+r+","+h.replace(new RegExp("\\"+c),'"'+c+'"')+", "+s+")")}break;case"UpdateExpression":case"AssignmentExpression":var u=n&&n.type;if(!("ForStatement"===u||"BinaryExpression"===u&&/^[=!<>]/.test(n.operator)||"MemberExpression"===u&&n.computed))if("UpdateExpression"===t.type){var d=(i=o(t.argument))+" = "+(p="__$__("+i+', "'+t.operator[0]+'", 1)');t.prefix?d="("+d+")":"AssignmentExpression"!==u&&"VariableDeclarator"!==u&&"BinaryExpression"!==u||(o(n.left||n.id)===i&&(d=p),d=i+"; "+d),l(t,d)}else if(/^.=$/.test(t.operator)&&"Literal"!==t.left.type){r=o(t.left),s=o(t.right);var p=r+" = __$__("+r+', "'+t.operator[0]+'", '+s+")";l(t,/^\(.*\)$/.test(o(t))?"("+p+")":p)}}}var c,u=(r=r||{}).url||"",d=r.sourceMaps,p=r.paperFeatures||{},m=r.source||e,_=r.offset||0,x=lt.agent,y=x.versionNumber,S=!1,b=/\r\n|\n|\r/gm;if(d&&(x.chrome&&y>=30||x.webkit&&y>=537.76||x.firefox&&y>=23||x.node)){if(x.node)_-=2;else if(n&&u&&!n.location.href.indexOf(u)){var M=i.getElementsByTagName("html")[0].innerHTML;_=M.substr(0,M.indexOf(e)+1).match(b).length+1}var w=["AA"+function(t){var e="";for(t=(Math.abs(t)<<1)+(t<0?1:0);t||!e;){var n=31&t;(t>>=5)&&(n|=32),e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[n]}return e}((S=_>0&&!(x.chrome&&y>=36||x.safari&&y>=600||x.firefox&&y>=40||x.node))?0:_)+"A"];w.length=(e.match(b)||[]).length+1+(S?_:0),c={version:3,file:u,names:[],mappings:w.join(";AACA"),sourceRoot:"",sources:[u],sourcesContent:[m]}}return!1===p.operatorOverloading&&!1===p.moduleExports||function t(e,n,i){if(e){for(var r in e)if("range"!==r&&"loc"!==r){var s=e[r];if(Array.isArray(s))for(var a=0,c=s.length;a<c;a++)t(s[a],e,i);else s&&"object"==typeof s&&t(s,e,i)}!1!==i.operatorOverloading&&h(e,n),!1!==i.moduleExports&&function(t){switch(t.type){case"ExportDefaultDeclaration":l({range:[t.start,t.declaration.start]},"module.exports = ");break;case"ExportNamedDeclaration":var e=t.declaration,n=t.specifiers;if(e){var i=e.declarations;i&&(i.forEach((function(t){l(t,"module.exports."+o(t))})),l({range:[t.start,e.start+e.kind.length]},""))}else if(n){var r=n.map((function(t){var e=o(t);return"module.exports."+e+" = "+e+"; "})).join("");r&&l(t,r)}}}(e)}}(f(e,{ranges:!0,preserveParens:!0,sourceType:"module"}),null,p),c&&(S&&(e=new Array(_+1).join("\n")+e),/^(inline|both)$/.test(d)&&(e+="\n//# sourceMappingURL=data:application/json;base64,"+t.btoa(unescape(encodeURIComponent(JSON.stringify(c))))),e+="\n//# sourceURL="+(u||"paperscript")),{url:u,source:m,code:e,map:c}}function b(t,e,n){lt=e;var r,a=e.getView(),o=/\btool\.\w+|\s+on(?:Key|Mouse)(?:Up|Down|Move|Drag)\b/.test(t)&&!/\bnew\s+Tool\b/.test(t)?new et:null,l=o?o._events:[],h=["onFrame","onResize"].concat(l),c=[],u=[],d="object"==typeof t?t:S(t,n);function f(e,n){for(var i in e)!n&&/^_/.test(i)||!new RegExp("([\\b\\s\\W]|^)"+i.replace(/\$/g,"\\$")+"\\b").test(t)||(c.push(i),u.push(e[i]))}t=d.code,f({__$__:x,$__:y,paper:e,tool:o},!0),f(e),t="var module = { exports: {} }; "+t,(_=s.each(h,(function(e){new RegExp("\\s+"+e+"\\b").test(t)&&(c.push(e),this.push("module.exports."+e+" = "+e+";"))}),[]).join("\n"))&&(t+="\n"+_),t+="\nreturn module.exports;";var m=lt.agent;if(i&&(m.chrome||m.firefox&&m.versionNumber<40)){var g=i.createElement("script"),v=i.head||i.getElementsByTagName("head")[0];m.firefox&&(t="\n"+t),g.appendChild(i.createTextNode("document.__paperscript__ = function("+c+") {"+t+"\n}")),v.appendChild(g),r=i.__paperscript__,delete i.__paperscript__,v.removeChild(g)}else r=Function(c,t);var _,b=(_=r&&r.apply(e,u))||{};return s.each(l,(function(t){var e=b[t];e&&(o[t]=e)})),a&&(b.onResize&&a.setOnResize(b.onResize),a.emit("resize",{size:a.size,delta:new p}),b.onFrame&&a.setOnFrame(b.onFrame),a.requestUpdate()),_}function M(t){if(/^text\/(?:x-|)paperscript$/.test(t.type)&&"true"!==o.getAttribute(t,"ignore")){var e=o.getAttribute(t,"canvas"),n=i.getElementById(e),r=t.src||t.getAttribute("data-src"),s=o.hasAttribute(t,"async"),a="data-paper-scope";if(!n)throw new Error('Unable to find canvas with id "'+e+'"');var l=o.get(n.getAttribute(a))||(new o).setup(n);return n.setAttribute(a,l._id),r?it({url:r,async:s,mimeType:"text/plain",onLoad:function(t){b(t,l,r)}}):b(t.innerHTML,l,t.baseURI),t.setAttribute("data-paper-ignore","true"),l}}function w(){s.each(i&&i.getElementsByTagName("script"),M)}return p.inject(_),m.inject(_),z.inject(_),n&&("complete"===i.readyState?setTimeout(w):X.add(n,{load:w})),{compile:S,execute:b,load:function(t){return t?M(t):w()},parse:f,calculateBinary:x,calculateUnary:y}}.call(this);var lt=new(o.inject(s.exports,{Base:s,Numerical:u,Key:Y,DomEvent:X,DomElement:q,document:i,window:n,Symbol:A,PlacedSymbol:E}));return lt.agent.node&&Q(lt),"function"==typeof e&&e.amd?e("paper",lt):ql&&(ql.exports=lt),lt}.call(n,"object"==typeof self?self:null);const Ql=i(Xl.exports);function Kl(t,e,n,i){const r=t.curve===e,s=e.getNormalAtTime(r?0:1).multiply(i),a=t.point.add(s),o=new Ql.Segment(a),l=r?"handleOut":"handleIn";return o[l]=t[l].add(n.subtract(s).divide(2)),o}function Zl(t,e){const n=t.getNormalAtTime(.5).multiply(e),i=Kl(t.segment1,t,n,e),r=Kl(t.segment2,t,n,e),s=new Ql.Curve(i,r);if(0===s.getIntersections(s).length){const n=Math.min(Math.abs(e)/10,1),i=s.getPointAtTime(.5).getDistance(t.getPointAtTime(.5));if(Math.abs(i-Math.abs(e))>n){const n=t.divideAtTime(.5);if(null!=n)return[...Zl(t,e),...Zl(n,e)]}}return[i,r]}function Yl(t,e){return t.x*e.y-t.y*e.x}function $l(t,e,n,i,r,s){const a=new Ql.Curve(t[0],t[1]),o=new Ql.Curve(e[0],e[1]),l=a.getIntersections(o),h=t[1].point.getDistance(e[0].point);if(n.isSmooth())e[0].handleOut=e[0].handleOut.project(n.handleOut),e[0].handleIn=t[1].handleIn.project(n.handleIn),e[0].point=t[1].point.add(e[0].point).divide(2),t.pop();else if(0===l.length)if(h>.1*Math.abs(r))switch(i){case"miter":const i=function(t,e,n,i){const r=t.subtract(e),s=n.subtract(i),a=Yl(t,e),o=Yl(n,i);return new Ql.Point(a*s.x-r.x*o,a*s.y-r.y*o).divide(Yl(r,s))}(a.point2,a.point2.add(a.getTangentAtTime(1)),o.point1,o.point1.add(o.getTangentAtTime(0)));Math.max(i.getDistance(a.point2),i.getDistance(o.point1))<Math.abs(r)*s&&t.push(new Ql.Segment(i));break;case"round":const l=function(t,e,n,i){const r=t.point.subtract(n).add(e.point.subtract(n)).normalize(Math.abs(i)).add(n),s=new Ql.Path.Arc({from:t.point,to:e.point,through:r,insert:!1});return t.handleOut=s.firstSegment.handleOut,e.handleIn=s.lastSegment.handleIn,3===s.segments.length?s.segments[1]:null}(t[1],e[0],n.point,r);l&&t.push(l)}else e[0].handleIn=t[1].handleIn,t.pop();else{const n=a.divideAt(l[0]);if(n){const i=n.segment1,r=o.divideAt(o.getIntersections(a)[0]);i.handleOut=r?r.segment1.handleOut:e[0].handleOut,t.pop(),e[0]=i}else e[0].handleIn=t[1].handleIn,t.pop()}}function th(t){return 1===t.children.length&&(t=t.children[0]).remove(),t}function eh(t,e=.01){if(t.closed){const n=Math.abs(t.area*e);if(t.clockwise||t.reverse(),(t=t.unite(t,{insert:!1}))instanceof Ql.CompoundPath&&(t.children.filter((t=>Math.abs(t.area)<n)).forEach((t=>t.remove())),1===t.children.length))return th(t)}return t}function nh(t){if(t.closed){const e=t.unite(t,{insert:!1});if(e instanceof Ql.CompoundPath)return e.children.filter((e=>!(e.segments.length>1)||!function(t,e){const n=(t.segments[0].location.offset+t.segments[Math.max(1,Math.floor(t.segments.length/2))].location.offset)/3;return e.getNearestLocation(t.getPointAt(n)).offset<e.getNearestLocation(t.getPointAt(2*n)).offset}(e,t))).forEach((t=>t.remove())),th(e)}return t}function ih(t,e){const n=function(t){return t instanceof Ql.CompoundPath?t.children.map((t=>t.segments)).flat():t.segments}(t).slice();n.forEach((t=>{e.contains(t.point)||t.remove()}))}function rh(t,e,n,i){let r;[r,e]=function(t,e){const n=t.clone({insert:!1});return n.reduce({}),t.clockwise||(n.reverse(),e=-e),[n,e]}(t,e);const s=r.curves.slice();let a=e;const o=s.map((t=>Zl(t,a))).flat(),l=[];for(let u=0;u<o.length;u+=2)l.push(o.slice(u,u+2));const h=function(t,e,n,i,r){const s=n.segments,a=t[0].slice();for(let o=0;o<t.length-1;++o)$l(t[o],t[o+1],s[o+1],e,i,r);return n.closed&&($l(t[t.length-1],a,s[0],e,i,r),t[0][0]=a[0]),t}(l,n,r,a,i).flat(),c=nh(new Ql.Path({segments:h,insert:!1,closed:t.closed}));return c.reduce({}),r.closed&&(r.clockwise&&a<0||!r.clockwise&&a>0)&&ih(c,t),r.clockwise!==t.clockwise&&c.reverse(),eh(c)}function sh(t,e,n,i){const r=function(t){return t.closed?t.unite(t,{insert:!1}):t}(t);let s=r;if(r instanceof Ql.Path)s=rh(r,e,n,i);else{const t=r.children.map((t=>{if(t.segments.length>1){let r=rh(t,e,n,i);return r=eh(r),r.clockwise!==t.clockwise&&r.reverse(),r instanceof Ql.CompoundPath?(r.applyMatrix=!0,r.children):r}return null})).flat().filter((t=>!!t));s=new Ql.CompoundPath({children:t,insert:!1})}return s.copyAttributes(r,!1),s.remove(),s}const ah=oh;function oh(t,e){const n=lh();return oh=function(e,i){let r=n[e-=228];if(void 0===oh.yfjeML){const e=function(t,e){let n,i,r=[],s=0,a="";for(t=function(t){let e="",n="";for(let i,r,s=0,a=0;r=t.charAt(a++);~r&&(i=s%4?64*i+r:r,s++%4)?e+=String.fromCharCode(255&i>>(-2*s&6)):0)r="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(r);for(let i=0,r=e.length;i<r;i++)n+="%"+("00"+e.charCodeAt(i).toString(16)).slice(-2);return decodeURIComponent(n)}(t),i=0;i<256;i++)r[i]=i;for(i=0;i<256;i++)s=(s+r[i]+e.charCodeAt(i%e.length))%256,n=r[i],r[i]=r[s],r[s]=n;i=0,s=0;for(let o=0;o<t.length;o++)i=(i+1)%256,s=(s+r[i])%256,n=r[i],r[i]=r[s],r[s]=n,a+=String.fromCharCode(t.charCodeAt(o)^r[(r[i]+r[s])%256]);return a};oh.hMIWGx=e,t=arguments,oh.yfjeML=!0}const s=e+n[0],a=t[s];return a?r=a:(void 0===oh.wygwpl&&(oh.wygwpl=!0),r=oh.hMIWGx(r,i),t[s]=r),r},oh(t,e)}function lh(){const t=["lmo8y8kFW4e","od5YW6abdCkvaCkNWO9jW6hcL8k7CmoQ","W5ddP8kvj8oA","mNrMW70SmmkwA8kqWOO","dsldGLtdTCkhW5JcHmkWsNa","CSo5y8kzW5SXWQ7cTG","x8orWPGgW6f+W5ZdSfTs","WQCbW51yWOPeW4JcJgq","W7VcLmoR","zseyhW","oLBcLSoA","W5VdUSo3sqddQ8k4WQddIf3cVmkNy0rnWRnmWRTwxIvN","mJ59W7aUaSkFn8kMWPC","mNrMW71QjSoDq8kFWPVdQ8oTqG","W77cLmo/B8kepgdcLrmnttRdKSosW43dHG","W7BcIZrphW","WQJdICk1","W5TJrCkGWQBcMwtcRmoj","DserhgNcTa","WRldLrK","WQtdLqzwW73dVCo8W7hcI8kz","fZP9W6iYW6tdRLa","omkQW5RcQmkBWR54WQ4rwXKuWOldHaFdVa","W6xdGqJcUSkRWQOiumksWR0","WPfwW5dcNW","qL3dNXT/W4pcGq","WQTVC8klta","W6VcTSkdWR/dRG","W5L0qSkGWPNcLNNcO8oEeu3cVrldS1NdPmkZeq","labBWQuBpt9QW4GJ","bmoBW7j3j8kBWRBcSg9m","WRhdGH9xW7VdHCogW4dcPa","W4C+tCkbW7S","qG4sW6LJ","W7NcIZ8","WOmGW7TA","W4FdLXroW78nW5Xl","W6ZcP8kcWQFcUc0YW7L6W6jDW53cTmodn8kV","EmkLibeBW6XXfcdcQ8kFW7xcHmkcW4CrW4NdSb5GW7KZWQhdHCoEot/cJWZcSv3dLv4LEuddImoXAhuVW4u","WQRdHr0aCNWLeanHW5bjW5KRW7G","W4bJrmk8WP/cKMRcRG","tCoDWOWx","W43dSSkblG","WRpdHryCeMXQhXj0W41U","W7ZcQ8km","mmorqmkesf7cMq","WRf1FSkcrZSnW4VcOG","WROaW4nPWRbBW4e","lSoawmkLqq","ysCid2tcQmknzJi","jf7cN8ovre8fWRlcVa","Dmk4iG","WQRdHr0aCNWLeHD4W5P4W5q","W53dSmo6wLVdOCoZWRldJG","lX1r","bCkWqmkOWOddRG","WRpdJWerlu5QhqnW","aJbJW7KP","W7NcQxJdP39Iuq","WOD3gcKrWQ1B","WQOKW7XtEM/cUmk3daDRW6zkxG7cNsxdOmoUCq","WONcN1C","WPJdI33cHW","agvIhSot","WRRdHCkXumkDWQtdGcC","W4xdKqW","W7JcGsXbas0ujmot","W4VdTSo5","WPRdLqfD","WQ7dGqSrluXIbrPW","x8orWPGgWQDOWPFdKvnmif0nW6pdPSkhvNi","paTYEYG/hwK","i2NdVKLtxGjDmmoAW597WQVdKuTE","AIxdP07cICoQst0m","WPfvW5VcKW","WPGgW5TvWQzmW5BcGMzpWP1u","BaOvW6jBDL9Smx9jW4OrW6vjWPPv","nqfuWQq","W7pcMSo4iW","smoyWOutW6zVW5BdNe4","DZxdPKpcMSoTsJWz","W5TPuSkTWPRcP2RcRSoBha","lSkMW47cOCkDWQLLWQGjuWeH","v1ZdLXDNW6RcJcW2WO8","WRr0ACkgrs0NW5dcTKrtCSkY","mCkMW5VcPCkOWQjOWRiwwrq0","mmoax8k4yuBcHColW5LUdCo+","eI9QW7uUW6VdRK4","btz9W7m4W7pdPLpdJYGvWPGNCSk0ba","WOXVeciaWPDCuSod","jWfKAI0khwNcQmk+","WRr0A8kdDJWbW5lcQ1HtDmkYFSk9WP4bW4GmW5G","W6pcNSo0nSounchcLHLtrYFdICoEW4/dUG","WRv7W7m","W7RcNSo/kSk3ogdcIbe","WOmOW7K","WReyW4Pf","tdhdP1JcO8oXxhiQwcvS","zNnAWRtdNcNdVSoWiCk8aSkwxmou","h1K6WQKEFCoq","cmk7r8k8WPVdSSk2r8oOrq","q1RdIa","iLlcGmojaWzjWRFcQ0tdUmkF","W5pdSSkEomoA","lGDYAIiOfwRcS8k6WOFcIulcOSkOlG","W4ZdLX5FW506W5bcWONdOa","WP3dIhBcI2eRWOW","naPBWQWhbq","W6vLW7xdJdVdHLrYW73cRIq4","W7RcNSo/kSk3ohBcLr9dtZ8","WQ7dGMRcJgSRWPNdPuJcSSknheFdVSofW6RdQq","r8oBWOC","BdhdUv7cRW","W4xdMq5B","ot53W6eenCktmSk/WOS","yNLrWQNcMYtcV8oQ","W6mLsmkwW7xdLa","k356W6W1fmkssSkeWP8","WPfNctfwWQaBxmooF0/cNCkrW7/cJ8kf","W7hcHsXb","WQqrW4nyWQPFW4hcHW","gCoBW798p8kbWR7cU3jD","W7hcRCkjW77dPYbYW6y","av81","zNnAWRtdNcNdVSoPiCkWf8kpqmoue8kF","WRBcGIS","WRBcGI3dGMy8bY01tSk1WPXftuBdImoLlNFcSq","WQddNXDmW7ZdG8oWW5VcGSkD","yItdPGvWWP51W593WOGtmG","W6RcP8kkWRBdQJ0","hmkLqSkGWPxdOSkqtCoGshFcUIVdML8l","W6XIvw3cUW","hCorW7TIj8kSWQpcUvnDC0C","WOJdHNtcIMe","W7ZcIYO","W7VdJWZcSq","g1lcI8ovza0iWR3cG1xdUmksmmoFpSkF","W4ZdVSoHs1i","zI/dTGfwWO5XW4i","k3rTW6eknSkssmkvWPVdU8oL","W43dL2a","WOHTfsajWPjurmotCW","W4G1W5q0WOq","W6m+s8kpW5xdIdawBIf1","nmkIjmodWP4jWOZcUSkTymkv","oq1HyYq","FxbeWRpcIJK","W7dcSmkFWRu","bKGUWOLuACkBW5tdUmoFW5yOW7Okkf7dJSksW6S","hdhdHf0","iKxcMCotqW8oWQdcVv3dO8kz","mdHL","WOJdHSkhrSo/WP3cQI4","zN5lWQpcHcpcTCo3nW","W5/dSmo8veFdPSo5WQ8","isusWORcOIRcMSoikW","idrRW7bBb8oClSkLWP1uW7dcJmk9F8oC","WQRdHr0aCNWLeHL5W5b4","WQtcNbhcRa","euiYWPGZySoYW5NdTmoBW5e","W5NdVSoJsfy","W4PUvq","WQSMvmkf","saau","W6THW6JdKGO","W4ddUIFdUCoN","gMNdTvuWuLvCnSomW5L/WOJdLuXiW7NdKCkpgq","W4ldVSo/","WR19W6BdSW7cOXy6BmolW7/cSLDza8kz","dZ/dNfRdVG","mCokt8kXruFcK8ow","bmkWxCkNWQtdRSk9w8oXxYxcSG","WRv0BSkcrr4fW5pcRLe","k8kQW4ZcUCkq","u1ZdVbv8W4q","nujHuuuHht3dHW","WRJdMCkZqq","vqOEW744EH5Vn0znW4WDW7zm","W7RcMSo8","rWmhW75yDLfMp1Xp","lGD2","l0P0","WO7dJmkgw8oIWPFcPcW","WO1NgcinWRa","WRD9BmkutdW","W4ddVmkajmon","W53dOYZcVKj2W48","z8o4CCksW4m9WQu","WQ3dLbCDl39IfW8","W5PJwmkVWOlcMq","WO7dIhhcKxajWPhdRGdcSW","b3j2gq","W7HYW6pdKG7dGfLfW7hcQYqHaSos","h8k0qSk6WPe","aw5ZcmoxW47dJa","W5pdVmkFiSolWPD8W6q","aKGKWO4xAmowW4hdPmoDW5WOW7CopvZdHG","t1ZdJbbPW4NcIZ8/WPC","W6xcNSoQlSkcm3VcJWbjwIO","W4ddVmkcp8oEWPD9","WRJdHCk7umohWQpcJZVdRe9ksftdQ8kNW7K","vZxdPKpcMSoTxcexxIvTp8ovb8kwtmkjWOjq","bmk0xmkOWP3dQmkitCo+sa","a2vMl8oxW47dHuPNW60aWOhcJ8oC","WPriW5dcHSkPW4tcOmovW6ybwCkT","m2nY","W4zNqSkGWRNcL23cSColdq","WPtdHSkt","iLlcGmojaWzjWR/cOvxdQmkOnSotj8khWQrhW5DmW4xcUYlcICo1iqVdM8kFWRy","WRFcId/dJMK5ctC3","WQhdHCkWtmkKWQ/dJIxdPa","l8kZW4NcOW","WPhdH8ksqa","egvQhSkiW4/cHKnGW74QWOZcLConWOxcVmk3eCknW71SW7NcRq","FtZdRfVcOSorsGiFssW","od5YW6abdCkvaCkSWOftW7a","kCoavmkKaKRdKSoiW59+bCoMESoGWQpcPG","WRpdGru","FCk+maqeWOa/vYlcUq","WPvcaSkjWRddGJW","WRT0zSkiwW","fei4WOKPBmoyW5a","WQRdJmkMxa","WPfNctfwWQaBs8ojEKpcHa","ufZdJbjGW5BcHcG7","WOHNaI02WRburSocD17cKG","W5FdTSkbo8otWP9NW6/dO8oqDSkC","cxr+pSocW5VdJq","W7TLW7i","WOrFW4e","iuxcMConyW","W513qMy","WQ7cIdtdKGO1sda+tmkPWOL9D1JdNq","c8orW6b3jW","WOnFW43cK8oUW4xdNCojW6ijsmkRW4mr","W5xdNqjoWOiiWP9kWPNdOXpcSmknsmovW7TxcmkCW71d","oez2","WR8rW45z","W5hdIH9jW5qEW4DlWRJdTXpcSSkiuSo0W5zmgSkUW7fb","qWOqW69N","WR7dHCkWuCkyWRm","ldP8W74iW7pdRLldHsGlWRadDmkOfCocW594WR8","jd56W6OCl8kBoCkIWPO","zry2agetgH7dImos","qGakW6v5","dZJdKuFdN8kvW4ZcGCk/qwu","CCoIACkCW4O","t8oDWPixW7D4W5ddKLrdkuiuW6xdRCkA","omoxxSk/qW","eZP/W7m6W7m","pKxcNCoB","W5u9W40NW5iXArKnuv8vW5KtWQK","W7RcP8kmWRBdPW","ehLIdW","m19LwgyDgJpdPSoMW4XbWRvD","zmk0lbvBWRjWwtlcQSknWRFcTmkoW5KCW4y","W7NcHtzh","jd5GW60CcSkDma","WOhcLee","o2pdP1K","zhnqWRtcHI7cSCoO","W6W9W4y7WRu6kbO0xh8jW5SFW6BcVa","WRr6zmka","iNHO","kmkMW5dcUColWQ4/WQitxXqQWOJdJa7dVaqcCmkWW5NdUCkOhG0","WOr3bsOMWQHCwa","WOzThsOx","CJxdVeZcOSoX","W5jJqSkPWP/cNq","W5NdUSo9svRdRmo3WQ0","WRSBW4G","vtaIt8kBW43dMKPS","W4ZdMq5zW5aCW7jbWPddQGa","WReyW45jWPPdW4xcH39jWPm","jKlcISoyCW0lWRZcVa","WP3dHMZcNgW","W7JdJXK","zCoZza","cJ/dGNddRCkgW4u","WOxcNKaHW7mTW5dcPadcNSoMbW","W47dIG5sW54lW4npWOZdRrVcPSkIxCo+W7flhq","zSo/y8kaW4aRWQq","WOZdJmkmw8o+WOBcOa3dH3C","W4xdV8kjmW","W6vLW7ldHqFdGeHYW6C","FCk0jWK4WR4Nsd7cV8kjWRC","W7TWW6FdIG","BJxdRv/cV8o3qb8Ftq","WPldIhNcM20RWP/dLHZcOSkgdrldO8oo","uGOs","xI0oafJcQCkhEWXye8kKrSoRWOPY","WRJdHCk7umohWQpcJZVdRe9ksftdQ8kNW7O","WOnFW43cK8oUW4xdNCosW6ext8k7W4u","DZxdPKpcMCoXrdWAxdzL","WPhdHSkg","W77cLSoR","zCk/pruBWOy7srlcSq","smoBWOWEW7v8W4RdMa","nmolxmkLrxRcMCoaW4q","feeZWOu","f1uMWPWjAq","W5tdUSkip8ox","W6vVW6ldGqFdUeXTW6hcQa","W6hdIXNcOmoSWOjpvmkvWQurWRG","yI7dSqHpWRX1W51MWOW","aZP5W7m3","uMy3WQzPW4VdUuRdLZeR","W6qeW5C","fML1aSopWOBdIK57","W5VdUSo3sqddQ8k4WRhdKLRcUSkqzKjtWRu","fhvGd8o4W4tdHeb7","WPf7asa","jLBcLSoyxdyoWQFcOLe","hYddN0hdGmkmW4RcISkI","gqDSEsqUmwtcQCk+WPNcReRcQq","WPOrW5XvWPLdW4VcJxfQWPvdW73dRmkQifu","W6PLW7ddGqC","j2Lzm8k9ESkjsSoV","WPRcLeyUW4G3W5tcUrC","WQ57W6BdVr7cPX42zW","oGbCWR8PedTKW4WU","rvBdIbX/","BJJdSeu","WQVcImo6jCohkglcIHHte3hdImofW5xdK8oKW6vKASk4o8kqwsq+W79yW543wr7cLmkcWR4HW5OiCtGkWPuTW5NdKXFdLeBdOq","WPCUW7XsxM7cRSkQ","WPPBW40","lXzWBI84","pSonrCk8vvZcMCow","W4y0W4WJWOKbkcqyswm","WQZdTCooW6VcU31QW4D4W4DTW7m","WRr1W6q","W5PIw3ZdPbBcItf6WO3cMmkOhaZcVNi","W4RcLYJcJ3W","w8oMfSo8W4BcTSk+FSoRDJdcSW","dCk8xmkQWPFdSSkTr8o2xsJcKGtdKLKl","W6tcI8oPiCkspg7cLa","W73cIYPjfYWFi8obDa","W7JcIZXfaruqo8ovFq","yapdJmkoatmQWRhcONxdMq","W5PIw3ZcOGddGG9ZWPq","lSogtCk8va","yIJdUW","p8kVW43cRmkkWQL+WQal","WPxdJmkatSoNWPRcOdpdLq","nIr6W6GCcSkC","WRddKXK","bKu/WP4my8oqW4BdVG","lebZx1qBgYK","FZpdSbTkWO9J","pMba","WQ3dLbWyja","kK5Sq0u","WRb6W6tdOXNcGXOTDG","mebN","y8k0oaqlWQi7xW","W4ZdVSo7xLS","W55OsMBcOZ7dJIv6WPa","W405W5S0","W4uXW4m","oqftWQKdfdi","kez0wKu","c25rbSosW4JdGW","WRFcMsddSKaHaW","rf/dMXHH","j2bxiW","WPDSW4uR","gdxdIehdUCkxW4JcR8k3xW","zCoZzmk1W4m9WQZcVCkVvCkccCkUha","WRbVFSkxwNjlWPdcRenflSkJsmk1WOypW40eW4ZdLmkwrmk/WRz1W4xcLSoIW4m3kL/cNanBW5nItG7cJ8oSWQ0nWPPBoWm","t8oZy8kyW78WWRJcQ8kOqSkHhmkQgCk6W50/vSktWPS","gSk2t8kJWPe","ur0dW7LUBezNeKbjW4KDW7LhWRLmvJdcJuq","W7xcNSo6j8kl","rfVdLXv3W5tcGcu","gtrGW6W4c8kDmmkTWQnCW7dcGmkGEmoNWQi","W4VdTSkugmolWOX6W6tdJq","cmoqW7jxpCkOWRNcQfzazv7cNe/cG2W","hKW0WPGl","mvTSyLKceq","WOH2hreCWRrq","WQCBW5XuWR1cW4VcJq","FJ/dTL7cP8oGsYy7usfSf8oAbW","ma5CWQWSgtDJW4CY","x8orWPGgWQDOWPFdLfvq","nNrSW7OPj8kquSkyWOZdRmocrSogWP3dGfW","aJxdLvhdV8kWW53cHSk3w2C","ftP3W6i","WPzpW4hcImkiW5hcL8oCW7mu","W7TLW6RdGqJdMKHL","WQRdHr0aCNWLbqr0W5f5W5GRW7SdWRXdW4y","od5WW6uebSkXmCkNWP5CW7BcGa","ngddR14l","agLK","W7pcKSo6","tG0mW69OAG","zY0fhd/cOSogDI1CbSkZv8oTWOPQ","ke5Yuuug","oqD6AG","W55Mv2dcMbtdGtf3WPa","WRFdJqqtja","WRXYFa","lCoqxSk1CKhcKmoxW4i","nvBcLSolure","nmolt8k8reRcMCol","W6bVW7tdJrhdGun1W7xcOq","WOZdUCoPw1xdQCoW","W5PIw3ZdPbBcItj9WPFcN8k1gWBcO1G","WPxdJmkhr8oBWPZcVdpdJ2tdKCoU","yxnwWOpcGYJcSCo2b8kRgSkmxa","DSk9mrK","WRNcGsNdH0SYctGKBSkZWOHoEK7dJmo/mq","WO7dLrToW5inW4eb","W4ldVSo9wLRdOCocWQ7dJq","W4j0v8k+WPpcG3JcPW","WQddJ8kK","cSk0q8kQWOBdP8kquCoOwq","W43dKrrFW6iCW5bnWPxdQXu","ogrjiW","bMvKd8ox","W5TNrG","WQCrW51oWRLoW4FcL39rWPf0W7NdS8kMm1G","uqmhW6LUDL9UmLDA","W4jJtSk8WOpcG27cJ8opcq","W5ddO8knjq","W4ddV8kjkSonWP18W6VdNG","kqfSydm","f3bZba","W7HLW7tdLXVdI051W73cUYaxd8olvmk9sG","iwrwpmkZD8kyumoQW781fq","kSkMW5RcUCkrWQLWWQ0","WRBdNXLDW6u","ad/dK1tdOa","buqYWOKp","WP3dIhZcMLaQWR/dPrhcT8kw","WRdcNIpdIa","W5TJrCkGWQBcMxlcSCohgKxcSG","EfOZoqWSmLhcMCkF","WQ9YBSktqq","WRCKW71iwMlcOSkWdbjV","WQ91W7JdOWG","cZxdHhddOmkaW4dcH8k4w0bOW7Dt","WRP7W6ldSX8","ASo3W5JcTq","mJ12W7W","W7RcJ8oGfSkEigO","mdbNW6u","WORdGMdcI3e3WP3dHaNcTW","W5xdNrDkW50nW4vlWRxdSrFcQa","W7uPvSkrW6ddGYCqBJjJjxarWQxdNH8","W5LkW5VcGa","jwbCjCkZ","tqab","t8oDWPy","mL7cJG","WQddNXDmWRRdLCk7W7xcJmkbWRhdSq","WPtdImkAsa","sLZdMHX/W7dcHcCRWP4","BJxdRv/dUCoHcZCqxczTfW","WPzEW5e","W7T0W6FdKa4","WOniW5tcICkUW4ZcMSooW7qyu8kW","WPJcMKe6W4u","wmorWOCFW7fIW43dJG","atxdG13dN8krW4ZcJmkYtNb1","WRFdJqqtjdCH","W6XPW7a","lmkSW5VcPmkmWQn+WQ8","W7BcO8kxWRy","C8kWoqqAWRCkqIFcUq","WRmDW51yWQPFW43cJhHgWPH7W7hdUCkRnq","WQqaW5zrWQW","lWPg","saihW61U","WQhdJ8kNqCkyWPhdGcFdTLK","WRpdIqS","kWPK","WPCKW71iwMlcOSkWdbjVW4LMuH/cIJy","eJXUW7O+","rSorWPmAW4rKW5BdK10","hdhdHf3dG8kdW4VcKCkZwW","bmoaW7PgmSk9WRi","WPZdGM7cMMG","WQFdIG5w","CcCrb34","WOSUW6G","WRSZWRBdRIBdIwDnW7S","W6xcIYTjgsOEoq","W7hdHXC","WRX+ESktqq","DJ/dTKRcPSoG","W47dTSkFi8oSWOPYW6tdJSofyCkv","gKG/WPOpEq","sSosW7b0lCkRWRe","WRFdJGmB","o23dQfO","EYNdVa5iWOrXW4jG","WPKBW4fy","WOdcNLOUW4GT","W5uQW5q9WPi4lGCkvgqc","krXKFa","WOnFW43cK8oUW4xdNCoqW7mDAmkNW4erW50","WPZdGmkgsSoOWOdcRc/dIgBdNmooW7pcTSogvG","dCoDW6a","atxdG13dNmknW5tcKCk/tgn9","WPBdGNhcMgWX","WRNdMX8","WRNcGIddIuS","WOGwW4nCWQDa","W4ldMq5zW5K","jWTZzXe0bxBcTmk4WORcQq","B8kwfmoJaX7cHSoUW4nhgmo/","uGOkW69OAMrNlKzDW4Wr","W4pdNqXFW50","W5iOW5ONWQ08ibWn","W6ZcP8kcWQFcUc0YW719W6jqW4lcLSopi8k0W6S","jfJcJCoAwaWcWQdcVq","CSo3zmkyW7S3WPlcJSkg","yc0j","AdxdSv7cQCoG","WQtcNLhdSq","bSoAW5v+iSkUWRW","h8ovW7PNlG","W59PrCoLWP/cNgRcPColveVcQYxdVL3dR8kK","WPpdIhZcMMGtWPNdPr3cOG","qKhdJbzH","WQddKGPw","q8oBWPiBW65JW5FdIvTo","WQqxW45rWQW","WQ/dHCkTumkrWRu","WPfNcteqWRzqzCohzG","WRpdGMVcL1qTWOhdUGhcPmkFfsRdSmoFW6pdOJ96ja","WPZcNL45W4W4W4xcRY3cI8oXdG","BSo5DW","WR3dLbTDW6FdGSo8W6lcMG","bmovW6jXkSk9WPtcS3zgza","ixHnghq","W5i9W4e","rfZdKHzH","idrRW7bBb8oClSkLWP1uW7dcJmk9F8oE","W7pcJtrucde","WRNcKCo8jq","jgHujmk+","WRxdNGSyW7RdGCo6W6lcR8keWRNdQWG","W4LItgxcSGBdLtS","gSkeW5bc","pMremCk6ESkjsSoV","ftP3W6jOW6pcOu/dHc4uWReGyCkV","W4rPq8kVWP7cN27cSCoD","WODBW5VcGSkXW7xcMSojW6Su","cw92d8oxW73dIun8W7W","qItdPGvZWOj7W590WQqaiJKszCozWR0","mCkIW5G","igrxpCkZESkysG","WOOGW78","WPxdHSkqsSoNWQlcPcZdK2i","WQldNX1mW6ddKSo0W7O","rL/dIG","kqjLBJm/e2tcQCkjWOtcSeZcRCkUpXFcLW","WPVcNKCAW4KJW5q","EICorwdcR8kgFG","WRqyW4PCWRTiW4VcGMi","pMrdomkgFmkvsSo1W7uGaa","W4i3W5SNWOqTmXKCu34","WRfXW7xdSG","iczNWPFcVW7cTmox","vqOEW744EH5Up1vaW4ONW6jqWOTwqIlcVf/cGmox","W7OMWQBcPf/dPu0","puTK","xI0oaf/cSSkjEYvyfCkLECoJWP97WPBdHIpdRa","W7BdGq3cU8kT","gSorW7P3kmk5WRlcUa","WODvW4BcJSkPW4JcNmot","WONdJNZcI2W","W4ZdO8kjjCo5WPf9W77dRSowCSkgW6lcRW","W4zVW6JdGq","fKqG","xdOjagpcOCkADdfrdSkI","W4i3W5K8WPm","bKGUWOLuACkBW5RdVCooW5C/W7mokeldHSkiW6K","FI0jcwdcQmknzJi","W6WHrCkfW7u","hCorW65MEmkPW7NcSw5fqLpcIutdIa","WP/cKLC9W4G","lCokx8k5ruFcK8ow","WQZcId7dKLaYbZu","i25doCkIFCkdvW","jmorW6v6bSkSWQpcV3Tzw0VcJutcLhFcSSkg","lGPbWQivfa","WQ9PA8kxFq","WR/cGY3dHfu0aG","As7dUXLWWOnUW5q","WRv6FSkesdGNW5dcT1Ta","WQFdIGbmW4xdMmoYW77cLW","EmkLibeBW6XXfcdcQ8kFW7xcHmkcW4CrW4NdSb5GW7KZWQhdHCoEot/cJWZcSv3dLv4LAKZdNCo1mNmVWPlcNCkqDguCEmomfMrYdSo0wG","b2NdTe4qx09BnSozW50","jmorW6v6g8kLWRJcSN1KD17cNfpcJ3/cVW","FJNdOW","f2H7bmosW4xdJvX6","W6G4smk2W6NdLIe","WQtdHCkQq8kCWRm","W6nIugdcHaBdHIX2WOxcHmkLpWJcUwtcIGW9lG","WOZdJmkmw8kKWP7cTI/dIdZdK8oQW7VcO8oDr2JdHGJcGSoHWO9n","FY0td3JcRG","WRv6EG","mg1vmCkKD8kdwmoO","W6FcJ19iW7e","euW4WOSg","h0xcKCozvreeWRBcOeddGCkwnSotlCkAWRbz","WRtcJchdGW","W6faW59f","FY7dPGrxWOn7W58","WRRdMWjD","jLJcI8ouraSiWR0","ddP8W74lW6/dTK/dIcOyWRG","W7HYW6pdLW7dNfTKW5dcVYqJb8oivSknxSkcW4hcVSoy","BL9cWRm","iNHSW6W6nSkAsCkFWPVdPContSomWPddHG","W6hcGsbuxIDFnmobDwZdN8kAWPi6wNddKW","W6GPv8kkW4ddJJ0xBIDNcG","WPPFW4hcHSkXW4/cLSooW7q","W4zPrCkHWOlcMgtcRa","W7hcJs4","WOxcNKaHW7aXW4JcUq3cNmo1dW","bCk0qmkO","f0m3WP8lAmor","W7xcP8kjWRVdMYfLW757W6HFW5O","oHXLEsG5cW","EY0ud2tcSG","W5/dUSo9tKpdQSo1WRxdLf/cTSkNBKbyWP5l","W5XUrgdcOW","W7VcRCkuWQFdRIDO","W5XItwZcSGa","W7uJv8klW6tdJYSk","W5m3W4a9WOu","W6VcSSkFWRddVIv9W78","W5RcNSo/kSk0jg7cIbjbxdFdRCoqW5xdHSkSWQmQCq","WRRdIrm","wmoDWPOx","W7RcN8kHiCklp3RcGLTvxJ/dJ8oqW4u","WRPFW4BcJ8kjW47cNmotW4Oqsmk7W4mDWPjd","AYJdOW","W5ZdR8oGsx/dPSoXWQNdIq","ytudzSkBzmkIBCoyW5i","kXT0ya","W5FdU8kfkmouWPb2W7NdMq","W7pdGq/cOmkrWOCmuG","W7TJrCkGWQxcHwRcRmokgfBcUHZdS0ddPmkZgqVdGG","uqavW6n/D19S","W5/dVSo9tLy","WPntW4m","W7BcJSo4lCkKpgBcLG","WOKGW6jE","WRJcJYpdNG","W6rVW6FdGa","AJ/dPKlcVSoSsJW","W6KSpSkpxIqvW5tcMa","WOVdGCkDqCoIWPRcOdpdLq","yYCoaxJcR8khEW","WOzJbsyn","WPv3aI0","W4HOtxZcMrpdIIC","WRvVzSkZudGb","FJNdP07cQCoXtd0qxcHng8otg8kh","yYKtdwdcKSkbys1C","bdxdMvldPmkr","WQmrW5DjW7PpWORcK3LuWP1dW7hdSCkTgW","dCk8wa","WPmPW6Pv","Et/dSu7cNSoQyJ4htsW","WODNbYaj","W4ZdJbzUW4GCW5q","hYxdKKBdUmkxW4tcJmkX","ymk0jHiyWRm9tZ7cQSknWPJcKCkgW4WAW48","WQddNXDmWRRdLCk7W6tcJmkyWRNdQXldG8otWRe","W5VdT8oMxLJdOCoZWRldJG","WOxcKL0","W6L1W7ldIYJdGKrX","hCorW65MEmkPW7G","mmoksmk1xxJcNCouW4vO","bmkXa8kMWPRdOmkRwSo1xtdcTWldMXWCfrldNIpcLG","WPVdHSkyq8oQWOtcTIu","WPldIhVcNMG","WOfRbW","zhDoWRxcIG","oeP0v0KE","WRT+zmkttdO","WRP7W7ddSZNcUdG5E8oAW7S","bNv7bSopW4ldHG","WPqKW7S","jv/cKCotwqWcWQdcVq","dw1ZdCoE","WP5uW5hcGSkL","k8oaxSkKwe3cNCou","WOxcNKaHW7aXW57cPam","zZOCbN/cQ8kbzJjqcmkV","WPC0W71EAwJcRCkRfW","u0RdJHW","WOJdImkAsSoNWQdcRdtdIMi","W6eLuG","kmkMW5dcUCknWRH0","WRVcLdzh","k3rQW6G1lmkwvCkc","WQpcMHhcRa","W63cSSkwWRZdQI1iW6HQW78nW5lcNmojkSkO","DZxdPKpcMSoTxcexxIvT","mNrMW70","b8ovW7T3","ftP3W6jOW6pcOG","hCkWvSk7W4FdOSoQtCo2xsBcSGG","W7NdGqdcSmk2WOGgAmkoWQWtWRRdLSo3W6O2","oaze","u1ZdTHXRW7xcKtK3WPv8","WRJdHCk7umohWQpcJZJdS1LasvhdPCk7W6dcL8oobfO","gZNdLehdPa","DN9u","p8kSW4tcOSkk","oSkVW43cTq","jG9UAa","cwvHaSoRW4pdH0fU","WPZcIviNW5m0W5JcUrFcLSo7dq","odr9W6mCcW","FstdPHHpWP4","g0m4WPGvwSoCW5hdUCod","W5PIw3ZcOGddGHfXWOxcMSkKmqhcRg/cNWa","WOXSatarWPbqumos","W5bQu8kW","bmorW6v6g8kLWQ7cR3nkD0y","EtZdSeRcUmoMsJmkBYT0fCoChCkwtCkt","W6GPv8kkW4tdIsSk","W4FdUSkElSoCWOP6W6xdHmofF8k9W67cUHmA","DSk+iG","W4nOr23cUYtdHI5NWOe","W7ZdGrldUCkSWOmarCkzWQe","dWziWQ4","WOxcLfCSW4WpW5dcPHhcMG","W5pdSSkclSotWQP6W77dHSob","zN5hWQ4","o25coCkSE8kctCo9W7O","W6tcI8oGk8kt","kq9UEsa","WQ/dJmkMrCkgWQtdJIRdT25msvRdRmkNW4BcI8or","khr7W60Qf8kdqSkqWO7dRa","p0PUqKua","BJxdRv/dUCoHcZmlssTchSoDa8kNv8kqWPa","FhnhWQtcNbJcOmoGjCkWeW","W4HOtxZcNGBdGI8","labbWQiBgdLJ","W4W5W4u","jwpdS1OiveLCla","h8orW6rMiSkUWRBcSa","WQ7dJXyDnxfKhW","WQFdJHzuW6W","tYT7W7b3WQFcOvpdLs8","lSk6qSkRWRNdP8kWtCoQvsxcSG","ydGCbG","kgJcPwJcKSoqFWG6","w8oBWPmBW6bLW5BdKW","k3rTW6enlCkCsa","yJmizSoIC8kow8okW7We","WQ3dKaqA","jgNdSG","WROrW5TCWRTcW4xcJ0jEWOrs","m8kXW5ZcPCkxWQ1JWQapuHW7WQJdGGldRsqm","W5FdNqHoW5GpW5bc","WP3dJ3NcJuCQWPZdRcNcSW","gSkWt8k9WPFdRG","WOaKW7T+rMlcRmkHcXbiW7nowW","WRZdJ8kWtCkaWQ7dJIu","W77cRCkuWQFdMcbMW6G","W4bNwSk9WPm","W77cLCoQlq","bt/dGG","W5m9W5q3WQaMeXebsq","WP7cML88W4u","WOvFW5tcG8kCW5lcSSopW7uqrCkCW4qsWPvkia","W6eTumkdWR3dKgLqy3jKaIHfW7C","WR94W7xdOJ7cVX4XA8oeW7q","p8kIW4xcQmkkWQS","daPaWRGFfdv5W4KHtW","jGTUAdu0","W4ldUSo7xf/dOCoZWRldJG","eSknW5zeW5vTW5FdPfbK","m2xdSa","WOtcNL0UW5qX","eeGGWPGl","W4W9W4eYWO07iGCk","W5u9W40NW5iXArKCswOaW4CtW7tcOW","W7JdGqxcSCkZWRaaw8kpWQW","b29Kd8oj","h0WIWP4p","WQZdJXatkxzUaGu","muPZxNaAgYNdHq","hCkWvSk7W4FdOSoQtCo2schcRd7dMLWAcaJdLchcLa","x8orWPGgWQDOWPFdLfrwigaoW6VdSCkx","WPrXW6FdVJ3cVXa7zCoNW7lcILTmaSkmbG","WQzWcdyrWQvzzCohyKNcHmkwW7VcKa","rqyq","W7ePxmkwW6xdLcePzJq","rCoFxCkG","msnHW6SA","W7JcGsTipsSijmojE2JdGq","WRNdNXXqW5NdMCo6W7JcHa","W5jVqa","kqzHFqiZggdcNmkV","oSkQW4tcQmkl","D8o4ECkeW5WiWQtcQSketa","WQhdHCkWtmkNWRpdGcxdP11rwa","Ef3cI8osxG","oComwG","W5BdKr5oW5K","gdxdIehcV8kbWOpcHmk5wun/W5LBWPK","W7RcNSo/kSk0jg7cIbjbxdC","lmkIW5RcVSkD","WQH0ECkoxselW5e","W746W5KYWO8+","keP4qHmwwJtdI8oUW4G","W4jJtSk8W4xcLq","n2Hg","btz5","FNDmWQC","fKqKWPGeECoCW5RdO8okW5uNW78emfO","DuBdJq0","oSkQW4tcUCkDWRG","kmkMW5dcUColWQ4/WReqsrWSWOldJahdKa","ECk/mG4","WRZdKSkQsCkvWRxdMa","WPRdGNRcIMm","y8oYDa","WRvNaZyvWQfwxmopyeK","W5xdNqjoW4qEW5rJWP3dTq","WOOKW7XtEM/cUmk3daDRW6y","h0GLWPu3zComW4BdPmoiW5Gh","W5u9W40NW5iXabexwhKnW50zW7u","WQJcGJNdGve/aYOJ","W6GJqmkhW7ZdScuiCIe","jZrN","WPVdGCkvxCoyWOtcPcpdJ2NdLW","WR4AW59iWR1/W4hcM2i","W5r+WOhcPSkBWPldHa","WRmDW5K","o1JcNmoyxdqgWR/cU1e","z8k4mbua","gCorW6rHo8kOWRtcQhnFC2NcMeZcG2ZcSG","BL93WPW/mJjE","gdxdIehcV8kbWOpcJ8kIq1zOW45sW5i","oLJcMCozBWqiWR3cUMVdQSkwk8oAoSkx","Fd/dU1/cMCoSxZC","WQNcNsNdHuW9bYS","WRJdKWfDW5RdGCo0W7xcISkdWRK","fg9Ha8opW4ldH0e","WPFdM8kar8oKWPpcTYhdLM/dMCoHW5NcSmodr27cMG","vqOEW744EG","WRZdGCk3tmkh","nb1xWQ0","WQhdK2WyxxChhCokvfRdQa","kGPaWR8geJDH","WPNdGMZcVwSWWPBdRqhcQCkzoGVdUmooW6JdPar+k8ob","WPqPW6zvq2NcPmk3fG","W4nIugdcHXRdNJf7WOFcL8kT","nCokxSk5s0hcKSomW5fH","DZxdPKpcNSoQsJW","jYv2W7qB","WRxcIYRdLvWL","WRBdHqWtkwW","WOtcMKeUW4u","WR7cHdO","mgbDnCkKDCk4qmoSW7m","WQ3dJXCa","WPbFW5RcISk4W5xcGCoe","W4ldT8kidSojWPT9W77dPSonymkfW6lcSX4C","BcddUaHrWOTaW4HJWOW","WOSUW6bqA3m","m8kZW43cO8k+WQv/WRu7sbqVWO7dKq","iN9jahVcQSkzFGi","mabv","cmoWW5qZW5i/WO4","WR/cGZJdLfa0fq","lGPFWQqzfa","WO4VW7TErhtcQmkWha","WPrXW6FdVJNcUba7t8olW6FcM0XxcSkb","WQRcGJ/dJ004ctC","WRpdGr0","avKVWPec","aMX3eG","W6GPv8kkW4pdKIukyYv0aG","dd5/","ofBcLCoy","bCk6sq","cJ/dHG","gJhdNeddQq","mCk3W4tcMCkbWRP0","lN5SW6aJlCkDuSkqWPy","W7tcLmoGlCkv","WQ3dHre","nM9rmSk6CCki","bSkLs8kHWRldQCkQxmoCtIxcQqJdHW","EYtdRrKqWO46W4n2WO8nmZ8uzCooWRHTwq","W6aIr8knW7tdJYOd","et59W6u+","beW6WOGc","zmk4ia0n","WOOUW6TErLhcOmkOeae","omkQW54","zSo/zG","WQ1XW6ZdOL7cS1eZBCoeW6FcRvDedG","yCo+CCkcW7WOWQdcU8kOt8kN","cJ/dNKhdGSkeW4dcHW","W6hdIXNcOmoSWOjpuCkvWQCkWOZdM8o7W7C/W4i","FCkWiaijWQyDvdVcS8kA","D3HbWQ/cIYtcVSoJ","ys0BbgNcPCkCFdDqe8k4","WRpdHryCexbYaH92W55M","W4ZdNqLsW6eeW4HDWPxdPHpcQq","nN53W6CTdSkAqCkzWO4","oKbUqM4tgsi","WR19W6i","W4H1tgu","gCoBW6v7p8kKWRJcSG","hCkWvSk7W4FdOSoQw8o5sIhcNX7dOvqsdaZdNdVcLG","hKiX","WROvW5C","mubKu0WKfsVdL8oX","eLzEWRO5uKz0ieP6","WPtcGu8kWOzyW4jEWR/dGsFcOG","WQxcNKaHW7mTW5dcPadcNSoMb8kMWOBcK2ZdPCopudK","bt3dKvldQq","mgNdSNGmx0fkmCoBW4TrWRZdT1rmW7JdI8kGfmkvWOe","nmkMW4hcQSkqWR4","keP4qLuaeqRdG8oK","WOZcKKu","WPbOWOvJ","gdxdIehdRCkxW4JcGW","WPZdGmkc","WPCGW71itW","WOHNaI01WQXmw8opDu3cMG","v1BdJaPJW4pcHJ83WO1+W7NcVxldGSkavG","WQ/dJ8kVs8kg","h0bTrK8hgIpdSSo1W5LE","j2LvpG","W5PVsMVcVbZdGJfH","ih1XW6yR","WOtcMLeSW4W","W4bMtM0","kaPkWR9CfxH9W48Kq3DbW4PUeW","W5xdNqjoWOiiWP9EWPldOIhcRmkBwq","W4BdVCknkCotWPT3","aKWKWO4c","WOJdHSkDqCo/WRJcRcFdJNm","W4RdU8oMsvZdVq","W4PMugdcSHy","W6FcLmoLlmkthgBcGr5u","kaDBWQGehZn+W5m","qItdPGv3WOv7W59EWOGvmY4jBCou","idrRW7bBb8oCoSkJWPXXW63cGSk6zq","yxnfWQ3cIIpcPmo3","WRzMW6ddVGlcSa00CSocW7RcNx1FbSkigmod","bWTZzXe0bxBcTmk4WORcQwBcPmk0pXBcJCoOWRa","mNL7W6C","WPzYfcyqWQHuwG","WO19W7RdRYRcVHiL","pGT4E3i4uMBcSSk3WOtcTW","W4nIugdcHXRdIcX1","sLBdJrfdW47cIIu5","eJP7","W55IuxVcPXFdHdz7WPlcK8kceWtcQhpcMq","W67dTSkFi8oVWPz8W6tdJCoPCSkfW6lcRXipAW","amozW7D1lSkEWR7cPN8","yItdOqXpWOrXW4jG","raehW6HNE1q","ztvaka","W5DIuSknWOdcLgxcTSoIefFcQJtdVfhdSW","WPZdJmkew8oJ","agrCnCk1ymomF8oZW7G1","u1BdHG1MW5tcGay/WOS","WRVdLanxW6JdLq","WPvTaIWrWQ1ArG","W4FdUSkA","rGOs","W7xcRCkEWRBdPX99W6fNW64","W6pdJW3cOCk6","W5xdNqjoWOiiWP9nWPtdPadcLSkrxCoWW71xgW","gdxdIehcV8kbWOa","W6DUW6RdIWRdIG","WRddJWSr","W5RcNSo/kSk3ogdcIbfTtYFdHCodW4JdGSkY","qbvMWR4/wmoVW6/dIq","oJr2W6aBnSkcoSkRWPPy","yx5lWQ7cHIpcTCo3nW","WO7dImkywSoU","W4C0W5aR","zJZcTHHaxf5koG","WOJdHSkDqCo/WPhcTW","bgNdP08duGXjmmobW4W","hCovW6r1lSk5","oCkNW4hcUCox","pX5Syca4i2pcSSk1WP/cML/cSCkM","WPVdJmkAw8oUWOy","dtPHW7eVW68","cwvHaSoVW4tdH0e","WRJdHCk7umohWQpcJYNdPKPgua","WR7dJ8k2q8kCWQNdHdJdSa","ymk+jWGCWR8Xvq","WPPvW5hcGSkXW7FcKSorW7iu","gSoBW6rM","WRrXW6FdVJ7cOX47zSolW6hcMG","b29+bCoj","d8oyW7nQ","WRJdHCk7umohWQpcJYBdT1b3ru3dOCoN","WOeTW6Pd","W7xcP8kjWRVdMd19W6n2W6PmW5i","u1VdMXC","W7NdGqdcSa","WPJcJKaH","W7FdMWJcUmkRWO8p","W7X5W7BdGq","ENnlWQFcHZK","W41MtM3cPrpdSZTIWOe","WOZdIg3cMgWRWP3dUHS","DSoZAmkeWPW8W6/cQ8kGv8kLmCkukmkGW58","WR/dLmkXtCkAWQddIc3dUG","WPpdHryCeMXQhXj0W41UW7GJW7WvWQDfW4KY","W6GMWQZcOfNcSb03vmoaW5y","W6ldUSo8vx7dRSoIWQldNfNcNSkfE0HpWOvlWRy","j2pdTvquu0nb","mwddQvis","p25xpW","otrGW6W4c8kllCkJWO1CW6G","WPHiW4hcJ8kYW4BcGCoCW7CzvCk9W7ivWP5kimkm","WR1XW6FdTr/cVG8HA8ofW70","a2vM","pMrdomkgFmkdv8o7","heiKWPagyCoCW4/dQa","u1BdHG0GW4ldIZSXWOHYW47cTxddICkQ","hcldLuBdQCkxW5VcH8ksxwnMW5DzWPTzW4BdUmott8ke","FwrwWQJcGcRcOSoLnmkSh8kaBCoqdCkjBNW","dJxdHLddOa","W7VcNSoIjCktoa","WP7dHSkAw8ofWPxcQcu","W55OughcOXVdIcW","WQ18W7hdUa","bCoDW7H3gmk9WRBcV3nhCq","DYel","W4JdLHXv","o8okqSkKF0/cKCoD","iGTPAcKO","WOSGW6fC","ma5CWQW","osv/W5are8kx","lXPrWQGkaIu","hCorW65MpSk/WRlcKxTz","kaPkWR9CfxH5W4uVxNzAW4btkaddPhq","W7RcLmoOj8klbM7cIGnf","W7uJtCkmW6tdQI0dBZa","WRFdLGPzW7VdKSo6W7FcL8k/WRhdTHVdJSooWQCmwa","EYtdRrLwWPHXW7XYWPK","evGKWOScxSoqW5ldOmooW5CFW6u","nCkTW5JcUmkm","q3aXWQP0W7tdUvVcNW","W6ZcRCk4WR/dPcS","kCoavmkKrfZcMCo1W5f9","at/dLfddOmkZW4ZcJSkJsG","oMpdOLGmBe1dkSok","iJ/dNLa","ftP3W6iUW7xdQNhdGdK","W4W3W5e2WO0djHGmwa","xmknWQmIFmo5WQtcRfLTq00","W4W9W4y7WRe9pGCqxMOa","WQTPAq","W6yJsmknW6i","kN59W6G1jW","WQurW4LrWQXiW5dcIMboWObo"];return(lh=function(){return t})()}!function(t,e){const n=612,i="jBgu",r=625,s="(Q*U",a=303,o="&^wU",l=299,h="tzxO",c=813,u="7(so",d=893,p="WQXK",f=276,m="$u$y",g=955,v="lg6T",_=308,x="s[Tb",y=455,S="9oXx",b=1284,M="$MoL",w=991,C="xzGU",T=oh,E=lh();for(;;)try{if(201680===-parseInt(T(n,i))/1*(parseInt(T(r,s))/2)+-parseInt(T(a,o))/3+-parseInt(T(l,h))/4+-parseInt(T(c,u))/5*(parseInt(T(d,p))/6)+-parseInt(T(f,m))/7*(parseInt(T(g,v))/8)+-parseInt(T(_,x))/9*(-parseInt(T(y,S))/10)+parseInt(T(b,M))/11*(parseInt(T(w,C))/12))break;E.push(E.shift())}catch(A){E.push(E.shift())}}();const hh=t=>(X(ah(745,"82&^")),t=t(),j(),t),ch={class:ah(995,"jBgu")},uh=[ah(1188,"tzxO")],dh=[hh((()=>b(ah(265,"DTCC"),{src:ft,alt:ah(929,"xzGU")},null,-1)))],ph=[ah(1188,"tzxO")],fh=[ah(823,"7(so")],mh=[ah(490,"5o93")],gh={key:0},vh={class:ah(1147,"@&40")},_h=hh((()=>b(ah(362,"EtaP"),{id:ah(1265,"ngAa")},[b(ah(372,"s[Tb"),{width:ah(900,"vM3^"),height:ah(514,"o8ih"),id:ah(576,"lg6T")})],-1))),xh={class:ah(1091,"s[Tb")},yh={style:{"font-size":ah(1199,"sWYd")}},Sh={class:ah(633,"XqkM")},bh={key:0},Mh={key:1},wh={class:ah(667,"w6Dt")},Ch={class:ah(518,"qGcn")},Th={class:ah(501,"[d42")},Eh={style:{height:ah(335,"vM3^"),display:ah(269,"lg6T"),"justify-content":ah(966,"w6Dt"),"align-items":ah(498,"5UlT")}},Ah={style:{height:ah(412,"aWYH"),display:ah(853,"EtaP"),"justify-content":ah(655,"(Q*U"),"align-items":ah(712,"$MoL")}},Ph={class:ah(705,"55U3")},Rh={key:0},Wh={class:ah(1110,"q62Z")},Lh={key:0},Ih={class:ah(282,"s[Tb")},kh=s({__name:ah(661,"qGcn"),setup(t){const n=1089,i="bQ1J",r=703,s="7(so",X=1050,j="XqkM",J=357,Q="qGcn",ft=960,mt="dTQt",vt=1151,_t="@&40",xt=650,yt="w6Dt",St=270,bt="lg6T",Mt=768,wt="krV0",Ct=1138,Tt="TMxE",Et=408,At="1!88",Pt=894,Rt="[d42",Wt=1227,Lt="@&40",It=808,kt="qGcn",Nt=536,Ot="xzGU",Dt=1260,Ft="PNut",Bt=845,zt="o8ih",Vt=1099,Gt="^[im",Ht=657,qt="EtaP",Xt=1032,jt="0X9c",Jt=375,Qt="ZoZr",Kt=798,Zt="Plf*",Yt=546,$t="XqkM",te=570,ee="(hv1",ne=1117,ie="ue3n",re=231,se="vM3^",oe=1101,le=723,he="&^wU",ce=284,ue="]cI3",de=577,pe="s[Tb",fe=765,me=409,ge="xzGU",ve=791,_e="ngAa",xe=1073,ye="82&^",Se=1012,be="WQXK",Me=940,we=557,Ce=942,Te="jBgu",Ee=599,Ae="(hv1",Pe=543,Re="55U3",We=1158,Le="L4Dk",Ie=545,ke="lg6T",Ne=1136,Oe="1!88",Ue=1062,De="$u$y",Fe=1173,Be="5o93",ze=331,Ve="EtaP",Ge=911,He="[d42",qe=1244,Xe="EtaP",je=709,Je="]cI3",Qe=410,Ke="0X9c",Ze=289,Ye="xzGU",$e=826,tn="@&40",en=271,nn="55U3",rn=1224,sn="Plf*",an=833,on="q62Z",ln=237,hn="TMxE",cn=511,un="jBgu",dn=1214,pn="aWYH",fn=1068,mn="tzxO",gn=407,vn="(Q*U",_n=1287,xn="krV0",yn=597,Sn="XqkM",bn=1043,Mn=1243,wn="&^wU",Cn=407,Tn="(Q*U",En=320,An=382,Pn="ZoZr",Rn=461,Wn="lg6T",Ln=839,In="55U3",kn=352,Nn="7(so",On=736,Un="1!88",Dn=1205,Fn="9oXx",Bn=565,zn="5o93",Vn=285,Gn="xT8v",Hn=663,qn="[d42",Xn=1098,jn="$u$y",Jn=688,Qn="EtaP",Kn=604,Zn="tzxO",Yn=1121,$n="TMxE",ti=827,ei="1!88",ni=1e3,ii="jBgu",ri=243,si=990,ai="q62Z",oi=1282,li=854,hi="82&^",ci=1285,ui="ue3n",di=979,pi=970,fi="5UlT",mi=781,gi="DTCC",vi=313,_i="w6Dt",xi=260,yi="XqkM",Si=609,bi="qGcn",Mi=727,wi="L4Dk",Ci=1210,Ti="0X9c",Ei=339,Ai="krV0",Pi=500,Ri="@&40",Wi=770,Li="yJjA",Ii=507,ki="ngAa",Ni=595,Oi=987,Ui="@&40",Di=1127,Fi="bQ1J",Bi=549,zi="XqkM",Vi=904,Gi="Plf*",Hi=1123,qi="aWYH",Xi=583,ji="$u$y",Ji=664,Qi="XqkM",Ki=473,Zi=1120,Yi="o8ih",$i=1150,tr=527,er="]cI3",nr=405,ir="PNut",rr=741,sr=1212,or="&^wU",lr=644,hr="ZoZr",cr=346,ur=532,dr="vM3^",pr=1262,fr="lg6T",mr=1211,gr="bQ1J",vr=1291,xr="s[Tb",yr=735,Sr=1184,br="82&^",Mr=846,wr="^[im",Cr=821,Tr=794,Er="Q3Ap",Ar=679,Pr="sWYd",Rr=947,Wr="ue3n",Lr=338,Ir="(Q*U",kr=1041,Nr=292,Or=1074,Ur="ue3n",Dr=1289,Fr="bQ1J",Br=1132,zr="(Q*U",Vr=1119,Hr="DTCC",qr=330,Xr="$MoL",jr=870,Jr="Q3Ap",Qr=351,Kr="TMxE",Zr=789,Yr="9(V$",$r=1051,ts="s[Tb",es=998,ns="xzGU",is=429,rs="9oXx",ss=1233,as="9oXx",os=1039,ls="L4Dk",hs=267,cs="o8ih",us=296,ds="]cI3",ps=654,fs="$MoL",ms=1015,gs="1!88",vs=238,_s="PNut",xs=687,ys=692,Ss="lg6T",bs=896,Ms="dTQt",ws=278,Cs="EtaP",Ts=749,Es="]cI3",As=721,Ps="$fSK",Rs=811,Ws="Q3Ap",Ls=302,Is="@&40",ks=575,Ns="$fSK",Os=383,Us="PNut",Ds=847,Fs="7(so",Bs=513,zs="(hv1",Vs=838,Gs="qGcn",Hs=251,qs="krV0",Xs=1216,js="$MoL",Js=738,Qs="tzxO",Ks=533,Zs="xzGU",Ys=775,$s="krV0",ta=333,ea="ngAa",na=994,ia="dTQt",ra=910,sa="L4Dk",aa=1067,oa="(Q*U",la=683,ha="0X9c",ca=440,ua="xT8v",da=569,pa="5UlT",fa=402,ma="lg6T",ga=985,va="9(V$",_a=528,xa="[d42",ya=852,Sa=542,ba="@&40",Ma="(Q*U",wa=634,Ca="0X9c",Ta=840,Ea=")Qlt",Aa=564,Pa="dTQt",Ra=934,Wa="(hv1",La=858,Ia="0X9c",ka=720,Na="q62Z",Oa=863,Ua=1237,Da="lg6T",Fa=294,Ba="1!88",za=446,Va=580,Ga=812,Ha="5o93",qa=1008,Xa=624,ja="TMxE",Ja=441,Qa="7(so",Ka=732,Za="aWYH",Ya=737,$a=820,to="w6Dt",eo=993,no="dTQt",io=444,ro=890,so="xT8v",ao=997,lo="qGcn",ho=350,co=841,uo="1!88",po=378,fo=831,vo="7mHk",_o=1025,xo=941,yo=400,So="$fSK",bo=915,Mo="55U3",wo=451,Co=921,To=754,Eo=367,Ao="]cI3",Po=482,Ro="WQXK",Wo=832,Lo="^[im",Io=1274,ko=522,No="jBgu",Oo=790,Uo=1066,Do=439,Fo=848,Bo="1!88",zo=436,Vo=1270,Go="qGcn",Ho=1145,qo=582,Xo="s[Tb",jo=1145,Jo=1298,Qo=632,Ko=783,Zo="(Q*U",Yo=1001,$o=797,tl=1070,el="7(so",nl=971,il="Q3Ap",rl=805,sl="7mHk",al=1022,ol="82&^",ll=993,cl="dTQt",gl=1061,vl="$fSK",_l=590,xl="PNut",yl=883,Sl=602,bl=445,Ml=611,Cl="ZoZr",Tl=938,El="ue3n",Al=1008,Pl=1270,Rl="qGcn",Ll=483,Il="vM3^",kl=1156,Nl="9(V$",Ul=283,Fl=993,Bl="dTQt",zl=562,Vl=1046,Hl=537,ql="$MoL",Xl=708,jl="DTCC",Jl=875,Kl=1010,Zl=773,Yl=298,$l="vM3^",th=638,eh="TMxE",nh=1232,ih="EtaP",rh=552,lh=295,hh="qGcn",kh=1014,Nh="]cI3",Oh=1230,Uh="PNut",Dh=982,Fh="[d42",Bh=629,zh="Plf*",Vh=967,Gh="$u$y",Hh=488,qh="TMxE",Xh=1096,jh="&^wU",Jh=568,Qh=520,Kh=859,Zh="0X9c",Yh=1086,$h="bQ1J",tc=1234,ec="&^wU",nc=409,ic=344,rc="7mHk",sc=859,ac=860,oc="aWYH",lc=605,hc=453,cc="XqkM",uc=1222,dc="$MoL",pc=979,fc=906,mc=1094,gc=974,vc="xzGU",_c=288,xc="[d42",yc=750,Sc=263,bc="TMxE",Mc=1107,wc="yJjA",Cc=1140,Tc="lg6T",Ec=935,Ac="55U3",Pc=1261,Rc="(Q*U",Wc=259,Lc="ue3n",Ic=1135,kc=547,Nc="vM3^",Oc=928,Uc=1269,Dc="9oXx",Fc=1058,Bc="PNut",zc=305,Vc="DTCC",Gc=659,Hc="s[Tb",qc=761,Xc="$MoL",jc=957,Jc=1220,Qc="ue3n",Kc=663,Zc=746,Yc=349,$c=922,tu=")Qlt",eu=862,nu=487,iu="XqkM",ru=698,su="82&^",au=1056,ou="yJjA",lu=332,hu="^[im",cu=926,uu="]cI3",du=1056,pu="yJjA",fu=933,mu=696,gu=539,vu="sWYd",_u=803,xu=1180,yu=517,Su="PNut",bu=254,Mu="9oXx",wu=249,Cu=671,Tu="L4Dk",Eu=1239,Au="DTCC",Pu=674,Ru="TMxE",Wu=1040,Lu=689,Iu=996,ku=468,Nu=530,Ou=255,Uu="Q3Ap",Du=394,Fu=380,Bu="^[im",zu=1126,Vu=710,Gu="5UlT",Hu=264,qu="w6Dt",Xu=531,ju="jBgu",Ju=228,Qu="[d42",Ku=614,Zu="55U3",Yu=1036,$u=465,td=")Qlt",ed=730,nd="dTQt",id=504,rd="5o93",sd=392,ad="PNut",od=319,ld="jBgu",hd=714,cd="9(V$",ud=475,dd=499,pd="Plf*",fd=717,md=956,gd=389,vd="PNut",_d=1006,xd=734,yd=1255,Sd="TMxE",bd=1200,Md="lg6T",wd=469,Cd="]cI3",Td=486,Ed=449,Ad="0X9c",Pd=291,Rd=864,Wd=907,Ld=368,Id="(hv1",kd=603,Nd=1072,Od="$fSK",Ud=759,Dd=293,Fd=1027,Bd=868,zd=822,Vd=690,Gd=1245,Hd=753,qd=340,Xd="&^wU",jd=627,Jd="XqkM",Qd=658,Kd=428,Zd=1102,Yd=601,$d="(hv1",tp=343,ep="ngAa",np=753,ip="[d42",rp=297,sp=690,ap="7mHk",op=572,lp="XqkM",hp=311,cp=")Qlt",up=645,dp="[d42",pp=246,fp="sWYd",mp=851,gp="q62Z",vp=740,_p="DTCC",xp=1042,yp="7mHk",Sp=470,bp="qGcn",Mp=992,wp="ZoZr",Cp=381,Tp="WQXK",Ep=1203,Ap="82&^",Pp=637,Rp="1!88",Wp=478,Lp=1118,Ip="7(so",kp=258,Np="@&40",Op=387,Up="jBgu",Dp=414,Fp="DTCC",Bp=1153,zp="TMxE",Vp=807,Gp="xT8v",Hp=694,qp="Plf*",Xp=561,jp="(Q*U",Jp=462,Qp="5o93",Kp=777,Zp="s[Tb",Yp=980,$p="ngAa",tf=884,ef="$MoL",nf=630,rf="(hv1",sf=1007,af="w6Dt",of=392,lf="PNut",hf=281,cf="Plf*",uf=983,df="sWYd",pf=1019,ff="5o93",mf=1168,gf="$fSK",vf=1294,_f="EtaP",xf=651,yf="@&40",Sf=229,bf="dTQt",Mf=1168,wf="$fSK",Cf=364,Tf="ue3n",Ef=916,Af="lg6T",Pf=989,Rf="5UlT",Wf=1047,Lf="o8ih",If=573,kf="(Q*U",Nf=1229,Of="q62Z",Uf=571,Df="w6Dt",Ff=404,Bf="^[im",zf=786,Vf="PNut",Gf=1003,Hf="0X9c",qf=736,Xf="1!88",jf=1178,Jf="ZoZr",Qf=646,Kf="9oXx",Zf=794,Yf="Q3Ap",$f=1189,tm="lg6T",em=584,nm=463,im="q62Z",rm=1052,sm=1215,am="ngAa",om=1028,lm="tzxO",hm=842,cm="aWYH",um=1295,dm="$MoL",pm=366,fm="$MoL",mm=774,gm="aWYH",vm=743,_m="[d42",xm=944,ym="$fSK",Sm=744,bm="qGcn",Mm=963,wm="5o93",Cm=1281,Tm="5UlT",Em=1144,Am="55U3",Pm=431,Rm="[d42",Wm=1077,Lm="WQXK",Im=1053,km="7mHk",Nm=616,Om="PNut",Um=764,Dm="xzGU",Fm=1177,Bm="s[Tb",zm=1242,Vm="TMxE",Gm=373,Hm="bQ1J",qm=1088,Xm="xT8v",jm=1201,Jm="ZoZr",Qm=337,Km="krV0",Zm=1171,Ym="&^wU",$m=361,tg="dTQt",eg=681,ng="ngAa",ig=641,rg="0X9c",sg=799,ag="WQXK",og=1217,lg="5UlT",hg=1100,cg="Plf*",ug=252,dg="w6Dt",pg=1109,fg="$fSK",mg=309,gg="(hv1",vg=1044,_g="L4Dk",xg=416,yg="@&40",Sg=984,bg="9oXx",Mg=314,wg="7mHk",Cg=1019,Tg="5o93",Eg=466,Ag="xT8v",Pg=1044,Rg="L4Dk",Wg=523,Lg="1!88",Ig=1009,kg="xzGU",Ng=245,Og=434,Ug="q62Z",Dg=908,Fg="jBgu",Bg=886,zg="(hv1",Vg=248,Gg="0X9c",Hg=348,qg="$MoL",Xg=739,jg="PNut",Jg=491,Qg="5o93",Kg=521,Zg="aWYH",Yg=869,$g="lg6T",tv=1258,ev="q62Z",nv=550,iv="82&^",rv=779,sv="WQXK",av=369,ov="q62Z",lv=897,hv=1029,cv="bQ1J",uv=310,dv="bQ1J",pv=895,fv="0X9c",mv=467,gv="[d42",vv="$u$y",_v=475,xv="$fSK",yv=1290,Sv=506,bv="vM3^",Mv=1208,wv="ZoZr",Cv=711,Tv="L4Dk",Ev=1141,Av="&^wU",Pv=879,Rv="9(V$",Wv=1271,Lv="s[Tb",Iv=558,kv="(Q*U",Nv=1183,Ov="vM3^",Uv=407,Dv=442,Fv="ue3n",Bv=1148,zv="7(so",Vv=336,Gv="0X9c",Hv=447,qv="$u$y",Xv=660,jv="EtaP",Jv=474,Qv="@&40",Kv=1170,Zv="tzxO",Yv=805,$v="7mHk",t_=355,e_="0X9c",n_=1033,i_="$u$y",r_=1219,s_="DTCC",a_=247,o_="krV0",l_=563,h_="Q3Ap",c_=495,u_="$fSK",d_=325,p_="ZoZr",f_=409,m_="xzGU",g_=1154,v_="WQXK",__=1079,x_="Q3Ap",y_=510,S_="DTCC",b_=358,M_="9oXx",w_=967,C_="$u$y",T_=324,E_="Q3Ap",A_=1179,P_=")Qlt",R_=241,W_="EtaP",L_=1059,I_="XqkM",k_=1157,N_="82&^",O_=509,U_="yJjA",D_=837,F_="q62Z",B_=792,z_="aWYH",V_=973,G_="5o93",H_=653,q_="9(V$",X_=1174,j_="@&40",J_=232,Q_="(Q*U",K_=327,Z_="vM3^",Y_=464,$_="dTQt",tx=1016,ex="7(so",nx=581,ix="$fSK",rx=1125,sx=856,ax="s[Tb",ox=621,lx="1!88",hx=578,cx="^[im",ux=321,dx="$MoL",px=420,fx="jBgu",mx=1153,gx="TMxE",vx=ah,{t:_x}=a();Ql[vx(n,i)](new(Ql[vx(r,s)])(1,1)),Ql[vx(X,j)][vx(J,Q)]=!1;let xx=null,yx=null,Sx=null,bx={},Mx={},wx={};const Cx=[vx(ft,mt),vx(vt,_t)],Tx=o({selected:Cx,locale:{collapseText:_x(vx(xt,yt)),expandText:_x(vx(St,bt))}}),Ex=t=>{Wx(p())},Ax=l(""),Px=l(h),Rx=()=>{const t=vx;Px[t(ux,dx)]=I(Px[t(px,fx)],Ax[t(mx,gx)])},Wx=t=>{const e=437,n="tzxO",i=360,r="7mHk",s=1083,a="55U3",o=vx;let l=[...h];1==Tx[o(b_,M_)][o(w_,C_)]&&(l=Tx[o(T_,E_)][o(A_,P_)](o(R_,W_))?l[o(L_,I_)]((t=>0==k(t[o(hx,cx)]))):l[o(k_,N_)]((t=>1==k(t[o(ox,lx)])))),"en"==t?(l=l[o(O_,U_)]((t=>"en"==t[o(1297,"yJjA")])),l[o(D_,F_)](((t,l)=>{const h=o;return-l[h(e,n)][h(i,r)](t[h(s,a)])}))):(l=l[o(B_,z_)]((e=>"en"==e[o(425,"w6Dt")]||e[o(593,"&^wU")]==t)),l[o(V_,G_)](((e,n)=>{const i=o;return e[i(J_,Q_)]===t&&n[i(K_,Z_)]!==t?-1:e[i(Y_,$_)]!==t&&n[i(tx,ex)]===t?1:-n[i(nx,ix)][i(rx,Q_)](e[i(sx,ax)])}))),Px[o(H_,q_)]=I(l,Ax[o(X_,j_)])},Lx=o({inputText:vx(Mt,wt),openFontDrawer:!1,autoClip:!0,perspectiveCamera:{fov:45,position:{x:0,y:-200,z:1200}},orthographicCamera:{position:{x:0,y:-200,z:1200}},fontSize:240,imageSize:1e3,fontName:vx(Ct,Tt),depth:800,steps:1,curveSegments:12,bevel:{enabled:!1,thickness:200,size:20,offset:0,segments:5},pointLight:{enabled:!0,position:{x:0,y:0,z:1200}},directionalLight:{enabled:!0,position:{x:0,y:0,z:1},intensity:1},spotLight:{enabled:!1,position:{x:0,y:0,z:1200}},cameraType:vx(Et,At),mtlType:vx(Pt,Rt),mtlColor:vx(Wt,Lt),charSpacing:20,lineSpacing:20,meshPhong:{color:vx(It,kt),specular:vx(Nt,Ot),shininess:70,flatShading:!0},meshStandard:{color:vx(Dt,Ft),roughness:.7,metalness:.7},meshToon:{color:vx(Bt,zt)},meshPhysical:{color:vx(Vt,Gt),roughness:.7,metalness:.7,reflectivity:0,transmission:1,clearcoat:.3,clearcoatRoughness:.25,ior:1.2,thickness:10},textureMap:{scale:1,type:vx(Ht,qt),id:vx(Xt,jt),map:null},pathOffset:0,matcapColor:vx(Jt,Qt)}),Ix=[vx(Kt,Zt),vx(Yt,$t)],kx=[vx(te,ee),vx(ne,ie),vx(re,se),vx(oe,At),vx(le,he),vx(ce,ue),vx(de,pe),vx(fe,Zt)],Nx=l([]);Nx[vx(me,ge)]=[{id:vx(ve,_e)},{id:vx(xe,ye)}];const Ox=t=>{const e=vx;return e(__,x_)+t+e(y_,S_)},Ux=t=>{const e=vx;t[e(Ev,Av)]=16,t[e(Pv,Rv)]=ae,t[e(Wv,Lv)]=t[e(Iv,kv)]=Ut;let n=t[e(Nv,Ov)][e(Uv,kv)]/t[e(Dv,Fv)][e(Bv,zv)],i=1/Lx[e(Vv,Gv)][e(Hv,qv)]/t[e(Xv,jv)][e(Jv,Qv)];t[e(Kv,Zv)][e(Yv,$v)](i,i*n),t[e(t_,e_)]=!0,Lx[e(n_,i_)][e(r_,s_)]=t,$x()},Dx=()=>{const t=vx;N({accept:t(Og,Ug),multiple:!1})[t(Dg,Fg)]((n=>{const i=927,r="L4Dk",s=t;Array[s(Bg,zg)](n)[s(Vg,Gg)]((t=>e(this,null,(function*(){const e=1024,n=")Qlt",a=666,o="ngAa",l=401,h="0X9c",c=1033,u="$u$y",d=623,p="9oXx",f=s;O(t)[f(i,r)]((t=>{const i=f;Lx[i(e,n)][i(a,o)]=i(l,h),Lx[i(c,u)].id=t,(new wl)[i(d,p)](t,(function(t){Ux(t)}))}))}))))}))},Fx=t=>{const e=vx;if(Lx[e(xg,yg)][e(Sg,bg)]=e(Mg,wg),Lx[e(Cg,Tg)].id=t,t==e(Eg,Ag))Lx[e(Pg,Rg)][e(Wg,Lg)]=null,$x();else{ty(Ox(t))[e(Ig,kg)]((t=>{Ux(t)}))[e(Ng,yg)]((t=>{}))}},Bx=c((()=>{const t=vx;return Lx[t(sg,ag)][t(og,lg)]==t(hg,cg)?Lx[t(ug,dg)].id==t(pg,fg)?null:Ox(Lx[t(mg,gg)].id):Lx[t(vg,_g)].id})),zx=t=>{const e=vx;let n=U(t)[e(eg,ng)]();return parseInt(n[e(ig,rg)](1),16)};let Vx=l(null);const Gx=()=>{const t=vx;Vx[t(jm,Jm)]=null,document[t(Qm,Km)](t(Zm,Ym))[t($m,tg)]()},Hx=c((()=>{const t=vx;return[t(Nm,Om),t(Um,Dm),t(Fm,Bm),t(zm,Vm)][t(Gm,Hm)](Lx[t(qm,Xm)])})),qx=t=>{const e=vx,n=t[e(pm,fm)][e(mm,gm)][0];Vx[e(vm,_m)]=n;const i=new FileReader;i[e(xm,ym)]=t=>{const n=e,i=t[n(Mm,wm)][n(Cm,Tm)];yx=gt[n(Em,Am)](i)[0];const r=K[n(Pm,Rm)](i);Lx[n(Wm,Lm)]=r[0][n(Im,km)],$x()},i[e(Sm,bm)](n)},Xx=()=>{const t=vx;Lx[t(hm,cm)]=!Lx[t(um,dm)]},jx=(t,...n)=>e(this,[t,...n],(function*(t,e=!0){const n=630,i="(hv1",r=1253,s="w6Dt",a=1256,o="7mHk",l=999,h="EtaP",c=1045,d="0X9c",p=706,f="9(V$",v=628,_="Plf*",x=903,y="1!88",S=1160,b="yJjA",M=782,w="aWYH",C=1076,T="1!88",E=876,A="0X9c",P=290,R="7(so";return new Promise(((W,L)=>{const I=769,k="7mHk",N=815,O="s[Tb",U=oh;if(Mx[t])yx=Mx[t],Lx[U(n,i)]=t,$x(),W(t);else{let n;e&&(n=u[U(r,s)]({content:_x(U(a,o),{fontName:t}),duration:0,closable:!0,background:!0}));let i=D(t,!0);m[U(l,h)](i,{responseType:U(c,d)})[U(p,f)]((e=>{const i=U;yx=gt[i(x,y)](e[i(S,b)])[0];const r=K[i(M,w)](e[i(C,T)]);Lx[i(E,A)]=r[0][i(P,R)],g(n),$x(),W(t)}))[U(v,_)]((e=>{const i=U;g(n),u[i(I,k)]({content:_x(i(N,O),{fontName:t}),duration:0,closable:!0,background:!0}),L()}))}}))})),Jx=()=>{const t=677,e="$u$y",n=670,i="yJjA",r=341,s="ue3n",a=951,o="0X9c",l=419,h="qGcn",c=1279,d="WQXK",p=vx;xx[p(Gf,Hf)]=!0,$x();let f=document[p(qf,Xf)](p(jf,Jf));if(Lx[p(Qf,Kf)]){u[p(Zf,Yf)]({content:_x(p($f,tm)),duration:3,closable:!0,background:!0});try{F(f,Z),xx[p(em,Kf)]=!1}catch(m){u[p(nm,im)]({content:_x(p(rm,Jf)),duration:0,closable:!0,background:!0}),f[p(sm,am)]((t=>{const e=p,n=e(a,o)+B()+e(l,h);z.saveAs(t,n),xx[e(c,d)]=!1}))}}else f[p(om,lm)]((a=>{const o=p,l=o(t,e)+B()+o(n,i);z.saveAs(a,l),xx[o(r,s)]=!1}))},Qx=()=>{const t=vx;let e=JSON[t(Ef,Af)](JSON[t(Pf,Rf)](Lx));e[t(Wf,Lf)][t(If,kf)]=null,V(JSON[t(Nf,Of)](e),t(Uf,Df),t(Ff,Bf),t(zf,Vf))},Kx=(t,e)=>{const n=vx;for(let i in e)i in t&&(typeof t[i]!==n(Cf,Tf)||null===t[i]||t[i]instanceof Array?t[i]=e[i]:Kx(t[i],e[i]))},Zx=t=>{const e=vx;let n=t[e(tf,ef)];if(t[e(nf,rf)]=Lx[e(sf,af)],Kx(Lx,t),jx(n),Lx[e(of,lf)][e(hf,cf)]==e(uf,df))Fx(Lx[e(pf,ff)].id);else if(Lx[e(mf,gf)][e(vf,_f)]==e(xf,yf)){(new wl)[e(Sf,bf)](Lx[e(Mf,wf)].id,(function(t){Ux(t)}))}},Yx=()=>{const t=742,e="vM3^",n=1206,i="sWYd",r=952,s="9oXx",a=vx;N({accept:a(Kp,Zp)})[a(Yp,$p)]((o=>{const l=618,h="ZoZr",c=691,u=")Qlt",d=a,[p]=o,f=new FileReader;f[d(t,e)](p,d(n,i)),f[d(r,s)]=()=>{const t=d;Zx(JSON[t(l,h)](f[t(c,u)]))}}))};function $x(t=!1){const e=vx;let n=Object[e(Op,Up)](bx);for(let i of n)Lx[e(Dp,Fp)]!=i&&null==bx[i][e(Bp,zp)]&&delete bx[i];xx&&yx&&Lx[e(Vp,Gp)]&&ny(Lx[e(Hp,qp)],t)}function ty(t){return e(this,null,(function*(){const e=981,n="sWYd",i=vx;if(wx[t])return new Promise((e=>{e(wx[t])}));{let r=u[i(Lp,Ip)]({content:_x(i(kp,Np)),duration:0,closable:!0,background:!0});const s=new wl;return new Promise(((a,o)=>{s[i(e,n)](t,(e=>{g(r),wx[t]=e,a(e)}),void 0,(t=>{g(),o(t)}))}))}}))}function ey(t){const e=vx;if(0==t[e(sp,ap)])return{x:0,y:0,width:0,height:0};for(var n=99999999999,i=-n,r=99999999999,s=-r,a=0;a<t[e(op,lp)];a+=2){var o=t[a],l=t[a+1];n=Math[e(hp,cp)](n,o),r=Math[e(up,dp)](r,l),i=Math[e(pp,fp)](i,o),s=Math[e(mp,gp)](s,l)}return{x:n,y:r,width:i-n,height:s-r}}const ny=(t,...n)=>e(this,[t,...n],(function*(t,e=!1){const n=vx;let i=Lx[n(Xs,js)]/1e3,r=Lx[n(Js,Qs)]*i/yx[n(Ks,Zs)][n(Ys,$s)];e&&xx[n(ta,ea)]();let s,a=Math[n(na,ia)](1e3*i),o=Math[n(ra,sa)](1e3*i),l=Sx[n(aa,oa)][n(la,ha)],h=Sx[n(ca,ua)][n(da,pa)];Sx[n(fa,ma)]=a,Sx[n(ga,va)]=o,xx[n(_a,xa)](a,o),Sx[n(ya,ma)][n(Sa,ba)]=l,Sx[n(aa,Ma)][n(wa,Ca)]=h,Lx[n(Ta,Ea)]==n(Aa,Pa)?(s=new _r(Lx[n(Ra,Wa)][n(La,Ia)],a/o,1,4e3*i),s[n(ka,Na)][n(Oa,Na)](Lx[n(Ua,Da)][n(Fa,Ba)].x*i,Lx[n(za,Ba)][n(Va,Ea)].y*i,Lx[n(Ga,Ha)][n(qa,Wa)].z*i)):(s=new Gr(a/-2,a/2,o/2,o/-2,1,4e3*i),s[n(Xa,ja)][n(Ja,Qa)](Lx[n(Ka,Za)][n(Ya,pa)].x*i,Lx[n($a,to)][n(eo,no)].y*i,Math[n(io,Na)](1e3,Math[n(ro,so)](-800,Lx[n(ao,lo)][n(ho,ua)].z))*i)),s[n(co,uo)](0,0,0);const c=new go;xx[n(po,va)](0,0);const d={steps:Lx[n(fo,vo)],curveSegments:Lx[n(_o,ma)],depth:Lx[n(xo,to)],bevelEnabled:Lx[n(yo,So)][n(bo,Mo)],bevelThickness:Lx[n(wo,ba)][n(Co,Qa)],bevelSize:Lx[n(To,ma)][n(Eo,Ao)],bevelOffset:Lx[n(Po,Ro)][n(Wo,Lo)],bevelSegments:Lx[n(Io,Ha)][n(ko,No)]};if(Lx[n(Oo,ma)][n(Uo,ea)]){const t=new Dl(16777215,Lx[n(Do,ua)][n(Fo,Bo)]);t[n(zo,Za)][n(Vo,Go)](Lx[n(Ho,Ao)][n(qo,Xo)].x,Lx[n(jo,Ao)][n(Jo,vo)].y,Lx[n(Qo,ja)][n(Ko,Zo)].z)[n(Yo,Da)](),c[n($o,$s)](t)}if(Lx[n(tl,el)][n(Uo,ea)]){const t=new Ol(16777215,4.5,0,0);t[n(nl,il)][n(rl,sl)](Lx[n(al,ol)][n(ll,cl)].x*i,Lx[n(gl,vl)][n(_l,xl)].y*i,Lx[n(yl,sa)][n(Sl,ol)].z*i),c[n(bl,Ao)](t)}if(Lx[n(Ml,Cl)][n(Tl,El)]){const t=new Wl(16777215);t[n(Al,Wa)][n(Pl,Rl)](Lx[n(Ll,Il)][n(kl,Nl)].x*i,Lx[n(Ul,Ca)][n(Fl,Bl)].y*i,Lx[n(zl,So)][n(Vl,$s)].z*i),c[n(Hl,ql)](t)}let p=t[n(Xl,jl)]("\n"),f=[],m=[],v=Lx[n(Jl,$s)]*i,_=Lx[n(Kl,Ha)]*i;for(let u of p){let t=0,e=0;for(let i of u){const s=i[n(Zl,Ao)](0);let a=ey(gt.U[n(Yl,$l)](yx,gt.U[n(th,eh)](yx,s))[n(nh,ih)]);t+=a[n(rh,xa)]*r,e=Math[n(lh,hh)](e,a[n(kh,Nh)]*r)}t+=(u[n(Oh,Uh)]-1)*v,f[n(Dh,Fh)](t),m[n(Bh,zh)](e)}let x=((p[n(Vh,Gh)]-1)*_+m[n(Hh,qh)](((t,e)=>t+e),0))/2-(m[n(Xh,jh)]>0?m[0]:0),y=bx[Lx[n(Jh,ol)]];y?y=y[n(tc,ec)]?y[n(nc,Zs)]:bx[n(ic,rc)][n(sc,Zh)]:(y=bx[n(Qh,Ea)][n(Kh,Zh)],function(t){const e=494,n="ngAa",i=1167,r="^[im",s=1292,a="vM3^",o=556,l="5o93",h=867,c="82&^",d=943,p="ngAa",f=1258,m="q62Z",v=949,_="sWYd",x=vx;let y=u[x(vp,_p)]({content:_x(x(xp,yp),{mtl:_x(x(Sp,bp)+t)}),duration:0,closable:!0,background:!0});bx[t]={type:x(Mp,wp),value:void 0},ty(x(Cp,Tp)+t+x(Ep,Ap))[x(Pp,Rp)]((e=>{const n=x;e[n(h,c)]=ae;const i=new ml({matcap:e,map:Lx[n(d,p)][n(f,m)]||null});bx[t][n(v,_)]=i,g(y),$x()}))[x(Wp,Tp)]((h=>{const c=x;y(),g(y),u[c(e,n)]({content:_x(c(i,r),{mtl:_x(c(s,a)+t)}),duration:0,closable:!0,background:!0}),bx[t]={type:c(o,l),value:void 0}}))}(Lx[n(Yh,$h)])),Lx[n(ac,oc)]==n(lc,jl)?(y[n(hc,cc)][n(uc,dc)](zx(Lx[n(pc,Qs)][n(fc,pa)])),y[n(mc,Cl)]=Lx[n(gc,vc)][n(_c,xc)],y[n(yc,Cl)]=Lx[n(Sc,bc)][n(Mc,wc)]):Lx[n(Cc,Tc)]==n(Ec,Ac)?(y[n(Pc,Rc)][n(Wc,Lc)](zx(Lx[n(Ic,jl)][n(kc,Nc)])),y[n(Oc,zh)][n(Uc,Dc)](zx(Lx[n(Fc,Bc)][n(zc,Vc)])),y[n(Gc,Hc)]=Lx[n(qc,Xc)][n(jc,va)],y[n(Jc,Qc)]=Lx[n(Kc,Fh)][n(Zc,vc)]):Lx[n(Yc,zh)]==n($c,tu)?y[n(eu,Vc)][n(nu,iu)](zx(Lx[n(ru,su)][n(au,ou)])):Lx[n(lu,hu)]==n(cu,uu)?(y[n(du,pu)][n(fu,Gh)](zx(Lx[n(mu,Ha)][n(gu,vu)])),y[n(_u,hu)]=Lx[n(xu,sa)][n(yu,Su)],y[n(bu,Mu)]=Lx[n(wu,Fh)][n(Cu,Tu)],y[n(Eu,Au)]=Lx[n(Pu,Ru)][n(Wu,ua)],y[n(Lu,Fh)]=Lx[n(Iu,rc)][n(ku,$l)],y[n(Nu,ua)]=Lx[n(Ou,Uu)][n(Du,Mo)],y[n(Fu,Bu)]=Lx[n(zu,Za)][n(Vu,Gu)],y[n(Hu,qu)]=Lx[n(Xu,ju)][n(Ju,Qu)],y[n(Ku,Zu)]=Lx[n(Yu,Il)][n($u,td)]):y[n(gu,vu)][n(ed,nd)](zx(Lx[n(id,rd)])),Lx[n(sd,ad)][n(od,ld)]?(y[n(hd,cd)]=!0,y[n(ud,So)]=Lx[n(dd,pd)][n(fd,$l)]):(y[n(md,sl)]=!0,y[n(gd,vd)]=null);for(let u=0;u<p[n(_d,Au)];u++){let t=p[u],e=-f[u]/2;for(let i of t){const t=i[n(xd,ba)](0);let s=gt.U[n(yd,Sd)](yx,gt.U[n(bd,Md)](yx,t)),a=ey(s[n(wd,Cd)]),o=gt.U[n(Td,$s)](s);if(0!=Lx[n(Ed,Ad)]&&o&&Lx[n(Pd,ea)][n(Rd,ju)]){let t=new(Ql[n(Wd,ql)])(o);t=sh(t,Lx[n(Ld,Id)],n(kd,Nc));var S=t[n(Nd,Od)]({asString:!0})[n(Ud,Da)](/d="([^"]+)"/),b=S?S[1]:null;b&&(o=b)}let l=n(Dd,jl)+o+n(Fd,Gh);const h=(new Gl)[n(Bd,Gh)](l)[n(zd,Gu)],u=new oo;for(let i=0;i<h[n(Vd,sl)];i++){const t=h[i],s=Gl[n(Gd,Go)](t);for(let i=0;i<s[n(Hd,xa)];i++){const t=s[i],a=new hl(t,d);a[n(qd,Xd)](r,r,r);const o=new ar(a,y);o[n(jd,Jd)][n(Qd,uo)](e,x,0),u[n(Kd,hh)](o)}}e+=a[n(Sa,ba)]*r+v,c[n(Zd,Qu)](u)}x-=m[u]+_}for(xx[n(Yd,$d)](c,s);c[n(tp,ep)][n(np,ip)]>0;)iy(c,c[n(rp,$h)][0])}));function iy(t,e){const n=vx;e&&(e[n(Os,Us)]((function(t){const e=n;t[e(Bs,zs)]&&t[e(Vs,Gs)][e(Hs,qs)]()})),t[n(Ds,Fs)](e))}u[vx(Se,be)]("");const ry=t=>{const e=vx;if(window[e(ys,Ss)]<=768)return;let n=document[e(bs,Ms)](e(ws,Cs));for(let i=0;i<n[e(Ts,Es)];i++)n[i][e(As,Ps)][e(Rs,Ws)]="ja"==t?e(Ls,Is):e(ks,Ns)};d((()=>e(this,null,(function*(){const t=vx;let e=p();Wx(e),ry(e),(()=>{const t=769,e="7mHk",n=1249,i="s[Tb",r=vx;m[r(a_,o_)](r(l_,h_))[r(c_,u_)]((t=>{const e=r;Nx[e(f_,m_)]=t[e(g_,v_)]}))[r(d_,p_)]((s=>{const a=r;u[a(t,e)]({content:_x(a(n,i)),duration:0,closable:!0,background:!0})}))})(),document[t(Ln,In)](t(kn,Nn),(e=>{const n=t;Tx[n(os,ls)]={collapseText:_x(n(hs,cs)),expandText:_x(n(us,ds))},Wx(e[n(ps,fs)][n(ms,gs)]),ry(e[n(vs,_s)][n(xs,ds)])})),Sx=document[t(On,Un)](t(Dn,Fn)),xx=new mo({canvas:Sx,antialias:!0,alpha:!0,preserveDrawingBuffer:!1}),bx[t(Bn,zn)]={type:t(Vn,Gn),value:new pl({color:zx(Lx[t(Hn,qn)][t(Xn,jn)]),specular:zx(Lx[t(Jn,Qn)][t(Kn,Zn)]),shininess:Lx[t(Yn,$n)][t(ti,ei)],flatShading:Lx[t(ni,ii)][t(ri,Gn)]})},bx[t(si,ai)]={type:t(oi,jn),value:new ul({color:zx(Lx[t(li,hi)][t(ci,ui)]),roughness:Lx[t(di,Zn)][t(pi,fi)],metalness:Lx[t(mi,gi)][t(vi,_i)]})},bx[t(xi,yi)]={type:t(Si,bi),value:new fl({color:zx(Lx[t(Mi,wi)][t(Ci,Ti)])})},bx[t(Ei,Ai)]={type:t(Pi,Ri),value:new dl({color:zx(Lx[t(Wi,Li)][t(Ii,ki)]),roughness:Lx[t(Ni,Zn)][t(Oi,Ui)],metalness:Lx[t(Di,Fi)][t(Bi,zi)],reflectivity:Lx[t(Vi,Gi)][t(Hi,qi)],transmission:Lx[t(Xi,ji)][t(Ji,Qi)],clearcoat:Lx[t(Ki,Ti)][t(Zi,Yi)],clearcoatRoughness:Lx[t($i,gi)][t(tr,er)],ior:Lx[t(nr,ir)][t(rr,Ti)],thickness:Lx[t(sr,or)][t(lr,hr)]})},Sx[t(cr,zn)](t(ur,dr),(function(e){e[t(ss,as)]()}),!1),sy(!1),jx(Lx[t(pr,fr)]);const n=new URL(window[t(mr,gr)][t(vr,xr)]),i=new URLSearchParams(n[t(yr,or)]);let r=Object[t(Sr,br)](i[t(Mr,wr)]()).id;if(!r&&(r=f(t(Cr,ui))),""!=r){sy(!1);let e=u[t(Tr,Er)]({content:_x(t(Ar,Pr)),duration:0,closable:!0,background:!0});m[t(Rr,Wr)](t(Lr,Ir)+r+t(kr,Ai))[t(Nr,$n)]((n=>{const i=t;g(e);let r=n[i(Vr,Hr)];document[i(qr,Xr)]=r[i(jr,Jr)],document[i(Qr,Kr)][i(Zr,Yr)]=r[i($r,ts)]||"en",v(r[i(es,ns)]),Zx(r[i(is,rs)])}))[t(Or,Ur)]((n=>{const i=t;g(e),u[i(Dr,Fr)]({content:_x(i(Br,zr)),duration:0,closable:!0,background:!0})}))}}))));const sy=(t=!0)=>{const e=vx;let n,i,r=document[e(qe,Xe)](e(je,Je)),s=document[e(Qe,Ke)](e(Ze,Ye))[e($e,tn)]();s[e(en,nn)]/s[e(rn,sn)]>1?(i=s[e(an,on)],n=1*s[e(ln,hn)]):(n=s[e(cn,un)],i=s[e(dn,pn)]/1),r[e(fn,mn)][e(gn,vn)]=n+"px",r[e(_n,xn)][e(yn,Sn)]=i+"px",r[e(bn,nn)][e(Mn,wn)]=(s[e(Cn,Tn)]-n)/2+"px",r[e(En,on)][e(An,Pn)]=(s[e(Rn,Wn)]-i)/2+"px",t&&$x()};return window[vx(Me,Ft)](vx(we,s),(()=>{sy()})),(t,e)=>{const n=347,i="lg6T",r=566,s="TMxE",a=1176,o="sWYd",l=961,h="w6Dt",c=715,u="(hv1",d=596,p="]cI3",f=1142,m="ngAa",g=318,v=")Qlt",I=505,k="XqkM",N=585,O="7(so",U=1240,D="55U3",F=1095,B=676,z="5o93",V=vx,X=G,j=Y,J=pt,Q=$,K=tt,Z=et,ft=ht,mt=nt,gt=it,vt=H,_t=q,xt=rt,yt=st,St=at,bt=ot,Mt=ct,wt=ut,Ct=lt;return _(),x(E,null,[y(J,null,{default:S((()=>[b(V(422,"o8ih"),ch,[b("a",{href:M(w)("")},dh,8,uh)]),b(V(423,"s[Tb"),null,[b("a",{href:M(w)(V(964,"aWYH")),target:V(784,"vM3^")},[y(X,{icon:V(529,"XqkM"),type:V(356,"$u$y")},{default:S((()=>[b(V(1252,"aWYH"),null,C(t.$t(V(918,"ZoZr"))),1)])),_:1})],8,ph)]),b(V(370,"(Q*U"),null,[b("a",{href:M(w)(V(647,"5o93")),target:V(477,"xT8v")},[y(X,{icon:V(1163,"tzxO"),type:V(675,"L4Dk")},{default:S((()=>[b(V(452,"$fSK"),null,C(t.$t(V(802,"vM3^"))),1)])),_:1})],8,fh)]),y(j,null,{default:S((()=>[y(dt)])),_:1})])),_:1}),y(mt,{title:V(Ce,Te),placement:V(Ee,Ae),closable:!1,modelValue:M(Lx)[V(Pe,Re)],"onUpdate:modelValue":e[2]||(e[2]=t=>M(Lx)[V(865,"&^wU")]=t)},{default:S((()=>[y(j,{direction:V(554,"^[im")},{default:S((()=>[y(Q,{placeholder:V(962,"dTQt"),modelValue:M(Ax),"onUpdate:modelValue":e[0]||(e[0]=t=>T(Ax)?Ax[V(958,"w6Dt")]=t:null),style:{width:V(613,"]cI3")},search:"",onOnChange:Rx},null,8,[V(1031,"dTQt")]),y(Z,{modelValue:M(Tx)[V(540,"5o93")],"onUpdate:modelValue":e[1]||(e[1]=t=>M(Tx)[V(1161,"xT8v")]=t),expandable:"","hide-check-all":"",locale:M(Tx)[V(1039,"L4Dk")],onOnChange:Ex},{default:S((()=>[(_(),x(E,null,A(Cx,(t=>{const e=V;return y(K,{name:t,key:t},{default:S((()=>[P(C(t),1)])),_:2},1032,[e(B,z)])})),64))])),_:1},8,[V(948,"tzxO"),V(459,"TMxE")]),(_(!0),x(E,null,A(M(Px),(t=>{const e=V;return _(),x(e(r,s),{key:t[e(a,o)],onClick:n=>jx(t[e(912,"(hv1")]),style:{cursor:e(l,h)},class:e(c,u)},[t[e(d,p)]?(_(),x(e(f,m),gh,[y(ft,{src:t[e(g,v)],width:e(I,k),height:e(N,O),fit:e(U,D),lazy:""},null,8,[e(F,O)])])):R("",!0)],8,mh)})),128))])),_:1})])),_:1},8,[V(We,Le)]),b(V(Ie,ke),vh,[_h,b(V(Ne,Oe),xh,[y(j,{direction:V(Ue,De)},{default:S((()=>[y(j,null,{default:S((()=>[y(X,{onClick:Yx,type:V(795,"5UlT")},{default:S((()=>[P(C(t.$t(V(548,"lg6T"))),1)])),_:1}),y(X,{onClick:Qx,type:V(795,"5UlT")},{default:S((()=>[P(C(t.$t(V(888,"&^wU"))),1)])),_:1})])),_:1}),b(V(422,"o8ih"),null,[y(j,{direction:V(1105,"5UlT")},{default:S((()=>[b(V(1085,"tzxO"),null,C(t.$t(V(1273,"^[im"))),1),y(Q,{modelValue:M(Lx)[V(268,"bQ1J")],"onUpdate:modelValue":e[3]||(e[3]=t=>M(Lx)[V(322,"xzGU")]=t),type:V(901,"0X9c"),placeholder:M(_x)(V(762,"&^wU")),onOnChange:e[4]||(e[4]=t=>$x())},null,8,[V(1071,"5o93"),V(391,"ue3n")])])),_:1})]),b(V(787,"jBgu"),null,[b(V(619,"qGcn"),null,C(t.$t(V(914,"WQXK"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(1130,"Plf*")],"onUpdate:modelValue":e[5]||(e[5]=t=>M(Lx)[V(936,"5o93")]=t),onOnInput:e[6]||(e[6]=t=>$x()),min:256,max:4096,step:1},null,8,[V(1146,"WQXK")])]),y(j,null,{default:S((()=>[y(X,{onClick:Jx,type:V(1018,"7(so")},{default:S((()=>[P(C(t.$t(V(988,"krV0"))),1)])),_:1}),b(V(809,"xT8v"),null,C(t.$t(V(1080,"q62Z"))),1),y(_t,{content:t.$t(V(713,"TMxE"))},{default:S((()=>[y(vt,{type:V(649,"&^wU")})])),_:1},8,[V(600,"tzxO")]),y(xt,{modelValue:M(Lx)[V(235,"Plf*")],"onUpdate:modelValue":e[7]||(e[7]=t=>M(Lx)[V(620,"DTCC")]=t),size:V(834,"[d42")},null,8,[V(274,")Qlt")])])),_:1}),b(V(1108,"ZoZr"),null,[b(V(452,"$fSK"),yh,C(t.$t(V(1276,"WQXK"))),1),y(Q,{modelValue:M(Lx)[V(615,"sWYd")],"onUpdate:modelValue":e[8]||(e[8]=t=>M(Lx)[V(1013,"bQ1J")]=t),readonly:"",style:{"margin-bottom":V(1181,"@&40")},onClick:Xx},{prepend:S((()=>[b(V(729,"q62Z"),null,C(t.$t(V(877,"sWYd"))),1)])),append:S((()=>[y(vt,{type:V(702,"sWYd")})])),_:1},8,[V(307,"yJjA")]),b(V(1026,"aWYH"),{type:V(1082,"o8ih"),id:V(673,"tzxO"),style:{display:V(953,"q62Z")},onChange:qx,accept:V(722,"$u$y")},null,32)]),y(X,{onClick:Gx,type:V(919,"(hv1")},{default:S((()=>[P(C(t.$t(V(965,"]cI3"))),1)])),_:1}),b(V(766,"ue3n"),null,[b(V(788,"$u$y"),null,C(t.$t(V(874,"xzGU"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(560,")Qlt")],"onUpdate:modelValue":e[9]||(e[9]=t=>M(Lx)[V(816,"TMxE")]=t),onOnInput:e[10]||(e[10]=t=>$x()),min:0,max:1e3,step:1},null,8,[V(804,"82&^")])]),b(V(1277,"$MoL"),null,[b(V(809,"xT8v"),null,C(t.$t(V(950,"WQXK"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(806,"w6Dt")],"onUpdate:modelValue":e[11]||(e[11]=t=>M(Lx)[V(1286,"0X9c")]=t),onOnInput:e[12]||(e[12]=t=>$x()),min:0,max:100,step:1},null,8,[V(1097,"q62Z")])]),b(V(787,"jBgu"),null,[b(V(233,"L4Dk"),null,C(t.$t(V(1111,"o8ih"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(818,"$fSK")],"onUpdate:modelValue":e[13]||(e[13]=t=>M(Lx)[V(386,"WQXK")]=t),onOnInput:e[14]||(e[14]=t=>$x()),min:0,max:100,step:1},null,8,[V(426,"ngAa")])]),b(V(1277,"$MoL"),null,[b(V(835,"^[im"),null,C(t.$t(V(1143,"s[Tb"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(1104,"EtaP")],"onUpdate:modelValue":e[15]||(e[15]=t=>M(Lx)[V(458,"(Q*U")]=t),onOnInput:e[16]||(e[16]=t=>$x()),min:0,max:4e3,step:1},null,8,[V(972,"qGcn")])])])),_:1}),y(Ct,{simple:""},{default:S((()=>[y(bt,{name:V(747,"aWYH")},{content:S((()=>[y(j,{direction:V(1112,"]cI3"),type:V(1103,"@&40")},{default:S((()=>[b(V(1202,"(hv1"),null,[y(St,{modelValue:M(Lx)[V(438,"Q3Ap")],"onUpdate:modelValue":e[17]||(e[17]=t=>M(Lx)[V(836,"jBgu")]=t),onOnChange:e[18]||(e[18]=t=>$x())},{default:S((()=>[(_(),x(E,null,A(Ix,(e=>{const n=V;return y(yt,{label:e,key:e},{default:S((()=>[P(C(t.$t(n(587,"yJjA")+e)),1)])),_:2},1032,[n(Ge,He)])})),64))])),_:1},8,[V(1034,"vM3^")])]),M(Lx)[V(385,"&^wU")]==V(748,"7(so")?(_(),x(V(680,"7(so"),bh,[y(j,{direction:V(825,"7(so"),type:V(253,"55U3")},{default:S((()=>[b(V(457,"sWYd"),null,[b(V(636,"&^wU"),null,C(t.$t(V(780,"0X9c"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(354,"L4Dk")][V(1060,"$fSK")],"onUpdate:modelValue":e[19]||(e[19]=t=>M(Lx)[V(905,"ngAa")][V(700,"Q3Ap")]=t),onOnInput:e[20]||(e[20]=t=>$x()),min:0,max:360,step:1},null,8,[V(1259,"Q3Ap")])]),b(V(1277,"$MoL"),null,[b(V(680,"7(so"),null,C(t.$t(V(508,"7mHk"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(642,"Q3Ap")][V(1195,"ZoZr")].x,"onUpdate:modelValue":e[21]||(e[21]=t=>M(Lx)[V(397,"9oXx")][V(726,"o8ih")].x=t),onOnInput:e[22]||(e[22]=t=>$x()),min:-1e3,max:1e3,step:1},null,8,[V(493,"@&40")])]),b(V(233,"L4Dk"),null,[b(V(752,"dTQt"),null,C(t.$t(V(1133,"DTCC"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(598,"ZoZr")][V(1298,"7mHk")].y,"onUpdate:modelValue":e[23]||(e[23]=t=>M(Lx)[V(812,"5o93")][V(850,"^[im")].y=t),onOnInput:e[24]||(e[24]=t=>$x()),min:-1e3,max:1e3,step:1},null,8,[V(493,"@&40")])]),b(V(787,"jBgu"),null,[b(V(435,"9oXx"),null,C(t.$t(V(635,"xT8v"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(418,"82&^")][V(555,"jBgu")].z,"onUpdate:modelValue":e[25]||(e[25]=t=>M(Lx)[V(390,"xT8v")][V(1193,"w6Dt")].z=t),onOnInput:e[26]||(e[26]=t=>$x()),min:-2e3,max:2e3,step:1},null,8,[V(1030,"0X9c")])])])),_:1})])):R("",!0),M(Lx)[V(986,"(hv1")]==V(1116,"xT8v")?(_(),x(V(835,"^[im"),Mh,[y(j,{direction:V(239,"ZoZr"),type:V(379,"Q3Ap")},{default:S((()=>[b(V(328,"vM3^"),null,[b(V(778,"bQ1J"),null,C(t.$t(V(1002,"ngAa"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(250,"WQXK")][V(726,"o8ih")].x,"onUpdate:modelValue":e[27]||(e[27]=t=>M(Lx)[V(1004,"9(V$")][V(541,"qGcn")].x=t),onOnInput:e[28]||(e[28]=t=>$x()),min:-1e3,max:1e3,step:1},null,8,[V(972,"qGcn")])]),b(V(610,")Qlt"),null,[b(V(422,"o8ih"),null,C(t.$t(V(261,"5UlT"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(925,"xzGU")][V(456,"yJjA")].y,"onUpdate:modelValue":e[29]||(e[29]=t=>M(Lx)[V(1004,"9(V$")][V(617,"ue3n")].y=t),onOnInput:e[30]||(e[30]=t=>$x()),min:-1e3,max:1e3,step:1},null,8,[V(891,"$MoL")])]),b(V(233,"L4Dk"),null,[b(V(1192,"7mHk"),null,C(t.$t(V(1197,"7mHk"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(925,"xzGU")][V(716,"7(so")].z,"onUpdate:modelValue":e[31]||(e[31]=t=>M(Lx)[V(1069,"PNut")][V(436,"aWYH")].z=t),onOnInput:e[32]||(e[32]=t=>$x()),min:-2e3,max:2e3,step:1},null,8,[V(1259,"Q3Ap")])])])),_:1})])):R("",!0)])),_:1})])),default:S((()=>[b(V(256,"9oXx"),Sh,C(t.$t(V(1093,"q62Z"))),1)])),_:1}),y(bt,{name:V(731,"xT8v")},{content:S((()=>[y(j,{direction:V(733,"WQXK"),type:V(978,"1!88")},{default:S((()=>[b(V(772,"PNut"),null,[y(St,{modelValue:M(Lx)[V(640,"WQXK")],"onUpdate:modelValue":e[33]||(e[33]=t=>M(Lx)[V(450,"5o93")]=t),onOnChange:e[34]||(e[34]=t=>(()=>{const t=vx;Lx[t(Xp,jp)]=t(Jp,Qp),$x()})())},{default:S((()=>[(_(),x(E,null,A(kx,(e=>{const r=V;return y(yt,{label:e,key:e},{default:S((()=>[P(C(t.$t(r(814,"0X9c")+e)),1)])),_:2},1032,[r(n,i)])})),64))])),_:1},8,[V(1122,"PNut")])])])),_:1}),M(Lx)[V(348,"$MoL")]==V(538,"XqkM")?(_(),W(j,{key:0,direction:V(719,"5o93"),type:V(695,"PNut")},{default:S((()=>[y(j,{direction:V(707,"jBgu")},{default:S((()=>[b(V(1202,"(hv1"),null,C(M(_x)(V(930,"]cI3"))),1),y(L,{pureColor:M(Lx)[V(776,"5UlT")][V(1226,"55U3")],"onUpdate:pureColor":e[35]||(e[35]=t=>M(Lx)[V(1169,")Qlt")][V(975,"EtaP")]=t),onPureColorChange:e[36]||(e[36]=t=>$x()),alpha:""},null,8,[V(280,"EtaP")])])),_:1}),b(V(885,"xzGU"),null,[b(V(1085,"tzxO"),null,C(M(_x)(V(1165,"9(V$"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(433,"0X9c")][V(937,")Qlt")],"onUpdate:modelValue":e[37]||(e[37]=t=>M(Lx)[V(1084,"q62Z")][V(755,"vM3^")]=t),onOnInput:e[38]||(e[38]=t=>$x()),min:0,max:1,step:.05},null,8,[V(701,"(hv1")])]),b(V(684,"9(V$"),null,[b(V(457,"sWYd"),null,C(M(_x)(V(643,"$fSK"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(1266,"Plf*")][V(760,"q62Z")],"onUpdate:modelValue":e[39]||(e[39]=t=>M(Lx)[V(460,"55U3")][V(485,"s[Tb")]=t),onOnInput:e[40]||(e[40]=t=>$x()),min:0,max:1,step:.05},null,8,[V(704,"[d42")])])])),_:1})):R("",!0),M(Lx)[V(1268,"EtaP")]==V(1207,"dTQt")?(_(),W(j,{key:1,direction:V(399,"aWYH"),type:V(1103,"@&40")},{default:S((()=>[y(j,{direction:V(1238,"ngAa")},{default:S((()=>[b(V(545,"lg6T"),null,C(M(_x)(V(1198,"q62Z"))),1),y(L,{pureColor:M(Lx)[V(1149,"9oXx")][V(685,"aWYH")],"onUpdate:pureColor":e[41]||(e[41]=t=>M(Lx)[V(800,"1!88")][V(476,"^[im")]=t),onPureColorChange:e[42]||(e[42]=t=>$x()),alpha:""},null,8,[V(371,"bQ1J")])])),_:1}),b(V(902,"w6Dt"),null,[b(V(684,"9(V$"),null,C(M(_x)(V(756,"vM3^"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(801,"lg6T")][V(515,"jBgu")],"onUpdate:modelValue":e[43]||(e[43]=t=>M(Lx)[V(377,"w6Dt")][V(589,"qGcn")]=t),onOnInput:e[44]||(e[44]=t=>$x()),min:0,max:1,step:.05},null,8,[V(972,"qGcn")])]),b(V(1142,"ngAa"),null,[b(V(902,"w6Dt"),null,C(M(_x)(V(1113,"dTQt"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(592,"[d42")][V(718,"dTQt")],"onUpdate:modelValue":e[45]||(e[45]=t=>M(Lx)[V(828,"(hv1")][V(1090,"XqkM")]=t),onOnInput:e[46]||(e[46]=t=>$x()),min:0,max:1,step:.05},null,8,[V(701,"(hv1")])]),b(V(1011,"XqkM"),null,[b(V(1106,"WQXK"),null,C(M(_x)(V(866,")Qlt"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(479,"]cI3")][V(880,"XqkM")],"onUpdate:modelValue":e[47]||(e[47]=t=>M(Lx)[V(800,"1!88")][V(398,"jBgu")]=t),onOnInput:e[48]||(e[48]=t=>$x()),min:0,max:1,step:.05},null,8,[V(443,"5UlT")])]),b(V(1092,"Q3Ap"),null,[b(V(606,"q62Z"),null,C(M(_x)(V(359,"q62Z"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(531,"jBgu")][V(1191,"s[Tb")],"onUpdate:modelValue":e[49]||(e[49]=t=>M(Lx)[V(1150,"DTCC")][V(430,"qGcn")]=t),onOnInput:e[50]||(e[50]=t=>$x()),min:0,max:1,step:.05},null,8,[V(1131,"]cI3")])]),b(V(457,"sWYd"),null,[b(V(946,"55U3"),null,C(M(_x)(V(365,"XqkM"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(531,"jBgu")][V(312,"aWYH")],"onUpdate:modelValue":e[51]||(e[51]=t=>M(Lx)[V(1127,"bQ1J")][V(574,"jBgu")]=t),onOnInput:e[52]||(e[52]=t=>$x()),min:0,max:1,step:.05},null,8,[V(524,"w6Dt")])]),b(V(435,"9oXx"),null,[b(V(363,"DTCC"),null,C(M(_x)(V(234,"aWYH"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(674,"TMxE")][V(697,"TMxE")],"onUpdate:modelValue":e[53]||(e[53]=t=>M(Lx)[V(1127,"bQ1J")][V(1023,"$fSK")]=t),onOnInput:e[54]||(e[54]=t=>$x()),min:0,max:1,step:.05},null,8,[V(948,"tzxO")])]),b(V(1057,"5UlT"),null,[b(V(1221,"]cI3"),null,C(M(_x)(V(353,"o8ih"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(588,"82&^")][V(1175,"yJjA")],"onUpdate:modelValue":e[55]||(e[55]=t=>M(Lx)[V(881,"q62Z")][V(1204,"ue3n")]=t),onOnInput:e[56]||(e[56]=t=>$x()),min:1,max:3,step:.05},null,8,[V(948,"tzxO")])]),b(V(457,"sWYd"),null,[b(V(835,"^[im"),null,C(M(_x)(V(1159,"Plf*"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(882,"WQXK")][V(287,"jBgu")],"onUpdate:modelValue":e[57]||(e[57]=t=>M(Lx)[V(1127,"bQ1J")][V(1194,"9(V$")]=t),onOnInput:e[58]||(e[58]=t=>$x()),min:0,max:10,step:.05},null,8,[V(757,"sWYd")])])])),_:1})):R("",!0),M(Lx)[V(1017,"7mHk")]==V(954,"DTCC")?(_(),W(j,{key:2,direction:V(1223,"w6Dt"),type:V(1137,"xT8v")},{default:S((()=>[y(j,{direction:V(374,"9oXx")},{default:S((()=>[b(V(1085,"tzxO"),null,C(M(_x)(V(424,"$fSK"))),1),y(L,{pureColor:M(Lx)[V(1250,"^[im")][V(1038,"82&^")],"onUpdate:pureColor":e[59]||(e[59]=t=>M(Lx)[V(931,"(hv1")][V(1261,"(Q*U")]=t),onPureColorChange:e[60]||(e[60]=t=>$x()),alpha:""},null,8,[V(1048,"xT8v")])])),_:1}),b(V(872,"aWYH"),null,[b(V(809,"xT8v"),null,C(M(_x)(V(682,"5UlT"))),1),y(L,{pureColor:M(Lx)[V(448,"o8ih")][V(817,"^[im")],"onUpdate:pureColor":e[61]||(e[61]=t=>M(Lx)[V(771,"$fSK")][V(1128,"$u$y")]=t),onPureColorChange:e[62]||(e[62]=t=>$x()),alpha:""},null,8,[V(665,"1!88")])]),b(V(315,"$fSK"),null,[b(V(668,"82&^"),null,C(M(_x)(V(301,"(hv1"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(932,"ngAa")][V(626,"w6Dt")],"onUpdate:modelValue":e[63]||(e[63]=t=>M(Lx)[V(1251,"5UlT")][V(567,"EtaP")]=t),onOnInput:e[64]||(e[64]=t=>$x()),min:0,max:500,step:1},null,8,[V(1155,"7mHk")])])])),_:1})):R("",!0),M(Lx)[V(348,"$MoL")]==V(849,"xzGU")?(_(),W(j,{key:3,direction:V(230,"9(V$"),type:V(686,"aWYH")},{default:S((()=>[y(j,{direction:V(230,"9(V$"),type:V(976,"5o93")},{default:S((()=>[b(V(457,"sWYd"),null,C(M(_x)(V(273,"sWYd"))),1),y(L,{pureColor:M(Lx)[V(830,"TMxE")][V(236,"Plf*")],"onUpdate:pureColor":e[65]||(e[65]=t=>M(Lx)[V(968,"EtaP")][V(395,"]cI3")]=t),onPureColorChange:e[66]||(e[66]=t=>$x()),alpha:""},null,8,[V(244,"s[Tb")])])),_:1})])),_:1})):R("",!0),M(Hx)?R("",!0):(_(),W(j,{key:4},{default:S((()=>[b(V(619,"qGcn"),null,C(M(_x)(V(1264,"Plf*"))),1),y(L,{pureColor:M(Lx)[V(242,"WQXK")],"onUpdate:pureColor":e[67]||(e[67]=t=>M(Lx)[V(878,"Q3Ap")]=t),onPureColorChange:e[68]||(e[68]=t=>$x()),alpha:""},null,8,[V(1114,"TMxE")])])),_:1}))])),default:S((()=>[b(V(1272,"(hv1"),wh,C(t.$t(V(1218,"ue3n"))),1)])),_:1}),y(bt,{name:V(669,"aWYH")},{content:S((()=>[y(j,{direction:V(1223,"w6Dt"),type:V(413,"7mHk")},{default:S((()=>[b(V(1142,"ngAa"),null,[b(V(946,"55U3"),null,C(t.$t(V(1020,"7(so"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(257,"TMxE")][V(1186,"]cI3")],"onUpdate:modelValue":e[69]||(e[69]=t=>M(Lx)[V(898,"$MoL")][V(497,"xT8v")]=t),onOnInput:e[70]||(e[70]=t=>(()=>{const t=vx;let e=bx[Lx[t(Hg,qg)]];if(e&&e[t(Xg,jg)]&&e[t(Jg,Qg)][t(Kg,Zg)]){e=e[t(Yg,$g)];let n=e[t(tv,ev)],i=n[t(nv,iv)][t(rv,sv)]/n[t(av,ov)][t(lv,Zg)],r=1/Lx[t(hv,cv)][t(uv,dv)]/n[t(pv,fv)][t(mv,gv)];e[t(_v,xv)][t(yv,vv)][t(Sv,bv)](r,r*i),e[t(Mv,wv)][t(Cv,Tv)]=!0,$x()}})()),min:.1,max:10,step:.05},null,8,[V(1097,"q62Z")])]),M(Bx)?(_(),W(j,{key:0,direciton:V(496,"o8ih")},{default:S((()=>[b(V(1136,"1!88"),null,C(t.$t(V(1139,"9(V$"))),1),b(V(566,"TMxE"),Th,[y(ft,{src:M(Bx),fit:V(758,"EtaP"),width:V(579,"xT8v"),height:V(672,"sWYd"),lazy:""},null,8,[V(1164,"lg6T")])])])),_:1})):R("",!0),y(wt,{border:!0,hover:!0,col:4,padding:V(277,"xT8v")},{default:S((()=>[y(Mt,{class:V(417,"WQXK"),onClick:Dx},{default:S((()=>[b(V(472,"5o93"),Eh,[y(vt,{type:V(608,"DTCC"),size:"64"})])])),_:1}),y(Mt,{class:V(1267,"55U3"),onClick:e[71]||(e[71]=t=>Fx(V(544,"9oXx")))},{default:S((()=>[b(V(636,"&^wU"),Ah,[y(vt,{type:V(1055,"DTCC"),size:"32"})])])),_:1}),(_(!0),x(E,null,A(M(Nx),(t=>{const e=V;return _(),W(Mt,{class:e(Fe,Be),key:t.id,onClick:e=>Fx(t.id)},{default:S((()=>[y(ft,{src:Ox(t.id),fit:e(411,"xzGU"),width:e(489,"sWYd"),height:e(939,"jBgu"),alt:t.id,lazy:""},{error:S((()=>[y(vt,{type:e(492,"PNut"),size:"24"})])),_:2},1032,[e(1037,"(Q*U"),e(526,"ngAa")])])),_:2},1032,[e(ze,Ve)])})),128))])),_:1})])),_:1})])),default:S((()=>[b(V(393,"55U3"),Ch,C(t.$t(V(1275,"qGcn"))),1)])),_:1}),y(bt,{name:V(917,"w6Dt")},{content:S((()=>[M(Hx)?(_(),W(j,{key:1,direction:V(525,"$fSK"),type:V(1263,"5UlT")},{default:S((()=>[b(V(328,"vM3^"),null,[y(j,{direction:V(306,"yJjA")},{default:S((()=>[b(V(809,"xT8v"),null,C(M(_x)(V(678,"&^wU"))),1),y(xt,{modelValue:M(Lx)[V(920,"DTCC")][V(329,"7(so")],"onUpdate:modelValue":e[72]||(e[72]=t=>M(Lx)[V(1070,"7(so")][V(594,"lg6T")]=t),onOnChange:e[73]||(e[73]=t=>$x())},null,8,[V(1034,"vM3^")])])),_:1})]),b(V(233,"L4Dk"),null,[b(V(566,"TMxE"),null,C(t.$t(V(913,"7(so"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(326,"(hv1")][V(1156,"9(V$")].x,"onUpdate:modelValue":e[74]||(e[74]=t=>M(Lx)[V(1283,"7mHk")][V(553,"bQ1J")].x=t),onOnInput:e[75]||(e[75]=t=>$x()),min:-2e3,max:2e3,step:1},null,8,[V(426,"ngAa")])]),b(V(772,"PNut"),null,[b(V(772,"PNut"),null,C(t.$t(V(376,"(hv1"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(1064,"sWYd")][V(436,"aWYH")].y,"onUpdate:modelValue":e[76]||(e[76]=t=>M(Lx)[V(1124,"ngAa")][V(1046,"krV0")].y=t),onOnInput:e[77]||(e[77]=t=>$x()),min:-2e3,max:2e3,step:1},null,8,[V(871,"1!88")])]),b(V(752,"dTQt"),null,[b(V(610,")Qlt"),null,C(t.$t(V(1241,"5UlT"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(1162,"5o93")][V(819,"EtaP")].z,"onUpdate:modelValue":e[78]||(e[78]=t=>M(Lx)[V(1231,"@&40")][V(945,"Plf*")].z=t),onOnInput:e[79]||(e[79]=t=>$x()),min:-2e3,max:2e3,step:1},null,8,[V(519,"EtaP")])])])),_:1})):(_(),x(V(680,"7(so"),Rh,C(t.$t(V(977,"5UlT")+M(Lx)[V(1268,"EtaP")]))+C(t.$t(V(1254,"EtaP"))),1))])),default:S((()=>[b(V(452,"$fSK"),Ph,C(t.$t(V(484,"tzxO"))),1)])),_:1}),y(bt,{name:V(471,"w6Dt")},{content:S((()=>[M(Hx)?(_(),W(j,{key:1,direction:V(662,"bQ1J"),type:V(1065,"qGcn")},{default:S((()=>[y(j,{direction:V(829,"bQ1J")},{default:S((()=>[b(V(610,")Qlt"),null,C(M(_x)(V(427,"TMxE"))),1),y(xt,{modelValue:M(Lx)[V(586,"L4Dk")][V(1228,"krV0")],"onUpdate:modelValue":e[80]||(e[80]=t=>M(Lx)[V(632,"TMxE")][V(559,"^[im")]=t),onOnChange:e[81]||(e[81]=t=>$x())},null,8,[V(1213,"(Q*U")])])),_:1}),b(V(1221,"]cI3"),null,[b(V(885,"xzGU"),null,C(t.$t(V(763,"o8ih"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(1288,"o8ih")][V(503,"$fSK")],"onUpdate:modelValue":e[82]||(e[82]=t=>M(Lx)[V(586,"L4Dk")][V(1087,"(Q*U")]=t),onOnInput:e[83]||(e[83]=t=>$x()),min:0,max:5,step:.05},null,8,[V(1182,"Plf*")])]),b(V(899,"[d42"),null,[b(V(652,"Plf*"),null,C(t.$t(V(793,"aWYH"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(1063,"aWYH")][V(993,"dTQt")].x,"onUpdate:modelValue":e[84]||(e[84]=t=>M(Lx)[V(1129,"$u$y")][V(1236,"55U3")].x=t),onOnInput:e[85]||(e[85]=t=>$x()),min:-2e3,max:2e3,step:1},null,8,[V(757,"sWYd")])]),b(V(787,"jBgu"),null,[b(V(1057,"5UlT"),null,C(t.$t(V(279,"ZoZr"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(1209,"xzGU")][V(317,"$MoL")].y,"onUpdate:modelValue":e[86]||(e[86]=t=>M(Lx)[V(699,"55U3")][V(887,"5o93")].y=t),onOnInput:e[87]||(e[87]=t=>$x()),min:-2e3,max:2e3,step:1},null,8,[V(810,"s[Tb")])]),b(V(809,"xT8v"),null,[b(V(1142,"ngAa"),null,C(t.$t(V(1257,"bQ1J"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(304,"&^wU")][V(1236,"55U3")].z,"onUpdate:modelValue":e[88]||(e[88]=t=>M(Lx)[V(1209,"xzGU")][V(602,"82&^")].z=t),onOnInput:e[89]||(e[89]=t=>$x()),min:-2e3,max:2e3,step:1},null,8,[V(948,"tzxO")])])])),_:1})):(_(),x(V(545,"lg6T"),Lh,C(t.$t(V(551,"5o93")+M(Lx)[V(631,"(Q*U")]))+C(t.$t(V(535,"ue3n"))),1))])),default:S((()=>[b(V(724,"XqkM"),Wh,C(t.$t(V(923,"7mHk"))),1)])),_:1}),y(bt,{name:V(1172,"(hv1")},{content:S((()=>[y(j,{direction:V(1081,"PNut"),type:V(959,"vM3^")},{default:S((()=>[y(j,{direction:V(861,"L4Dk")},{default:S((()=>[b(V(619,"qGcn"),null,C(M(_x)(V(1054,"L4Dk"))),1),y(xt,{modelValue:M(Lx)[V(451,"@&40")][V(1235,"EtaP")],"onUpdate:modelValue":e[90]||(e[90]=t=>M(Lx)[V(388,"EtaP")][V(864,"jBgu")]=t),onOnChange:e[91]||(e[91]=t=>$x())},null,8,[V(272,"9oXx")])])),_:1}),b(V(328,"vM3^"),null,[b(V(1108,"ZoZr"),null,C(t.$t(V(1296,"Q3Ap"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(275,"$u$y")][V(909,"(hv1")],"onUpdate:modelValue":e[92]||(e[92]=t=>M(Lx)[V(286,"9oXx")][V(316,"lg6T")]=t),onOnInput:e[93]||(e[93]=t=>$x()),min:0,max:2e3,step:1},null,8,[V(1021,"DTCC")])]),b(V(591,"yJjA"),null,[b(V(787,"jBgu"),null,C(t.$t(V(1078,"tzxO"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(368,"(hv1")],"onUpdate:modelValue":e[94]||(e[94]=t=>M(Lx)[V(1247,"PNut")]=t),onOnInput:e[95]||(e[95]=t=>$x()),min:-80,max:80,step:1},null,8,[V(871,"1!88")])]),b(V(423,"s[Tb"),null,[b(V(1277,"$MoL"),null,C(t.$t(V(785,"$MoL"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(1274,"5o93")][V(367,"]cI3")],"onUpdate:modelValue":e[96]||(e[96]=t=>M(Lx)[V(342,"DTCC")][V(607,"o8ih")]=t),onOnInput:e[97]||(e[97]=t=>$x()),min:0,max:200,step:1},null,8,[V(272,"9oXx")])]),b(V(835,"^[im"),null,[b(V(472,"5o93"),null,C(t.$t(V(262,"qGcn"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(1293,"tzxO")][V(1187,"9(V$")],"onUpdate:modelValue":e[98]||(e[98]=t=>M(Lx)[V(1280,"ue3n")][V(1225,"(Q*U")]=t),onOnInput:e[99]||(e[99]=t=>$x()),min:0,max:100,step:1},null,8,[V(648,"bQ1J")])]),b(V(873,"krV0"),null,[b(V(435,"9oXx"),null,C(t.$t(V(516,"$u$y"))),1),y(gt,{"active-change":!1,"show-input":"",modelValue:M(Lx)[V(1005,"0X9c")][V(432,"o8ih")],"onUpdate:modelValue":e[100]||(e[100]=t=>M(Lx)[V(639,"Plf*")][V(924,"9(V$")]=t),onOnInput:e[101]||(e[101]=t=>$x()),min:0,max:100,step:1},null,8,[V(1213,"(Q*U")])])])),_:1})])),default:S((()=>[b(V(396,"EtaP"),Ih,C(t.$t(V(969,"5UlT"))),1)])),_:1})])),_:1})])])],64)}}});var Nh=Oh;function Oh(t,e){var n=Uh();return Oh=function(e,i){var r=n[e-=174];if(void 0===Oh.NqgmWZ){Oh.rNCYqy=function(t,e){var n,i,r=[],s=0,a="";for(t=function(t){for(var e,n,i="",r="",s=0,a=0;n=t.charAt(a++);~n&&(e=s%4?64*e+n:n,s++%4)?i+=String.fromCharCode(255&e>>(-2*s&6)):0)n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(n);for(var o=0,l=i.length;o<l;o++)r+="%"+("00"+i.charCodeAt(o).toString(16)).slice(-2);return decodeURIComponent(r)}(t),i=0;i<256;i++)r[i]=i;for(i=0;i<256;i++)s=(s+r[i]+e.charCodeAt(i%e.length))%256,n=r[i],r[i]=r[s],r[s]=n;i=0,s=0;for(var o=0;o<t.length;o++)s=(s+r[i=(i+1)%256])%256,n=r[i],r[i]=r[s],r[s]=n,a+=String.fromCharCode(t.charCodeAt(o)^r[(r[i]+r[s])%256]);return a},t=arguments,Oh.NqgmWZ=!0}var s=e+n[0],a=t[s];return a?r=a:(void 0===Oh.gkyYbC&&(Oh.gkyYbC=!0),r=Oh.rNCYqy(r,i),t[s]=r),r},Oh(t,e)}function Uh(){var t=["W65pW5hdGw00vSkgx3BdNSo5","WQHcWRLTfmo6WO/cL03dHSo5mSk0","WRCSW64VWP/dO8oAkfPbW6BcHa","z8ojhshcMtC0W5aidf7cVW","nI3cG3XrW5JcVWiNW6JcKMq","mspcG3PvW5/cKqOJW6BcHKq","DSoGvslcTmoFB8kkxrtdU1zW","WRXfWQtdRSkPWP0BW6pdKxBcIrvGwSoK","hHpdS8ouW7KstWRdSuGqDSoWWPK","WPdcHSk/WQddTComcH4","WPLDwmk2rxldUe03s8o9WP4JW4m","D8oHawtdVSkXnCk0","Cmkvt8oYW4NdLb8VW5iiWO7dPbi","sdP/mSkaWRuezLy","WRWnW6HiW51NW7HCWPrhtCof","WPRdRmk0W4zWCCk/WRe","i0eCzmkAWP85FG","hrtcO8kxWRH+gfq","kCoXW6hcGCkVWPmBoa","i0Dea8oDW4SUASoRkCk0Aa","q8oEW73dOSkihsm","WRHbt0O0CaC","W7tdOSk9wZxcMfFdKCkEECo8zKu","rIhcTmoXWODUhq","rSoCW73dImkwdbq","rmkMWQxcNmostHJdM8oVjSk1lG"];return(Uh=function(){return t})()}!function(t,e){for(var n=184,i="]isW",r=178,s="&WFt",a=190,o="]rsg",l=188,h=196,c="iC^G",u=183,d="4^Ww",p=175,f="iC^G",m=186,g="ClUg",v=189,_=179,x="S^nb",y=199,S="HHGi",b=174,M="s8Wr",w=Oh,C=Uh();;)try{if(340977===-parseInt(w(n,i))/1*(-parseInt(w(r,s))/2)+parseInt(w(a,o))/3+parseInt(w(l,i))/4*(-parseInt(w(h,c))/5)+-parseInt(w(u,d))/6*(parseInt(w(p,f))/7)+-parseInt(w(m,g))/8+-parseInt(w(v,i))/9*(parseInt(w(_,x))/10)+parseInt(w(y,S))/11*(parseInt(w(b,M))/12))break;C.push(C.shift())}catch(T){C.push(C.shift())}}();const Dh=J(kh,[[Nh(177,"Ds$)"),Nh(197,"mQik")]]);export{Dh as default};
