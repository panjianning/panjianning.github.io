import{a as e,L as i,aB as t,A as a,P as r,r as n,o as l,l as o,D as s,e as d,t as g,E as h,C as m,s as c,c as p}from"./main.0517a3e2.js";const f={name:"Image",mixins:[i],components:{ImagePreview:t},emits:["on-load","on-error","on-switch","on-close","on-click"],props:{src:{type:String,default:""},alt:{type:String,default:""},preview:{type:Boolean,default:!1},referrerPolicy:{type:String,default:""},width:{type:[String,Number],default:""},height:{type:[String,Number],default:""},fit:{type:String,default:""},lazy:{type:Boolean,default:!1},scrollContainer:{type:[String],default:""},transfer:{type:Boolean,default(){const e=a().appContext.config.globalProperties;return!(!e.$VIEWUI||""===e.$VIEWUI.transfer)&&e.$VIEWUI.transfer}},maskClosable:{type:Boolean,default:!0},previewList:{type:Array},infinite:{type:Boolean,default:!0},initialIndex:{type:Number,default:0},previewTip:{type:Boolean,default:!0},toolbar:{type:Array,default(){const e=a().appContext.config.globalProperties;return e.$VIEWUI&&e.$VIEWUI.image&&""!==e.$VIEWUI.image.toolbar?e.$VIEWUI.image.toolbar:["zoomIn","zoomOut","original","rotateLeft","rotateRight","download"]}}},data:()=>({loadingImage:!1,loading:!1,imageError:!1,scrollElement:null,observer:null,imagePreviewModal:!1}),watch:{src(){this.loadImage()}},computed:{innerClasses(){return["ivu-image-inner",{"ivu-image-cursor":this.preview}]},imgClasses(){return["ivu-image-img",{"ivu-image-img-hidden":this.loading||this.imageError}]},fitStyle(){const{fit:e}=this;return["fill","contain","cover","none","scale-down"].includes(e)?`object-fit:${e};`:""},imageStyles(){return{width:"number"==typeof this.width?`${this.width}px`:this.width,height:"number"==typeof this.height?`${this.height}px`:this.height}},loadingLang(){return this.t("i.select.loading")},failLang(){return this.t("i.image.fail")},previewLang(){return this.t("i.image.preview")},loadingType(){return this.lazy?"lazy":"eager"}},mounted(){r&&this.handleImageEvent()},methods:{handleLazy(){const e=this.$refs.image;(this.observer=new IntersectionObserver(this.handlerObserveImage,{root:this.scrollElement,rootMargin:"0px",threshold:0})).observe(e)},handlerObserveImage(e){for(let i of e)i.isIntersecting&&(this.offObserver(),this.loadImage())},addLazyImageListener(){const{scrollContainer:e}=this;var i;this.scrollElement=null,i=e,"object"==typeof HTMLElement&&i instanceof HTMLElement?this.scrollElement=e:e&&"string"==typeof e&&(this.scrollElement=document.querySelector(e)),this.handleLazy()},handleImageLoad(){this.loading=!1,this.imageError=!1,this.$emit("on-load")},handleImageError(){this.loading=!1,this.imageError=!0,this.loadingImage=!1,this.$emit("on-error")},loadImage(){this.loading=!0,this.imageError=!1,this.loadingImage=!0},handleImageEvent(){const{lazy:e}=this;e?this.addLazyImageListener():this.loadImage()},offObserver(){const{observer:e}=this;e&&e.disconnect()},handlePreview(){const{preview:e,initialIndex:i}=this;e&&(this.imagePreviewModal=!0,this.$emit("on-click",{initialIndex:i}))},handleClose(){this.$emit("on-close")},handleSwitch(e){this.$emit("on-switch",e)}},beforeUnmount(){this.offObserver()}},u={key:0,class:"ivu-image-placeholder"},v={key:1,class:"ivu-image-error"},y=["alt","src","loading","referrerPolicy"],I={class:"ivu-image-mark"};const w=e(f,[["render",function(e,i,t,a,r,f){const w=n("ImagePreview");return l(),o("div",{class:"ivu-image",ref:"image",style:c(f.imageStyles)},[r.loading?(l(),o("div",u,[s(e.$slots,"placeholder",{},(()=>[d("span",null,g(f.loadingLang),1)]))])):r.imageError?(l(),o("div",v,[s(e.$slots,"error",{},(()=>[d("span",null,g(f.failLang),1)]))])):h("",!0),r.loadingImage?(l(),o("div",{key:2,class:m(f.innerClasses),onClick:i[2]||(i[2]=(...e)=>f.handlePreview&&f.handlePreview(...e))},[d("img",{class:m(f.imgClasses),style:c([f.fitStyle]),alt:t.alt,src:t.src,loading:f.loadingType,referrerPolicy:t.referrerPolicy,onLoad:i[0]||(i[0]=(...e)=>f.handleImageLoad&&f.handleImageLoad(...e)),onError:i[1]||(i[1]=(...e)=>f.handleImageError&&f.handleImageError(...e))},null,46,y),t.preview&&t.previewTip?s(e.$slots,"preview",{key:0},(()=>[d("div",I,[d("span",null,g(f.previewLang),1)])])):h("",!0)],2)):h("",!0),t.preview?(l(),p(w,{key:3,modelValue:r.imagePreviewModal,"onUpdate:modelValue":i[3]||(i[3]=e=>r.imagePreviewModal=e),"preview-list":t.previewList,"initial-index":t.initialIndex,infinite:t.infinite,"mask-closable":t.maskClosable,transfer:t.transfer,toolbar:t.toolbar,onOnClose:f.handleClose,onOnSwitch:f.handleSwitch},null,8,["modelValue","preview-list","initial-index","infinite","mask-closable","transfer","toolbar","onOnClose","onOnSwitch"])):h("",!0)],4)}]]);export{w as I};
